

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">
  <link href="https://fonts.proxy.ustclug.org/css2?family=Noto+Serif+SC&display=swap" rel="stylesheet">

 <link rel="apple-touch-icon" sizes="76x76" href="/img/1avatar.png">
  <link rel="icon" href="/img/1avatar.png">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="D3n13d">
  <meta name="keywords" content="Web,CTF,渗透测试">
  
    <meta name="description" content="信息安全-C++逆向基础存储单位​    bit     最小单位 0&#x2F;1 ​    Byte  1Byte&#x3D;8bit ​    DWORD   1DWORD&#x3D;2Byte 寄存器通用寄存器​    eax    累加器寄存器，用于进行数学运算。 ​    ebx    基数寄存器 ​    ecx    计数器 ​    edx    数据寄存器 ​    ESI    原地址寄存器 ​    E">
<meta property="og:type" content="article">
<meta property="og:title" content="C++逆向笔记">
<meta property="og:url" content="https://d3n13d.github.io/2022/01/07/C-%E9%80%86%E5%90%91%E7%AC%94%E8%AE%B0/index.html">
<meta property="og:site_name" content="D3n13d &#39;s blog">
<meta property="og:description" content="信息安全-C++逆向基础存储单位​    bit     最小单位 0&#x2F;1 ​    Byte  1Byte&#x3D;8bit ​    DWORD   1DWORD&#x3D;2Byte 寄存器通用寄存器​    eax    累加器寄存器，用于进行数学运算。 ​    ebx    基数寄存器 ​    ecx    计数器 ​    edx    数据寄存器 ​    ESI    原地址寄存器 ​    E">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://photo-1308752946.cos.ap-beijing.myqcloud.com/img/Typora/202112261422135.png">
<meta property="og:image" content="https://photo-1308752946.cos.ap-beijing.myqcloud.com/img/Typora/202112261718094.png">
<meta property="article:published_time" content="2022-01-07T08:44:13.000Z">
<meta property="article:modified_time" content="2022-01-09T03:43:46.330Z">
<meta property="article:author" content="D3n13d">
<meta property="article:tag" content="Web,CTF,渗透测试">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="https://photo-1308752946.cos.ap-beijing.myqcloud.com/img/Typora/202112261422135.png">
  
  
  <title>C++逆向笔记 - D3n13d &#39;s blog</title>

  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css" />


  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/github-markdown-css@4/github-markdown.min.css" />
  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hint.css@2/hint.min.css" />

  
    
    
      
      <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@10/styles/github-gist.min.css" />
    
  

  
    <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3/dist/jquery.fancybox.min.css" />
  


<!-- 主题依赖的图标库，不要自行修改 -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_ba1fz6golrf.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_lbnruvf0jn.css">


<link  rel="stylesheet" href="/css/main.css" />

<!-- 自定义样式保持在最底部 -->

  
<link rel="stylesheet" href="//cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.css">



  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    var CONFIG = {"hostname":"d3n13d.github.io","root":"/","version":"1.8.14","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":2,"color":"#29d","options":{"showSpinner":true,"trickleSpeed":80}},"copy_btn":true,"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":2},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":false,"baidu":null,"google":null,"gtag":null,"tencent":{"sid":null,"cid":null},"woyaola":21256305,"cnzz":null,"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false}},"search_path":"/local-search.xml"};
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
<meta name="generator" content="Hexo 6.0.0"><link rel="alternate" href="/atom.xml" title="D3n13d 's blog" type="application/atom+xml">
</head>


<body>
  <header style="height: 70vh;">
    <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>D3n13d &#39;s blog</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                首页
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/">
                <i class="iconfont icon-archive-fill"></i>
                时间线
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/">
                <i class="iconfont icon-category-fill"></i>
                分类
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/">
                <i class="iconfont icon-tags-fill"></i>
                标签
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/">
                <i class="iconfont icon-user-fill"></i>
                关于
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/links/">
                <i class="iconfont icon-link-fill"></i>
                友人
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              &nbsp;<i class="iconfont icon-search"></i>&nbsp;
            </a>
          </li>
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">&nbsp;<i
                class="iconfont icon-dark" id="color-toggle-icon"></i>&nbsp;</a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

    <div class="banner" id="banner" parallax=true
         style="background: url('/img/bg/tree.jpg') no-repeat center center;
           background-size: cover;">
      <div class="full-bg-img">
        <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
          <div class="page-header text-center fade-in-up">
            <span class="h2" id="subtitle" title="C++逆向笔记">
              
            </span>

            
              <div class="mt-3">
  
  
    <span class="post-meta">
      <i class="iconfont icon-date-fill" aria-hidden="true"></i>
      <time datetime="2022-01-07 16:44" pubdate>
        2022年1月7日 下午
      </time>
    </span>
  
</div>

<div class="mt-1">
  
    <span class="post-meta mr-2">
      <i class="iconfont icon-chart"></i>
      33k 字
    </span>
  

  
    <span class="post-meta mr-2">
      <i class="iconfont icon-clock-fill"></i>
      
      
      278 分钟
    </span>
  

  
  
</div>

            
          </div>

          
        </div>
      </div>
    </div>
  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="d-none d-lg-block col-lg-2"></div>
    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div class="py-5" id="board">
          <article class="post-content mx-auto">
            <!-- SEO header -->
            <h1 style="display: none">C++逆向笔记</h1>
            
            <div class="markdown-body">
              <h1 id="信息安全-C-逆向"><a href="#信息安全-C-逆向" class="headerlink" title="信息安全-C++逆向"></a>信息安全-C++逆向</h1><h2 id="基础"><a href="#基础" class="headerlink" title="基础"></a>基础</h2><h3 id="存储单位"><a href="#存储单位" class="headerlink" title="存储单位"></a>存储单位</h3><p>​    bit     最小单位 0/1</p>
<p>​    Byte  1Byte=8bit</p>
<p>​    DWORD   1DWORD=2Byte</p>
<h3 id="寄存器"><a href="#寄存器" class="headerlink" title="寄存器"></a>寄存器</h3><h4 id="通用寄存器"><a href="#通用寄存器" class="headerlink" title="通用寄存器"></a>通用寄存器</h4><p>​    eax    累加器寄存器，用于进行数学运算。</p>
<p>​    ebx    基数寄存器</p>
<p>​    ecx    计数器</p>
<p>​    edx    数据寄存器</p>
<p>​    ESI    原地址寄存器</p>
<p>​    EDI    目的寄存器</p>
<p>​    EBP    栈底    </p>
<p>​    ESP    栈顶</p>
<p>​    EIP    指令寄存器，EIP指向下一个将会被执行的指令。</p>
<p>寄存器大小都是32位 (四个字节) 。它们可以储存值为从0-FFFFFFFF (无符号)的数据</p>
<h4 id="段寄存器"><a href="#段寄存器" class="headerlink" title="段寄存器"></a>段寄存器</h4><ol>
<li>CS -&gt; ‘code segment’(代码段寄存器)：用于存放应用程序代码所在段的段基址(之后会说明)</li>
<li>DS -&gt; ‘data segment’(数据段寄存器)：用于存放数据段的段基址(以后会说明)</li>
<li>ES -&gt; ‘extra segment’(附加段寄存器)：用于存放程序使用的附加数据段的基地址</li>
<li>SS -&gt; ‘stack segment’(栈段寄存器)：用于存放栈段的段基址(以后会说明)</li>
</ol>
<h4 id="标志寄存器"><a href="#标志寄存器" class="headerlink" title="标志寄存器"></a>标志寄存器</h4><p>ZF、OF、CF</p>
<p><strong>Z-Flag(零标志)：</strong></p>
<p>ZF是破解中用得最多的寄存器(通常情况下占了90%)，它可以设成0或者1。若上一个运算结果为0，则其值为1，否则其值为0。(你可能会问为什么‘CMP’可以操作ZF寄存器，这是因为该指令在做比较操作(等于、不等于)，那什么时候结果是0什么时候是1呢？待会再说) </p>
<p><strong>The O-Flag(溢出标志)：</strong></p>
<p>OF寄存器在逆向工程中大概占了4%，当上一步操作改变了某寄存器的最高有效位时，OF寄存器会被设置成1。例如：EAX的值为7FFFFFFFF，如果你此时再给EAX加1，OF寄存器就会被设置成1，因为此时EAX寄存器的最高有效位改变了(你可以使用电脑自带计算器将这个16进制转化成2进制看看)。还有当上一步操作产生溢出时(即算术运算超出了有符号数的表示范围)，OF寄存器也会被设置成1。 </p>
<p><strong>The C-Flag(进位标志)：</strong></p>
<p>进位寄存器的使用大概占了1%，如果产生了溢出，就会被设置成1。例，假如某寄存器值为FFFFFFFF，再加上1就会产生溢出，你可以用电脑自带的计算器尝试。 </p>
<h4 id="指令"><a href="#指令" class="headerlink" title="指令"></a>指令</h4><p><strong>CALL (调用)</strong></p>
<p>语法：CALL something</p>
<p>CALL指令将当前的相对地址(IP)压入栈中，并且调用CALL 后的子程序</p>
<p>CALL 可以这样使用：</p>
<figure class="highlight html"><table><tr><td class="gutter"><div class="code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><pre><code class="hljs html">CALL 404000                ;; 最常见: CALL 地址CALL EAX                   ;<br>; CALL 寄存器 - 如果寄存器存的值为404000，那就等同于第一种情况CALL DWORD PTR [EAX]       ;; <br>CALL [EAX]偏移量所指向的地址CALL DWORD PTR [EAX+5]     ;;‘’<br>CALL [EAX+5]偏移量所指向的地址<br></code></pre></td></tr></table></figure>

<p><strong>CDQ</strong></p>
<p>语法：CDQ</p>
<p>CDQ指令第一次出现时通常不好理解。它通常出现在除法前面，作用是将EDX的所有位变成EAX最高位的值，</p>
<p>比如当EAX&gt;=80000000h时，其二进制最高位为1，则EDX被32位全赋值为1，即FFFFFFFF</p>
<p>若EAX&lt;80000000，则其二进制最高位为0，EDX为00000000。</p>
<p>然后将EDX：EAX组成新数(64位)：FFFFFFFF 80000000</p>
<p><strong>DEC (自减)</strong></p>
<p>语法: DEC something</p>
<p>dec用来自减1，相当于c中的–</p>
<p>dec可以有以下使用方式：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs html">dec eax                             ;; eax自减1dec [eax]                           ;; 偏移量为eax的值自减1dec [401000]                        ;; 偏移量为401000的值自减1dec [eax+401000]                    ;; 偏移量为eax+401000的值自减1<br></code></pre></td></tr></table></figure>

<p>dec指令可以标记ZF、OF</p>
<p><strong>DIV (除)</strong></p>
<p>语法: DIV 除数</p>
<p>DIV指令用来将EAX除以除数(无符号除法)，被除数通常是EAX，结果也储存在EAX中，而被除数对除数取的模存在除数中。</p>
<p>例：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs html">mov eax,64                      ;<br>; EAX = 64h = 100<br>mov ecx,9                       ;; <br>ECX = 9<br>div ecx                         ;; EAX除以ECX<br></code></pre></td></tr></table></figure>

<p>在除法之后 EAX = 100/9 = 0B(十进制：11) 并且 ECX = 100 MOD 9 = 1</p>
<p>div指令可以标记CF、OF、ZF</p>
<p><strong>IDIV (整除)</strong></p>
<p>语法: IDIV 除数</p>
<p>IDIV执行方式同div一样，不过IDIV是有符号的除法</p>
<p>idiv指令可以标记CF、OC、ZF</p>
<p><strong>IMUL (整乘)</strong></p>
<p>语法：IMUL 数值</p>
<p>IMUL 目标寄存器、数值、数值</p>
<p>IMUL 目标寄存器、数值</p>
<p>IMUL指令可以把让EAX乘上一个数(INUL 数值)或者让两个数值相乘并把乘积放在目标寄存器中(IMUL 目标寄存器, 数值,数值)或者将目标寄存器乘上某数值(IMUL 目标寄存器, 数值)</p>
<p>如果乘积太大目标寄存器装不下，那OF、CF都会被标记，ZF也会被标记</p>
<p><strong>JUMPS</strong></p>
<p>这些都是最重要的跳转指令和触发条件(重要用*标记，最重要用**标记)：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs html">指令                条件                    条件<br>JA*          -    如果大于就跳转(无符号)      - CF=0 and ZF=0<br>JAE          -    如果大于或等于就跳转(无符号)- CF=0JB*          -    如果小于就跳转(无符号)   - CF=<br>1JBE          -    如果小于或等于就跳转(无符号)- CF=1 or ZF=1<br>JC           -    如果CF被标记就了跳转       - CF=1JCXZ         -    如果CX等于0就跳转      - CX=0<br>JE**         -    如果相等就跳转        - ZF=1<br>JECXZ        -    如果ECX等于0就跳转       - ECX=0JG*          -    如果大于就跳转(有符号)   - ZF=0 and SF=OF (SF = Sign Flag)<br><br>JL          -    如果小于就跳转(有符号)    - SF != OF (!= is not)<br>JLE         -    如果小于或等于就跳转(有符号 - ZF=1 and OF != OF<br>JMP      -    跳转             - 强制跳转JNA          -    如果不大于就跳转(无符号)   - CF=1 or ZF=1<br>JNAE         -    如果不大于等于就跳转(无符号) - CF=1<br>JNB          -    如果不小于就跳转(无符号)   - CF=0JNBE         -    如果不小于等于就跳转(无符号) - CF=0 and ZF=0JNC          -    如果CF未被标记就跳转     - CF=0JNE**        -    如果不等于就跳转       - ZF=0JNG          -    如果不大于就跳转(有符号)   - ZF=1 or SF!=OF<br>JGE*         -    如果大于或等于就跳转(有符号) - SF=OF<br>JNGE         -    如果不大于等于就跳转(有符号) - SF!=OF<br>JNL          -    如果不小于就跳转(有符号)   - SF=OF<br>JNLE         -    如果不小于等于就跳转(有符号) - ZF=0 and SF=OF<br>JNO          -    如果OF未被标记就跳转     - OF=0<br>JNP          -    如果PF未被标记就跳转     - PF=0<br>JNS          -    如果SF未被标记就跳转      - SF=0<br>JNZ          -    如果不等于0就跳转      - ZF=0JO           -    如果OF被标记就跳转     - OF=1JP           -    如果PF被标记就跳转     - PF=1<br>JPE          -    如果是偶数就跳转       - PF=1JPO          -    如果是奇数就跳转       - PF=0<br>JS           -    如果SF被标记就跳转     - SF=1<br>JZ           -    如果等于0就跳转      - ZF=1<br></code></pre></td></tr></table></figure>

<p><strong>MUL (乘法)</strong></p>
<p>语法：MUL 数值</p>
<p>这个指令同IMUL一样，不过MUL可以乘无符号数。</p>
<p><strong>REP/REPE/REPZ/REPNE/REPNZ</strong></p>
<p>语法: REP/REPE/REPZ/REPNE/REPNZ ins</p>
<p>重复上面的指令：直到CX=0。ins必须是一个操作符，比如CMPS、INS、LODS、MOVS、OUTS、SCAS 或 STOS</p>
<p><strong>RET (返回)</strong></p>
<p>语法：RET</p>
<p>RET digit</p>
<p>RET指令的功能是从一个代码区域中退出到调用CALL的指令处。</p>
<p>RET digit在返回前会清理栈</p>
<p><strong>TEST</strong></p>
<p>语法：TEST 操作符、操作符</p>
<p>这个指令99%都是用于”TEST EAX, EAX”，它执行与AND相同的功能，但是并不储存数据。如果EAX=0就会标记ZF，如果EAX不是0，就会清空ZF</p>
<p><strong>XOR</strong></p>
<p>语法：XOR 目的数,源数</p>
<p>XOR指令对两个数进行异或操作</p>
<p>这个指令清空OF、CF，但会标记ZF</p>
<p>为了更好的理解，思考下面的二进制串：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs html">1001010110 0101001101<br></code></pre></td></tr></table></figure>

<p>如果异或它们，结果将是1100011011</p>
<p>如果两个值相等，则结果为0，否则为1，你可以使用计算器验算。</p>
<p>很多情况下我们会使用”XOR EAX, EAX”，这个操作是将EAX赋值为0，因为当一个值异或其自身，就过都是0。</p>
<h2 id="选择结构语句"><a href="#选择结构语句" class="headerlink" title="选择结构语句"></a>选择结构语句</h2><h3 id="if"><a href="#if" class="headerlink" title="if"></a>if</h3><h4 id="Only-ifelse"><a href="#Only-ifelse" class="headerlink" title="Only ifelse"></a>Only ifelse</h4><p>特点：</p>
<p>​    cmp ;条件反写，为了跳过后面的jxx 进而执行代码块内容</p>
<p>​    if else则都是往增量地址跳转</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-keyword">int</span> argc, <span class="hljs-keyword">char</span>* argv[])</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span> nNumber = <span class="hljs-number">0</span>;<br>    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%ud&quot;</span>,&amp;nNumber);<br>    <span class="hljs-keyword">if</span>(argc == <span class="hljs-number">0</span>)<br>    &#123;<br>        nNumber = <span class="hljs-number">0</span>;                <span class="hljs-comment">//第一种情况下无分支</span><br>    &#125;<br>    <span class="hljs-keyword">else</span><br>    &#123;<br>        nNumber = <span class="hljs-number">-1</span>;<br>    &#125;<br>    <span class="hljs-keyword">return</span> nNumber;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>对应反汇编结果</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs c">; <span class="hljs-function"><span class="hljs-keyword">int</span> __cdecl <span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-keyword">int</span> argc, <span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span> **argv, <span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span> **envp)</span></span><br><span class="hljs-function">	<span class="hljs-keyword">public</span> main</span><br><span class="hljs-function">	main proc near</span><br><span class="hljs-function">	</span><br><span class="hljs-function">	var_4</span>= dword ptr <span class="hljs-number">-4</span><br>	arg_0= dword ptr  <span class="hljs-number">10</span>h<br>	arg_8= qword ptr  <span class="hljs-number">18</span>h<br>	<br>	push    rbp<br>	mov     rbp, rsp  <span class="hljs-comment">//初始化栈</span><br>	sub     rsp, <span class="hljs-number">30</span>h   <span class="hljs-comment">//开辟栈</span><br>	mov     [rbp+arg_0], ecx <br>	mov     [rbp+arg_8], rdx<br>	call    __main<br>	mov     [rbp+var_4], <span class="hljs-number">0</span>   <span class="hljs-comment">//[rbp-4] =0 val1=0</span><br>	lea     rax, [rbp+var_4]  <br>	mov     rdx, rax<br>	lea     rcx, Format     ; <span class="hljs-string">&quot;%ud&quot;</span><br>	call    <span class="hljs-built_in">scanf</span>  <span class="hljs-comment">//scanf读入数据</span><br>	cmp     [rbp+arg_0], <span class="hljs-number">0</span>   <span class="hljs-comment">// argc==0</span><br>	jnz     <span class="hljs-keyword">short</span> loc_40158D<br>       <span class="hljs-comment">//分支1</span><br>        mov     [rbp+var_4], <span class="hljs-number">0</span>  <br>		jmp     <span class="hljs-keyword">short</span> loc_401594<br>       <span class="hljs-comment">//分支2</span><br>        loc_40158D:<br>		mov     [rbp+var_4], <span class="hljs-number">0F</span>FFFFFFFh <span class="hljs-comment">// 代码中体现的是变量值=-1 这里为什么是0FFFFFFFF</span><br>     <br></code></pre></td></tr></table></figure>

<h4 id="onlyifelse1"><a href="#onlyifelse1" class="headerlink" title="onlyifelse1"></a>onlyifelse1</h4><p>特点：</p>
<p>​    不能调换if和else的位置，因为代码的位置不能变，否则某些依赖代码位置的计算会出错</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-keyword">int</span> argc, <span class="hljs-keyword">char</span>* argv[])</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span> nNumber = <span class="hljs-number">0</span>;<br>    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%ud&quot;</span>,&amp;nNumber);<br>    <span class="hljs-keyword">if</span>(argc == nNumber)<br>    &#123;<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d&quot;</span>,nNumber / <span class="hljs-number">8</span>);<br>    &#125;<br>    <span class="hljs-keyword">else</span><br>    &#123;<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d&quot;</span>,nNumber / <span class="hljs-number">5</span>);<br>    &#125;<br>    <span class="hljs-keyword">return</span> nNumber;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>对应反汇编结果</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><code class="hljs c">; <span class="hljs-function"><span class="hljs-keyword">int</span> __cdecl <span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-keyword">int</span> argc, <span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span> **argv, <span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span> **envp)</span></span><br><span class="hljs-function">.text:0000000000401550                 <span class="hljs-keyword">public</span> main</span><br><span class="hljs-function">.text:0000000000401550 main            proc near               </span>; CODE XREF: __tmainCRTStartup+<span class="hljs-number">242</span>↑p<br>.text:<span class="hljs-number">0000000000401550</span>                                         ; DATA XREF: .pdata:<span class="hljs-number">000000000040506</span>C↓o<br>.text:<span class="hljs-number">0000000000401550</span><br>.text:<span class="hljs-number">0000000000401550</span> var_4           = dword ptr <span class="hljs-number">-4</span><br>.text:<span class="hljs-number">0000000000401550</span> arg_0           = dword ptr  <span class="hljs-number">10</span>h  <span class="hljs-comment">//对应argc</span><br>.text:<span class="hljs-number">0000000000401550</span> arg_8           = qword ptr  <span class="hljs-number">18</span>h    <span class="hljs-comment">//argv</span><br>.text:<span class="hljs-number">0000000000401550</span><br>.text:<span class="hljs-number">0000000000401550</span>                 push    rbp<br>.text:<span class="hljs-number">0000000000401551</span>                 mov     rbp, rsp<br>.text:<span class="hljs-number">0000000000401554</span>                 sub     rsp, <span class="hljs-number">30</span>h<br>.text:<span class="hljs-number">0000000000401558</span>                 mov     [rbp+arg_0], ecx<br>.text:<span class="hljs-number">000000000040155B</span>                 mov     [rbp+arg_8], rdx<br>.text:<span class="hljs-number">000000000040155F</span>                 call    __main     <span class="hljs-comment">//main函数开始</span><br>.text:<span class="hljs-number">0000000000401564</span>                 mov     [rbp+var_4], <span class="hljs-number">0</span>  ; var_a=<span class="hljs-number">0</span><br>.text:<span class="hljs-number">000000000040156B</span>                 lea     rax, [rbp+var_4]    <br>.text:<span class="hljs-number">000000000040156F</span>                 mov     rdx, rax        ; rdx=<span class="hljs-number">0</span><br>.text:<span class="hljs-number">0000000000401572</span>                 lea     rcx, Format     ; <span class="hljs-string">&quot;%ud&quot;</span><br>.text:<span class="hljs-number">0000000000401579</span>                 call    <span class="hljs-built_in">scanf</span><br>.text:<span class="hljs-number">000000000040157</span>E                 mov     edx, [rbp+arg_0]  <span class="hljs-comment">//argc</span><br>.text:<span class="hljs-number">0000000000401581</span>                 mov     eax, [rbp+var_4] <span class="hljs-comment">//var_a=0</span><br>.text:<span class="hljs-number">0000000000401584</span>                 cmp     edx, eax  <span class="hljs-comment">//if(argc==var_a)&#123; var_a=var_a/8;printf(&quot;%d&quot;,); &#125;</span><br>.text:<span class="hljs-number">0000000000401586</span>                 jnz     <span class="hljs-keyword">short</span> loc_40159E<br>.text:<span class="hljs-number">0000000000401588</span>                 mov     eax, [rbp+var_4]  <span class="hljs-comment">//eax=0</span><br>.text:<span class="hljs-number">000000000040158B</span>                 shr     eax, <span class="hljs-number">3</span>          ; /<span class="hljs-number">8</span><br>.text:<span class="hljs-number">000000000040158</span>E                 mov     edx, eax  <br>.text:<span class="hljs-number">0000000000401590</span>                 lea     rcx, aD         ; <span class="hljs-string">&quot;%d&quot;</span><br>.text:<span class="hljs-number">0000000000401597</span>                 call    <span class="hljs-built_in">printf</span>   <br>.text:<span class="hljs-number">000000000040159</span>C                 jmp     <span class="hljs-keyword">short</span> loc_4015BB<br>.text:<span class="hljs-number">000000000040159</span>E ; ---------------------------------------------------------------------------<br>.text:<span class="hljs-number">000000000040159</span>E<br>.text:<span class="hljs-number">000000000040159</span>E loc_40159E:                             ; CODE XREF: main+<span class="hljs-number">36</span>↑j  <span class="hljs-comment">//else </span><br>.text:<span class="hljs-number">000000000040159</span>E                 mov     eax, [rbp+var_4]  <span class="hljs-comment">//eax=var_a</span><br>.text:<span class="hljs-number">00000000004015</span>A1                 mov     edx, <span class="hljs-number">0</span>CCCCCCCDh<br>.text:<span class="hljs-number">00000000004015</span>A6                 mul     edx   <span class="hljs-comment">//eax * 0CCCCCCCDh</span><br>.text:<span class="hljs-number">00000000004015</span>A8                 mov     eax, edx  <span class="hljs-comment">//</span><br>.text:<span class="hljs-number">00000000004015</span>AA                 shr     eax, <span class="hljs-number">2</span>   <span class="hljs-comment">//eax/4</span><br>.text:<span class="hljs-number">00000000004015</span>AD                 mov     edx, eax<br>.text:<span class="hljs-number">00000000004015</span>AF                 lea     rcx, aD         ; <span class="hljs-string">&quot;%d&quot;</span><br>.text:<span class="hljs-number">00000000004015B</span>6                 call    <span class="hljs-built_in">printf</span><br>.text:<span class="hljs-number">00000000004015B</span>B<br>.text:<span class="hljs-number">00000000004015B</span>B loc_4015BB:                             ; CODE XREF: main+<span class="hljs-number">4</span>C↑j<br>.text:<span class="hljs-number">00000000004015B</span>B                 mov     eax, [rbp+var_4]<br>.text:<span class="hljs-number">00000000004015B</span>E                 add     rsp, <span class="hljs-number">30</span>h<br>.text:<span class="hljs-number">00000000004015</span>C2                 pop     rbp<br>.text:<span class="hljs-number">00000000004015</span>C3                 retn<br>.text:<span class="hljs-number">00000000004015</span>C3 main            endp<br></code></pre></td></tr></table></figure>

<h4 id="ifelseifelse结构"><a href="#ifelseifelse结构" class="headerlink" title="ifelseifelse结构"></a>ifelseifelse结构</h4><p>当每个跳转指令的跳转地址之前都紧跟着 jmp指令，并且他们的跳转地址都一样时，可视为一个 多分支结构。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-keyword">int</span> argc, <span class="hljs-keyword">char</span>* argv[])</span></span><br><span class="hljs-function"></span>&#123;<br>  <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span> nVar_4 = <span class="hljs-number">5</span>;<br>  <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d&quot;</span>, &amp;nVar_4);<br><br>  <span class="hljs-comment">// argc == 0 ? 0 : -1</span><br>  <span class="hljs-keyword">if</span> (argc == <span class="hljs-number">0</span>)<br>  &#123;<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;argc == 0\r\n&quot;</span>);<br>  &#125;<br>  <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(argc == <span class="hljs-number">1</span>)<br>  &#123;<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;argc == 1\r\n&quot;</span>);<br>  &#125;<br>  <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(argc == <span class="hljs-number">2</span>)<br>  &#123;<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;argc == 2\r\n&quot;</span>);<br>  &#125;<br>  <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(argc == <span class="hljs-number">3</span>)<br>  &#123;<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;argc == 3\r\n&quot;</span>);<br>  &#125;<br>  <span class="hljs-keyword">else</span><br>  &#123;<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;else\r\n&quot;</span>);<br>  &#125;<br>  <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;haha\r\n&quot;</span>);<br>  <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;haha\r\n&quot;</span>);<br>  <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;haha\r\n&quot;</span>);<br>  <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;haha\r\n&quot;</span>);<br>  <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;haha\r\n&quot;</span>);<br>    <span class="hljs-keyword">return</span> nVar_4;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>对应的反汇编代码</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><code class="hljs c"> <span class="hljs-function"><span class="hljs-keyword">int</span> __cdecl <span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-keyword">int</span> argc, <span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span> **argv, <span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span> **envp)</span></span><br><span class="hljs-function">.text:0000000000401550                 <span class="hljs-keyword">public</span> main</span><br><span class="hljs-function">.text:0000000000401550 main            proc near               </span>; CODE XREF: __tmainCRTStartup+<span class="hljs-number">242</span>↑p<br>.text:<span class="hljs-number">0000000000401550</span>                                         ; DATA XREF: .pdata:<span class="hljs-number">000000000040506</span>C↓o<br>.text:<span class="hljs-number">0000000000401550</span><br>.text:<span class="hljs-number">0000000000401550</span> var_4           = dword ptr <span class="hljs-number">-4</span>   <span class="hljs-comment">//</span><br>.text:<span class="hljs-number">0000000000401550</span> arg_0           = dword ptr  <span class="hljs-number">10</span>h  <span class="hljs-comment">//argc</span><br>.text:<span class="hljs-number">0000000000401550</span> arg_8           = qword ptr  <span class="hljs-number">18</span>h  <span class="hljs-comment">//argv</span><br>.text:<span class="hljs-number">0000000000401550</span><br>.text:<span class="hljs-number">0000000000401550</span>                 push    rbp<br>.text:<span class="hljs-number">0000000000401551</span>                 mov     rbp, rsp<br>.text:<span class="hljs-number">0000000000401554</span>                 sub     rsp, <span class="hljs-number">30</span>h<br>.text:<span class="hljs-number">0000000000401558</span>                 mov     [rbp+arg_0], ecx<br>.text:<span class="hljs-number">000000000040155B</span>                 mov     [rbp+arg_8], rdx<br>.text:<span class="hljs-number">000000000040155F</span>                 call    __main<br>.text:<span class="hljs-number">0000000000401564</span>                 mov     [rbp+var_4], <span class="hljs-number">5</span>   <span class="hljs-comment">//var_a=5</span><br>.text:<span class="hljs-number">000000000040156B</span>                 lea     rax, [rbp+var_4]  <br>.text:<span class="hljs-number">000000000040156F</span>                 mov     rdx, rax<br>.text:<span class="hljs-number">0000000000401572</span>                 lea     rcx, Format     ; <span class="hljs-string">&quot;%d&quot;</span><br>.text:<span class="hljs-number">0000000000401579</span>                 call    <span class="hljs-built_in">scanf</span><br>.text:<span class="hljs-number">000000000040157</span>E                 cmp     [rbp+arg_0], <span class="hljs-number">0</span>  <span class="hljs-comment">//argc -0  //if (var_a==0)&#123; pintf(&quot;argc == 0\r&quot;);&#125;</span><br>.text:<span class="hljs-number">0000000000401582</span>                 jnz     <span class="hljs-keyword">short</span> loc_401592<br>.text:<span class="hljs-number">0000000000401584</span>                 lea     rcx, Buffer     ; <span class="hljs-string">&quot;argc == 0\r&quot;</span><br>.text:<span class="hljs-number">000000000040158B</span>                 call    <span class="hljs-built_in">puts</span><br>.text:<span class="hljs-number">0000000000401590</span>                 jmp     <span class="hljs-keyword">short</span> loc_4015DA  <span class="hljs-comment">//直接结束</span><br>.text:<span class="hljs-number">0000000000401592</span> ; ---------------------------------------------------------------------------<br>.text:<span class="hljs-number">0000000000401592</span>  <span class="hljs-comment">//这里可以看到是直接无条件跳转到这里 结束指向同一个 地址loc_4015DA 由于loc_4015BE后才是统一结束判断地址 因为 那里是对应的else语句 因此可以判断使用了 ifelif语句结构</span><br>.text:<span class="hljs-number">0000000000401592</span> loc_401592:                             ; CODE XREF: main+<span class="hljs-number">32</span>↑j  <span class="hljs-comment">//if</span><br>.text:<span class="hljs-number">0000000000401592</span>                 cmp     [rbp+arg_0], <span class="hljs-number">1</span>  <span class="hljs-comment">//elif (var_a==1)&#123; pintf(&quot;argc == 1\r&quot;);&#125;</span><br>.text:<span class="hljs-number">0000000000401596</span>                 jnz     <span class="hljs-keyword">short</span> h<br>.text:<span class="hljs-number">0000000000401598</span>                 lea     rcx, aArgc1     ; <span class="hljs-string">&quot;argc == 1\r&quot;</span><br>.text:<span class="hljs-number">000000000040159F</span>                 call    <span class="hljs-built_in">puts</span><br>.text:<span class="hljs-number">00000000004015</span>A4                 jmp     <span class="hljs-keyword">short</span> loc_4015DA<br>.text:<span class="hljs-number">00000000004015</span>A6 ; ---------------------------------------------------------------------------<br>.text:<span class="hljs-number">00000000004015</span>A6<br>.text:<span class="hljs-number">00000000004015</span>A6 loc_4015A6:                             ; CODE XREF: main+<span class="hljs-number">46</span>↑j <span class="hljs-comment">//elif (var_a==2)&#123; pintf(&quot;argc == 2\r&quot;);&#125;</span><br>.text:<span class="hljs-number">00000000004015</span>A6                 cmp     [rbp+arg_0], <span class="hljs-number">2</span><br>.text:<span class="hljs-number">00000000004015</span>AA                 jnz     <span class="hljs-keyword">short</span> loc_4015BA<br>.text:<span class="hljs-number">00000000004015</span>AC                 lea     rcx, aArgc2     ; <span class="hljs-string">&quot;argc == 2\r&quot;</span><br>.text:<span class="hljs-number">00000000004015B</span>3                 call    <span class="hljs-built_in">puts</span><br>.text:<span class="hljs-number">00000000004015B</span>8                 jmp     <span class="hljs-keyword">short</span> loc_4015DA<br>.text:<span class="hljs-number">00000000004015B</span>A ; ---------------------------------------------------------------------------<br>.text:<span class="hljs-number">00000000004015B</span>A<br>.text:<span class="hljs-number">00000000004015B</span>A loc_4015BA:                             ; CODE XREF: main+<span class="hljs-number">5</span>A↑j <span class="hljs-comment">//elif (var_a==3)&#123; pintf(&quot;argc == 3\r&quot;);&#125;</span><br>.text:<span class="hljs-number">00000000004015B</span>A                 cmp     [rbp+arg_0], <span class="hljs-number">3</span><br>.text:<span class="hljs-number">00000000004015B</span>E                 jnz     <span class="hljs-keyword">short</span> loc_4015CE<br>.text:<span class="hljs-number">00000000004015</span>C0                 lea     rcx, aArgc3     ; <span class="hljs-string">&quot;argc == 3\r&quot;</span><br>.text:<span class="hljs-number">00000000004015</span>C7                 call    <span class="hljs-built_in">puts</span><br>.text:<span class="hljs-number">00000000004015</span>CC                 jmp     <span class="hljs-keyword">short</span> loc_4015DA<br>.text:<span class="hljs-number">00000000004015</span>CE ; ---------------------------------------------------------------------------<br>.text:<span class="hljs-number">00000000004015</span>CE<br>.text:<span class="hljs-number">00000000004015</span>CE loc_4015CE:                             ; CODE XREF: main+<span class="hljs-number">6</span>E↑j<br>.text:<span class="hljs-number">00000000004015</span>CE                 lea     rcx, aElse      ; <span class="hljs-string">&quot;else\r&quot;</span><br>.text:<span class="hljs-number">00000000004015</span>D5                 call    <span class="hljs-built_in">puts</span><br>.text:<span class="hljs-number">00000000004015</span>DA<br>.text:<span class="hljs-number">00000000004015</span>DA loc_4015DA:                             ; CODE XREF: main+<span class="hljs-number">40</span>↑j<br>.text:<span class="hljs-number">00000000004015</span>DA                                         ; main+<span class="hljs-number">54</span>↑j ...<br>.text:<span class="hljs-number">00000000004015</span>DA                 lea     rcx, aHaha      ; <span class="hljs-string">&quot;haha\r&quot;</span><br>.text:<span class="hljs-number">00000000004015E1</span>                 call    <span class="hljs-built_in">puts</span><br>.text:<span class="hljs-number">00000000004015E6</span>                 lea     rcx, aHaha      ; <span class="hljs-string">&quot;haha\r&quot;</span><br>.text:<span class="hljs-number">00000000004015</span>ED                 call    <span class="hljs-built_in">puts</span><br>.text:<span class="hljs-number">00000000004015F</span>2                 lea     rcx, aHaha      ; <span class="hljs-string">&quot;haha\r&quot;</span><br>.text:<span class="hljs-number">00000000004015F</span>9                 call    <span class="hljs-built_in">puts</span><br>.text:<span class="hljs-number">00000000004015F</span>E                 lea     rcx, aHaha      ; <span class="hljs-string">&quot;haha\r&quot;</span><br>.text:<span class="hljs-number">0000000000401605</span>                 call    <span class="hljs-built_in">puts</span><br>.text:<span class="hljs-number">000000000040160</span>A                 lea     rcx, aHaha      ; <span class="hljs-string">&quot;haha\r&quot;</span><br>.text:<span class="hljs-number">0000000000401611</span>                 call    <span class="hljs-built_in">puts</span><br>.text:<span class="hljs-number">0000000000401616</span>                 mov     eax, [rbp+var_4]<br>.text:<span class="hljs-number">0000000000401619</span>                 add     rsp, <span class="hljs-number">30</span>h<br>.text:<span class="hljs-number">000000000040161</span>D                 pop     rbp<br>.text:<span class="hljs-number">000000000040161</span>E                 retn<br>.text:<span class="hljs-number">000000000040161</span>E main            endp<br></code></pre></td></tr></table></figure>

<h3 id="switch"><a href="#switch" class="headerlink" title="switch"></a>switch</h3><p>特点：</p>
<p>​    特点1: // 注意，和elseif不同，内容中没有break的话，编译不会自动加入break（就是jmp 结尾） </p>
<p>​    特点2: // 内容连着写，这是为了符合C语言的语法：case中不写break，会顺着执行下一条case</p>
<p>​    特点3:// 跳转表是从0开始的，因此记录最小值，switch的判断中会让元素减去最小值，再查表。减去最小值的好处：如果输入小于最小值，那么这个输入再减去最小值就会变成负数， 而比较时使用ja，也就是用无符号数判断，那么这个负数就会变成一个很大的数，同样会跳转</p>
<h4 id="ezswitch小于3"><a href="#ezswitch小于3" class="headerlink" title="ezswitch小于3"></a>ezswitch小于3</h4><p>switch</p>
<p>当case情况小于等于3时，ifelse和switch并没有什么区别</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-keyword">int</span> argc, <span class="hljs-keyword">char</span>* argv[])</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-keyword">switch</span>(argc)<br>    &#123;<br>    <span class="hljs-keyword">case</span> <span class="hljs-number">0</span>:<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;case 0\n&quot;</span>);<br><br>        <span class="hljs-keyword">break</span>;<br>    <span class="hljs-keyword">case</span> <span class="hljs-number">1</span>:<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;case 1\n&quot;</span>);<br><br>        <span class="hljs-keyword">break</span>;<br>    <span class="hljs-keyword">case</span> <span class="hljs-number">2</span>:<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;case 2\n&quot;</span>);<br><br>        <span class="hljs-keyword">break</span>;<br>    &#125;<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;HelloWorld\n&quot;</span>);<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>对应反汇编</p>
<p>//下面这里编辑器做了优化 减少了一次跳转 0 1 2  =&gt; 1 2 0</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><code class="hljs c">.text:<span class="hljs-number">0000000000401550</span> ; <span class="hljs-function"><span class="hljs-keyword">int</span> __cdecl <span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-keyword">int</span> argc, <span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span> **argv, <span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span> **envp)</span></span><br><span class="hljs-function">.text:0000000000401550                 <span class="hljs-keyword">public</span> main</span><br><span class="hljs-function">.text:0000000000401550 main            proc near               </span>; CODE XREF: __tmainCRTStartup+<span class="hljs-number">242</span>↑p<br>.text:<span class="hljs-number">0000000000401550</span>                                         ; DATA XREF: .pdata:<span class="hljs-number">000000000040506</span>C↓o<br>.text:<span class="hljs-number">0000000000401550</span><br>.text:<span class="hljs-number">0000000000401550</span> arg_0           = dword ptr  <span class="hljs-number">10</span>h<br>.text:<span class="hljs-number">0000000000401550</span> arg_8           = qword ptr  <span class="hljs-number">18</span>h<br>.text:<span class="hljs-number">0000000000401550</span><br>.text:<span class="hljs-number">0000000000401550</span>                 push    rbp<br>.text:<span class="hljs-number">0000000000401551</span>                 mov     rbp, rsp<br>.text:<span class="hljs-number">0000000000401554</span>                 sub     rsp, <span class="hljs-number">20</span>h<br>.text:<span class="hljs-number">0000000000401558</span>                 mov     [rbp+arg_0], ecx<br>.text:<span class="hljs-number">000000000040155B</span>                 mov     [rbp+arg_8], rdx<br>.text:<span class="hljs-number">000000000040155F</span>                 call    __main<br>.text:<span class="hljs-number">0000000000401564</span>                 cmp     [rbp+arg_0], <span class="hljs-number">1</span><br>.text:<span class="hljs-number">0000000000401568</span>                 jz      <span class="hljs-keyword">short</span> loc_401584<br>.text:<span class="hljs-number">000000000040156</span>A                 cmp     [rbp+arg_0], <span class="hljs-number">2</span><br>.text:<span class="hljs-number">000000000040156</span>E                 jz      <span class="hljs-keyword">short</span> loc_401592<br>.text:<span class="hljs-number">0000000000401570</span>                 cmp     [rbp+arg_0], <span class="hljs-number">0</span><br>.text:<span class="hljs-number">0000000000401574</span>                 jnz     <span class="hljs-keyword">short</span> loc_40159F<br>.text:<span class="hljs-number">0000000000401576</span>                 lea     rcx, Buffer     ; <span class="hljs-string">&quot;case 0&quot;</span><br>.text:<span class="hljs-number">000000000040157</span>D                 call    <span class="hljs-built_in">puts</span><br>.text:<span class="hljs-number">0000000000401582</span>                 jmp     <span class="hljs-keyword">short</span> loc_40159F<br>.text:<span class="hljs-number">0000000000401584</span> ; ---------------------------------------------------------------------------<br>.text:<span class="hljs-number">0000000000401584</span><br>.text:<span class="hljs-number">0000000000401584</span> loc_401584:                             ; CODE XREF: main+<span class="hljs-number">18</span>↑j<br>.text:<span class="hljs-number">0000000000401584</span>                 lea     rcx, aCase1     ; <span class="hljs-string">&quot;case 1&quot;</span><br>.text:<span class="hljs-number">000000000040158B</span>                 call    <span class="hljs-built_in">puts</span><br>.text:<span class="hljs-number">0000000000401590</span>                 jmp     <span class="hljs-keyword">short</span> loc_40159F<br>.text:<span class="hljs-number">0000000000401592</span> ; ---------------------------------------------------------------------------<br>.text:<span class="hljs-number">0000000000401592</span><br>.text:<span class="hljs-number">0000000000401592</span> loc_401592:                             ; CODE XREF: main+<span class="hljs-number">1</span>E↑j<br>.text:<span class="hljs-number">0000000000401592</span>                 lea     rcx, aCase2     ; <span class="hljs-string">&quot;case 2&quot;</span><br>.text:<span class="hljs-number">0000000000401599</span>                 call    <span class="hljs-built_in">puts</span><br>.text:<span class="hljs-number">000000000040159</span>E                 nop<br>.text:<span class="hljs-number">000000000040159F</span><br>.text:<span class="hljs-number">000000000040159F</span> loc_40159F:                             ; CODE XREF: main+<span class="hljs-number">24</span>↑j<br>.text:<span class="hljs-number">000000000040159F</span>                                         ; main+<span class="hljs-number">32</span>↑j ...<br>.text:<span class="hljs-number">000000000040159F</span>                 lea     rcx, aHelloworld ; <span class="hljs-string">&quot;HelloWorld&quot;</span><br>.text:<span class="hljs-number">00000000004015</span>A6                 call    <span class="hljs-built_in">puts</span><br>.text:<span class="hljs-number">00000000004015</span>AB                 mov     eax, <span class="hljs-number">0</span><br>.text:<span class="hljs-number">00000000004015B</span>0                 add     rsp, <span class="hljs-number">20</span>h<br>.text:<span class="hljs-number">00000000004015B</span>4                 pop     rbp<br>.text:<span class="hljs-number">00000000004015B</span>5                 retn<br>.text:<span class="hljs-number">00000000004015B</span>5 main            endp<br></code></pre></td></tr></table></figure>

<h4 id="switch-分支大于4"><a href="#switch-分支大于4" class="headerlink" title="switch 分支大于4"></a>switch 分支大于4</h4><p>注意switch分支大于4之后就有跳转表</p>
<p>详解在switch7那里</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">myFunction</span><span class="hljs-params">(<span class="hljs-keyword">int</span> x)</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-keyword">switch</span>(x)<br>    &#123;<br>    <span class="hljs-keyword">case</span> <span class="hljs-number">1</span>:<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;1&quot;</span>);<br>        <span class="hljs-keyword">break</span>;<br>    <span class="hljs-keyword">case</span> <span class="hljs-number">2</span>:<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;2&quot;</span>);<br>        <span class="hljs-keyword">break</span>;<br>    <span class="hljs-keyword">case</span> <span class="hljs-number">3</span>:<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;3&quot;</span>);<br>        <span class="hljs-keyword">break</span>;<br>    <span class="hljs-keyword">case</span> <span class="hljs-number">4</span>:<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;4&quot;</span>);<br>        <span class="hljs-keyword">break</span>;<br>    <span class="hljs-keyword">default</span>:<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;error&quot;</span>);<br>    &#125;<br>&#125;<br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>    myFunction(<span class="hljs-number">2</span>);<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>对应的反汇编代码  (这里仅放function的部分)</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><code class="hljs c"> myFunction      proc near               ; CODE XREF: main+<span class="hljs-number">12</span>↓p<br>.text:<span class="hljs-number">0000000000401550</span>                                         ; DATA XREF: .pdata:<span class="hljs-number">000000000040506</span>C↓o<br>.text:<span class="hljs-number">0000000000401550</span><br>.text:<span class="hljs-number">0000000000401550</span> arg_0           = dword ptr  <span class="hljs-number">10</span>h   <span class="hljs-comment">//传入参数</span><br>.text:<span class="hljs-number">0000000000401550</span><br>.text:<span class="hljs-number">0000000000401550</span>                 push    rbp  <br>.text:<span class="hljs-number">0000000000401551</span>                 mov     rbp, rsp<br>.text:<span class="hljs-number">0000000000401554</span>                 sub     rsp, <span class="hljs-number">20</span>h                 <span class="hljs-comment">//开辟空间 </span><br>.text:<span class="hljs-number">0000000000401558</span>                 mov     [rbp+arg_0], ecx  <span class="hljs-comment">//把 传入的参数 给 函数体内的局部变量 </span><br>.text:<span class="hljs-number">000000000040155B</span>                 cmp     [rbp+arg_0], <span class="hljs-number">2</span>   <span class="hljs-comment">// if(x==2)</span><br>.text:<span class="hljs-number">000000000040155F</span>                 jz      <span class="hljs-keyword">short</span> loc_401589<br>.text:<span class="hljs-number">0000000000401561</span>                 cmp     [rbp+arg_0], <span class="hljs-number">2</span>  <span class="hljs-comment">//if(x&gt;2)</span><br>.text:<span class="hljs-number">0000000000401565</span>                 jg      <span class="hljs-keyword">short</span> loc_40156F<br>.text:<span class="hljs-number">0000000000401567</span>                 cmp     [rbp+arg_0], <span class="hljs-number">1</span> <span class="hljs-comment">//if(x==1)</span><br>.text:<span class="hljs-number">000000000040156B</span>                 jz      <span class="hljs-keyword">short</span> loc_40157D  <br>.text:<span class="hljs-number">000000000040156</span>D                 jmp     <span class="hljs-keyword">short</span> loc_4015AD<br>.text:<span class="hljs-number">000000000040156F</span> ; ---------------------------------------------------------------------------<br>.text:<span class="hljs-number">000000000040156F</span><br>.text:<span class="hljs-number">000000000040156F</span> loc_40156F:                             ; CODE XREF: myFunction+<span class="hljs-number">15</span>↑j<br>.text:<span class="hljs-number">000000000040156F</span>                 cmp     [rbp+arg_0], <span class="hljs-number">3</span>   <br>.text:<span class="hljs-number">0000000000401573</span>                 jz      <span class="hljs-keyword">short</span> loc_401595<br>.text:<span class="hljs-number">0000000000401575</span>                 cmp     [rbp+arg_0], <span class="hljs-number">4</span><br>.text:<span class="hljs-number">0000000000401579</span>                 jz      <span class="hljs-keyword">short</span> loc_4015A1<br>.text:<span class="hljs-number">000000000040157B</span>                 jmp     <span class="hljs-keyword">short</span> loc_4015AD<br>.text:<span class="hljs-number">000000000040157</span>D ; ---------------------------------------------------------------------------<br>.text:<span class="hljs-number">000000000040157</span>D<br>.text:<span class="hljs-number">000000000040157</span>D loc_40157D:                             ; CODE XREF: myFunction+<span class="hljs-number">1B</span>↑j<br>.text:<span class="hljs-number">000000000040157</span>D                 mov     ecx, <span class="hljs-number">31</span>h ; <span class="hljs-string">&#x27;1&#x27;</span>  ; Character<br>.text:<span class="hljs-number">0000000000401582</span>                 call    <span class="hljs-built_in">putchar</span>   <span class="hljs-comment">//printf(&quot;1&quot;);</span><br>.text:<span class="hljs-number">0000000000401587</span>                 jmp     <span class="hljs-keyword">short</span> loc_4015B9<br>.text:<span class="hljs-number">0000000000401589</span> ; ---------------------------------------------------------------------------<br>.text:<span class="hljs-number">0000000000401589</span><br>.text:<span class="hljs-number">0000000000401589</span> loc_401589:                             ; CODE XREF: myFunction+F↑j<br>.text:<span class="hljs-number">0000000000401589</span>                 mov     ecx, <span class="hljs-number">32</span>h ; <span class="hljs-string">&#x27;2&#x27;</span>  ; Character<br>.text:<span class="hljs-number">000000000040158</span>E                 call    <span class="hljs-built_in">putchar</span>   <span class="hljs-comment">// printf(&quot;2&quot;);</span><br>.text:<span class="hljs-number">0000000000401593</span>                 jmp     <span class="hljs-keyword">short</span> loc_4015B9<br>.text:<span class="hljs-number">0000000000401595</span> ; ---------------------------------------------------------------------------<br>.text:<span class="hljs-number">0000000000401595</span><br>.text:<span class="hljs-number">0000000000401595</span> loc_401595:                             ; CODE XREF: myFunction+<span class="hljs-number">23</span>↑j<br>.text:<span class="hljs-number">0000000000401595</span>                 mov     ecx, <span class="hljs-number">33</span>h ; <span class="hljs-string">&#x27;3&#x27;</span>  ; Character<br>.text:<span class="hljs-number">000000000040159</span>A                 call    <span class="hljs-built_in">putchar</span>  <span class="hljs-comment">//printf(&quot;3&quot;);</span><br>.text:<span class="hljs-number">000000000040159F</span>                 jmp     <span class="hljs-keyword">short</span> loc_4015B9<br>.text:<span class="hljs-number">00000000004015</span>A1 ; ---------------------------------------------------------------------------<br>.text:<span class="hljs-number">00000000004015</span>A1<br>.text:<span class="hljs-number">00000000004015</span>A1 loc_4015A1:                             ; CODE XREF: myFunction+<span class="hljs-number">29</span>↑j<br>.text:<span class="hljs-number">00000000004015</span>A1                 mov     ecx, <span class="hljs-number">34</span>h ; <span class="hljs-string">&#x27;4&#x27;</span>  ; Character<br>.text:<span class="hljs-number">00000000004015</span>A6                 call    <span class="hljs-built_in">putchar</span>  <span class="hljs-comment">//printf(&quot;4&quot;);</span><br>.text:<span class="hljs-number">00000000004015</span>AB                 jmp     <span class="hljs-keyword">short</span> loc_4015B9<br>.text:<span class="hljs-number">00000000004015</span>AD ; ---------------------------------------------------------------------------<br>.text:<span class="hljs-number">00000000004015</span>AD<br>.text:<span class="hljs-number">00000000004015</span>AD loc_4015AD:                             ; CODE XREF: myFunction+<span class="hljs-number">1</span>D↑j<br>.text:<span class="hljs-number">00000000004015</span>AD                                         ; myFunction+<span class="hljs-number">2B</span>↑j<br>.text:<span class="hljs-number">00000000004015</span>AD                 lea     rcx, Format     ; <span class="hljs-string">&quot;error&quot;</span>  <span class="hljs-comment">//default:error</span><br>.text:<span class="hljs-number">00000000004015B</span>4                 call    <span class="hljs-built_in">printf</span><br>.text:<span class="hljs-number">00000000004015B</span>9<br>.text:<span class="hljs-number">00000000004015B</span>9 loc_4015B9:                             ; CODE XREF: myFunction+<span class="hljs-number">37</span>↑j<br>.text:<span class="hljs-number">00000000004015B</span>9                                         ; myFunction+<span class="hljs-number">43</span>↑j ...<br>.text:<span class="hljs-number">00000000004015B</span>9                 nop<br>.text:<span class="hljs-number">00000000004015B</span>A                 add     rsp, <span class="hljs-number">20</span>h<br>.text:<span class="hljs-number">00000000004015B</span>E                 pop     rbp<br>.text:<span class="hljs-number">00000000004015B</span>F                 retn<br>.text:<span class="hljs-number">00000000004015B</span>F myFunction      endp<br></code></pre></td></tr></table></figure>

<h4 id="switch-分支大于7"><a href="#switch-分支大于7" class="headerlink" title="switch 分支大于7"></a>switch 分支大于7</h4><p>当switch的分支大于7时</p>
<p>这是小表存放跳转的索引 即 edx</p>
<p><img src="https://photo-1308752946.cos.ap-beijing.myqcloud.com/img/Typora/202112261422135.png" srcset="/img/loading.gif" lazyload alt="image-20211226142233001"></p>
<p>内存会建立跳转表 存放 每个case后的函数体的起始地址</p>
<p>这里的寻址类似于数组的寻址  address=[第一个case的起始地址+4*寄存器(步长)]</p>
<p><img src="https://photo-1308752946.cos.ap-beijing.myqcloud.com/img/Typora/202112261718094.png" srcset="/img/loading.gif" lazyload alt="image-20211226171819013"></p>
<p>如图，展示了大表存储跳转表的地址</p>
<p>可知     jmp [寄存器*4 + 0xxxxx] ;跳转表模式的重要特征</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">Function</span><span class="hljs-params">(<span class="hljs-keyword">int</span> x)</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-keyword">switch</span>(x)<br>    &#123;<br>    <span class="hljs-keyword">case</span> <span class="hljs-number">1</span>:<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;1&quot;</span>);<span class="hljs-keyword">break</span>;<br>    <span class="hljs-keyword">case</span> <span class="hljs-number">2</span>:<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;2&quot;</span>);<span class="hljs-keyword">break</span>;<br>    <span class="hljs-keyword">case</span> <span class="hljs-number">3</span>:<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;3&quot;</span>);<span class="hljs-keyword">break</span>;<br>    <span class="hljs-keyword">case</span> <span class="hljs-number">4</span>:<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;4&quot;</span>);<span class="hljs-keyword">break</span>;<br>    <span class="hljs-keyword">case</span> <span class="hljs-number">5</span>:<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;5&quot;</span>);<span class="hljs-keyword">break</span>;<br><br>    <span class="hljs-keyword">case</span> <span class="hljs-number">233</span>:<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;233&quot;</span>);<span class="hljs-keyword">break</span>;<br><br>    <span class="hljs-keyword">case</span> <span class="hljs-number">7</span>:<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;7&quot;</span>);<span class="hljs-keyword">break</span>;<br>    <span class="hljs-keyword">case</span> <span class="hljs-number">8</span>:<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;8&quot;</span>);<span class="hljs-keyword">break</span>;<br>    <span class="hljs-keyword">case</span> <span class="hljs-number">9</span>:<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;9&quot;</span>);<span class="hljs-keyword">break</span>;<br>    <span class="hljs-keyword">default</span>:<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;error&quot;</span>);<span class="hljs-keyword">break</span>;<br><br>    &#125;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>    Function(<span class="hljs-number">3</span>);<br>&#125;<br></code></pre></td></tr></table></figure>

<p>对应的反汇编代码</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-number">4</span>:        <span class="hljs-keyword">switch</span>(x)<br><span class="hljs-number">5</span>:        &#123;<br><span class="hljs-number">0040</span>D898   mov         eax,dword ptr [ebp+<span class="hljs-number">8</span>]<br><span class="hljs-number">0040</span>D89B   mov         dword ptr [ebp<span class="hljs-number">-4</span>],eax<br><span class="hljs-number">0040</span>D89E   mov         ecx,dword ptr [ebp<span class="hljs-number">-4</span>]<br><span class="hljs-number">0040</span>D8A1   sub         ecx,<span class="hljs-number">1</span><br><span class="hljs-number">0040</span>D8A4   mov         dword ptr [ebp<span class="hljs-number">-4</span>],ecx<br><span class="hljs-number">0040</span>D8A7   cmp         dword ptr [ebp<span class="hljs-number">-4</span>],<span class="hljs-number">0E8</span>h<br><span class="hljs-number">0040</span>D8AE   ja          $L548+<span class="hljs-number">0F</span>h (<span class="hljs-number">0040</span>d950)<br><span class="hljs-number">0040</span>D8B4   mov         eax,dword ptr [ebp<span class="hljs-number">-4</span>]<br><span class="hljs-number">0040</span>D8B7   <span class="hljs-keyword">xor</span>         edx,edx<br><span class="hljs-number">0040</span>D8B9   mov         dl,<span class="hljs-function">byte <span class="hljs-title">ptr</span>  <span class="hljs-params">(<span class="hljs-number">0040</span>d996)</span>[eax]</span><br><span class="hljs-function">0040D8BF   jmp         dword ptr [edx*4+40D96Eh]    <span class="hljs-comment">//计算出跳转表的地址 然后 根据跳转存储的值 跳转到 case语句部分</span></span><br><span class="hljs-function">6:        <span class="hljs-keyword">case</span> 1:</span><br><span class="hljs-function">7:            <span class="hljs-title">printf</span><span class="hljs-params">(<span class="hljs-string">&quot;1&quot;</span>)</span></span>;<span class="hljs-keyword">break</span>;<br><span class="hljs-number">0040</span>D8C6   push        offset <span class="hljs-built_in">string</span> <span class="hljs-string">&quot;1&quot;</span> (<span class="hljs-number">0042203</span>c)<br><span class="hljs-number">0040</span><span class="hljs-function">D8CB   call        <span class="hljs-title">printf</span> <span class="hljs-params">(<span class="hljs-number">004011f</span>0)</span></span><br><span class="hljs-function">0040D8D0   add         esp,4</span><br><span class="hljs-function">0040D8D3   jmp         $L548+1<span class="hljs-title">Ch</span> <span class="hljs-params">(<span class="hljs-number">0040</span>d95d)</span></span><br><span class="hljs-function">8:        <span class="hljs-keyword">case</span> 2:</span><br><span class="hljs-function">9:            <span class="hljs-title">printf</span><span class="hljs-params">(<span class="hljs-string">&quot;2&quot;</span>)</span></span>;<span class="hljs-keyword">break</span>;<br><span class="hljs-number">0040</span>D8D8   push        offset <span class="hljs-built_in">string</span> <span class="hljs-string">&quot;2&quot;</span> (<span class="hljs-number">00422038</span>)<br><span class="hljs-number">0040</span><span class="hljs-function">D8DD   call        <span class="hljs-title">printf</span> <span class="hljs-params">(<span class="hljs-number">004011f</span>0)</span></span><br><span class="hljs-function">0040D8E2   add         esp,4</span><br><span class="hljs-function">0040D8E5   jmp         $L548+1<span class="hljs-title">Ch</span> <span class="hljs-params">(<span class="hljs-number">0040</span>d95d)</span></span><br><span class="hljs-function">10:       <span class="hljs-keyword">case</span> 3:</span><br><span class="hljs-function">11:           <span class="hljs-title">printf</span><span class="hljs-params">(<span class="hljs-string">&quot;3&quot;</span>)</span></span>;<span class="hljs-keyword">break</span>;<br><span class="hljs-number">0040</span>D8E7   push        offset <span class="hljs-built_in">string</span> <span class="hljs-string">&quot;3&quot;</span> (<span class="hljs-number">00422034</span>)<br><span class="hljs-number">0040</span><span class="hljs-function">D8EC   call        <span class="hljs-title">printf</span> <span class="hljs-params">(<span class="hljs-number">004011f</span>0)</span></span><br><span class="hljs-function">0040D8F1   add         esp,4</span><br><span class="hljs-function">0040D8F4   jmp         $L548+1<span class="hljs-title">Ch</span> <span class="hljs-params">(<span class="hljs-number">0040</span>d95d)</span></span><br><span class="hljs-function">12:       <span class="hljs-keyword">case</span> 4:</span><br><span class="hljs-function">13:           <span class="hljs-title">printf</span><span class="hljs-params">(<span class="hljs-string">&quot;4&quot;</span>)</span></span>;<span class="hljs-keyword">break</span>;<br><span class="hljs-number">0040</span>D8F6   push        offset <span class="hljs-built_in">string</span> <span class="hljs-string">&quot;4&quot;</span> (<span class="hljs-number">00422030</span>)<br><span class="hljs-number">0040</span><span class="hljs-function">D8FB   call        <span class="hljs-title">printf</span> <span class="hljs-params">(<span class="hljs-number">004011f</span>0)</span></span><br><span class="hljs-function">0040D900   add         esp,4</span><br><span class="hljs-function">0040D903   jmp         $L548+1<span class="hljs-title">Ch</span> <span class="hljs-params">(<span class="hljs-number">0040</span>d95d)</span></span><br><span class="hljs-function">14:       <span class="hljs-keyword">case</span> 5:</span><br><span class="hljs-function">15:           <span class="hljs-title">printf</span><span class="hljs-params">(<span class="hljs-string">&quot;5&quot;</span>)</span></span>;<span class="hljs-keyword">break</span>;<br><span class="hljs-number">0040</span>D905   push        offset <span class="hljs-built_in">string</span> <span class="hljs-string">&quot;5&quot;</span> (<span class="hljs-number">0042202</span>c)<br><span class="hljs-number">0040</span><span class="hljs-function">D90A   call        <span class="hljs-title">printf</span> <span class="hljs-params">(<span class="hljs-number">004011f</span>0)</span></span><br><span class="hljs-function">0040D90F   add         esp,4</span><br><span class="hljs-function">0040D912   jmp         $L548+1<span class="hljs-title">Ch</span> <span class="hljs-params">(<span class="hljs-number">0040</span>d95d)</span></span><br><span class="hljs-function">16:</span><br><span class="hljs-function">17:       <span class="hljs-keyword">case</span> 233:</span><br><span class="hljs-function">18:           <span class="hljs-title">printf</span><span class="hljs-params">(<span class="hljs-string">&quot;233&quot;</span>)</span></span>;<span class="hljs-keyword">break</span>;<br><span class="hljs-number">0040</span>D914   push        offset <span class="hljs-built_in">string</span> <span class="hljs-string">&quot;12&quot;</span> (<span class="hljs-number">0042201</span>c)<br><span class="hljs-number">0040</span><span class="hljs-function">D919   call        <span class="hljs-title">printf</span> <span class="hljs-params">(<span class="hljs-number">004011f</span>0)</span></span><br><span class="hljs-function">0040D91E   add         esp,4</span><br><span class="hljs-function">0040D921   jmp         $L548+1<span class="hljs-title">Ch</span> <span class="hljs-params">(<span class="hljs-number">0040</span>d95d)</span></span><br><span class="hljs-function">19:</span><br><span class="hljs-function">20:       <span class="hljs-keyword">case</span> 7:</span><br><span class="hljs-function">21:           <span class="hljs-title">printf</span><span class="hljs-params">(<span class="hljs-string">&quot;7&quot;</span>)</span></span>;<span class="hljs-keyword">break</span>;<br><span class="hljs-number">0040</span>D923   push        offset <span class="hljs-built_in">string</span> <span class="hljs-string">&quot;7&quot;</span> (<span class="hljs-number">00422028</span>)<br><span class="hljs-number">0040</span><span class="hljs-function">D928   call        <span class="hljs-title">printf</span> <span class="hljs-params">(<span class="hljs-number">004011f</span>0)</span></span><br><span class="hljs-function">0040D92D   add         esp,4</span><br><span class="hljs-function">0040D930   jmp         $L548+1<span class="hljs-title">Ch</span> <span class="hljs-params">(<span class="hljs-number">0040</span>d95d)</span></span><br><span class="hljs-function">22:       <span class="hljs-keyword">case</span> 8:</span><br><span class="hljs-function">23:           <span class="hljs-title">printf</span><span class="hljs-params">(<span class="hljs-string">&quot;8&quot;</span>)</span></span>;<span class="hljs-keyword">break</span>;<br><span class="hljs-number">0040</span>D932   push        offset <span class="hljs-built_in">string</span> <span class="hljs-string">&quot;10&quot;</span> (<span class="hljs-number">00422024</span>)<br><span class="hljs-number">0040</span><span class="hljs-function">D937   call        <span class="hljs-title">printf</span> <span class="hljs-params">(<span class="hljs-number">004011f</span>0)</span></span><br><span class="hljs-function">0040D93C   add         esp,4</span><br><span class="hljs-function">0040D93F   jmp         $L548+1<span class="hljs-title">Ch</span> <span class="hljs-params">(<span class="hljs-number">0040</span>d95d)</span></span><br><span class="hljs-function">24:       <span class="hljs-keyword">case</span> 9:</span><br><span class="hljs-function">25:           <span class="hljs-title">printf</span><span class="hljs-params">(<span class="hljs-string">&quot;9&quot;</span>)</span></span>;<span class="hljs-keyword">break</span>;<br><span class="hljs-number">0040</span>D941   push        offset <span class="hljs-built_in">string</span> <span class="hljs-string">&quot;11&quot;</span> (<span class="hljs-number">00422020</span>)<br><span class="hljs-number">0040</span><span class="hljs-function">D946   call        <span class="hljs-title">printf</span> <span class="hljs-params">(<span class="hljs-number">004011f</span>0)</span></span><br><span class="hljs-function">0040D94B   add         esp,4</span><br><span class="hljs-function">0040D94E   jmp         $L548+1<span class="hljs-title">Ch</span> <span class="hljs-params">(<span class="hljs-number">0040</span>d95d)</span></span><br><span class="hljs-function">26:       <span class="hljs-keyword">default</span>:</span><br><span class="hljs-function">27:           <span class="hljs-title">printf</span><span class="hljs-params">(<span class="hljs-string">&quot;error&quot;</span>)</span></span>;<span class="hljs-keyword">break</span>;<br><span class="hljs-number">0040</span>D950   push        offset <span class="hljs-built_in">string</span> <span class="hljs-string">&quot;error&quot;</span> (<span class="hljs-number">00422f</span>cc)<br><span class="hljs-number">0040</span><span class="hljs-function">D955   call        <span class="hljs-title">printf</span> <span class="hljs-params">(<span class="hljs-number">004011f</span>0)</span></span><br><span class="hljs-function">0040D95A   add         esp,4</span><br><span class="hljs-function">28:</span><br><span class="hljs-function">29:       &#125;</span><br><span class="hljs-function">30:   &#125;</span><br></code></pre></td></tr></table></figure>





<h3 id="dowhile"><a href="#dowhile" class="headerlink" title="dowhile"></a>dowhile</h3><p>特点：</p>
<p>​    向上跳转（分支语句都是向上跳转）</p>
<p>​    跳转条件不反写</p>
<p>​    只用一次跳转，效率最高</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;stdio.h&gt;</span></span><br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-keyword">int</span> argc, <span class="hljs-keyword">char</span>* argv[])</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-keyword">int</span> nSum = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">do</span> <br>    &#123;<br>        nSum = nSum + i;<br>    &#125; <span class="hljs-keyword">while</span> (i &lt;=<span class="hljs-number">100</span>);<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>汇编代码</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs c">text:<span class="hljs-number">0000000000401550</span> ; <span class="hljs-function"><span class="hljs-keyword">int</span> __cdecl <span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-keyword">int</span> argc, <span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span> **argv, <span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span> **envp)</span></span><br><span class="hljs-function">.text:0000000000401550                 <span class="hljs-keyword">public</span> main</span><br><span class="hljs-function">.text:0000000000401550 main            proc near               </span>; CODE XREF: __tmainCRTStartup+<span class="hljs-number">242</span>↑p<br>.text:<span class="hljs-number">0000000000401550</span>                                         ; DATA XREF: .pdata:<span class="hljs-number">000000000040506</span>C↓o<br>.text:<span class="hljs-number">0000000000401550</span><br>.text:<span class="hljs-number">0000000000401550</span> var_8           = dword ptr <span class="hljs-number">-8</span><br>.text:<span class="hljs-number">0000000000401550</span> var_4           = dword ptr <span class="hljs-number">-4</span><br>.text:<span class="hljs-number">0000000000401550</span> arg_0           = dword ptr  <span class="hljs-number">10</span>h<br>.text:<span class="hljs-number">0000000000401550</span> arg_8           = qword ptr  <span class="hljs-number">18</span>h<br>.text:<span class="hljs-number">0000000000401550</span><br>.text:<span class="hljs-number">0000000000401550</span>                 push    rbp<br>.text:<span class="hljs-number">0000000000401551</span>                 mov     rbp, rsp<br>.text:<span class="hljs-number">0000000000401554</span>                 sub     rsp, <span class="hljs-number">30</span>h<br>.text:<span class="hljs-number">0000000000401558</span>                 mov     [rbp+arg_0], ecx<br>.text:<span class="hljs-number">000000000040155B</span>                 mov     [rbp+arg_8], rdx<br>.text:<span class="hljs-number">000000000040155F</span>                 call    __main       <span class="hljs-comment">//main开始</span><br>.text:<span class="hljs-number">0000000000401564</span>                 mov     [rbp+var_4], <span class="hljs-number">0</span>   <span class="hljs-comment">//a=0</span><br>.text:<span class="hljs-number">000000000040156B</span>                 mov     [rbp+var_8], <span class="hljs-number">0</span>  <span class="hljs-comment">//b=0</span><br>.text:<span class="hljs-number">0000000000401572</span><br>.text:<span class="hljs-number">0000000000401572</span> loc_401572:                             ; CODE XREF: main+<span class="hljs-number">2</span>C↓j<br>.text:<span class="hljs-number">0000000000401572</span>                 mov     eax, [rbp+var_8]  <span class="hljs-comment">//eax=b</span><br>.text:<span class="hljs-number">0000000000401575</span>                 add     [rbp+var_4], eax  <span class="hljs-comment">//a=a+b</span><br>.text:<span class="hljs-number">0000000000401578</span>                 cmp     [rbp+var_8], <span class="hljs-number">64</span>h ; <span class="hljs-string">&#x27;d&#x27;</span>  <br>.text:<span class="hljs-number">000000000040157</span>C                 jle     <span class="hljs-keyword">short</span> loc_401572     <br>.text:<span class="hljs-number">000000000040157</span>E                 mov     eax, <span class="hljs-number">0</span><br>.text:<span class="hljs-number">0000000000401583</span>                 add     rsp, <span class="hljs-number">30</span>h<br>.text:<span class="hljs-number">0000000000401587</span>                 pop     rbp<br>.text:<span class="hljs-number">0000000000401588</span>                 retn<br>.text:<span class="hljs-number">0000000000401588</span> main            endp<br></code></pre></td></tr></table></figure>

<h3 id="while"><a href="#while" class="headerlink" title="while"></a>while</h3><p>​    while 要先比较，再跳转，一共两次，效率较低 其中第一次跳转其地址是往增量跳转,第二次跳转其地址是往减量地址跳转</p>
<p>​    Release版本下</p>
<p>　　1.常量传播的优化方式下,其代码会变成do while执行</p>
<p>　　2.代码外提的情况下,其代码会变成if 包含 do while执行,其中代码的条件外提.注意,函数不可以作为代码外提</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;stdio.h&gt;</span></span><br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-keyword">int</span> argc, <span class="hljs-keyword">char</span>* argv[])</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-keyword">int</span> nSum = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">while</span>(i &lt;= <span class="hljs-number">100</span>) <br>    &#123;<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d&quot;</span>,nSum);<br>        nSum = nSum + i;<br>    &#125;<br>    <span class="hljs-keyword">return</span> argc;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>对应反汇编</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><code class="hljs c">.text:<span class="hljs-number">0000000000401550</span> ; <span class="hljs-function"><span class="hljs-keyword">int</span> __cdecl <span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-keyword">int</span> argc, <span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span> **argv, <span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span> **envp)</span></span><br><span class="hljs-function">.text:0000000000401550                 <span class="hljs-keyword">public</span> main</span><br><span class="hljs-function">.text:0000000000401550 main            proc near               </span>; CODE XREF: __tmainCRTStartup+<span class="hljs-number">242</span>↑p<br>.text:<span class="hljs-number">0000000000401550</span>                                         ; DATA XREF: .pdata:<span class="hljs-number">000000000040506</span>C↓o<br>.text:<span class="hljs-number">0000000000401550</span><br>.text:<span class="hljs-number">0000000000401550</span> var_8           = dword ptr <span class="hljs-number">-8</span><br>.text:<span class="hljs-number">0000000000401550</span> var_4           = dword ptr <span class="hljs-number">-4</span><br>.text:<span class="hljs-number">0000000000401550</span> arg_0           = dword ptr  <span class="hljs-number">10</span>h<br>.text:<span class="hljs-number">0000000000401550</span> arg_8           = qword ptr  <span class="hljs-number">18</span>h<br>.text:<span class="hljs-number">0000000000401550</span><br>.text:<span class="hljs-number">0000000000401550</span>                 push    rbp<br>.text:<span class="hljs-number">0000000000401551</span>                 mov     rbp, rsp<br>.text:<span class="hljs-number">0000000000401554</span>                 sub     rsp, <span class="hljs-number">30</span>h<br>.text:<span class="hljs-number">0000000000401558</span>                 mov     [rbp+arg_0], ecx<br>.text:<span class="hljs-number">000000000040155B</span>                 mov     [rbp+arg_8], rdx<br>.text:<span class="hljs-number">000000000040155F</span>                 call    __main<br>.text:<span class="hljs-number">0000000000401564</span>                 mov     [rbp+var_4], <span class="hljs-number">0</span>  <span class="hljs-comment">//a=0</span><br>.text:<span class="hljs-number">000000000040156B</span>                 mov     [rbp+var_8], <span class="hljs-number">0</span>    <span class="hljs-comment">//b=0</span><br>.text:<span class="hljs-number">0000000000401572</span>                 jmp     <span class="hljs-keyword">short</span> loc_40158B<br>.text:<span class="hljs-number">0000000000401574</span> ; ---------------------------------------------------------------------------<br>.text:<span class="hljs-number">0000000000401574</span><br>.text:<span class="hljs-number">0000000000401574</span> loc_401574:                             ; CODE XREF: main+<span class="hljs-number">3F</span>↓j<br>.text:<span class="hljs-number">0000000000401574</span>                 mov     eax, [rbp+var_4]<br>.text:<span class="hljs-number">0000000000401577</span>                 mov     edx, eax<br>.text:<span class="hljs-number">0000000000401579</span>                 lea     rcx, Format     ; <span class="hljs-string">&quot;%d&quot;</span>  <span class="hljs-comment">//printf(&#x27;%d&#x27;,a);</span><br>.text:<span class="hljs-number">0000000000401580</span>                 call    <span class="hljs-built_in">printf</span>      <br>.text:<span class="hljs-number">0000000000401585</span>                 mov     eax, [rbp+var_8]   <span class="hljs-comment">//a+b</span><br>.text:<span class="hljs-number">0000000000401588</span>                 add     [rbp+var_4], eax<br>.text:<span class="hljs-number">000000000040158B</span><br>.text:<span class="hljs-number">000000000040158B</span> loc_40158B:                             ; CODE XREF: main+<span class="hljs-number">22</span>↑j<br>.text:<span class="hljs-number">000000000040158B</span>                 cmp     [rbp+var_8], <span class="hljs-number">64</span>h ; <span class="hljs-string">&#x27;d&#x27;</span>  <span class="hljs-comment">//while(b&lt;100)</span><br>.text:<span class="hljs-number">000000000040158F</span>                 jle     <span class="hljs-keyword">short</span> loc_401574   <span class="hljs-comment">//小于执行loc_401574</span><br>.text:<span class="hljs-number">0000000000401591</span>                 mov     eax, [rbp+arg_0]<br>.text:<span class="hljs-number">0000000000401594</span>                 add     rsp, <span class="hljs-number">30</span>h<br>.text:<span class="hljs-number">0000000000401598</span>                 pop     rbp<br>.text:<span class="hljs-number">0000000000401599</span>                 retn<br>.text:<span class="hljs-number">0000000000401599</span> main            endp<br></code></pre></td></tr></table></figure>

<h3 id="for"><a href="#for" class="headerlink" title="for"></a>for</h3><p>​    for 需要三次跳转：1赋初值后要跳过步长 2循环条件的比较 3代码块执行完要跳回到步长（for也 可以转换为do）</p>
<p>​    for循环因为有步长的问题,所以多一次跳转. 其中 第一步跳转到 条件位置处,第二此跳转则判断条件是否成立,不成立则退出,此时找到for的下界,当前位置可以当做if的上界.</p>
<p>​    条件成立之后代码继续执行,则此时又来了一次跳转,此跳转跳转到步长执行代码</p>
<p>Release版本下</p>
<p>　　1.常量传播方式下 代码变为do while执行</p>
<p>　　2.代码外提情况下,代码变成了 if + do while的形式　</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-keyword">int</span> argc, <span class="hljs-keyword">char</span>* argv[])</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-keyword">int</span> nSum = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">for</span>(i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">100</span>;i++) <br>    &#123;<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d&quot;</span>,nSum);<br>        nSum = nSum + i;<br>    &#125;<br>    <span class="hljs-keyword">return</span> argc;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>对应的反汇编代码</p>
<h4 id="Debug"><a href="#Debug" class="headerlink" title="Debug"></a>Debug</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><code class="hljs c">.text:<span class="hljs-number">0000000000401550</span> ; <span class="hljs-function"><span class="hljs-keyword">int</span> __cdecl <span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-keyword">int</span> argc, <span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span> **argv, <span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span> **envp)</span></span><br><span class="hljs-function">.text:0000000000401550                 <span class="hljs-keyword">public</span> main</span><br><span class="hljs-function">.text:0000000000401550 main            proc near               </span>; CODE XREF: __tmainCRTStartup+<span class="hljs-number">242</span>↑p<br>.text:<span class="hljs-number">0000000000401550</span>                                         ; DATA XREF: .pdata:<span class="hljs-number">000000000040506</span>C↓o<br>.text:<span class="hljs-number">0000000000401550</span><br>.text:<span class="hljs-number">0000000000401550</span> var_8           = dword ptr <span class="hljs-number">-8</span><br>.text:<span class="hljs-number">0000000000401550</span> var_4           = dword ptr <span class="hljs-number">-4</span><br>.text:<span class="hljs-number">0000000000401550</span> arg_0           = dword ptr  <span class="hljs-number">10</span>h<br>.text:<span class="hljs-number">0000000000401550</span> arg_8           = qword ptr  <span class="hljs-number">18</span>h<br>.text:<span class="hljs-number">0000000000401550</span><br>.text:<span class="hljs-number">0000000000401550</span>                 push    rbp<br>.text:<span class="hljs-number">0000000000401551</span>                 mov     rbp, rsp<br>.text:<span class="hljs-number">0000000000401554</span>                 sub     rsp, <span class="hljs-number">30</span>h<br>.text:<span class="hljs-number">0000000000401558</span>                 mov     [rbp+arg_0], ecx<br>.text:<span class="hljs-number">000000000040155B</span>                 mov     [rbp+arg_8], rdx<br>.text:<span class="hljs-number">000000000040155F</span>                 call    __main<br><span class="hljs-comment">/*赋初值</span><br><span class="hljs-comment">.text:0000000000401564                 mov     [rbp+var_4], 0  //a=0</span><br><span class="hljs-comment">.text:000000000040156B                 mov     [rbp+var_8], 0  //b=0</span><br><span class="hljs-comment">.text:0000000000401572                 mov     [rbp+var_8], 0</span><br><span class="hljs-comment">.text:0000000000401579                 jmp     short loc_401596</span><br><span class="hljs-comment">    </span><br><span class="hljs-comment"></span><br><span class="hljs-comment">    </span><br><span class="hljs-comment">.text:000000000040157B ; ---------------------------------------------------------------------------</span><br><span class="hljs-comment">.text:000000000040157B</span><br><span class="hljs-comment"> */</span>  <br> <br>.text:<span class="hljs-number">000000000040157B</span> loc_40157B:                             ; CODE XREF: main+<span class="hljs-number">4</span>A↓j<br>.text:<span class="hljs-number">000000000040157B</span>                 mov     eax, [rbp+var_4]  <span class="hljs-comment">//eax=a</span><br>.text:<span class="hljs-number">000000000040157</span>E                 mov     edx, eax  <span class="hljs-comment">//edx=a</span><br>.text:<span class="hljs-number">0000000000401580</span>                 lea     rcx, Format     ; <span class="hljs-string">&quot;%d&quot;</span><br>.text:<span class="hljs-number">0000000000401587</span>                 call    <span class="hljs-built_in">printf</span>   <span class="hljs-comment">//输出a</span><br>.text:<span class="hljs-number">000000000040158</span>C                 mov     eax, [rbp+var_8]  <span class="hljs-comment">//eax=b</span><br>.text:<span class="hljs-number">000000000040158F</span>                 add     [rbp+var_4], eax  <span class="hljs-comment">//a+=b   </span><br>.text:<span class="hljs-number">0000000000401592</span>                 add     [rbp+var_8], <span class="hljs-number">1</span> <span class="hljs-comment">//b+=1  步长</span><br>.text:<span class="hljs-number">0000000000401596</span><br>.text:<span class="hljs-number">0000000000401596</span> loc_401596:                             ; CODE XREF: main+<span class="hljs-number">29</span>↑j<br>    <span class="hljs-comment">//比较</span><br>.text:<span class="hljs-number">0000000000401596</span>                 cmp     [rbp+var_8], <span class="hljs-number">63</span>h ; <span class="hljs-string">&#x27;c&#x27;</span>  <span class="hljs-comment">//99</span><br>.text:<span class="hljs-number">000000000040159</span>A                 jle     <span class="hljs-keyword">short</span> loc_40157B   <span class="hljs-comment">// </span><br>.text:<span class="hljs-number">000000000040159</span>C                 mov     eax, [rbp+arg_0]<br>.text:<span class="hljs-number">000000000040159F</span>                 add     rsp, <span class="hljs-number">30</span>h<br>.text:<span class="hljs-number">00000000004015</span>A3                 pop     rbp<br>.text:<span class="hljs-number">00000000004015</span>A4                 retn<br>.text:<span class="hljs-number">00000000004015</span>A4 main            endp<br></code></pre></td></tr></table></figure>



<h2 id="函数"><a href="#函数" class="headerlink" title="函数"></a>函数</h2><h3 id="三种调用方式"><a href="#三种调用方式" class="headerlink" title="三种调用方式"></a>三种调用方式</h3><h4 id="cdel-调用方平衡堆栈"><a href="#cdel-调用方平衡堆栈" class="headerlink" title="__cdel 调用方平衡堆栈"></a>__cdel 调用方平衡堆栈</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-function"><span class="hljs-keyword">int</span> __cdecl <span class="hljs-title">MyAdd</span><span class="hljs-params">(<span class="hljs-keyword">int</span> a,<span class="hljs-keyword">int</span> b)</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-keyword">return</span> a + b;<br>&#125;<br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-keyword">int</span> argc, <span class="hljs-keyword">char</span>* argv[])</span></span><br><span class="hljs-function"></span>&#123;<br>    MyAdd(<span class="hljs-number">3</span>,<span class="hljs-number">4</span>);<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>优点：可以用于可变参数函数（因为可变参数情况下，我传几个参数我是知道的，自己 传自己删<br>缺点：增加了代码长度，调用几次子函数，就要多几次栈平衡操作</p>
<p>解释：这里main函数对add产生调用，main属于调用方，所以在main函数这里平衡堆栈</p>
<p>即 在 call 子函数 之后 add 开辟空间</p>
<h4 id="stdcall-被调方平衡堆栈"><a href="#stdcall-被调方平衡堆栈" class="headerlink" title="__stdcall 被调方平衡堆栈"></a>__stdcall 被调方平衡堆栈</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-function">__int64 __stdcall <span class="hljs-title">MyAdd</span><span class="hljs-params">(<span class="hljs-keyword">float</span> a,<span class="hljs-keyword">double</span> b,<span class="hljs-keyword">int</span> c)</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-keyword">return</span> a + b + c;<br>&#125;<br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-keyword">int</span> argc, <span class="hljs-keyword">char</span>* argv[])</span></span><br><span class="hljs-function"></span>&#123;<br>    MyAdd(<span class="hljs-number">3.0f</span>,<span class="hljs-number">4.0f</span>,<span class="hljs-number">6</span>);<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>优点：节省代码长度 缺点：不支持可变参数（因为子函数是可重复使用的代码块，这段代码块一定是死的，<br>是不能再改变的，所以如果希望子函数平衡栈，那么它的参数个数必须确定）</p>
<p>解释：这里main函数对add产生调用，add函数属于被调用方，所以在add函数这里平衡堆栈</p>
<p>即 在 call 子函数 之前 add 开辟空间</p>
<h4 id="fastcall-stdcallfast版"><a href="#fastcall-stdcallfast版" class="headerlink" title="__fastcall stdcallfast版"></a>__fastcall stdcallfast版</h4><h2 id="数组"><a href="#数组" class="headerlink" title="数组"></a>数组</h2><p>​    特征：连续几次赋值类型相同，且赋值的目的地址是从低到高的。 而连续定义的局部变量其赋值地址是从高到低的。 而全局数组和静态数组看上去就和连续定义同类项变量没有区别<br>​    字符串：是以’\0’结尾的char数组</p>
<p>​    字符串赋初值时，不是一个char一个char复制的，而是优先4字节，再2字节，最后1字节 （4-2-1）<br>​    作为参数传递：数组作为参数传递会退化为指针，因此数组参数实际上是指针，此时不能使用 sizeof获取其长度<br>​    作为返回值：禁止！局部数组的生命周期在函数返回时就结束了，因此返回的内容将不确定 可以使用全局数组、静态数组、作为参数传入的数组 静态数组作为一个整体，只占一个代表初始化的标志位（好像 多维数组的存储方式：展成一维（多维数组是C语言概念，不是汇编的概念） 转成汇编后，常量下标和一维情况完全没有区别，如[ebp+1C];<br>​    数组寻址方式 数组名和指针的区别：指针访问元素的效率比数组名要低：原因是指针是个变量，使用时要 先访问这个变量的内容（数组的首地址），再偏移（两次寻址）；而数组名自身就是常值， 直接偏移即可（一次寻址） 一维数组下：<br>​    下标是常量：编译直接计算出地址 下标是变量：先取变量，再计算偏移 下标是表达式：看复杂程度，其余同上<br>​    二维数组：<br>​        两维都是常量：编辑直接计算出地址 有一维是常量：取一次变量，之后直接计算地址<br>​        两维都是变量：取第一个变量，计算出第二维的首地址；取第二个变量，结合计算出的 首地址，求出该元素的偏移<br>​    多维数组：类推</p>
<h3 id="一维数组"><a href="#一维数组" class="headerlink" title="一维数组"></a>一维数组</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-keyword">int</span> argc, <span class="hljs-keyword">char</span>* argv[])</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-keyword">int</span> Ary[<span class="hljs-number">3</span>] = &#123;<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">2</span>&#125;;<br>    <span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>;<br><br>    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d&quot;</span>,&amp;i);<br><br>    Ary[i] = <span class="hljs-number">3</span>;  <span class="hljs-comment">//这句话会产生数组寻址公式</span><br>    <span class="hljs-keyword">return</span> Ary[i];<br>&#125;<br></code></pre></td></tr></table></figure>

<p>反汇编</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs c">text:<span class="hljs-number">0000000000401550</span> ; <span class="hljs-function"><span class="hljs-keyword">int</span> __cdecl <span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-keyword">int</span> argc, <span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span> **argv, <span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span> **envp)</span></span><br><span class="hljs-function">.text:0000000000401550                 <span class="hljs-keyword">public</span> main</span><br><span class="hljs-function">.text:0000000000401550 main            proc near               </span>; CODE XREF: __tmainCRTStartup+<span class="hljs-number">242</span>↑p<br>.text:<span class="hljs-number">0000000000401550</span>                                         ; DATA XREF: .pdata:<span class="hljs-number">000000000040506</span>C↓o<br>.text:<span class="hljs-number">0000000000401550</span><br>.text:<span class="hljs-number">0000000000401550</span> var_10          = dword ptr <span class="hljs-number">-10</span>h<br>.text:<span class="hljs-number">0000000000401550</span> var_C           = dword ptr <span class="hljs-number">-0</span>Ch<br>.text:<span class="hljs-number">0000000000401550</span> var_8           = dword ptr <span class="hljs-number">-8</span><br>.text:<span class="hljs-number">0000000000401550</span> var_4           = dword ptr <span class="hljs-number">-4</span><br>.text:<span class="hljs-number">0000000000401550</span> arg_0           = dword ptr  <span class="hljs-number">10</span>h<br>.text:<span class="hljs-number">0000000000401550</span> arg_8           = qword ptr  <span class="hljs-number">18</span>h<br>.text:<span class="hljs-number">0000000000401550</span><br>.text:<span class="hljs-number">0000000000401550</span>                 push    rbp<br>.text:<span class="hljs-number">0000000000401551</span>                 mov     rbp, rsp<br>.text:<span class="hljs-number">0000000000401554</span>                 sub     rsp, <span class="hljs-number">30</span>h<br>.text:<span class="hljs-number">0000000000401558</span>                 mov     [rbp+arg_0], ecx<br>.text:<span class="hljs-number">000000000040155B</span>                 mov     [rbp+arg_8], rdx<br>.text:<span class="hljs-number">000000000040155F</span>                 call    __main<br>.text:<span class="hljs-number">0000000000401564</span>                 mov     [rbp+var_C], <span class="hljs-number">0</span>  <span class="hljs-comment">//a[0]=0</span><br>.text:<span class="hljs-number">000000000040156B</span>                 mov     [rbp+var_8], <span class="hljs-number">1</span>  <span class="hljs-comment">//a[1]=1</span><br>.text:<span class="hljs-number">0000000000401572</span>                 mov     [rbp+var_4], <span class="hljs-number">2</span>  <span class="hljs-comment">//a[2]=2</span><br>.text:<span class="hljs-number">0000000000401579</span>                 mov     [rbp+var_10], <span class="hljs-number">0</span>  <span class="hljs-comment">//a=0</span><br>.text:<span class="hljs-number">0000000000401580</span>                 lea     rax, [rbp+var_10] <br>.text:<span class="hljs-number">0000000000401584</span>                 mov     rdx, rax<br>.text:<span class="hljs-number">0000000000401587</span>                 lea     rcx, Format     ; <span class="hljs-string">&quot;%d&quot;</span> <span class="hljs-comment">//scanf(&quot;&quot;);</span><br>.text:<span class="hljs-number">000000000040158</span>E                 call    <span class="hljs-built_in">scanf</span><br>.text:<span class="hljs-number">0000000000401593</span>                 mov     eax, [rbp+var_10]<br>.text:<span class="hljs-number">0000000000401596</span>                 cdqe<br>.text:<span class="hljs-number">0000000000401598</span>                 mov     [rbp+rax*<span class="hljs-number">4</span>+var_C], <span class="hljs-number">3</span> <span class="hljs-comment">//a[]</span><br>.text:<span class="hljs-number">00000000004015</span>A0                 mov     eax, [rbp+var_10]<br>.text:<span class="hljs-number">00000000004015</span>A3                 cdqe<br>.text:<span class="hljs-number">00000000004015</span>A5                 mov     eax, [rbp+rax*<span class="hljs-number">4</span>+var_C]<br>.text:<span class="hljs-number">00000000004015</span>A9                 add     rsp, <span class="hljs-number">30</span>h<br>.text:<span class="hljs-number">00000000004015</span>AD                 pop     rbp<br>.text:<span class="hljs-number">00000000004015</span>AE                 retn<br>.text:<span class="hljs-number">00000000004015</span>AE main            endp<br></code></pre></td></tr></table></figure>

<h3 id="二维数组"><a href="#二维数组" class="headerlink" title="二维数组"></a>二维数组</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs C"><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-keyword">int</span> argc, <span class="hljs-keyword">char</span>* argv[])</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-keyword">int</span> Ary[<span class="hljs-number">2</span>][<span class="hljs-number">3</span>][<span class="hljs-number">4</span>] = &#123;<span class="hljs-number">0</span>&#125;;<br>    <span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">int</span> j = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">int</span> k = <span class="hljs-number">0</span>;<br>    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d%d%d&quot;</span>,&amp;i,&amp;j,&amp;k);<br><br>    Ary[i][j][k] = <span class="hljs-number">9</span>;  <span class="hljs-comment">//会产生数组寻址公式</span><br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>反汇编</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><code class="hljs c">.text:<span class="hljs-number">0000000000401550</span> ; <span class="hljs-function"><span class="hljs-keyword">int</span> __cdecl <span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-keyword">int</span> argc, <span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span> **argv, <span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span> **envp)</span></span><br><span class="hljs-function">.text:0000000000401550                 <span class="hljs-keyword">public</span> main</span><br><span class="hljs-function">.text:0000000000401550 main            proc near               </span>; CODE XREF: __tmainCRTStartup+<span class="hljs-number">242</span>↑p<br>.text:<span class="hljs-number">0000000000401550</span>                                         ; DATA XREF: .pdata:<span class="hljs-number">000000000040506</span>C↓o<br>.text:<span class="hljs-number">0000000000401550</span><br>.text:<span class="hljs-number">0000000000401550</span> var_7C          = dword ptr <span class="hljs-number">-7</span>Ch<br>.text:<span class="hljs-number">0000000000401550</span> var_78          = dword ptr <span class="hljs-number">-78</span>h<br>.text:<span class="hljs-number">0000000000401550</span> var_74          = dword ptr <span class="hljs-number">-74</span>h<br>.text:<span class="hljs-number">0000000000401550</span> var_70          = dword ptr <span class="hljs-number">-70</span>h<br>.text:<span class="hljs-number">0000000000401550</span> arg_0           = dword ptr  <span class="hljs-number">10</span>h<br>.text:<span class="hljs-number">0000000000401550</span> arg_8           = qword ptr  <span class="hljs-number">18</span>h<br>.text:<span class="hljs-number">0000000000401550</span><br>.text:<span class="hljs-number">0000000000401550</span>                 push    rbp<br>.text:<span class="hljs-number">0000000000401551</span>                 push    rdi<br>.text:<span class="hljs-number">0000000000401552</span>                 sub     rsp, <span class="hljs-number">98</span>h<br>.text:<span class="hljs-number">0000000000401559</span>                 lea     rbp, [rsp+<span class="hljs-number">80</span>h]<br>.text:<span class="hljs-number">0000000000401561</span>                 mov     [rbp+<span class="hljs-number">20</span>h+arg_0], ecx<br>.text:<span class="hljs-number">0000000000401564</span>                 mov     [rbp+<span class="hljs-number">20</span>h+arg_8], rdx<br>.text:<span class="hljs-number">0000000000401568</span>                 call    __main<br>.text:<span class="hljs-number">000000000040156</span>D                 lea     rdx, [rbp+<span class="hljs-number">20</span>h+var_70] <br>.text:<span class="hljs-number">0000000000401571</span>                 mov     eax, <span class="hljs-number">0</span><br>.text:<span class="hljs-number">0000000000401576</span>                 mov     ecx, <span class="hljs-number">0</span>Ch<br>.text:<span class="hljs-number">000000000040157B</span>                 mov     rdi, rdx<br>.text:<span class="hljs-number">000000000040157</span>E                 rep stosq<br>.text:<span class="hljs-number">0000000000401581</span>                 mov     [rbp+<span class="hljs-number">20</span>h+var_74], <span class="hljs-number">0</span>  <br>.text:<span class="hljs-number">0000000000401588</span>                 mov     [rbp+<span class="hljs-number">20</span>h+var_78], <span class="hljs-number">0</span><br>.text:<span class="hljs-number">000000000040158F</span>                 mov     [rbp+<span class="hljs-number">20</span>h+var_7C], <span class="hljs-number">0</span><br>.text:<span class="hljs-number">0000000000401596</span>                 lea     rcx, [rbp+<span class="hljs-number">20</span>h+var_7C]<br>.text:<span class="hljs-number">000000000040159</span>A                 lea     rdx, [rbp+<span class="hljs-number">20</span>h+var_78]<br>.text:<span class="hljs-number">000000000040159</span>E                 lea     rax, [rbp+<span class="hljs-number">20</span>h+var_74]<br>.text:<span class="hljs-number">00000000004015</span>A2                 mov     r9, rcx<br>.text:<span class="hljs-number">00000000004015</span>A5                 mov     r8, rdx<br>.text:<span class="hljs-number">00000000004015</span>A8                 mov     rdx, rax<br>.text:<span class="hljs-number">00000000004015</span>AB                 lea     rcx, Format     ; <span class="hljs-string">&quot;%d%d%d&quot;</span>  <span class="hljs-comment">//读取三维数组</span><br>.text:<span class="hljs-number">00000000004015B</span>2                 call    <span class="hljs-built_in">scanf</span><br>.text:<span class="hljs-number">00000000004015B</span>7                 mov     edx, [rbp+<span class="hljs-number">20</span>h+var_74]<br>.text:<span class="hljs-number">00000000004015B</span>A                 mov     eax, [rbp+<span class="hljs-number">20</span>h+var_78]<br>.text:<span class="hljs-number">00000000004015B</span>D                 mov     ecx, [rbp+<span class="hljs-number">20</span>h+var_7C]<br>.text:<span class="hljs-number">00000000004015</span>C0                 movsxd  rcx, ecx<br>.text:<span class="hljs-number">00000000004015</span>C3                 movsxd  rdx, edx<br>.text:<span class="hljs-number">00000000004015</span>C6                 movsxd  r8, eax<br>.text:<span class="hljs-number">00000000004015</span>C9                 mov     rax, rdx<br>.text:<span class="hljs-number">00000000004015</span>CC                 add     rax, rax<br>.text:<span class="hljs-number">00000000004015</span>CF                 add     rax, rdx<br>.text:<span class="hljs-number">00000000004015</span>D2                 add     rax, r8<br>.text:<span class="hljs-number">00000000004015</span>D5                 shl     rax, <span class="hljs-number">2</span><br>.text:<span class="hljs-number">00000000004015</span>D9                 add     rax, rcx<br>.text:<span class="hljs-number">00000000004015</span>DC                 mov     [rbp+rax*<span class="hljs-number">4</span>+<span class="hljs-number">20</span>h+var_70], <span class="hljs-number">9</span><br>.text:<span class="hljs-number">00000000004015E4</span>                 mov     eax, <span class="hljs-number">0</span><br>.text:<span class="hljs-number">00000000004015E9</span>                 add     rsp, <span class="hljs-number">98</span>h<br>.text:<span class="hljs-number">00000000004015F</span>0                 pop     rdi<br>.text:<span class="hljs-number">00000000004015F</span>1                 pop     rbp<br>.text:<span class="hljs-number">00000000004015F</span>2                 retn<br>.text:<span class="hljs-number">00000000004015F</span>2 main            endp<br></code></pre></td></tr></table></figure>

<p>公式先贴出来:</p>
<p>　　<strong>Ary + sizeof(type[C][H]) * i + sizeof(type[H])*j + sizeof(type)*k</strong></p>
<p> 代入公式看汇编</p>
<p>　　1.eax = i的值</p>
<p>  　　2. eax * 30 ,相当于求 sizeof(type[C][H]) * i</p>
<p>　　3.求出数组首地址+eax,也就是求出了 Ary[M]的位置,给Ecx赋值</p>
<p>　　4.求出j的值</p>
<p>　　5.左移4位,相当于2^4次方也就是16 这一步相当于求 sizeof(type[H])的值</p>
<p>　　6.ary[M] + sizeof(type[H])的值得出了 ary[M][C]的值</p>
<p>　　7.求出k的值</p>
<p>　　8.数组寻址公式 ary[M][C]的值 + 4 * k的值.</p>
<h2 id="结构体"><a href="#结构体" class="headerlink" title="结构体"></a>结构体</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">TagList</span></span><br><span class="hljs-class">&#123;</span><br>    <span class="hljs-keyword">char</span> ch;<br>    <span class="hljs-keyword">int</span>  number1;<br>    <span class="hljs-keyword">short</span> <span class="hljs-keyword">int</span> number2;<br>    <span class="hljs-keyword">double</span> dbl;<br>    <span class="hljs-keyword">float</span> flt;<br>&#125;;<br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">TagList</span> <span class="hljs-title">t1</span>=</span>&#123;<br>    <span class="hljs-string">&#x27;a&#x27;</span>,<br>    <span class="hljs-number">1</span>,<br>    <span class="hljs-number">2</span>,<br>    <span class="hljs-number">3.14</span>,<br>    <span class="hljs-number">0.0</span>    <br>    &#125;<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d&quot;</span>,<span class="hljs-keyword">sizeof</span>(t1));<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>对应反汇编</p>
<figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs x86asm"><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000401550</span> <span class="hljs-comment">; int __cdecl main(int argc, const char **argv, const char **envp)</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000401550</span>                 <span class="hljs-meta">public</span> main<br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000401550</span> main            proc <span class="hljs-built_in">near</span>               <span class="hljs-comment">; CODE XREF: __tmainCRTStartup+242↑p</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000401550</span>                                         <span class="hljs-comment">; DATA XREF: .pdata:000000000040506C↓o</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000401550</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000401550</span> var_20          = <span class="hljs-built_in">byte</span> <span class="hljs-built_in">ptr</span> -<span class="hljs-number">20h</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000401550</span> var_1C          = <span class="hljs-built_in">dword</span> <span class="hljs-built_in">ptr</span> -<span class="hljs-number">1Ch</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000401550</span> var_18          = <span class="hljs-built_in">word</span> <span class="hljs-built_in">ptr</span> -<span class="hljs-number">18h</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000401550</span> var_10          = <span class="hljs-built_in">qword</span> <span class="hljs-built_in">ptr</span> -<span class="hljs-number">10h</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000401550</span> var_8           = <span class="hljs-built_in">dword</span> <span class="hljs-built_in">ptr</span> -<span class="hljs-number">8</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000401550</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000401550</span>                 <span class="hljs-keyword">push</span>    <span class="hljs-built_in">rbp</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000401551</span>                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">rbp</span>, <span class="hljs-built_in">rsp</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000401554</span>                 <span class="hljs-keyword">sub</span>     <span class="hljs-built_in">rsp</span>, <span class="hljs-number">40h</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000401558</span>                 <span class="hljs-keyword">call</span>    __main<br><span class="hljs-symbol">.text:</span><span class="hljs-number">000000000040155D</span>                 <span class="hljs-keyword">mov</span>     [<span class="hljs-built_in">rbp</span>+var_20], <span class="hljs-number">61h</span> <span class="hljs-comment">; &#x27;a&#x27;</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000401561</span>                 <span class="hljs-keyword">mov</span>     [<span class="hljs-built_in">rbp</span>+var_1C], <span class="hljs-number">1</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000401568</span>                 <span class="hljs-keyword">mov</span>     [<span class="hljs-built_in">rbp</span>+var_18], <span class="hljs-number">2</span><br><span class="hljs-symbol">.text:</span>000000000040156E                 <span class="hljs-keyword">movsd</span>   <span class="hljs-built_in">xmm0</span>, <span class="hljs-built_in">cs</span>:qword_404008<br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000401576</span>                 <span class="hljs-keyword">movsd</span>   [<span class="hljs-built_in">rbp</span>+var_10], <span class="hljs-built_in">xmm0</span><br><span class="hljs-symbol">.text:</span>000000000040157B                 <span class="hljs-keyword">pxor</span>    <span class="hljs-built_in">xmm0</span>, <span class="hljs-built_in">xmm0</span><br><span class="hljs-symbol">.text:</span>000000000040157F                 <span class="hljs-keyword">movss</span>   [<span class="hljs-built_in">rbp</span>+var_8], <span class="hljs-built_in">xmm0</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000401584</span>                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">edx</span>, <span class="hljs-number">20h</span> <span class="hljs-comment">; &#x27; &#x27;</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000401589</span>                 <span class="hljs-keyword">lea</span>     <span class="hljs-built_in">rcx</span>, Format     <span class="hljs-comment">; &quot;%d&quot;</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000401590</span>                 <span class="hljs-keyword">call</span>    printf<br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000401595</span>                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">eax</span>, <span class="hljs-number">0</span><br><span class="hljs-symbol">.text:</span>000000000040159A                 <span class="hljs-keyword">add</span>     <span class="hljs-built_in">rsp</span>, <span class="hljs-number">40h</span><br><span class="hljs-symbol">.text:</span>000000000040159E                 <span class="hljs-keyword">pop</span>     <span class="hljs-built_in">rbp</span><br><span class="hljs-symbol">.text:</span>000000000040159F                 <span class="hljs-keyword">retn</span><br><span class="hljs-symbol">.text:</span>000000000040159F main            endp<br></code></pre></td></tr></table></figure>

<p>​    编译器对齐值,设置为 alg, MeMber offset 从0开始计算, 其中Member offset 要每次代入公式之后,加上自己成员所占的字节大小,继续参与下次运算</p>
<p>　　结构体成员偏移计算公式:  MeMber offset % min(alg,sizeof(Member type)) == 0</p>
<p>　　结构体总大小计算公式: 　 sizeof(struct) % min(Max type size,alg) == 0;</p>
<h4 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h4><p>​    （对象调用成员函数时） lea ecx, [xxx]<br>​    (成员函数中) mov xxx，ecx ; 直接就使用了ecx call 成员函数 stdcall和cdec方式都是push传参（最后一个PUSH）<br>​    lea reg, 寄存器首地址 push reg call 成员函数<br>​    当给函数传参时第一个参数是地址，那么可以怀疑这个是类对象的成员函数 对象作为参数传递<br>​    成员简单：直接当作变量压栈，先定义的成员后压栈，后定义的成员先压栈（保证在栈中的 顺序和定义时一样）<br>​    成员复杂：将整个对象复制到栈顶（相当于整个压栈），具体操作<br>​    sub esp, 类对象长度 ; 预先申请栈空间，用于存储类对象的形参 mov ecx, 10<br>​    ;设置循环次数10次<br>​    rep movs 栈顶，对象地址 ;就是类似memcpy，将内容整体拷贝到栈顶（刚刚开辟的位置） call fun…<br>​    对象作为返回值 调用前会将对象返回的位置作为参数压栈（也就是调用方准备好空间，告诉子函数地址，到<br>时候子函数返回的过程就是直接写进那个地址）</p>
<p>​    空类的实例占用1字节：目的是为了能够获取到该实例的地址 对象中先定义的变量在低地址处，后定义的变量在高地址处（类似数组） 内存对齐：<br>​    每个数据存放的地址必须是自身长度的整数倍 2结构体总长度必须是数据中最长类型长度的整数倍 如果指定了#pragma pack(n)，则原值和n取min 编译器用0xCC填充<br>​    类中静态变量：是具有作用域的全局变量（同静态变量） 所以静态成员变量可以生成对象就使用（用类访问） 也无需this指针<br>​    this指针：在对象调用自己的成员函数时，会MOV ecx, 对象首地址，而进入成员函数时会自动将 ecx入栈，也就是说，实际上函数多了一个参数，是指向自己对象首地址的指针，这就是this指 针。<br>​    thiscall方式特点：使用ecx传this指针</p>
<h2 id="防火墙"><a href="#防火墙" class="headerlink" title="防火墙"></a>防火墙</h2><p>​    什么是防火墙 – 一种高级访问控制设备，置于<strong>不同网络安全域 之间的一系列部件的组合</strong>，它是<strong>不同网络安全 域间通信流的唯一通道</strong>，能根据企业有关的安全政策控制（允许、拒绝、监视、记录）进出网络的访问行为。</p>
<p>1.简单包过滤防火墙：（综合安全性最差） </p>
<p>① 简单包过滤防火墙不检查数据区 ② 简单包过滤防火墙不建立连接状态表 ③ 前后报文无关 ④ 应用层控制很弱 ⑤ 处理对象：单个包报头</p>
<p>2.状态检测包过滤防火墙 </p>
<p>① 不检查数据区 ② 建立连接状态表 ③ 前后报文相关 ④ 应用层控制很弱 ⑤ 处理对象：单个包报头</p>
<p>3.应用代理防火墙</p>
<p>只检查数据，不查ip，tcp报头，不建立连接表，网络层保护较弱，处理数据包</p>
<p>4.核检测防火墙（综合安全性最好） </p>
<p>检查多个报文的会话，协议还原，上下文相关，处理一次对话</p>
<p>软件防火墙：保护整个网络 单机防火墙：保护澹台主机</p>
<p>防火墙的其他功能： 身份认证；审计、日志分析；带宽管理；负载均衡；与 IDS 联动；与病毒网关联动；与URL 服务<br>器联动；Mac 绑定；Map 映射…</p>

            </div>
            <hr>
            <div>
              <div class="post-metas mb-3">
                
                  <div class="post-meta mr-3">
                    <i class="iconfont icon-category"></i>
                    
                      <a class="hover-with-bg" href="/categories/%E9%80%86%E5%90%91/">逆向</a>
                    
                  </div>
                
                
              </div>
              <p class="note note-warning">
                <strong>本文作者: </strong><a href="/">D3n13d</a> <br>
                <strong>本文链接: </strong><a href="https://d3n13d.github.io/2022/01/07/C-%E9%80%86%E5%90%91%E7%AC%94%E8%AE%B0/">https://d3n13d.github.io/2022/01/07/C-%E9%80%86%E5%90%91%E7%AC%94%E8%AE%B0/</a> <br>
                <strong>版权声明: </strong>本博客所有文章除特别声明外，均采用 <a target="_blank" href="https://creativecommons.org/licenses/by-sa/4.0/deed.zh" rel="nofollow noopener noopener">CC BY-SA 4.0 协议</a> ，转载请注明出处！
                   </p>
                   
              <!-- 
                <p class="note note-warning">
                  
                    本博客所有文章除特别声明外，均采用 <a target="_blank" href="https://creativecommons.org/licenses/by-sa/4.0/deed.zh" rel="nofollow noopener noopener">CC BY-SA 4.0 协议</a> ，转载请注明出处！
                  
                </p>
               -->
              
                <div class="post-prevnext">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2022/01/08/RCTF2021%E9%83%A8%E5%88%86%E5%A4%8D%E7%8E%B0/">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">RCTF2021部分复现</span>
                        <span class="visible-mobile">上一篇</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                  </article>
                </div>
              
            </div>

            
              <!-- Comments -->
              <article class="comments" id="comments" lazyload>
                
                  
                
                
  <script type="text/javascript">
    Fluid.utils.loadComments('#comments', function() {
      var light = 'github-light';
      var dark = 'github-dark';
      var schema = document.documentElement.getAttribute('data-user-color-scheme');
      if (schema === 'dark') {
        schema = dark;
      } else {
        schema = light;
      }
      window.UtterancesThemeLight = light;
      window.UtterancesThemeDark = dark;
      var s = document.createElement('script');
      s.setAttribute('src', 'https://utteranc.es/client.js');
      s.setAttribute('repo', 'D3n13d/utterances');
      s.setAttribute('issue-term', 'title');
      
      s.setAttribute('theme', schema);
      s.setAttribute('crossorigin', 'anonymous');
      document.getElementById('comments').appendChild(s);
    })
  </script>
  <noscript>Please enable JavaScript to view the comments</noscript>


              </article>
            
          </article>
        </div>
      </div>
    </div>
    
      <div class="d-none d-lg-block col-lg-2 toc-container" id="toc-ctn">
        <div id="toc">
  <p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;目录</p>
  <div class="toc-body" id="toc-body"></div>
</div>

      </div>
    
  </div>
</div>

<!-- Custom -->


    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v"
                 for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>
    

    
  </main>

  <img src="https://photo-1308752946.cos.ap-beijing.myqcloud.com/img/Typora/202202110012686.png" srcset="/img/loading.gif" lazyload class="rounded mx-auto d-block mt-5" style="width:120px; height:120px;">
  <br>
  <center> # 曾记否，到中流击水，浪遏飞舟？ </center>
<footer class="text-center mt-5 py-3">

  
  <div class="footer-content">
    <div>
      <span id="timeDate">载入天数...</span>
      <span id="times">载入时分秒...</span>
      <script>
      var now = new Date();
      function createtime(){
          var grt= new Date("01/07/2022 00:00:00");//此处修改你的建站时间或者网站上线时间
          now.setTime(now.getTime()+250);
          days = (now - grt ) / 1000 / 60 / 60 / 24;
          dnum = Math.floor(days);
          hours = (now - grt ) / 1000 / 60 / 60 - (24 * dnum);
          hnum = Math.floor(hours);
          if(String(hnum).length ==1 ){
              hnum = "0" + hnum;
          }
          minutes = (now - grt ) / 1000 /60 - (24 * 60 * dnum) - (60 * hnum);
          mnum = Math.floor(minutes);
          if(String(mnum).length ==1 ){
                    mnum = "0" + mnum;
          }
          seconds = (now - grt ) / 1000 - (24 * 60 * 60 * dnum) - (60 * 60 * hnum) - (60 * mnum);
          snum = Math.round(seconds);
          if(String(snum).length ==1 ){
                    snum = "0" + snum;
          }
          
          document.getElementById("timeDate").innerHTML = "🚀 &nbsp;"+dnum+"&nbsp天";  //此次自定义显示内容
          document.getElementById("times").innerHTML = hnum + "&nbsp小时&nbsp" + mnum + "&nbsp分&nbsp" + snum + "&nbsp秒";
      }  //此次自定义显示内容
      setInterval("createtime()",250);
      </script>
    </div>
  </div>

  
  
    <!-- 不蒜子统计 -->
    
      <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
            <span >本站总访问量：
            <span id="busuanzi_value_site_pv"></span>次</span>
    
    
    
    
    
    
  <div>©2022<a href="https://d3n13d.github.io/">&nbsp;&nbsp;D3n13d 的快乐小屋</a></div>

  
</footer>

<!-- SCRIPTS -->
<!-- 
  <script  src="https://cdn.jsdelivr.net/npm/nprogress@0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/nprogress@0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":true,"trickleSpeed":80})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js" ></script>
<script  src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>

<!-- Plugins -->


  <script  src="/js/local-search.js" ></script>



  
    <script  src="/js/img-lazyload.js" ></script>
  



  



  
    <script  src="https://cdn.jsdelivr.net/npm/tocbot@4/dist/tocbot.min.js" ></script>
  
  
    <script  src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3/dist/jquery.fancybox.min.js" ></script>
  
  
    <script  src="https://cdn.jsdelivr.net/npm/anchor-js@4/anchor.min.js" ></script>
  
  
    <script defer src="https://cdn.jsdelivr.net/npm/clipboard@2/dist/clipboard.min.js" ></script>
  



  <script defer src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" ></script>




  <script  src="https://cdn.jsdelivr.net/npm/typed.js@2/lib/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var title = document.getElementById('subtitle').title;
      
        typing(title);
      
    })(window, document);
  </script>














  
<script src="//cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.js"></script>
<script src="//cdn.jsdelivr.net/gh/metowolf/MetingJS@1.2/dist/Meting.min.js"></script>



<!-- 主题的启动项 保持在最底部 -->
<script  src="/js/boot.js" ></script>
 -->



  <!-- SCRIPTS -->
  
  <script  src="https://cdn.jsdelivr.net/npm/nprogress@0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/nprogress@0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":true,"trickleSpeed":80})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js" ></script>
<script  src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>

<!-- Plugins -->


  <script  src="/js/local-search.js" ></script>



  
    <script  src="/js/img-lazyload.js" ></script>
  



  



  
    <script  src="https://cdn.jsdelivr.net/npm/tocbot@4/dist/tocbot.min.js" ></script>
  
  
    <script  src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3/dist/jquery.fancybox.min.js" ></script>
  
  
    <script  src="https://cdn.jsdelivr.net/npm/anchor-js@4/anchor.min.js" ></script>
  
  
    <script defer src="https://cdn.jsdelivr.net/npm/clipboard@2/dist/clipboard.min.js" ></script>
  



  <script defer src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" ></script>




  <script  src="https://cdn.jsdelivr.net/npm/typed.js@2/lib/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var title = document.getElementById('subtitle').title;
      
        typing(title);
      
    })(window, document);
  </script>














  
<script src="//cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.js"></script>
<script src="//cdn.jsdelivr.net/gh/metowolf/MetingJS@1.2/dist/Meting.min.js"></script>



<!-- 主题的启动项 保持在最底部 -->
<script  src="/js/boot.js" ></script>


<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"log":false,"pluginJsPath":"lib/","pluginModelPath":"assets/","pluginRootPath":"live2dw/","tagMode":false});</script></body>
</html>
